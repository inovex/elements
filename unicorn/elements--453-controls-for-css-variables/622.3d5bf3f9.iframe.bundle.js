/*! For license information please see 622.3d5bf3f9.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_inovex_de_elements_storybook=self.webpackChunk_inovex_de_elements_storybook||[]).push([[622],{"../elements/dist/esm/_commonjsHelpers-212d567a.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>commonjsGlobal,c:()=>createCommonjsModule,g:()=>getDefaultExportFromCjs});__webpack_require__("../../node_modules/core-js/modules/es.global-this.js");var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function require(path,base){return function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},module.exports),module.exports}},"../elements/dist/esm/helpers-8b0cd51e.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>hasValue,r:()=>renderHiddenInput});__webpack_require__("../../node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../../node_modules/core-js/modules/es.function.name.js");function hasValue(str){return null!=str&&""!==str.trim()}var renderHiddenInput=function renderHiddenInput(container,name,value,disabled){var input=container.querySelector("input.aux-input");return input||((input=container.ownerDocument.createElement("input")).type="hidden",input.classList.add("aux-input"),container.appendChild(input)),input.disabled=disabled,input.name=name,input.value=value||"",input}},"../elements/dist/esm/index-796d4780.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>classnames});__webpack_require__("../../node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.join.js");var classnames=(0,__webpack_require__("../elements/dist/esm/_commonjsHelpers-212d567a.js").c)((function(module){!function(){var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}}else if("object"===argType){if(arg.toString!==Object.prototype.toString&&!arg.toString.toString().includes("[native code]")){classes.push(arg.toString());continue}for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):window.classNames=classNames}()}))},"../elements/dist/esm/ino-markdown-editor.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ino_markdown_editor:()=>MarkdownEditor});__webpack_require__("../../node_modules/core-js/modules/es.symbol.to-primitive.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.to-primitive.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.reflect.construct.js"),__webpack_require__("../../node_modules/core-js/modules/es.reflect.get.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.splice.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("../../node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.join.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.to-json.js"),__webpack_require__("../../node_modules/core-js/modules/web.url.to-json.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../../node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.find-index.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.create.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.match.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.reverse.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.split.js"),__webpack_require__("../../node_modules/core-js/modules/es.number.constructor.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.some.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.replace.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.last-index-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.anchor.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.now.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../../node_modules/core-js/modules/es.map.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/web.timers.js"),__webpack_require__("../../node_modules/core-js/modules/es.promise.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.every.js"),__webpack_require__("../../node_modules/core-js/modules/es.set.js"),__webpack_require__("../../node_modules/core-js/modules/es.weak-map.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.from-entries.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.match-all.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.flat.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.starts-with.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.freeze.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.values.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.search.js"),__webpack_require__("../../node_modules/core-js/modules/es.parse-int.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.ends-with.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.constructor.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.define-properties.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.bold.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.italics.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.strike.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.from-code-point.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.repeat.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.link.js");var _marks3,_Object$assign5,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__=__webpack_require__("../elements/dist/esm/index-2ff82bb8.js"),_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__=__webpack_require__("../elements/dist/esm/index-796d4780.js"),_helpers_8b0cd51e_js__WEBPACK_IMPORTED_MODULE_78__=__webpack_require__("../elements/dist/esm/helpers-8b0cd51e.js"),_tslib_es6_973a6cc3_js__WEBPACK_IMPORTED_MODULE_79__=__webpack_require__("../elements/dist/esm/tslib.es6-973a6cc3.js"),_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_80__=__webpack_require__("../elements/dist/esm/_commonjsHelpers-212d567a.js"),_excluded=["start"];function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(target,property,receiver){var base=function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _construct(Parent,args,Class){return _construct=_isNativeReflectConstruct()?Reflect.construct.bind():function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}function OrderedMap(content){this.content=content}function _findDiffStart(a,b,pos){for(var _i2=0;;_i2++){if(_i2==a.childCount||_i2==b.childCount)return a.childCount==b.childCount?null:pos;var childA=a.child(_i2),childB=b.child(_i2);if(childA!=childB){if(!childA.sameMarkup(childB))return pos;if(childA.isText&&childA.text!=childB.text){for(var j=0;childA.text[j]==childB.text[j];j++)pos++;return pos}if(childA.content.size||childB.content.size){var inner=_findDiffStart(childA.content,childB.content,pos+1);if(null!=inner)return inner}pos+=childA.nodeSize}else pos+=childA.nodeSize}}function _findDiffEnd(a,b,posA,posB){for(var iA=a.childCount,iB=b.childCount;;){if(0==iA||0==iB)return iA==iB?null:{a:posA,b:posB};var childA=a.child(--iA),childB=b.child(--iB),size=childA.nodeSize;if(childA!=childB){if(!childA.sameMarkup(childB))return{a:posA,b:posB};if(childA.isText&&childA.text!=childB.text){for(var same=0,minSize=Math.min(childA.text.length,childB.text.length);same<minSize&&childA.text[childA.text.length-same-1]==childB.text[childB.text.length-same-1];)same++,posA--,posB--;return{a:posA,b:posB}}if(childA.content.size||childB.content.size){var inner=_findDiffEnd(childA.content,childB.content,posA-1,posB-1);if(inner)return inner}posA-=size,posB-=size}else posA-=size,posB-=size}}OrderedMap.prototype={constructor:OrderedMap,find:function find(key){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===key)return i;return-1},get:function get(key){var found=this.find(key);return-1==found?void 0:this.content[found+1]},update:function update(key,value,newKey){var self=newKey&&newKey!=key?this.remove(newKey):this,found=self.find(key),content=self.content.slice();return-1==found?content.push(newKey||key,value):(content[found+1]=value,newKey&&(content[found]=newKey)),new OrderedMap(content)},remove:function remove(key){var found=this.find(key);if(-1==found)return this;var content=this.content.slice();return content.splice(found,2),new OrderedMap(content)},addToStart:function addToStart(key,value){return new OrderedMap([key,value].concat(this.remove(key).content))},addToEnd:function addToEnd(key,value){var content=this.remove(key).content.slice();return content.push(key,value),new OrderedMap(content)},addBefore:function addBefore(place,key,value){var without=this.remove(key),content=without.content.slice(),found=without.find(place);return content.splice(-1==found?content.length:found,0,key,value),new OrderedMap(content)},forEach:function forEach(f){for(var i=0;i<this.content.length;i+=2)f(this.content[i],this.content[i+1])},prepend:function prepend(map){return(map=OrderedMap.from(map)).size?new OrderedMap(map.content.concat(this.subtract(map).content)):this},append:function append(map){return(map=OrderedMap.from(map)).size?new OrderedMap(this.subtract(map).content.concat(map.content)):this},subtract:function subtract(map){var result=this;map=OrderedMap.from(map);for(var i=0;i<map.content.length;i+=2)result=result.remove(map.content[i]);return result},toObject:function toObject(){var result={};return this.forEach((function(key,value){result[key]=value})),result},get size(){return this.content.length>>1}},OrderedMap.from=function(value){if(value instanceof OrderedMap)return value;var content=[];if(value)for(var prop in value)content.push(prop,value[prop]);return new OrderedMap(content)};var Fragment=function(){function Fragment(content,size){if(_classCallCheck(this,Fragment),this.content=content,this.size=size||0,null==size)for(var _i4=0;_i4<content.length;_i4++)this.size+=content[_i4].nodeSize}return _createClass(Fragment,[{key:"nodesBetween",value:function nodesBetween(from,to,f){for(var nodeStart=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,parent=arguments.length>4?arguments[4]:void 0,_i6=0,pos=0;pos<to;_i6++){var child=this.content[_i6],end=pos+child.nodeSize;if(end>from&&!1!==f(child,nodeStart+pos,parent||null,_i6)&&child.content.size){var start=pos+1;child.nodesBetween(Math.max(0,from-start),Math.min(child.content.size,to-start),f,nodeStart+start)}pos=end}}},{key:"descendants",value:function descendants(f){this.nodesBetween(0,this.size,f)}},{key:"textBetween",value:function textBetween(from,to,blockSeparator,leafText){var text="",separated=!0;return this.nodesBetween(from,to,(function(node,pos){node.isText?(text+=node.text.slice(Math.max(from,pos)-pos,to-pos),separated=!blockSeparator):node.isLeaf?(leafText?text+="function"==typeof leafText?leafText(node):leafText:node.type.spec.leafText&&(text+=node.type.spec.leafText(node)),separated=!blockSeparator):!separated&&node.isBlock&&(text+=blockSeparator,separated=!0)}),0),text}},{key:"append",value:function append(other){if(!other.size)return this;if(!this.size)return other;var last=this.lastChild,first=other.firstChild,content=this.content.slice(),i=0;for(last.isText&&last.sameMarkup(first)&&(content[content.length-1]=last.withText(last.text+first.text),i=1);i<other.content.length;i++)content.push(other.content[i]);return new Fragment(content,this.size+other.size)}},{key:"cut",value:function cut(from){var to=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==from&&to==this.size)return this;var result=[],size=0;if(to>from)for(var _i8=0,pos=0;pos<to;_i8++){var child=this.content[_i8],end=pos+child.nodeSize;end>from&&((pos<from||end>to)&&(child=child.isText?child.cut(Math.max(0,from-pos),Math.min(child.text.length,to-pos)):child.cut(Math.max(0,from-pos-1),Math.min(child.content.size,to-pos-1))),result.push(child),size+=child.nodeSize),pos=end}return new Fragment(result,size)}},{key:"cutByIndex",value:function cutByIndex(from,to){return from==to?Fragment.empty:0==from&&to==this.content.length?this:new Fragment(this.content.slice(from,to))}},{key:"replaceChild",value:function replaceChild(index,node){var current=this.content[index];if(current==node)return this;var copy=this.content.slice(),size=this.size+node.nodeSize-current.nodeSize;return copy[index]=node,new Fragment(copy,size)}},{key:"addToStart",value:function addToStart(node){return new Fragment([node].concat(this.content),this.size+node.nodeSize)}},{key:"addToEnd",value:function addToEnd(node){return new Fragment(this.content.concat(node),this.size+node.nodeSize)}},{key:"eq",value:function eq(other){if(this.content.length!=other.content.length)return!1;for(var _i10=0;_i10<this.content.length;_i10++)if(!this.content[_i10].eq(other.content[_i10]))return!1;return!0}},{key:"firstChild",get:function get(){return this.content.length?this.content[0]:null}},{key:"lastChild",get:function get(){return this.content.length?this.content[this.content.length-1]:null}},{key:"childCount",get:function get(){return this.content.length}},{key:"child",value:function child(index){var found=this.content[index];if(!found)throw new RangeError("Index "+index+" out of range for "+this);return found}},{key:"maybeChild",value:function maybeChild(index){return this.content[index]||null}},{key:"forEach",value:function forEach(f){for(var _i12=0,p=0;_i12<this.content.length;_i12++){var child=this.content[_i12];f(child,p,_i12),p+=child.nodeSize}}},{key:"findDiffStart",value:function findDiffStart(other){return _findDiffStart(this,other,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}},{key:"findDiffEnd",value:function findDiffEnd(other){return _findDiffEnd(this,other,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,arguments.length>2&&void 0!==arguments[2]?arguments[2]:other.size)}},{key:"findIndex",value:function findIndex(pos){var round=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0==pos)return retIndex(0,pos);if(pos==this.size)return retIndex(this.content.length,pos);if(pos>this.size||pos<0)throw new RangeError("Position "+pos+" outside of fragment ("+this+")");for(var _i14=0,curPos=0;;_i14++){var end=curPos+this.child(_i14).nodeSize;if(end>=pos)return end==pos||round>0?retIndex(_i14+1,end):retIndex(_i14,curPos);curPos=end}}},{key:"toString",value:function toString(){return"<"+this.toStringInner()+">"}},{key:"toStringInner",value:function toStringInner(){return this.content.join(", ")}},{key:"toJSON",value:function toJSON(){return this.content.length?this.content.map((function(n){return n.toJSON()})):null}}],[{key:"fromJSON",value:function fromJSON(schema,value){if(!value)return Fragment.empty;if(!Array.isArray(value))throw new RangeError("Invalid input for Fragment.fromJSON");return new Fragment(value.map(schema.nodeFromJSON))}},{key:"fromArray",value:function fromArray(array){if(!array.length)return Fragment.empty;for(var joined,size=0,_i16=0;_i16<array.length;_i16++){var node=array[_i16];size+=node.nodeSize,_i16&&node.isText&&array[_i16-1].sameMarkup(node)?(joined||(joined=array.slice(0,_i16)),joined[joined.length-1]=node.withText(joined[joined.length-1].text+node.text)):joined&&joined.push(node)}return new Fragment(joined||array,size)}},{key:"from",value:function from(nodes){if(!nodes)return Fragment.empty;if(nodes instanceof Fragment)return nodes;if(Array.isArray(nodes))return this.fromArray(nodes);if(nodes.attrs)return new Fragment([nodes],nodes.nodeSize);throw new RangeError("Can not convert "+nodes+" to a Fragment"+(nodes.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}]),Fragment}();Fragment.empty=new Fragment([],0);var found={index:0,offset:0};function retIndex(index,offset){return found.index=index,found.offset=offset,found}function compareDeep(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var array=Array.isArray(a);if(Array.isArray(b)!=array)return!1;if(array){if(a.length!=b.length)return!1;for(var _i18=0;_i18<a.length;_i18++)if(!compareDeep(a[_i18],b[_i18]))return!1}else{for(var p in a)if(!(p in b)||!compareDeep(a[p],b[p]))return!1;for(var _p3 in b)if(!(_p3 in a))return!1}return!0}var Mark$1=function(){function Mark$1(type,attrs){_classCallCheck(this,Mark$1),this.type=type,this.attrs=attrs}return _createClass(Mark$1,[{key:"addToSet",value:function addToSet(set){for(var copy,placed=!1,_i20=0;_i20<set.length;_i20++){var other=set[_i20];if(this.eq(other))return set;if(this.type.excludes(other.type))copy||(copy=set.slice(0,_i20));else{if(other.type.excludes(this.type))return set;!placed&&other.type.rank>this.type.rank&&(copy||(copy=set.slice(0,_i20)),copy.push(this),placed=!0),copy&&copy.push(other)}}return copy||(copy=set.slice()),placed||copy.push(this),copy}},{key:"removeFromSet",value:function removeFromSet(set){for(var _i22=0;_i22<set.length;_i22++)if(this.eq(set[_i22]))return set.slice(0,_i22).concat(set.slice(_i22+1));return set}},{key:"isInSet",value:function isInSet(set){for(var _i24=0;_i24<set.length;_i24++)if(this.eq(set[_i24]))return!0;return!1}},{key:"eq",value:function eq(other){return this==other||this.type==other.type&&compareDeep(this.attrs,other.attrs)}},{key:"toJSON",value:function toJSON(){var obj={type:this.type.name};for(var _ in this.attrs){obj.attrs=this.attrs;break}return obj}}],[{key:"fromJSON",value:function fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Mark.fromJSON");var type=schema.marks[json.type];if(!type)throw new RangeError("There is no mark type "+json.type+" in this schema");return type.create(json.attrs)}},{key:"sameSet",value:function sameSet(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(var _i26=0;_i26<a.length;_i26++)if(!a[_i26].eq(b[_i26]))return!1;return!0}},{key:"setFrom",value:function setFrom(marks){if(!marks||Array.isArray(marks)&&0==marks.length)return Mark$1.none;if(marks instanceof Mark$1)return[marks];var copy=marks.slice();return copy.sort((function(a,b){return a.type.rank-b.type.rank})),copy}}]),Mark$1}();Mark$1.none=[];var ReplaceError=function(_Error){_inherits(ReplaceError,_Error);var _super=_createSuper(ReplaceError);function ReplaceError(){return _classCallCheck(this,ReplaceError),_super.apply(this,arguments)}return _createClass(ReplaceError)}(_wrapNativeSuper(Error)),Slice=function(){function Slice(content,openStart,openEnd){_classCallCheck(this,Slice),this.content=content,this.openStart=openStart,this.openEnd=openEnd}return _createClass(Slice,[{key:"size",get:function get(){return this.content.size-this.openStart-this.openEnd}},{key:"insertAt",value:function insertAt(pos,fragment){var content=insertInto(this.content,pos+this.openStart,fragment);return content&&new Slice(content,this.openStart,this.openEnd)}},{key:"removeBetween",value:function removeBetween(from,to){return new Slice(removeRange(this.content,from+this.openStart,to+this.openStart),this.openStart,this.openEnd)}},{key:"eq",value:function eq(other){return this.content.eq(other.content)&&this.openStart==other.openStart&&this.openEnd==other.openEnd}},{key:"toString",value:function toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}},{key:"toJSON",value:function toJSON(){if(!this.content.size)return null;var json={content:this.content.toJSON()};return this.openStart>0&&(json.openStart=this.openStart),this.openEnd>0&&(json.openEnd=this.openEnd),json}}],[{key:"fromJSON",value:function fromJSON(schema,json){if(!json)return Slice.empty;var openStart=json.openStart||0,openEnd=json.openEnd||0;if("number"!=typeof openStart||"number"!=typeof openEnd)throw new RangeError("Invalid input for Slice.fromJSON");return new Slice(Fragment.fromJSON(schema,json.content),openStart,openEnd)}},{key:"maxOpen",value:function maxOpen(fragment){for(var openIsolating=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],openStart=0,openEnd=0,n=fragment.firstChild;n&&!n.isLeaf&&(openIsolating||!n.type.spec.isolating);n=n.firstChild)openStart++;for(var _n2=fragment.lastChild;_n2&&!_n2.isLeaf&&(openIsolating||!_n2.type.spec.isolating);_n2=_n2.lastChild)openEnd++;return new Slice(fragment,openStart,openEnd)}}]),Slice}();function removeRange(content,from,to){var _content$findIndex=content.findIndex(from),index=_content$findIndex.index,offset=_content$findIndex.offset,child=content.maybeChild(index),_content$findIndex2=content.findIndex(to),indexTo=_content$findIndex2.index,offsetTo=_content$findIndex2.offset;if(offset==from||child.isText){if(offsetTo!=to&&!content.child(indexTo).isText)throw new RangeError("Removing non-flat range");return content.cut(0,from).append(content.cut(to))}if(index!=indexTo)throw new RangeError("Removing non-flat range");return content.replaceChild(index,child.copy(removeRange(child.content,from-offset-1,to-offset-1)))}function insertInto(content,dist,insert,parent){var _content$findIndex3=content.findIndex(dist),index=_content$findIndex3.index,offset=_content$findIndex3.offset,child=content.maybeChild(index);if(offset==dist||child.isText)return parent&&!parent.canReplace(index,index,insert)?null:content.cut(0,dist).append(insert).append(content.cut(dist));var inner=insertInto(child.content,dist-offset-1,insert);return inner&&content.replaceChild(index,child.copy(inner))}function _replace($from,$to,slice){if(slice.openStart>$from.depth)throw new ReplaceError("Inserted content deeper than insertion position");if($from.depth-slice.openStart!=$to.depth-slice.openEnd)throw new ReplaceError("Inconsistent open depths");return replaceOuter($from,$to,slice,0)}function replaceOuter($from,$to,slice,depth){var index=$from.index(depth),node=$from.node(depth);if(index==$to.index(depth)&&depth<$from.depth-slice.openStart){var inner=replaceOuter($from,$to,slice,depth+1);return node.copy(node.content.replaceChild(index,inner))}if(slice.content.size){if(slice.openStart||slice.openEnd||$from.depth!=depth||$to.depth!=depth){var _prepareSliceForRepla=function prepareSliceForReplace(slice,$along){for(var extra=$along.depth-slice.openStart,node=$along.node(extra).copy(slice.content),_i30=extra-1;_i30>=0;_i30--)node=$along.node(_i30).copy(Fragment.from(node));return{start:node.resolveNoCache(slice.openStart+extra),end:node.resolveNoCache(node.content.size-slice.openEnd-extra)}}(slice,$from);return close(node,replaceThreeWay($from,_prepareSliceForRepla.start,_prepareSliceForRepla.end,$to,depth))}var parent=$from.parent,content=parent.content;return close(parent,content.cut(0,$from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))}return close(node,replaceTwoWay($from,$to,depth))}function checkJoin(main,sub){if(!sub.type.compatibleContent(main.type))throw new ReplaceError("Cannot join "+sub.type.name+" onto "+main.type.name)}function joinable$1($before,$after,depth){var node=$before.node(depth);return checkJoin(node,$after.node(depth)),node}function addNode(child,target){var last=target.length-1;last>=0&&child.isText&&child.sameMarkup(target[last])?target[last]=child.withText(target[last].text+child.text):target.push(child)}function addRange($start,$end,depth,target){var node=($end||$start).node(depth),startIndex=0,endIndex=$end?$end.index(depth):node.childCount;$start&&(startIndex=$start.index(depth),$start.depth>depth?startIndex++:$start.textOffset&&(addNode($start.nodeAfter,target),startIndex++));for(var _i28=startIndex;_i28<endIndex;_i28++)addNode(node.child(_i28),target);$end&&$end.depth==depth&&$end.textOffset&&addNode($end.nodeBefore,target)}function close(node,content){return node.type.checkContent(content),node.copy(content)}function replaceThreeWay($from,$start,$end,$to,depth){var openStart=$from.depth>depth&&joinable$1($from,$start,depth+1),openEnd=$to.depth>depth&&joinable$1($end,$to,depth+1),content=[];return addRange(null,$from,depth,content),openStart&&openEnd&&$start.index(depth)==$end.index(depth)?(checkJoin(openStart,openEnd),addNode(close(openStart,replaceThreeWay($from,$start,$end,$to,depth+1)),content)):(openStart&&addNode(close(openStart,replaceTwoWay($from,$start,depth+1)),content),addRange($start,$end,depth,content),openEnd&&addNode(close(openEnd,replaceTwoWay($end,$to,depth+1)),content)),addRange($to,null,depth,content),new Fragment(content)}function replaceTwoWay($from,$to,depth){var content=[];(addRange(null,$from,depth,content),$from.depth>depth)&&addNode(close(joinable$1($from,$to,depth+1),replaceTwoWay($from,$to,depth+1)),content);return addRange($to,null,depth,content),new Fragment(content)}Slice.empty=new Slice(Fragment.empty,0,0);var ResolvedPos=function(){function ResolvedPos(pos,path,parentOffset){_classCallCheck(this,ResolvedPos),this.pos=pos,this.path=path,this.parentOffset=parentOffset,this.depth=path.length/3-1}return _createClass(ResolvedPos,[{key:"resolveDepth",value:function resolveDepth(val){return null==val?this.depth:val<0?this.depth+val:val}},{key:"parent",get:function get(){return this.node(this.depth)}},{key:"doc",get:function get(){return this.node(0)}},{key:"node",value:function node(depth){return this.path[3*this.resolveDepth(depth)]}},{key:"index",value:function index(depth){return this.path[3*this.resolveDepth(depth)+1]}},{key:"indexAfter",value:function indexAfter(depth){return depth=this.resolveDepth(depth),this.index(depth)+(depth!=this.depth||this.textOffset?1:0)}},{key:"start",value:function start(depth){return 0==(depth=this.resolveDepth(depth))?0:this.path[3*depth-1]+1}},{key:"end",value:function end(depth){return depth=this.resolveDepth(depth),this.start(depth)+this.node(depth).content.size}},{key:"before",value:function before(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position before the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]}},{key:"after",value:function after(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position after the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]+this.path[3*depth].nodeSize}},{key:"textOffset",get:function get(){return this.pos-this.path[this.path.length-1]}},{key:"nodeAfter",get:function get(){var parent=this.parent,index=this.index(this.depth);if(index==parent.childCount)return null;var dOff=this.pos-this.path[this.path.length-1],child=parent.child(index);return dOff?parent.child(index).cut(dOff):child}},{key:"nodeBefore",get:function get(){var index=this.index(this.depth),dOff=this.pos-this.path[this.path.length-1];return dOff?this.parent.child(index).cut(0,dOff):0==index?null:this.parent.child(index-1)}},{key:"posAtIndex",value:function posAtIndex(index,depth){depth=this.resolveDepth(depth);for(var node=this.path[3*depth],pos=0==depth?0:this.path[3*depth-1]+1,_i32=0;_i32<index;_i32++)pos+=node.child(_i32).nodeSize;return pos}},{key:"marks",value:function marks(){var parent=this.parent,index=this.index();if(0==parent.content.size)return Mark$1.none;if(this.textOffset)return parent.child(index).marks;var main=parent.maybeChild(index-1),other=parent.maybeChild(index);if(!main){var tmp=main;main=other,other=tmp}for(var marks=main.marks,i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||other&&marks[i].isInSet(other.marks)||(marks=marks[i--].removeFromSet(marks));return marks}},{key:"marksAcross",value:function marksAcross($end){var after=this.parent.maybeChild(this.index());if(!after||!after.isInline)return null;for(var marks=after.marks,next=$end.parent.maybeChild($end.index()),i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||next&&marks[i].isInSet(next.marks)||(marks=marks[i--].removeFromSet(marks));return marks}},{key:"sharedDepth",value:function sharedDepth(pos){for(var depth=this.depth;depth>0;depth--)if(this.start(depth)<=pos&&this.end(depth)>=pos)return depth;return 0}},{key:"blockRange",value:function blockRange(){var other=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,pred=arguments.length>1?arguments[1]:void 0;if(other.pos<this.pos)return other.blockRange(this);for(var d=this.depth-(this.parent.inlineContent||this.pos==other.pos?1:0);d>=0;d--)if(other.pos<=this.end(d)&&(!pred||pred(this.node(d))))return new NodeRange(this,other,d);return null}},{key:"sameParent",value:function sameParent(other){return this.pos-this.parentOffset==other.pos-other.parentOffset}},{key:"max",value:function max(other){return other.pos>this.pos?other:this}},{key:"min",value:function min(other){return other.pos<this.pos?other:this}},{key:"toString",value:function toString(){for(var str="",_i34=1;_i34<=this.depth;_i34++)str+=(str?"/":"")+this.node(_i34).type.name+"_"+this.index(_i34-1);return str+":"+this.parentOffset}}],[{key:"resolve",value:function resolve(doc,pos){if(!(pos>=0&&pos<=doc.content.size))throw new RangeError("Position "+pos+" out of range");for(var path=[],start=0,parentOffset=pos,node=doc;;){var _node$content$findInd=node.content.findIndex(parentOffset),index=_node$content$findInd.index,offset=_node$content$findInd.offset,rem=parentOffset-offset;if(path.push(node,index,start+offset),!rem)break;if((node=node.child(index)).isText)break;parentOffset=rem-1,start+=offset+1}return new ResolvedPos(pos,path,parentOffset)}},{key:"resolveCached",value:function resolveCached(doc,pos){for(var _i36=0;_i36<resolveCache.length;_i36++){var cached=resolveCache[_i36];if(cached.pos==pos&&cached.doc==doc)return cached}var result=resolveCache[resolveCachePos]=ResolvedPos.resolve(doc,pos);return resolveCachePos=(resolveCachePos+1)%resolveCacheSize,result}}]),ResolvedPos}(),resolveCache=[],resolveCachePos=0,resolveCacheSize=12,NodeRange=function(){function NodeRange($from,$to,depth){_classCallCheck(this,NodeRange),this.$from=$from,this.$to=$to,this.depth=depth}return _createClass(NodeRange,[{key:"start",get:function get(){return this.$from.before(this.depth+1)}},{key:"end",get:function get(){return this.$to.after(this.depth+1)}},{key:"parent",get:function get(){return this.$from.node(this.depth)}},{key:"startIndex",get:function get(){return this.$from.index(this.depth)}},{key:"endIndex",get:function get(){return this.$to.indexAfter(this.depth)}}]),NodeRange}(),emptyAttrs=Object.create(null),Node$1=function(){function Node$1(type,attrs,content){var marks=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Mark$1.none;_classCallCheck(this,Node$1),this.type=type,this.attrs=attrs,this.marks=marks,this.content=content||Fragment.empty}return _createClass(Node$1,[{key:"nodeSize",get:function get(){return this.isLeaf?1:2+this.content.size}},{key:"childCount",get:function get(){return this.content.childCount}},{key:"child",value:function child(index){return this.content.child(index)}},{key:"maybeChild",value:function maybeChild(index){return this.content.maybeChild(index)}},{key:"forEach",value:function forEach(f){this.content.forEach(f)}},{key:"nodesBetween",value:function nodesBetween(from,to,f){var startPos=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(from,to,f,startPos,this)}},{key:"descendants",value:function descendants(f){this.nodesBetween(0,this.content.size,f)}},{key:"textContent",get:function get(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}},{key:"textBetween",value:function textBetween(from,to,blockSeparator,leafText){return this.content.textBetween(from,to,blockSeparator,leafText)}},{key:"firstChild",get:function get(){return this.content.firstChild}},{key:"lastChild",get:function get(){return this.content.lastChild}},{key:"eq",value:function eq(other){return this==other||this.sameMarkup(other)&&this.content.eq(other.content)}},{key:"sameMarkup",value:function sameMarkup(other){return this.hasMarkup(other.type,other.attrs,other.marks)}},{key:"hasMarkup",value:function hasMarkup(type,attrs,marks){return this.type==type&&compareDeep(this.attrs,attrs||type.defaultAttrs||emptyAttrs)&&Mark$1.sameSet(this.marks,marks||Mark$1.none)}},{key:"copy",value:function copy(){var content=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return content==this.content?this:new Node$1(this.type,this.attrs,content,this.marks)}},{key:"mark",value:function mark(marks){return marks==this.marks?this:new Node$1(this.type,this.attrs,this.content,marks)}},{key:"cut",value:function cut(from){var to=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==from&&to==this.content.size?this:this.copy(this.content.cut(from,to))}},{key:"slice",value:function slice(from){var to=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,includeParents=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(from==to)return Slice.empty;var $from=this.resolve(from),$to=this.resolve(to),depth=includeParents?0:$from.sharedDepth(to),start=$from.start(depth),content=$from.node(depth).content.cut($from.pos-start,$to.pos-start);return new Slice(content,$from.depth-depth,$to.depth-depth)}},{key:"replace",value:function replace(from,to,slice){return _replace(this.resolve(from),this.resolve(to),slice)}},{key:"nodeAt",value:function nodeAt(pos){for(var node=this;;){var _node$content$findInd2=node.content.findIndex(pos),index=_node$content$findInd2.index,offset=_node$content$findInd2.offset;if(!(node=node.maybeChild(index)))return null;if(offset==pos||node.isText)return node;pos-=offset+1}}},{key:"childAfter",value:function childAfter(pos){var _this$content$findInd=this.content.findIndex(pos),index=_this$content$findInd.index,offset=_this$content$findInd.offset;return{node:this.content.maybeChild(index),index,offset}}},{key:"childBefore",value:function childBefore(pos){if(0==pos)return{node:null,index:0,offset:0};var _this$content$findInd2=this.content.findIndex(pos),index=_this$content$findInd2.index,offset=_this$content$findInd2.offset;if(offset<pos)return{node:this.content.child(index),index,offset};var node=this.content.child(index-1);return{node,index:index-1,offset:offset-node.nodeSize}}},{key:"resolve",value:function resolve(pos){return ResolvedPos.resolveCached(this,pos)}},{key:"resolveNoCache",value:function resolveNoCache(pos){return ResolvedPos.resolve(this,pos)}},{key:"rangeHasMark",value:function rangeHasMark(from,to,type){var found=!1;return to>from&&this.nodesBetween(from,to,(function(node){return type.isInSet(node.marks)&&(found=!0),!found})),found}},{key:"isBlock",get:function get(){return this.type.isBlock}},{key:"isTextblock",get:function get(){return this.type.isTextblock}},{key:"inlineContent",get:function get(){return this.type.inlineContent}},{key:"isInline",get:function get(){return this.type.isInline}},{key:"isText",get:function get(){return this.type.isText}},{key:"isLeaf",get:function get(){return this.type.isLeaf}},{key:"isAtom",get:function get(){return this.type.isAtom}},{key:"toString",value:function toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var name=this.type.name;return this.content.size&&(name+="("+this.content.toStringInner()+")"),wrapMarks(this.marks,name)}},{key:"contentMatchAt",value:function contentMatchAt(index){var match=this.type.contentMatch.matchFragment(this.content,0,index);if(!match)throw new Error("Called contentMatchAt on a node with invalid content");return match}},{key:"canReplace",value:function canReplace(from,to){var replacement=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fragment.empty,start=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,end=arguments.length>4&&void 0!==arguments[4]?arguments[4]:replacement.childCount,one=this.contentMatchAt(from).matchFragment(replacement,start,end),two=one&&one.matchFragment(this.content,to);if(!two||!two.validEnd)return!1;for(var _i38=start;_i38<end;_i38++)if(!this.type.allowsMarks(replacement.child(_i38).marks))return!1;return!0}},{key:"canReplaceWith",value:function canReplaceWith(from,to,type,marks){if(marks&&!this.type.allowsMarks(marks))return!1;var start=this.contentMatchAt(from).matchType(type),end=start&&start.matchFragment(this.content,to);return!!end&&end.validEnd}},{key:"canAppend",value:function canAppend(other){return other.content.size?this.canReplace(this.childCount,this.childCount,other.content):this.type.compatibleContent(other.type)}},{key:"check",value:function check(){this.type.checkContent(this.content);for(var copy=Mark$1.none,_i40=0;_i40<this.marks.length;_i40++)copy=this.marks[_i40].addToSet(copy);if(!Mark$1.sameSet(copy,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(m){return m.type.name})));this.content.forEach((function(node){return node.check()}))}},{key:"toJSON",value:function toJSON(){var obj={type:this.type.name};for(var _ in this.attrs){obj.attrs=this.attrs;break}return this.content.size&&(obj.content=this.content.toJSON()),this.marks.length&&(obj.marks=this.marks.map((function(n){return n.toJSON()}))),obj}}],[{key:"fromJSON",value:function fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Node.fromJSON");var marks=null;if(json.marks){if(!Array.isArray(json.marks))throw new RangeError("Invalid mark data for Node.fromJSON");marks=json.marks.map(schema.markFromJSON)}if("text"==json.type){if("string"!=typeof json.text)throw new RangeError("Invalid text node in JSON");return schema.text(json.text,marks)}var content=Fragment.fromJSON(schema,json.content);return schema.nodeType(json.type).create(json.attrs,content,marks)}}]),Node$1}();Node$1.prototype.text=void 0;var TextNode=function(_Node$){_inherits(TextNode,_Node$);var _super2=_createSuper(TextNode);function TextNode(type,attrs,content,marks){var _this;if(_classCallCheck(this,TextNode),_this=_super2.call(this,type,attrs,null,marks),!content)throw new RangeError("Empty text nodes are not allowed");return _this.text=content,_this}return _createClass(TextNode,[{key:"toString",value:function toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wrapMarks(this.marks,JSON.stringify(this.text))}},{key:"textContent",get:function get(){return this.text}},{key:"textBetween",value:function textBetween(from,to){return this.text.slice(from,to)}},{key:"nodeSize",get:function get(){return this.text.length}},{key:"mark",value:function mark(marks){return marks==this.marks?this:new TextNode(this.type,this.attrs,this.text,marks)}},{key:"withText",value:function withText(text){return text==this.text?this:new TextNode(this.type,this.attrs,text,this.marks)}},{key:"cut",value:function cut(){var from=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,to=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==from&&to==this.text.length?this:this.withText(this.text.slice(from,to))}},{key:"eq",value:function eq(other){return this.sameMarkup(other)&&this.text==other.text}},{key:"toJSON",value:function toJSON(){var base=_get(_getPrototypeOf(TextNode.prototype),"toJSON",this).call(this);return base.text=this.text,base}}]),TextNode}(Node$1);function wrapMarks(marks,str){for(var _i42=marks.length-1;_i42>=0;_i42--)str=marks[_i42].type.name+"("+str+")";return str}var ContentMatch=function(){function ContentMatch(validEnd){_classCallCheck(this,ContentMatch),this.validEnd=validEnd,this.next=[],this.wrapCache=[]}return _createClass(ContentMatch,[{key:"matchType",value:function matchType(type){for(var _i44=0;_i44<this.next.length;_i44++)if(this.next[_i44].type==type)return this.next[_i44].next;return null}},{key:"matchFragment",value:function matchFragment(frag){for(var start=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:frag.childCount,cur=this,_i46=start;cur&&_i46<end;_i46++)cur=cur.matchType(frag.child(_i46).type);return cur}},{key:"inlineContent",get:function get(){return 0!=this.next.length&&this.next[0].type.isInline}},{key:"defaultType",get:function get(){for(var _i48=0;_i48<this.next.length;_i48++){var type=this.next[_i48].type;if(!type.isText&&!type.hasRequiredAttrs())return type}return null}},{key:"compatible",value:function compatible(other){for(var _i50=0;_i50<this.next.length;_i50++)for(var j=0;j<other.next.length;j++)if(this.next[_i50].type==other.next[j].type)return!0;return!1}},{key:"fillBefore",value:function fillBefore(after){var toEnd=arguments.length>1&&void 0!==arguments[1]&&arguments[1],startIndex=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,seen=[this];return function search(match,types){var finished=match.matchFragment(after,startIndex);if(finished&&(!toEnd||finished.validEnd))return Fragment.from(types.map((function(tp){return tp.createAndFill()})));for(var _i52=0;_i52<match.next.length;_i52++){var _match$next$_i=match.next[_i52],type=_match$next$_i.type,next=_match$next$_i.next;if(!type.isText&&!type.hasRequiredAttrs()&&-1==seen.indexOf(next)){seen.push(next);var _found=search(next,types.concat(type));if(_found)return _found}}return null}(this,[])}},{key:"findWrapping",value:function findWrapping(target){for(var _i54=0;_i54<this.wrapCache.length;_i54+=2)if(this.wrapCache[_i54]==target)return this.wrapCache[_i54+1];var computed=this.computeWrapping(target);return this.wrapCache.push(target,computed),computed}},{key:"computeWrapping",value:function computeWrapping(target){for(var seen=Object.create(null),active=[{match:this,type:null,via:null}];active.length;){var current=active.shift(),match=current.match;if(match.matchType(target)){for(var result=[],obj=current;obj.type;obj=obj.via)result.push(obj.type);return result.reverse()}for(var _i56=0;_i56<match.next.length;_i56++){var _match$next$_i2=match.next[_i56],type=_match$next$_i2.type,next=_match$next$_i2.next;type.isLeaf||type.hasRequiredAttrs()||type.name in seen||current.type&&!next.validEnd||(active.push({match:type.contentMatch,type,via:current}),seen[type.name]=!0)}}return null}},{key:"edgeCount",get:function get(){return this.next.length}},{key:"edge",value:function edge(n){if(n>=this.next.length)throw new RangeError("There's no "+n+"th edge in this content match");return this.next[n]}},{key:"toString",value:function toString(){var seen=[];return function scan(m){seen.push(m);for(var _i58=0;_i58<m.next.length;_i58++)-1==seen.indexOf(m.next[_i58].next)&&scan(m.next[_i58].next)}(this),seen.map((function(m,i){for(var out=i+(m.validEnd?"*":" ")+" ",_i60=0;_i60<m.next.length;_i60++)out+=(_i60?", ":"")+m.next[_i60].type.name+"->"+seen.indexOf(m.next[_i60].next);return out})).join("\n")}}],[{key:"parse",value:function parse(string,nodeTypes){var stream=new TokenStream(string,nodeTypes);if(null==stream.next)return ContentMatch.empty;var expr=parseExpr(stream);stream.next&&stream.err("Unexpected trailing text");var match=dfa(function nfa(expr){var nfa=[[]];return connect(compile(expr,0),node()),nfa;function node(){return nfa.push([])-1}function edge(from,to,term){var edge={term,to};return nfa[from].push(edge),edge}function connect(edges,to){edges.forEach((function(edge){return edge.to=to}))}function compile(expr,from){if("choice"==expr.type)return expr.exprs.reduce((function(out,expr){return out.concat(compile(expr,from))}),[]);if("seq"!=expr.type){if("star"==expr.type){var loop=node();return edge(from,loop),connect(compile(expr.expr,loop),loop),[edge(loop)]}if("plus"==expr.type){var _loop=node();return connect(compile(expr.expr,from),_loop),connect(compile(expr.expr,_loop),_loop),[edge(_loop)]}if("opt"==expr.type)return[edge(from)].concat(compile(expr.expr,from));if("range"==expr.type){for(var cur=from,_i64=0;_i64<expr.min;_i64++){var _next=node();connect(compile(expr.expr,cur),_next),cur=_next}if(-1==expr.max)connect(compile(expr.expr,cur),cur);else for(var _i66=expr.min;_i66<expr.max;_i66++){var _next2=node();edge(cur,_next2),connect(compile(expr.expr,cur),_next2),cur=_next2}return[edge(cur)]}if("name"==expr.type)return[edge(from,void 0,expr.value)];throw new Error("Unknown expr type")}for(var _i62=0;;_i62++){var next=compile(expr.exprs[_i62],from);if(_i62==expr.exprs.length-1)return next;connect(next,from=node())}}}(expr));return function checkForDeadEnds(match,stream){for(var _i74=0,work=[match];_i74<work.length;_i74++){for(var state=work[_i74],dead=!state.validEnd,nodes=[],j=0;j<state.next.length;j++){var _state$next$j=state.next[j],type=_state$next$j.type,next=_state$next$j.next;nodes.push(type.name),!dead||type.isText||type.hasRequiredAttrs()||(dead=!1),-1==work.indexOf(next)&&work.push(next)}dead&&stream.err("Only non-generatable nodes ("+nodes.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(match,stream),match}}]),ContentMatch}();ContentMatch.empty=new ContentMatch(!0);var TokenStream=function(){function TokenStream(string,nodeTypes){_classCallCheck(this,TokenStream),this.string=string,this.nodeTypes=nodeTypes,this.inline=null,this.pos=0,this.tokens=string.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}return _createClass(TokenStream,[{key:"next",get:function get(){return this.tokens[this.pos]}},{key:"eat",value:function eat(tok){return this.next==tok&&(this.pos++||!0)}},{key:"err",value:function err(str){throw new SyntaxError(str+" (in content expression '"+this.string+"')")}}]),TokenStream}();function parseExpr(stream){var exprs=[];do{exprs.push(parseExprSeq(stream))}while(stream.eat("|"));return 1==exprs.length?exprs[0]:{type:"choice",exprs}}function parseExprSeq(stream){var exprs=[];do{exprs.push(parseExprSubscript(stream))}while(stream.next&&")"!=stream.next&&"|"!=stream.next);return 1==exprs.length?exprs[0]:{type:"seq",exprs}}function parseExprSubscript(stream){for(var expr=function parseExprAtom(stream){if(stream.eat("(")){var expr=parseExpr(stream);return stream.eat(")")||stream.err("Missing closing paren"),expr}if(!/\W/.test(stream.next)){var exprs=function resolveName(stream,name){var types=stream.nodeTypes,type=types[name];if(type)return[type];var result=[];for(var typeName in types){var _type=types[typeName];_type.groups.indexOf(name)>-1&&result.push(_type)}0==result.length&&stream.err("No node type or group '"+name+"' found");return result}(stream,stream.next).map((function(type){return null==stream.inline?stream.inline=type.isInline:stream.inline!=type.isInline&&stream.err("Mixing inline and block content"),{type:"name",value:type}}));return stream.pos++,1==exprs.length?exprs[0]:{type:"choice",exprs}}stream.err("Unexpected token '"+stream.next+"'")}(stream);;)if(stream.eat("+"))expr={type:"plus",expr};else if(stream.eat("*"))expr={type:"star",expr};else if(stream.eat("?"))expr={type:"opt",expr};else{if(!stream.eat("{"))break;expr=parseExprRange(stream,expr)}return expr}function parseNum(stream){/\D/.test(stream.next)&&stream.err("Expected number, got '"+stream.next+"'");var result=Number(stream.next);return stream.pos++,result}function parseExprRange(stream,expr){var min=parseNum(stream),max=min;return stream.eat(",")&&(max="}"!=stream.next?parseNum(stream):-1),stream.eat("}")||stream.err("Unclosed braced range"),{type:"range",min,max,expr}}function cmp(a,b){return b-a}function nullFrom(nfa,node){var result=[];return function scan(node){var edges=nfa[node];if(1==edges.length&&!edges[0].term)return scan(edges[0].to);result.push(node);for(var _i68=0;_i68<edges.length;_i68++){var _edges$_i=edges[_i68],term=_edges$_i.term,to=_edges$_i.to;term||-1!=result.indexOf(to)||scan(to)}}(node),result.sort(cmp)}function dfa(nfa){var labeled=Object.create(null);return function explore(states){var out=[];states.forEach((function(node){nfa[node].forEach((function(_ref2){var term=_ref2.term,to=_ref2.to;if(term){for(var set,_i70=0;_i70<out.length;_i70++)out[_i70][0]==term&&(set=out[_i70][1]);nullFrom(nfa,to).forEach((function(node){set||out.push([term,set=[]]),-1==set.indexOf(node)&&set.push(node)}))}}))}));for(var state=labeled[states.join(",")]=new ContentMatch(states.indexOf(nfa.length-1)>-1),_i72=0;_i72<out.length;_i72++){var _states=out[_i72][1].sort(cmp);state.next.push({type:out[_i72][0],next:labeled[_states.join(",")]||explore(_states)})}return state}(nullFrom(nfa,0))}function defaultAttrs(attrs){var defaults=Object.create(null);for(var attrName in attrs){var attr=attrs[attrName];if(!attr.hasDefault)return null;defaults[attrName]=attr.default}return defaults}function _computeAttrs(attrs,value){var built=Object.create(null);for(var name in attrs){var given=value&&value[name];if(void 0===given){var attr=attrs[name];if(!attr.hasDefault)throw new RangeError("No value supplied for attribute "+name);given=attr.default}built[name]=given}return built}function initAttrs(attrs){var result=Object.create(null);if(attrs)for(var name in attrs)result[name]=new Attribute(attrs[name]);return result}var NodeType$1=function(){function NodeType$1(name,schema,spec){_classCallCheck(this,NodeType$1),this.name=name,this.schema=schema,this.spec=spec,this.markSet=null,this.groups=spec.group?spec.group.split(" "):[],this.attrs=initAttrs(spec.attrs),this.defaultAttrs=defaultAttrs(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(spec.inline||"text"==name),this.isText="text"==name}return _createClass(NodeType$1,[{key:"isInline",get:function get(){return!this.isBlock}},{key:"isTextblock",get:function get(){return this.isBlock&&this.inlineContent}},{key:"isLeaf",get:function get(){return this.contentMatch==ContentMatch.empty}},{key:"isAtom",get:function get(){return this.isLeaf||!!this.spec.atom}},{key:"whitespace",get:function get(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}},{key:"hasRequiredAttrs",value:function hasRequiredAttrs(){for(var n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1}},{key:"compatibleContent",value:function compatibleContent(other){return this==other||this.contentMatch.compatible(other.contentMatch)}},{key:"computeAttrs",value:function computeAttrs(attrs){return!attrs&&this.defaultAttrs?this.defaultAttrs:_computeAttrs(this.attrs,attrs)}},{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,content=arguments.length>1?arguments[1]:void 0,marks=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Node$1(this,this.computeAttrs(attrs),Fragment.from(content),Mark$1.setFrom(marks))}},{key:"createChecked",value:function createChecked(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,content=arguments.length>1?arguments[1]:void 0,marks=arguments.length>2?arguments[2]:void 0;return content=Fragment.from(content),this.checkContent(content),new Node$1(this,this.computeAttrs(attrs),content,Mark$1.setFrom(marks))}},{key:"createAndFill",value:function createAndFill(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,content=arguments.length>1?arguments[1]:void 0,marks=arguments.length>2?arguments[2]:void 0;if(attrs=this.computeAttrs(attrs),(content=Fragment.from(content)).size){var before=this.contentMatch.fillBefore(content);if(!before)return null;content=before.append(content)}var matched=this.contentMatch.matchFragment(content),after=matched&&matched.fillBefore(Fragment.empty,!0);return after?new Node$1(this,attrs,content.append(after),Mark$1.setFrom(marks)):null}},{key:"validContent",value:function validContent(content){var result=this.contentMatch.matchFragment(content);if(!result||!result.validEnd)return!1;for(var _i76=0;_i76<content.childCount;_i76++)if(!this.allowsMarks(content.child(_i76).marks))return!1;return!0}},{key:"checkContent",value:function checkContent(content){if(!this.validContent(content))throw new RangeError("Invalid content for node "+this.name+": "+content.toString().slice(0,50))}},{key:"allowsMarkType",value:function allowsMarkType(markType){return null==this.markSet||this.markSet.indexOf(markType)>-1}},{key:"allowsMarks",value:function allowsMarks(marks){if(null==this.markSet)return!0;for(var _i78=0;_i78<marks.length;_i78++)if(!this.allowsMarkType(marks[_i78].type))return!1;return!0}},{key:"allowedMarks",value:function allowedMarks(marks){if(null==this.markSet)return marks;for(var copy,_i80=0;_i80<marks.length;_i80++)this.allowsMarkType(marks[_i80].type)?copy&&copy.push(marks[_i80]):copy||(copy=marks.slice(0,_i80));return copy?copy.length?copy:Mark$1.none:marks}}],[{key:"compile",value:function compile(nodes,schema){var result=Object.create(null);nodes.forEach((function(name,spec){return result[name]=new NodeType$1(name,schema,spec)}));var topType=schema.spec.topNode||"doc";if(!result[topType])throw new RangeError("Schema is missing its top node type ('"+topType+"')");if(!result.text)throw new RangeError("Every schema needs a 'text' type");for(var _ in result.text.attrs)throw new RangeError("The text node type should not have attributes");return result}}]),NodeType$1}(),Attribute=function(){function Attribute(options){_classCallCheck(this,Attribute),this.hasDefault=Object.prototype.hasOwnProperty.call(options,"default"),this.default=options.default}return _createClass(Attribute,[{key:"isRequired",get:function get(){return!this.hasDefault}}]),Attribute}(),MarkType=function(){function MarkType(name,rank,schema,spec){_classCallCheck(this,MarkType),this.name=name,this.rank=rank,this.schema=schema,this.spec=spec,this.attrs=initAttrs(spec.attrs),this.excluded=null;var defaults=defaultAttrs(this.attrs);this.instance=defaults?new Mark$1(this,defaults):null}return _createClass(MarkType,[{key:"create",value:function create(){var attrs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!attrs&&this.instance?this.instance:new Mark$1(this,_computeAttrs(this.attrs,attrs))}},{key:"removeFromSet",value:function removeFromSet(set){for(var i=0;i<set.length;i++)set[i].type==this&&(set=set.slice(0,i).concat(set.slice(i+1)),i--);return set}},{key:"isInSet",value:function isInSet(set){for(var _i82=0;_i82<set.length;_i82++)if(set[_i82].type==this)return set[_i82]}},{key:"excludes",value:function excludes(other){return this.excluded.indexOf(other)>-1}}],[{key:"compile",value:function compile(marks,schema){var result=Object.create(null),rank=0;return marks.forEach((function(name,spec){return result[name]=new MarkType(name,rank++,schema,spec)})),result}}]),MarkType}(),Schema=function(){function Schema(spec){_classCallCheck(this,Schema),this.cached=Object.create(null);var instanceSpec=this.spec={};for(var _prop2 in spec)instanceSpec[_prop2]=spec[_prop2];instanceSpec.nodes=OrderedMap.from(spec.nodes),instanceSpec.marks=OrderedMap.from(spec.marks||{}),this.nodes=NodeType$1.compile(this.spec.nodes,this),this.marks=MarkType.compile(this.spec.marks,this);var contentExprCache=Object.create(null);for(var _prop4 in this.nodes){if(_prop4 in this.marks)throw new RangeError(_prop4+" can not be both a node and a mark");var type=this.nodes[_prop4],contentExpr=type.spec.content||"",markExpr=type.spec.marks;type.contentMatch=contentExprCache[contentExpr]||(contentExprCache[contentExpr]=ContentMatch.parse(contentExpr,this.nodes)),type.inlineContent=type.contentMatch.inlineContent,type.markSet="_"==markExpr?null:markExpr?gatherMarks(this,markExpr.split(" ")):""!=markExpr&&type.inlineContent?null:[]}for(var _prop6 in this.marks){var _type2=this.marks[_prop6],_excl=_type2.spec.excludes;_type2.excluded=null==_excl?[_type2]:""==_excl?[]:gatherMarks(this,_excl.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}return _createClass(Schema,[{key:"node",value:function node(type){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,content=arguments.length>2?arguments[2]:void 0,marks=arguments.length>3?arguments[3]:void 0;if("string"==typeof type)type=this.nodeType(type);else{if(!(type instanceof NodeType$1))throw new RangeError("Invalid node type: "+type);if(type.schema!=this)throw new RangeError("Node type from different schema used ("+type.name+")")}return type.createChecked(attrs,content,marks)}},{key:"text",value:function text(_text,marks){var type=this.nodes.text;return new TextNode(type,type.defaultAttrs,_text,Mark$1.setFrom(marks))}},{key:"mark",value:function mark(type,attrs){return"string"==typeof type&&(type=this.marks[type]),type.create(attrs)}},{key:"nodeFromJSON",value:function nodeFromJSON(json){return Node$1.fromJSON(this,json)}},{key:"markFromJSON",value:function markFromJSON(json){return Mark$1.fromJSON(this,json)}},{key:"nodeType",value:function nodeType(name){var found=this.nodes[name];if(!found)throw new RangeError("Unknown node type: "+name);return found}}]),Schema}();function gatherMarks(schema,marks){for(var found=[],_i84=0;_i84<marks.length;_i84++){var name=marks[_i84],mark=schema.marks[name],ok=mark;if(mark)found.push(mark);else for(var _prop8 in schema.marks){var _mark2=schema.marks[_prop8];("_"==name||_mark2.spec.group&&_mark2.spec.group.split(" ").indexOf(name)>-1)&&found.push(ok=_mark2)}if(!ok)throw new SyntaxError("Unknown mark type: '"+marks[_i84]+"'")}return found}var DOMParser=function(){function DOMParser(schema,rules){var _this2=this;_classCallCheck(this,DOMParser),this.schema=schema,this.rules=rules,this.tags=[],this.styles=[],rules.forEach((function(rule){rule.tag?_this2.tags.push(rule):rule.style&&_this2.styles.push(rule)})),this.normalizeLists=!this.tags.some((function(r){if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;var node=schema.nodes[r.node];return node.contentMatch.matchType(node)}))}return _createClass(DOMParser,[{key:"parse",value:function parse(dom){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},context=new ParseContext(this,options,!1);return context.addAll(dom,options.from,options.to),context.finish()}},{key:"parseSlice",value:function parseSlice(dom){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},context=new ParseContext(this,options,!0);return context.addAll(dom,options.from,options.to),Slice.maxOpen(context.finish())}},{key:"matchTag",value:function matchTag(dom,context,after){for(var _i86=after?this.tags.indexOf(after)+1:0;_i86<this.tags.length;_i86++){var rule=this.tags[_i86];if(matches(dom,rule.tag)&&(void 0===rule.namespace||dom.namespaceURI==rule.namespace)&&(!rule.context||context.matchesContext(rule.context))){if(rule.getAttrs){var result=rule.getAttrs(dom);if(!1===result)continue;rule.attrs=result||void 0}return rule}}}},{key:"matchStyle",value:function matchStyle(prop,value,context,after){for(var _i88=after?this.styles.indexOf(after)+1:0;_i88<this.styles.length;_i88++){var rule=this.styles[_i88],_style=rule.style;if(!(0!=_style.indexOf(prop)||rule.context&&!context.matchesContext(rule.context)||_style.length>prop.length&&(61!=_style.charCodeAt(prop.length)||_style.slice(prop.length+1)!=value))){if(rule.getAttrs){var result=rule.getAttrs(value);if(!1===result)continue;rule.attrs=result||void 0}return rule}}}}],[{key:"schemaRules",value:function schemaRules(schema){var result=[];function insert(rule){for(var priority=null==rule.priority?50:rule.priority,i=0;i<result.length;i++){var next=result[i];if((null==next.priority?50:next.priority)<priority)break}result.splice(i,0,rule)}var _loop2=function _loop2(name){var rules=schema.marks[name].spec.parseDOM;rules&&rules.forEach((function(rule){insert(rule=copy$1(rule)),rule.mark||rule.ignore||rule.clearMark||(rule.mark=name)}))};for(var name in schema.marks)_loop2(name);var _loop3=function _loop3(_name){var rules=schema.nodes[_name].spec.parseDOM;rules&&rules.forEach((function(rule){insert(rule=copy$1(rule)),rule.node||rule.ignore||rule.mark||(rule.node=_name)}))};for(var _name in schema.nodes)_loop3(_name);return result}},{key:"fromSchema",value:function fromSchema(schema){return schema.cached.domParser||(schema.cached.domParser=new DOMParser(schema,DOMParser.schemaRules(schema)))}}]),DOMParser}(),blockTags={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ignoreTags={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},listTags={ol:!0,ul:!0};function wsOptionsFor(type,preserveWhitespace,base){return null!=preserveWhitespace?(preserveWhitespace?1:0)|("full"===preserveWhitespace?2:0):type&&"pre"==type.whitespace?3:-5&base}var NodeContext=function(){function NodeContext(type,attrs,marks,pendingMarks,solid,match,options){_classCallCheck(this,NodeContext),this.type=type,this.attrs=attrs,this.marks=marks,this.pendingMarks=pendingMarks,this.solid=solid,this.options=options,this.content=[],this.activeMarks=Mark$1.none,this.stashMarks=[],this.match=match||(4&options?null:type.contentMatch)}return _createClass(NodeContext,[{key:"findWrapping",value:function findWrapping(node){if(!this.match){if(!this.type)return[];var fill=this.type.contentMatch.fillBefore(Fragment.from(node));if(!fill){var _wrap,start=this.type.contentMatch;return(_wrap=start.findWrapping(node.type))?(this.match=start,_wrap):null}this.match=this.type.contentMatch.matchFragment(fill)}return this.match.findWrapping(node.type)}},{key:"finish",value:function finish(openEnd){if(!(1&this.options)){var m,last=this.content[this.content.length-1];if(last&&last.isText&&(m=/[ \t\r\n\u000c]+$/.exec(last.text))){var _text2=last;last.text.length==m[0].length?this.content.pop():this.content[this.content.length-1]=_text2.withText(_text2.text.slice(0,_text2.text.length-m[0].length))}}var content=Fragment.from(this.content);return!openEnd&&this.match&&(content=content.append(this.match.fillBefore(Fragment.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content}},{key:"popFromStashMark",value:function popFromStashMark(mark){for(var _i90=this.stashMarks.length-1;_i90>=0;_i90--)if(mark.eq(this.stashMarks[_i90]))return this.stashMarks.splice(_i90,1)[0]}},{key:"applyPending",value:function applyPending(nextType){for(var _i92=0,pending=this.pendingMarks;_i92<pending.length;_i92++){var mark=pending[_i92];(this.type?this.type.allowsMarkType(mark.type):markMayApply(mark.type,nextType))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}}},{key:"inlineContext",value:function inlineContext(node){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:node.parentNode&&!blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())}}]),NodeContext}(),ParseContext=function(){function ParseContext(parser,options,isOpen){_classCallCheck(this,ParseContext),this.parser=parser,this.options=options,this.isOpen=isOpen,this.open=0;var topContext,topNode=options.topNode,topOptions=wsOptionsFor(null,options.preserveWhitespace,0)|(isOpen?4:0);topContext=topNode?new NodeContext(topNode.type,topNode.attrs,Mark$1.none,Mark$1.none,!0,options.topMatch||topNode.type.contentMatch,topOptions):new NodeContext(isOpen?null:parser.schema.topNodeType,null,Mark$1.none,Mark$1.none,!0,null,topOptions),this.nodes=[topContext],this.find=options.findPositions,this.needsBlock=!1}return _createClass(ParseContext,[{key:"top",get:function get(){return this.nodes[this.open]}},{key:"addDOM",value:function addDOM(dom){3==dom.nodeType?this.addTextNode(dom):1==dom.nodeType&&this.addElement(dom)}},{key:"withStyleRules",value:function withStyleRules(dom,f){var style=dom.getAttribute("style");if(!style)return f();var marks=this.readStyles(function parseStyles(style){var m,re=/\s*([\w-]+)\s*:\s*([^;]+)/g,result=[];for(;m=re.exec(style);)result.push(m[1],m[2].trim());return result}(style));if(marks){for(var _marks2=_slicedToArray(marks,2),addMarks=_marks2[0],removeMarks=_marks2[1],top=this.top,_i94=0;_i94<removeMarks.length;_i94++)this.removePendingMark(removeMarks[_i94],top);for(var _i96=0;_i96<addMarks.length;_i96++)this.addPendingMark(addMarks[_i96]);f();for(var _i98=0;_i98<addMarks.length;_i98++)this.removePendingMark(addMarks[_i98],top);for(var _i100=0;_i100<removeMarks.length;_i100++)this.addPendingMark(removeMarks[_i100])}}},{key:"addTextNode",value:function addTextNode(dom){var value=dom.nodeValue,top=this.top;if(2&top.options||top.inlineContext(dom)||/[^ \t\r\n\u000c]/.test(value)){if(1&top.options)value=2&top.options?value.replace(/\r\n?/g,"\n"):value.replace(/\r?\n|\r/g," ");else if(value=value.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(value)&&this.open==this.nodes.length-1){var nodeBefore=top.content[top.content.length-1],domNodeBefore=dom.previousSibling;(!nodeBefore||domNodeBefore&&"BR"==domNodeBefore.nodeName||nodeBefore.isText&&/[ \t\r\n\u000c]$/.test(nodeBefore.text))&&(value=value.slice(1))}value&&this.insertNode(this.parser.schema.text(value)),this.findInText(dom)}else this.findInside(dom)}},{key:"addElement",value:function addElement(dom,matchAfter){var ruleID,_this3=this,name=dom.nodeName.toLowerCase();listTags.hasOwnProperty(name)&&this.parser.normalizeLists&&function normalizeList(dom){for(var child=dom.firstChild,prevItem=null;child;child=child.nextSibling){var name=1==child.nodeType?child.nodeName.toLowerCase():null;name&&listTags.hasOwnProperty(name)&&prevItem?(prevItem.appendChild(child),child=prevItem):"li"==name?prevItem=child:name&&(prevItem=null)}}(dom);var rule=this.options.ruleFromNode&&this.options.ruleFromNode(dom)||(ruleID=this.parser.matchTag(dom,this,matchAfter));if(rule?rule.ignore:ignoreTags.hasOwnProperty(name))this.findInside(dom),this.ignoreFallback(dom);else if(!rule||rule.skip||rule.closeParent){rule&&rule.closeParent?this.open=Math.max(0,this.open-1):rule&&rule.skip.nodeType&&(dom=rule.skip);var sync,_top=this.top,oldNeedsBlock=this.needsBlock;if(blockTags.hasOwnProperty(name))_top.content.length&&_top.content[0].isInline&&this.open&&(this.open--,_top=this.top),sync=!0,_top.type||(this.needsBlock=!0);else if(!dom.firstChild)return void this.leafFallback(dom);rule&&rule.skip?this.addAll(dom):this.withStyleRules(dom,(function(){return _this3.addAll(dom)})),sync&&this.sync(_top),this.needsBlock=oldNeedsBlock}else this.withStyleRules(dom,(function(){_this3.addElementByRule(dom,rule,!1===rule.consuming?ruleID:void 0)}))}},{key:"leafFallback",value:function leafFallback(dom){"BR"==dom.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(dom.ownerDocument.createTextNode("\n"))}},{key:"ignoreFallback",value:function ignoreFallback(dom){"BR"!=dom.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}},{key:"readStyles",value:function readStyles(styles){for(var _this4=this,add=Mark$1.none,remove=Mark$1.none,_i102=0;_i102<styles.length;_i102+=2)for(var _ret,_loop4=function _loop4(_after){var rule=_this4.parser.matchStyle(styles[_i102],styles[_i102+1],_this4,_after);return rule?rule.ignore?{v:null}:(rule.clearMark?_this4.top.pendingMarks.concat(_this4.top.activeMarks).forEach((function(m){rule.clearMark(m)&&(remove=m.addToSet(remove))})):add=_this4.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(add),!1!==rule.consuming?(after=_after,0):void(after=_after=rule)):(after=_after,0)},after=void 0;0!==(_ret=_loop4(after));)if(_ret)return _ret.v;return[add,remove]}},{key:"addElementByRule",value:function addElementByRule(dom,rule,continueAfter){var sync,nodeType,mark,_this5=this;rule.node?(nodeType=this.parser.schema.nodes[rule.node]).isLeaf?this.insertNode(nodeType.create(rule.attrs))||this.leafFallback(dom):sync=this.enter(nodeType,rule.attrs||null,rule.preserveWhitespace):(mark=this.parser.schema.marks[rule.mark].create(rule.attrs),this.addPendingMark(mark));var startIn=this.top;if(nodeType&&nodeType.isLeaf)this.findInside(dom);else if(continueAfter)this.addElement(dom,continueAfter);else if(rule.getContent)this.findInside(dom),rule.getContent(dom,this.parser.schema).forEach((function(node){return _this5.insertNode(node)}));else{var contentDOM=dom;"string"==typeof rule.contentElement?contentDOM=dom.querySelector(rule.contentElement):"function"==typeof rule.contentElement?contentDOM=rule.contentElement(dom):rule.contentElement&&(contentDOM=rule.contentElement),this.findAround(dom,contentDOM,!0),this.addAll(contentDOM)}sync&&this.sync(startIn)&&this.open--,mark&&this.removePendingMark(mark,startIn)}},{key:"addAll",value:function addAll(parent,startIndex,endIndex){for(var index=startIndex||0,dom=startIndex?parent.childNodes[startIndex]:parent.firstChild,end=null==endIndex?null:parent.childNodes[endIndex];dom!=end;dom=dom.nextSibling,++index)this.findAtPoint(parent,index),this.addDOM(dom);this.findAtPoint(parent,index)}},{key:"findPlace",value:function findPlace(node){for(var route,sync,depth=this.open;depth>=0;depth--){var cx=this.nodes[depth],_found2=cx.findWrapping(node);if(_found2&&(!route||route.length>_found2.length)&&(route=_found2,sync=cx,!_found2.length))break;if(cx.solid)break}if(!route)return!1;this.sync(sync);for(var _i104=0;_i104<route.length;_i104++)this.enterInner(route[_i104],null,!1);return!0}},{key:"insertNode",value:function insertNode(node){if(node.isInline&&this.needsBlock&&!this.top.type){var _block=this.textblockFromContext();_block&&this.enterInner(_block)}if(this.findPlace(node)){this.closeExtra();var _top2=this.top;_top2.applyPending(node.type),_top2.match&&(_top2.match=_top2.match.matchType(node.type));for(var marks=_top2.activeMarks,_i106=0;_i106<node.marks.length;_i106++)_top2.type&&!_top2.type.allowsMarkType(node.marks[_i106].type)||(marks=node.marks[_i106].addToSet(marks));return _top2.content.push(node.mark(marks)),!0}return!1}},{key:"enter",value:function enter(type,attrs,preserveWS){var ok=this.findPlace(type.create(attrs));return ok&&this.enterInner(type,attrs,!0,preserveWS),ok}},{key:"enterInner",value:function enterInner(type){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,solid=arguments.length>2&&void 0!==arguments[2]&&arguments[2],preserveWS=arguments.length>3?arguments[3]:void 0;this.closeExtra();var top=this.top;top.applyPending(type),top.match=top.match&&top.match.matchType(type);var options=wsOptionsFor(type,preserveWS,top.options);4&top.options&&0==top.content.length&&(options|=4),this.nodes.push(new NodeContext(type,attrs,top.activeMarks,top.pendingMarks,solid,null,options)),this.open++}},{key:"closeExtra",value:function closeExtra(){var openEnd=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(openEnd));this.nodes.length=this.open+1}}},{key:"finish",value:function finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}},{key:"sync",value:function sync(to){for(var _i108=this.open;_i108>=0;_i108--)if(this.nodes[_i108]==to)return this.open=_i108,!0;return!1}},{key:"currentPos",get:function get(){this.closeExtra();for(var pos=0,_i110=this.open;_i110>=0;_i110--){for(var content=this.nodes[_i110].content,j=content.length-1;j>=0;j--)pos+=content[j].nodeSize;_i110&&pos++}return pos}},{key:"findAtPoint",value:function findAtPoint(parent,offset){if(this.find)for(var _i112=0;_i112<this.find.length;_i112++)this.find[_i112].node==parent&&this.find[_i112].offset==offset&&(this.find[_i112].pos=this.currentPos)}},{key:"findInside",value:function findInside(parent){if(this.find)for(var _i114=0;_i114<this.find.length;_i114++)null==this.find[_i114].pos&&1==parent.nodeType&&parent.contains(this.find[_i114].node)&&(this.find[_i114].pos=this.currentPos)}},{key:"findAround",value:function findAround(parent,content,before){if(parent!=content&&this.find)for(var _i116=0;_i116<this.find.length;_i116++){if(null==this.find[_i116].pos&&1==parent.nodeType&&parent.contains(this.find[_i116].node))content.compareDocumentPosition(this.find[_i116].node)&(before?2:4)&&(this.find[_i116].pos=this.currentPos)}}},{key:"findInText",value:function findInText(textNode){if(this.find)for(var _i118=0;_i118<this.find.length;_i118++)this.find[_i118].node==textNode&&(this.find[_i118].pos=this.currentPos-(textNode.nodeValue.length-this.find[_i118].offset))}},{key:"matchesContext",value:function matchesContext(context){var _this6=this;if(context.indexOf("|")>-1)return context.split(/\s*\|\s*/).some(this.matchesContext,this);var parts=context.split("/"),option=this.options.context,useRoot=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),minDepth=-(option?option.depth+1:0)+(useRoot?0:1);return function match(i,depth){for(;i>=0;i--){var _part=parts[i];if(""==_part){if(i==parts.length-1||0==i)continue;for(;depth>=minDepth;depth--)if(match(i-1,depth))return!0;return!1}var next=depth>0||0==depth&&useRoot?_this6.nodes[depth].type:option&&depth>=minDepth?option.node(depth-minDepth).type:null;if(!next||next.name!=_part&&-1==next.groups.indexOf(_part))return!1;depth--}return!0}(parts.length-1,this.open)}},{key:"textblockFromContext",value:function textblockFromContext(){var $context=this.options.context;if($context)for(var d=$context.depth;d>=0;d--){var deflt=$context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;if(deflt&&deflt.isTextblock&&deflt.defaultAttrs)return deflt}for(var name in this.parser.schema.nodes){var type=this.parser.schema.nodes[name];if(type.isTextblock&&type.defaultAttrs)return type}}},{key:"addPendingMark",value:function addPendingMark(mark){var found=function findSameMarkInSet(mark,set){for(var _i122=0;_i122<set.length;_i122++)if(mark.eq(set[_i122]))return set[_i122]}(mark,this.top.pendingMarks);found&&this.top.stashMarks.push(found),this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)}},{key:"removePendingMark",value:function removePendingMark(mark,upto){for(var depth=this.open;depth>=0;depth--){var level=this.nodes[depth];if(level.pendingMarks.lastIndexOf(mark)>-1)level.pendingMarks=mark.removeFromSet(level.pendingMarks);else{level.activeMarks=mark.removeFromSet(level.activeMarks);var stashMark=level.popFromStashMark(mark);stashMark&&level.type&&level.type.allowsMarkType(stashMark.type)&&(level.activeMarks=stashMark.addToSet(level.activeMarks))}if(level==upto)break}}}]),ParseContext}();function matches(dom,selector){return(dom.matches||dom.msMatchesSelector||dom.webkitMatchesSelector||dom.mozMatchesSelector).call(dom,selector)}function copy$1(obj){var copy={};for(var _prop10 in obj)copy[_prop10]=obj[_prop10];return copy}function markMayApply(markType,nodeType){var _ret2,nodes=nodeType.schema.nodes,_loop5=function _loop5(){var parent=nodes[name];if(!parent.allowsMarkType(markType))return 0;var seen=[];return function scan(match){seen.push(match);for(var _i120=0;_i120<match.edgeCount;_i120++){var _match$edge=match.edge(_i120),type=_match$edge.type,next=_match$edge.next;if(type==nodeType)return!0;if(seen.indexOf(next)<0&&scan(next))return!0}}(parent.contentMatch)?{v:!0}:void 0};for(var name in nodes)if(0!==(_ret2=_loop5())&&_ret2)return _ret2.v}var DOMSerializer=function(){function DOMSerializer(nodes,marks){_classCallCheck(this,DOMSerializer),this.nodes=nodes,this.marks=marks}return _createClass(DOMSerializer,[{key:"serializeFragment",value:function serializeFragment(fragment){var _this7=this,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},target=arguments.length>2?arguments[2]:void 0;target||(target=doc$1(options).createDocumentFragment());var top=target,active=[];return fragment.forEach((function(node){if(active.length||node.marks.length){for(var keep=0,rendered=0;keep<active.length&&rendered<node.marks.length;){var next=node.marks[rendered];if(_this7.marks[next.type.name]){if(!next.eq(active[keep][0])||!1===next.type.spec.spanning)break;keep++,rendered++}else rendered++}for(;keep<active.length;)top=active.pop()[1];for(;rendered<node.marks.length;){var add=node.marks[rendered++],markDOM=_this7.serializeMark(add,node.isInline,options);markDOM&&(active.push([add,top]),top.appendChild(markDOM.dom),top=markDOM.contentDOM||markDOM.dom)}}top.appendChild(_this7.serializeNodeInner(node,options))})),target}},{key:"serializeNodeInner",value:function serializeNodeInner(node,options){var _DOMSerializer$render=DOMSerializer.renderSpec(doc$1(options),this.nodes[node.type.name](node)),dom=_DOMSerializer$render.dom,contentDOM=_DOMSerializer$render.contentDOM;if(contentDOM){if(node.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(node.content,options,contentDOM)}return dom}},{key:"serializeNode",value:function serializeNode(node){for(var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},dom=this.serializeNodeInner(node,options),_i124=node.marks.length-1;_i124>=0;_i124--){var _wrap2=this.serializeMark(node.marks[_i124],node.isInline,options);_wrap2&&((_wrap2.contentDOM||_wrap2.dom).appendChild(dom),dom=_wrap2.dom)}return dom}},{key:"serializeMark",value:function serializeMark(mark,inline){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},toDOM=this.marks[mark.type.name];return toDOM&&DOMSerializer.renderSpec(doc$1(options),toDOM(mark,inline))}}],[{key:"renderSpec",value:function renderSpec(doc,structure){var xmlNS=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"==typeof structure)return{dom:doc.createTextNode(structure)};if(null!=structure.nodeType)return{dom:structure};if(structure.dom&&null!=structure.dom.nodeType)return structure;var contentDOM,tagName=structure[0],space=tagName.indexOf(" ");space>0&&(xmlNS=tagName.slice(0,space),tagName=tagName.slice(space+1));var dom=xmlNS?doc.createElementNS(xmlNS,tagName):doc.createElement(tagName),attrs=structure[1],start=1;if(attrs&&"object"==typeof attrs&&null==attrs.nodeType&&!Array.isArray(attrs))for(var name in start=2,attrs)if(null!=attrs[name]){var _space=name.indexOf(" ");_space>0?dom.setAttributeNS(name.slice(0,_space),name.slice(_space+1),attrs[name]):dom.setAttribute(name,attrs[name])}for(var _i126=start;_i126<structure.length;_i126++){var child=structure[_i126];if(0===child){if(_i126<structure.length-1||_i126>start)throw new RangeError("Content hole must be the only child of its parent node");return{dom,contentDOM:dom}}var _DOMSerializer$render2=DOMSerializer.renderSpec(doc,child,xmlNS),inner=_DOMSerializer$render2.dom,innerContent=_DOMSerializer$render2.contentDOM;if(dom.appendChild(inner),innerContent){if(contentDOM)throw new RangeError("Multiple content holes");contentDOM=innerContent}}return{dom,contentDOM}}},{key:"fromSchema",value:function fromSchema(schema){return schema.cached.domSerializer||(schema.cached.domSerializer=new DOMSerializer(this.nodesFromSchema(schema),this.marksFromSchema(schema)))}},{key:"nodesFromSchema",value:function nodesFromSchema(schema){var result=gatherToDOM(schema.nodes);return result.text||(result.text=function(node){return node.text}),result}},{key:"marksFromSchema",value:function marksFromSchema(schema){return gatherToDOM(schema.marks)}}]),DOMSerializer}();function gatherToDOM(obj){var result={};for(var name in obj){var toDOM=obj[name].spec.toDOM;toDOM&&(result[name]=toDOM)}return result}function doc$1(options){return options.document||window.document}var factor16=Math.pow(2,16);function recoverIndex(value){return 65535&value}var MapResult=function(){function MapResult(pos,delInfo,recover){_classCallCheck(this,MapResult),this.pos=pos,this.delInfo=delInfo,this.recover=recover}return _createClass(MapResult,[{key:"deleted",get:function get(){return(8&this.delInfo)>0}},{key:"deletedBefore",get:function get(){return(5&this.delInfo)>0}},{key:"deletedAfter",get:function get(){return(6&this.delInfo)>0}},{key:"deletedAcross",get:function get(){return(4&this.delInfo)>0}}]),MapResult}(),StepMap=function(){function StepMap(ranges){var inverted=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_classCallCheck(this,StepMap),this.ranges=ranges,this.inverted=inverted,!ranges.length&&StepMap.empty)return StepMap.empty}return _createClass(StepMap,[{key:"recover",value:function recover(value){var diff=0,index=recoverIndex(value);if(!this.inverted)for(var _i128=0;_i128<index;_i128++)diff+=this.ranges[3*_i128+2]-this.ranges[3*_i128+1];return this.ranges[3*index]+diff+function recoverOffset(value){return(value-(65535&value))/factor16}(value)}},{key:"mapResult",value:function mapResult(pos){var assoc=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(pos,assoc,!1)}},{key:"map",value:function map(pos){var assoc=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(pos,assoc,!0)}},{key:"_map",value:function _map(pos,assoc,simple){for(var diff=0,oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,_i130=0;_i130<this.ranges.length;_i130+=3){var start=this.ranges[_i130]-(this.inverted?diff:0);if(start>pos)break;var oldSize=this.ranges[_i130+oldIndex],newSize=this.ranges[_i130+newIndex],end=start+oldSize;if(pos<=end){var result=start+diff+((oldSize?pos==start?-1:pos==end?1:assoc:assoc)<0?0:newSize);if(simple)return result;var recover=pos==(assoc<0?start:end)?null:_i130/3+(pos-start)*factor16,_del=pos==start?2:pos==end?1:4;return(assoc<0?pos!=start:pos!=end)&&(_del|=8),new MapResult(result,_del,recover)}diff+=newSize-oldSize}return simple?pos+diff:new MapResult(pos+diff,0,null)}},{key:"touches",value:function touches(pos,recover){for(var diff=0,index=recoverIndex(recover),oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,_i132=0;_i132<this.ranges.length;_i132+=3){var start=this.ranges[_i132]-(this.inverted?diff:0);if(start>pos)break;var oldSize=this.ranges[_i132+oldIndex];if(pos<=start+oldSize&&_i132==3*index)return!0;diff+=this.ranges[_i132+newIndex]-oldSize}return!1}},{key:"forEach",value:function forEach(f){for(var oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,_i134=0,diff=0;_i134<this.ranges.length;_i134+=3){var start=this.ranges[_i134],oldStart=start-(this.inverted?diff:0),newStart=start+(this.inverted?0:diff),oldSize=this.ranges[_i134+oldIndex],newSize=this.ranges[_i134+newIndex];f(oldStart,oldStart+oldSize,newStart,newStart+newSize),diff+=newSize-oldSize}}},{key:"invert",value:function invert(){return new StepMap(this.ranges,!this.inverted)}},{key:"toString",value:function toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}}],[{key:"offset",value:function offset(n){return 0==n?StepMap.empty:new StepMap(n<0?[0,-n,0]:[0,0,n])}}]),StepMap}();StepMap.empty=new StepMap([]);var Mapping=function(){function Mapping(){var maps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],mirror=arguments.length>1?arguments[1]:void 0,from=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,to=arguments.length>3&&void 0!==arguments[3]?arguments[3]:maps.length;_classCallCheck(this,Mapping),this.maps=maps,this.mirror=mirror,this.from=from,this.to=to}return _createClass(Mapping,[{key:"slice",value:function slice(){var from=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,to=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new Mapping(this.maps,this.mirror,from,to)}},{key:"copy",value:function copy(){return new Mapping(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}},{key:"appendMap",value:function appendMap(map,mirrors){this.to=this.maps.push(map),null!=mirrors&&this.setMirror(this.maps.length-1,mirrors)}},{key:"appendMapping",value:function appendMapping(mapping){for(var _i136=0,startSize=this.maps.length;_i136<mapping.maps.length;_i136++){var mirr=mapping.getMirror(_i136);this.appendMap(mapping.maps[_i136],null!=mirr&&mirr<_i136?startSize+mirr:void 0)}}},{key:"getMirror",value:function getMirror(n){if(this.mirror)for(var _i138=0;_i138<this.mirror.length;_i138++)if(this.mirror[_i138]==n)return this.mirror[_i138+(_i138%2?-1:1)]}},{key:"setMirror",value:function setMirror(n,m){this.mirror||(this.mirror=[]),this.mirror.push(n,m)}},{key:"appendMappingInverted",value:function appendMappingInverted(mapping){for(var _i140=mapping.maps.length-1,totalSize=this.maps.length+mapping.maps.length;_i140>=0;_i140--){var mirr=mapping.getMirror(_i140);this.appendMap(mapping.maps[_i140].invert(),null!=mirr&&mirr>_i140?totalSize-mirr-1:void 0)}}},{key:"invert",value:function invert(){var inverse=new Mapping;return inverse.appendMappingInverted(this),inverse}},{key:"map",value:function map(pos){var assoc=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(pos,assoc,!0);for(var _i142=this.from;_i142<this.to;_i142++)pos=this.maps[_i142].map(pos,assoc);return pos}},{key:"mapResult",value:function mapResult(pos){var assoc=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(pos,assoc,!1)}},{key:"_map",value:function _map(pos,assoc,simple){for(var delInfo=0,_i144=this.from;_i144<this.to;_i144++){var result=this.maps[_i144].mapResult(pos,assoc);if(null!=result.recover){var corr=this.getMirror(_i144);if(null!=corr&&corr>_i144&&corr<this.to){_i144=corr,pos=this.maps[corr].recover(result.recover);continue}}delInfo|=result.delInfo,pos=result.pos}return simple?pos:new MapResult(pos,delInfo,null)}}]),Mapping}(),stepsByID=Object.create(null),Step=function(){function Step(){_classCallCheck(this,Step)}return _createClass(Step,[{key:"getMap",value:function getMap(){return StepMap.empty}},{key:"merge",value:function merge(other){return null}}],[{key:"fromJSON",value:function fromJSON(schema,json){if(!json||!json.stepType)throw new RangeError("Invalid input for Step.fromJSON");var type=stepsByID[json.stepType];if(!type)throw new RangeError("No step type "+json.stepType+" defined");return type.fromJSON(schema,json)}},{key:"jsonID",value:function jsonID(id,stepClass){if(id in stepsByID)throw new RangeError("Duplicate use of step JSON ID "+id);return stepsByID[id]=stepClass,stepClass.prototype.jsonID=id,stepClass}}]),Step}(),StepResult=function(){function StepResult(doc,failed){_classCallCheck(this,StepResult),this.doc=doc,this.failed=failed}return _createClass(StepResult,null,[{key:"ok",value:function ok(doc){return new StepResult(doc,null)}},{key:"fail",value:function fail(message){return new StepResult(null,message)}},{key:"fromReplace",value:function fromReplace(doc,from,to,slice){try{return StepResult.ok(doc.replace(from,to,slice))}catch(e){if(e instanceof ReplaceError)return StepResult.fail(e.message);throw e}}}]),StepResult}();function mapFragment(fragment,f,parent){for(var mapped=[],_i146=0;_i146<fragment.childCount;_i146++){var child=fragment.child(_i146);child.content.size&&(child=child.copy(mapFragment(child.content,f,child))),child.isInline&&(child=f(child,parent,_i146)),mapped.push(child)}return Fragment.fromArray(mapped)}var AddMarkStep=function(_Step){_inherits(AddMarkStep,_Step);var _super3=_createSuper(AddMarkStep);function AddMarkStep(from,to,mark){var _this8;return _classCallCheck(this,AddMarkStep),(_this8=_super3.call(this)).from=from,_this8.to=to,_this8.mark=mark,_this8}return _createClass(AddMarkStep,[{key:"apply",value:function apply(doc){var _this9=this,oldSlice=doc.slice(this.from,this.to),$from=doc.resolve(this.from),parent=$from.node($from.sharedDepth(this.to)),slice=new Slice(mapFragment(oldSlice.content,(function(node,parent){return node.isAtom&&parent.type.allowsMarkType(_this9.mark.type)?node.mark(_this9.mark.addToSet(node.marks)):node}),parent),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)}},{key:"invert",value:function invert(){return new RemoveMarkStep(this.from,this.to,this.mark)}},{key:"map",value:function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new AddMarkStep(from.pos,to.pos,this.mark)}},{key:"merge",value:function merge(other){return other instanceof AddMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from?new AddMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark):null}},{key:"toJSON",value:function toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new AddMarkStep(json.from,json.to,schema.markFromJSON(json.mark))}}]),AddMarkStep}(Step);Step.jsonID("addMark",AddMarkStep);var RemoveMarkStep=function(_Step2){_inherits(RemoveMarkStep,_Step2);var _super4=_createSuper(RemoveMarkStep);function RemoveMarkStep(from,to,mark){var _this10;return _classCallCheck(this,RemoveMarkStep),(_this10=_super4.call(this)).from=from,_this10.to=to,_this10.mark=mark,_this10}return _createClass(RemoveMarkStep,[{key:"apply",value:function apply(doc){var _this11=this,oldSlice=doc.slice(this.from,this.to),slice=new Slice(mapFragment(oldSlice.content,(function(node){return node.mark(_this11.mark.removeFromSet(node.marks))}),doc),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)}},{key:"invert",value:function invert(){return new AddMarkStep(this.from,this.to,this.mark)}},{key:"map",value:function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new RemoveMarkStep(from.pos,to.pos,this.mark)}},{key:"merge",value:function merge(other){return other instanceof RemoveMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from?new RemoveMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark):null}},{key:"toJSON",value:function toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new RemoveMarkStep(json.from,json.to,schema.markFromJSON(json.mark))}}]),RemoveMarkStep}(Step);Step.jsonID("removeMark",RemoveMarkStep);var AddNodeMarkStep=function(_Step3){_inherits(AddNodeMarkStep,_Step3);var _super5=_createSuper(AddNodeMarkStep);function AddNodeMarkStep(pos,mark){var _this12;return _classCallCheck(this,AddNodeMarkStep),(_this12=_super5.call(this)).pos=pos,_this12.mark=mark,_this12}return _createClass(AddNodeMarkStep,[{key:"apply",value:function apply(doc){var node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at mark step's position");var updated=node.type.create(node.attrs,null,this.mark.addToSet(node.marks));return StepResult.fromReplace(doc,this.pos,this.pos+1,new Slice(Fragment.from(updated),0,node.isLeaf?0:1))}},{key:"invert",value:function invert(doc){var node=doc.nodeAt(this.pos);if(node){var newSet=this.mark.addToSet(node.marks);if(newSet.length==node.marks.length){for(var _i148=0;_i148<node.marks.length;_i148++)if(!node.marks[_i148].isInSet(newSet))return new AddNodeMarkStep(this.pos,node.marks[_i148]);return new AddNodeMarkStep(this.pos,this.mark)}}return new RemoveNodeMarkStep(this.pos,this.mark)}},{key:"map",value:function map(mapping){var pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new AddNodeMarkStep(pos.pos,this.mark)}},{key:"toJSON",value:function toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new AddNodeMarkStep(json.pos,schema.markFromJSON(json.mark))}}]),AddNodeMarkStep}(Step);Step.jsonID("addNodeMark",AddNodeMarkStep);var RemoveNodeMarkStep=function(_Step4){_inherits(RemoveNodeMarkStep,_Step4);var _super6=_createSuper(RemoveNodeMarkStep);function RemoveNodeMarkStep(pos,mark){var _this13;return _classCallCheck(this,RemoveNodeMarkStep),(_this13=_super6.call(this)).pos=pos,_this13.mark=mark,_this13}return _createClass(RemoveNodeMarkStep,[{key:"apply",value:function apply(doc){var node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at mark step's position");var updated=node.type.create(node.attrs,null,this.mark.removeFromSet(node.marks));return StepResult.fromReplace(doc,this.pos,this.pos+1,new Slice(Fragment.from(updated),0,node.isLeaf?0:1))}},{key:"invert",value:function invert(doc){var node=doc.nodeAt(this.pos);return node&&this.mark.isInSet(node.marks)?new AddNodeMarkStep(this.pos,this.mark):this}},{key:"map",value:function map(mapping){var pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new RemoveNodeMarkStep(pos.pos,this.mark)}},{key:"toJSON",value:function toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new RemoveNodeMarkStep(json.pos,schema.markFromJSON(json.mark))}}]),RemoveNodeMarkStep}(Step);Step.jsonID("removeNodeMark",RemoveNodeMarkStep);var ReplaceStep=function(_Step5){_inherits(ReplaceStep,_Step5);var _super7=_createSuper(ReplaceStep);function ReplaceStep(from,to,slice){var _this14,structure=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return _classCallCheck(this,ReplaceStep),(_this14=_super7.call(this)).from=from,_this14.to=to,_this14.slice=slice,_this14.structure=structure,_this14}return _createClass(ReplaceStep,[{key:"apply",value:function apply(doc){return this.structure&&contentBetween(doc,this.from,this.to)?StepResult.fail("Structure replace would overwrite content"):StepResult.fromReplace(doc,this.from,this.to,this.slice)}},{key:"getMap",value:function getMap(){return new StepMap([this.from,this.to-this.from,this.slice.size])}},{key:"invert",value:function invert(doc){return new ReplaceStep(this.from,this.from+this.slice.size,doc.slice(this.from,this.to))}},{key:"map",value:function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deletedAcross&&to.deletedAcross?null:new ReplaceStep(from.pos,Math.max(from.pos,to.pos),this.slice)}},{key:"merge",value:function merge(other){if(!(other instanceof ReplaceStep)||other.structure||this.structure)return null;if(this.from+this.slice.size!=other.from||this.slice.openEnd||other.slice.openStart){if(other.to!=this.from||this.slice.openStart||other.slice.openEnd)return null;var _slice=this.slice.size+other.slice.size==0?Slice.empty:new Slice(other.slice.content.append(this.slice.content),other.slice.openStart,this.slice.openEnd);return new ReplaceStep(other.from,this.to,_slice,this.structure)}var slice=this.slice.size+other.slice.size==0?Slice.empty:new Slice(this.slice.content.append(other.slice.content),this.slice.openStart,other.slice.openEnd);return new ReplaceStep(this.from,this.to+(other.to-other.from),slice,this.structure)}},{key:"toJSON",value:function toJSON(){var json={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ReplaceStep(json.from,json.to,Slice.fromJSON(schema,json.slice),!!json.structure)}}]),ReplaceStep}(Step);Step.jsonID("replace",ReplaceStep);var ReplaceAroundStep=function(_Step6){_inherits(ReplaceAroundStep,_Step6);var _super8=_createSuper(ReplaceAroundStep);function ReplaceAroundStep(from,to,gapFrom,gapTo,slice,insert){var _this15,structure=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,ReplaceAroundStep),(_this15=_super8.call(this)).from=from,_this15.to=to,_this15.gapFrom=gapFrom,_this15.gapTo=gapTo,_this15.slice=slice,_this15.insert=insert,_this15.structure=structure,_this15}return _createClass(ReplaceAroundStep,[{key:"apply",value:function apply(doc){if(this.structure&&(contentBetween(doc,this.from,this.gapFrom)||contentBetween(doc,this.gapTo,this.to)))return StepResult.fail("Structure gap-replace would overwrite content");var gap=doc.slice(this.gapFrom,this.gapTo);if(gap.openStart||gap.openEnd)return StepResult.fail("Gap is not a flat range");var inserted=this.slice.insertAt(this.insert,gap.content);return inserted?StepResult.fromReplace(doc,this.from,this.to,inserted):StepResult.fail("Content does not fit in gap")}},{key:"getMap",value:function getMap(){return new StepMap([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}},{key:"invert",value:function invert(doc){var gap=this.gapTo-this.gapFrom;return new ReplaceAroundStep(this.from,this.from+this.slice.size+gap,this.from+this.insert,this.from+this.insert+gap,doc.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}},{key:"map",value:function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1),gapFrom=mapping.map(this.gapFrom,-1),gapTo=mapping.map(this.gapTo,1);return from.deletedAcross&&to.deletedAcross||gapFrom<from.pos||gapTo>to.pos?null:new ReplaceAroundStep(from.pos,to.pos,gapFrom,gapTo,this.slice,this.insert,this.structure)}},{key:"toJSON",value:function toJSON(){var json={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to||"number"!=typeof json.gapFrom||"number"!=typeof json.gapTo||"number"!=typeof json.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ReplaceAroundStep(json.from,json.to,json.gapFrom,json.gapTo,Slice.fromJSON(schema,json.slice),json.insert,!!json.structure)}}]),ReplaceAroundStep}(Step);function contentBetween(doc,from,to){for(var $from=doc.resolve(from),dist=to-from,depth=$from.depth;dist>0&&depth>0&&$from.indexAfter(depth)==$from.node(depth).childCount;)depth--,dist--;if(dist>0)for(var next=$from.node(depth).maybeChild($from.indexAfter(depth));dist>0;){if(!next||next.isLeaf)return!0;next=next.firstChild,dist--}return!1}function canCut(node,start,end){return(0==start||node.canReplace(start,node.childCount))&&(end==node.childCount||node.canReplace(0,end))}function liftTarget(range){for(var content=range.parent.content.cutByIndex(range.startIndex,range.endIndex),depth=range.depth;;--depth){var node=range.$from.node(depth),index=range.$from.index(depth),endIndex=range.$to.indexAfter(depth);if(depth<range.depth&&node.canReplace(index,endIndex,content))return depth;if(0==depth||node.type.spec.isolating||!canCut(node,index,endIndex))break}return null}function findWrapping(range,nodeType){var attrs=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,innerRange=arguments.length>3&&void 0!==arguments[3]?arguments[3]:range,around=function findWrappingOutside(range,type){var parent=range.parent,startIndex=range.startIndex,endIndex=range.endIndex,around=parent.contentMatchAt(startIndex).findWrapping(type);if(!around)return null;var outer=around.length?around[0]:type;return parent.canReplaceWith(startIndex,endIndex,outer)?around:null}(range,nodeType),inner=around&&function findWrappingInside(range,type){var parent=range.parent,startIndex=range.startIndex,endIndex=range.endIndex,inner=parent.child(startIndex),inside=type.contentMatch.findWrapping(inner.type);if(!inside)return null;for(var innerMatch=(inside.length?inside[inside.length-1]:type).contentMatch,_i158=startIndex;innerMatch&&_i158<endIndex;_i158++)innerMatch=innerMatch.matchType(parent.child(_i158).type);return innerMatch&&innerMatch.validEnd?inside:null}(innerRange,nodeType);return inner?around.map(withAttrs).concat({type:nodeType,attrs}).concat(inner.map(withAttrs)):null}function withAttrs(type){return{type,attrs:null}}function canSplit(doc,pos){var depth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,typesAfter=arguments.length>3?arguments[3]:void 0,$pos=doc.resolve(pos),base=$pos.depth-depth,innerType=typesAfter&&typesAfter[typesAfter.length-1]||$pos.parent;if(base<0||$pos.parent.type.spec.isolating||!$pos.parent.canReplace($pos.index(),$pos.parent.childCount)||!innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(),$pos.parent.childCount)))return!1;for(var d=$pos.depth-1,_i162=depth-2;d>base;d--,_i162--){var node=$pos.node(d),_index=$pos.index(d);if(node.type.spec.isolating)return!1;var rest=node.content.cutByIndex(_index,node.childCount),overrideChild=typesAfter&&typesAfter[_i162+1];overrideChild&&(rest=rest.replaceChild(0,overrideChild.type.create(overrideChild.attrs)));var after=typesAfter&&typesAfter[_i162]||node;if(!node.canReplace(_index+1,node.childCount)||!after.type.validContent(rest))return!1}var index=$pos.indexAfter(base),baseType=typesAfter&&typesAfter[0];return $pos.node(base).canReplaceWith(index,index,baseType?baseType.type:$pos.node(base+1).type)}function canJoin(doc,pos){var $pos=doc.resolve(pos),index=$pos.index();return joinable($pos.nodeBefore,$pos.nodeAfter)&&$pos.parent.canReplace(index,index+1)}function joinable(a,b){return!(!a||!b||a.isLeaf||!a.canAppend(b))}function joinPoint(doc,pos){for(var dir=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,$pos=doc.resolve(pos),d=$pos.depth;;d--){var before=void 0,after=void 0,index=$pos.index(d);if(d==$pos.depth?(before=$pos.nodeBefore,after=$pos.nodeAfter):dir>0?(before=$pos.node(d+1),index++,after=$pos.node(d).maybeChild(index)):(before=$pos.node(d).maybeChild(index-1),after=$pos.node(d+1)),before&&!before.isTextblock&&joinable(before,after)&&$pos.node(d).canReplace(index,index+1))return pos;if(0==d)break;pos=dir<0?$pos.before(d):$pos.after(d)}}function dropPoint(doc,pos,slice){var $pos=doc.resolve(pos);if(!slice.content.size)return pos;for(var content=slice.content,_i166=0;_i166<slice.openStart;_i166++)content=content.firstChild.content;for(var pass=1;pass<=(0==slice.openStart&&slice.size?2:1);pass++)for(var d=$pos.depth;d>=0;d--){var bias=d==$pos.depth?0:$pos.pos<=($pos.start(d+1)+$pos.end(d+1))/2?-1:1,insertPos=$pos.index(d)+(bias>0?1:0),parent=$pos.node(d),fits=!1;if(1==pass)fits=parent.canReplace(insertPos,insertPos,content);else{var wrapping=parent.contentMatchAt(insertPos).findWrapping(content.firstChild.type);fits=wrapping&&parent.canReplaceWith(insertPos,insertPos,wrapping[0])}if(fits)return 0==bias?$pos.pos:bias<0?$pos.before(d+1):$pos.after(d+1)}return null}function replaceStep(doc,from){var to=arguments.length>2&&void 0!==arguments[2]?arguments[2]:from,slice=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Slice.empty;if(from==to&&!slice.size)return null;var $from=doc.resolve(from),$to=doc.resolve(to);return fitsTrivially($from,$to,slice)?new ReplaceStep(from,to,slice):new Fitter($from,$to,slice).fit()}function fitsTrivially($from,$to,slice){return!slice.openStart&&!slice.openEnd&&$from.start()==$to.start()&&$from.parent.canReplace($from.index(),$to.index(),slice.content)}Step.jsonID("replaceAround",ReplaceAroundStep);var Fitter=function(){function Fitter($from,$to,unplaced){_classCallCheck(this,Fitter),this.$from=$from,this.$to=$to,this.unplaced=unplaced,this.frontier=[],this.placed=Fragment.empty;for(var _i168=0;_i168<=$from.depth;_i168++){var node=$from.node(_i168);this.frontier.push({type:node.type,match:node.contentMatchAt($from.indexAfter(_i168))})}for(var _i170=$from.depth;_i170>0;_i170--)this.placed=Fragment.from($from.node(_i170).copy(this.placed))}return _createClass(Fitter,[{key:"depth",get:function get(){return this.frontier.length-1}},{key:"fit",value:function fit(){for(;this.unplaced.size;){var fit=this.findFittable();fit?this.placeNodes(fit):this.openMore()||this.dropNode()}var moveInline=this.mustMoveInline(),placedSize=this.placed.size-this.depth-this.$from.depth,$from=this.$from,$to=this.close(moveInline<0?this.$to:$from.doc.resolve(moveInline));if(!$to)return null;for(var content=this.placed,openStart=$from.depth,openEnd=$to.depth;openStart&&openEnd&&1==content.childCount;)content=content.firstChild.content,openStart--,openEnd--;var slice=new Slice(content,openStart,openEnd);return moveInline>-1?new ReplaceAroundStep($from.pos,moveInline,this.$to.pos,this.$to.end(),slice,placedSize):slice.size||$from.pos!=this.$to.pos?new ReplaceStep($from.pos,$to.pos,slice):null}},{key:"findFittable",value:function findFittable(){for(var startDepth=this.unplaced.openStart,cur=this.unplaced.content,d=0,openEnd=this.unplaced.openEnd;d<startDepth;d++){var node=cur.firstChild;if(cur.childCount>1&&(openEnd=0),node.type.spec.isolating&&openEnd<=d){startDepth=d;break}cur=node.content}for(var pass=1;pass<=2;pass++)for(var sliceDepth=1==pass?startDepth:this.unplaced.openStart;sliceDepth>=0;sliceDepth--)for(var parent=null,_first=(sliceDepth?(parent=contentAt(this.unplaced.content,sliceDepth-1).firstChild).content:this.unplaced.content).firstChild,frontierDepth=this.depth;frontierDepth>=0;frontierDepth--){var _this$frontier$fronti=this.frontier[frontierDepth],type=_this$frontier$fronti.type,match=_this$frontier$fronti.match,_wrap3=void 0,inject=null;if(1==pass&&(_first?match.matchType(_first.type)||(inject=match.fillBefore(Fragment.from(_first),!1)):parent&&type.compatibleContent(parent.type)))return{sliceDepth,frontierDepth,parent,inject};if(2==pass&&_first&&(_wrap3=match.findWrapping(_first.type)))return{sliceDepth,frontierDepth,parent,wrap:_wrap3};if(parent&&match.matchType(parent.type))break}}},{key:"openMore",value:function openMore(){var _this$unplaced=this.unplaced,content=_this$unplaced.content,openStart=_this$unplaced.openStart,openEnd=_this$unplaced.openEnd,inner=contentAt(content,openStart);return!(!inner.childCount||inner.firstChild.isLeaf)&&(this.unplaced=new Slice(content,openStart+1,Math.max(openEnd,inner.size+openStart>=content.size-openEnd?openStart+1:0)),!0)}},{key:"dropNode",value:function dropNode(){var _this$unplaced2=this.unplaced,content=_this$unplaced2.content,openStart=_this$unplaced2.openStart,openEnd=_this$unplaced2.openEnd,inner=contentAt(content,openStart);if(inner.childCount<=1&&openStart>0){var openAtEnd=content.size-openStart<=openStart+inner.size;this.unplaced=new Slice(dropFromFragment(content,openStart-1,1),openStart-1,openAtEnd?openStart-1:openEnd)}else this.unplaced=new Slice(dropFromFragment(content,openStart,1),openStart,openEnd)}},{key:"placeNodes",value:function placeNodes(_ref3){for(var sliceDepth=_ref3.sliceDepth,frontierDepth=_ref3.frontierDepth,parent=_ref3.parent,inject=_ref3.inject,wrap=_ref3.wrap;this.depth>frontierDepth;)this.closeFrontierNode();if(wrap)for(var _i172=0;_i172<wrap.length;_i172++)this.openFrontierNode(wrap[_i172]);var slice=this.unplaced,fragment=parent?parent.content:slice.content,openStart=slice.openStart-sliceDepth,taken=0,add=[],_this$frontier$fronti2=this.frontier[frontierDepth],match=_this$frontier$fronti2.match,type=_this$frontier$fronti2.type;if(inject){for(var _i174=0;_i174<inject.childCount;_i174++)add.push(inject.child(_i174));match=match.matchFragment(inject)}for(var openEndCount=fragment.size+sliceDepth-(slice.content.size-slice.openEnd);taken<fragment.childCount;){var next=fragment.child(taken),_matches=match.matchType(next.type);if(!_matches)break;(++taken>1||0==openStart||next.content.size)&&(match=_matches,add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)),1==taken?openStart:0,taken==fragment.childCount?openEndCount:-1)))}var toEnd=taken==fragment.childCount;toEnd||(openEndCount=-1),this.placed=addToFragment(this.placed,frontierDepth,Fragment.from(add)),this.frontier[frontierDepth].match=match,toEnd&&openEndCount<0&&parent&&parent.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var _i176=0,cur=fragment;_i176<openEndCount;_i176++){var node=cur.lastChild;this.frontier.push({type:node.type,match:node.contentMatchAt(node.childCount)}),cur=node.content}this.unplaced=toEnd?0==sliceDepth?Slice.empty:new Slice(dropFromFragment(slice.content,sliceDepth-1,1),sliceDepth-1,openEndCount<0?slice.openEnd:sliceDepth-1):new Slice(dropFromFragment(slice.content,sliceDepth,taken),slice.openStart,slice.openEnd)}},{key:"mustMoveInline",value:function mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;var level,top=this.frontier[this.depth];if(!top.type.isTextblock||!contentAfterFits(this.$to,this.$to.depth,top.type,top.match,!1)||this.$to.depth==this.depth&&(level=this.findCloseLevel(this.$to))&&level.depth==this.depth)return-1;for(var depth=this.$to.depth,after=this.$to.after(depth);depth>1&&after==this.$to.end(--depth);)++after;return after}},{key:"findCloseLevel",value:function findCloseLevel($to){scan:for(var _i178=Math.min(this.depth,$to.depth);_i178>=0;_i178--){var _this$frontier$_i=this.frontier[_i178],match=_this$frontier$_i.match,type=_this$frontier$_i.type,dropInner=_i178<$to.depth&&$to.end(_i178+1)==$to.pos+($to.depth-(_i178+1)),fit=contentAfterFits($to,_i178,type,match,dropInner);if(fit){for(var d=_i178-1;d>=0;d--){var _this$frontier$d=this.frontier[d],_match=_this$frontier$d.match,_matches2=contentAfterFits($to,d,_this$frontier$d.type,_match,!0);if(!_matches2||_matches2.childCount)continue scan}return{depth:_i178,fit,move:dropInner?$to.doc.resolve($to.after(_i178+1)):$to}}}}},{key:"close",value:function close($to){var close=this.findCloseLevel($to);if(!close)return null;for(;this.depth>close.depth;)this.closeFrontierNode();close.fit.childCount&&(this.placed=addToFragment(this.placed,close.depth,close.fit)),$to=close.move;for(var d=close.depth+1;d<=$to.depth;d++){var node=$to.node(d),add=node.type.contentMatch.fillBefore(node.content,!0,$to.index(d));this.openFrontierNode(node.type,node.attrs,add)}return $to}},{key:"openFrontierNode",value:function openFrontierNode(type){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,content=arguments.length>2?arguments[2]:void 0,top=this.frontier[this.depth];top.match=top.match.matchType(type),this.placed=addToFragment(this.placed,this.depth,Fragment.from(type.create(attrs,content))),this.frontier.push({type,match:type.contentMatch})}},{key:"closeFrontierNode",value:function closeFrontierNode(){var add=this.frontier.pop().match.fillBefore(Fragment.empty,!0);add.childCount&&(this.placed=addToFragment(this.placed,this.frontier.length,add))}}]),Fitter}();function dropFromFragment(fragment,depth,count){return 0==depth?fragment.cutByIndex(count,fragment.childCount):fragment.replaceChild(0,fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content,depth-1,count)))}function addToFragment(fragment,depth,content){return 0==depth?fragment.append(content):fragment.replaceChild(fragment.childCount-1,fragment.lastChild.copy(addToFragment(fragment.lastChild.content,depth-1,content)))}function contentAt(fragment,depth){for(var _i180=0;_i180<depth;_i180++)fragment=fragment.firstChild.content;return fragment}function closeNodeStart(node,openStart,openEnd){if(openStart<=0)return node;var frag=node.content;return openStart>1&&(frag=frag.replaceChild(0,closeNodeStart(frag.firstChild,openStart-1,1==frag.childCount?openEnd-1:0))),openStart>0&&(frag=node.type.contentMatch.fillBefore(frag).append(frag),openEnd<=0&&(frag=frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty,!0)))),node.copy(frag)}function contentAfterFits($to,depth,type,match,open){var node=$to.node(depth),index=open?$to.indexAfter(depth):$to.index(depth);if(index==node.childCount&&!type.compatibleContent(node.type))return null;var fit=match.fillBefore(node.content,!0,index);return fit&&!function invalidMarks(type,fragment,start){for(var _i182=start;_i182<fragment.childCount;_i182++)if(!type.allowsMarks(fragment.child(_i182).marks))return!0;return!1}(type,node.content,index)?fit:null}function closeFragment(fragment,depth,oldOpen,newOpen,parent){if(depth<oldOpen){var _first2=fragment.firstChild;fragment=fragment.replaceChild(0,_first2.copy(closeFragment(_first2.content,depth+1,oldOpen,newOpen,_first2)))}if(depth>newOpen){var match=parent.contentMatchAt(0),start=match.fillBefore(fragment).append(fragment);fragment=start.append(match.matchFragment(start).fillBefore(Fragment.empty,!0))}return fragment}function coveredDepths($from,$to){for(var result=[],d=Math.min($from.depth,$to.depth);d>=0;d--){var start=$from.start(d);if(start<$from.pos-($from.depth-d)||$to.end(d)>$to.pos+($to.depth-d)||$from.node(d).type.spec.isolating||$to.node(d).type.spec.isolating)break;(start==$to.start(d)||d==$from.depth&&d==$to.depth&&$from.parent.inlineContent&&$to.parent.inlineContent&&d&&$to.start(d-1)==start-1)&&result.push(d)}return result}var AttrStep=function(_Step7){_inherits(AttrStep,_Step7);var _super9=_createSuper(AttrStep);function AttrStep(pos,attr,value){var _this16;return _classCallCheck(this,AttrStep),(_this16=_super9.call(this)).pos=pos,_this16.attr=attr,_this16.value=value,_this16}return _createClass(AttrStep,[{key:"apply",value:function apply(doc){var node=doc.nodeAt(this.pos);if(!node)return StepResult.fail("No node at attribute step's position");var attrs=Object.create(null);for(var name in node.attrs)attrs[name]=node.attrs[name];attrs[this.attr]=this.value;var updated=node.type.create(attrs,null,node.marks);return StepResult.fromReplace(doc,this.pos,this.pos+1,new Slice(Fragment.from(updated),0,node.isLeaf?0:1))}},{key:"getMap",value:function getMap(){return StepMap.empty}},{key:"invert",value:function invert(doc){return new AttrStep(this.pos,this.attr,doc.nodeAt(this.pos).attrs[this.attr])}},{key:"map",value:function map(mapping){var pos=mapping.mapResult(this.pos,1);return pos.deletedAfter?null:new AttrStep(pos.pos,this.attr,this.value)}},{key:"toJSON",value:function toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("number"!=typeof json.pos||"string"!=typeof json.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new AttrStep(json.pos,json.attr,json.value)}}]),AttrStep}(Step);Step.jsonID("attr",AttrStep);var DocAttrStep=function(_Step8){_inherits(DocAttrStep,_Step8);var _super10=_createSuper(DocAttrStep);function DocAttrStep(attr,value){var _this17;return _classCallCheck(this,DocAttrStep),(_this17=_super10.call(this)).attr=attr,_this17.value=value,_this17}return _createClass(DocAttrStep,[{key:"apply",value:function apply(doc){var attrs=Object.create(null);for(var name in doc.attrs)attrs[name]=doc.attrs[name];attrs[this.attr]=this.value;var updated=doc.type.create(attrs,doc.content,doc.marks);return StepResult.ok(updated)}},{key:"getMap",value:function getMap(){return StepMap.empty}},{key:"invert",value:function invert(doc){return new DocAttrStep(this.attr,doc.attrs[this.attr])}},{key:"map",value:function map(mapping){return this}},{key:"toJSON",value:function toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}}],[{key:"fromJSON",value:function fromJSON(schema,json){if("string"!=typeof json.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new DocAttrStep(json.attr,json.value)}}]),DocAttrStep}(Step);Step.jsonID("docAttr",DocAttrStep);var TransformError=Error;((TransformError=function TransformError(message){var err=Error.call(this,message);return err.__proto__=TransformError.prototype,err}).prototype=Object.create(Error.prototype)).constructor=TransformError,TransformError.prototype.name="TransformError";var Transform=function(){function Transform(doc){_classCallCheck(this,Transform),this.doc=doc,this.steps=[],this.docs=[],this.mapping=new Mapping}return _createClass(Transform,[{key:"before",get:function get(){return this.docs.length?this.docs[0]:this.doc}},{key:"step",value:function step(_step){var result=this.maybeStep(_step);if(result.failed)throw new TransformError(result.failed);return this}},{key:"maybeStep",value:function maybeStep(step){var result=step.apply(this.doc);return result.failed||this.addStep(step,result.doc),result}},{key:"docChanged",get:function get(){return this.steps.length>0}},{key:"addStep",value:function addStep(step,doc){this.docs.push(this.doc),this.steps.push(step),this.mapping.appendMap(step.getMap()),this.doc=doc}},{key:"replace",value:function replace(from){var to=arguments.length>1&&void 0!==arguments[1]?arguments[1]:from,slice=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Slice.empty,step=replaceStep(this.doc,from,to,slice);return step&&this.step(step),this}},{key:"replaceWith",value:function replaceWith(from,to,content){return this.replace(from,to,new Slice(Fragment.from(content),0,0))}},{key:"delete",value:function _delete(from,to){return this.replace(from,to,Slice.empty)}},{key:"insert",value:function insert(pos,content){return this.replaceWith(pos,pos,content)}},{key:"replaceRange",value:function replaceRange(from,to,slice){return function _replaceRange(tr,from,to,slice){if(!slice.size)return tr.deleteRange(from,to);var $from=tr.doc.resolve(from),$to=tr.doc.resolve(to);if(fitsTrivially($from,$to,slice))return tr.step(new ReplaceStep(from,to,slice));var targetDepths=coveredDepths($from,tr.doc.resolve(to));0==targetDepths[targetDepths.length-1]&&targetDepths.pop();var preferredTarget=-($from.depth+1);targetDepths.unshift(preferredTarget);for(var d=$from.depth,pos=$from.pos-1;d>0;d--,pos--){var spec=$from.node(d).type.spec;if(spec.defining||spec.definingAsContext||spec.isolating)break;targetDepths.indexOf(d)>-1?preferredTarget=d:$from.before(d)==pos&&targetDepths.splice(1,0,-d)}for(var type,preferredTargetIndex=targetDepths.indexOf(preferredTarget),leftNodes=[],preferredDepth=slice.openStart,content=slice.content,_i184=0;;_i184++){var node=content.firstChild;if(leftNodes.push(node),_i184==slice.openStart)break;content=node.content}for(var _d7=preferredDepth-1;_d7>=0;_d7--){var leftNode=leftNodes[_d7],def=(type=leftNode.type).spec.defining||type.spec.definingForContent;if(def&&!leftNode.sameMarkup($from.node(Math.abs(preferredTarget)-1)))preferredDepth=_d7;else if(def||!leftNode.type.isTextblock)break}for(var j=slice.openStart;j>=0;j--){var openDepth=(j+preferredDepth+1)%(slice.openStart+1),insert=leftNodes[openDepth];if(insert)for(var _i186=0;_i186<targetDepths.length;_i186++){var targetDepth=targetDepths[(_i186+preferredTargetIndex)%targetDepths.length],expand=!0;targetDepth<0&&(expand=!1,targetDepth=-targetDepth);var parent=$from.node(targetDepth-1),index=$from.index(targetDepth-1);if(parent.canReplaceWith(index,index,insert.type,insert.marks))return tr.replace($from.before(targetDepth),expand?$to.after(targetDepth):to,new Slice(closeFragment(slice.content,0,slice.openStart,openDepth),openDepth,slice.openEnd))}}for(var startSteps=tr.steps.length,_i188=targetDepths.length-1;_i188>=0&&(tr.replace(from,to,slice),!(tr.steps.length>startSteps));_i188--){var depth=targetDepths[_i188];depth<0||(from=$from.before(depth),to=$to.after(depth))}}(this,from,to,slice),this}},{key:"replaceRangeWith",value:function replaceRangeWith(from,to,node){return function _replaceRangeWith(tr,from,to,node){if(!node.isInline&&from==to&&tr.doc.resolve(from).parent.content.size){var point=function insertPoint(doc,pos,nodeType){var $pos=doc.resolve(pos);if($pos.parent.canReplaceWith($pos.index(),$pos.index(),nodeType))return pos;if(0==$pos.parentOffset)for(var d=$pos.depth-1;d>=0;d--){var index=$pos.index(d);if($pos.node(d).canReplaceWith(index,index,nodeType))return $pos.before(d+1);if(index>0)return null}if($pos.parentOffset==$pos.parent.content.size)for(var _d5=$pos.depth-1;_d5>=0;_d5--){var _index2=$pos.indexAfter(_d5);if($pos.node(_d5).canReplaceWith(_index2,_index2,nodeType))return $pos.after(_d5+1);if(_index2<$pos.node(_d5).childCount)return null}return null}(tr.doc,from,node.type);null!=point&&(from=to=point)}tr.replaceRange(from,to,new Slice(Fragment.from(node),0,0))}(this,from,to,node),this}},{key:"deleteRange",value:function deleteRange(from,to){return function deleteRange$1(tr,from,to){for(var $from=tr.doc.resolve(from),$to=tr.doc.resolve(to),covered=coveredDepths($from,$to),_i190=0;_i190<covered.length;_i190++){var depth=covered[_i190],last=_i190==covered.length-1;if(last&&0==depth||$from.node(depth).type.contentMatch.validEnd)return tr.delete($from.start(depth),$to.end(depth));if(depth>0&&(last||$from.node(depth-1).canReplace($from.index(depth-1),$to.indexAfter(depth-1))))return tr.delete($from.before(depth),$to.after(depth))}for(var d=1;d<=$from.depth&&d<=$to.depth;d++)if(from-$from.start(d)==$from.depth-d&&to>$from.end(d)&&$to.end(d)-to!=$to.depth-d)return tr.delete($from.before(d),to);tr.delete(from,to)}(this,from,to),this}},{key:"lift",value:function lift(range,target){return function lift$2(tr,range,target){for(var $from=range.$from,$to=range.$to,depth=range.depth,gapStart=$from.before(depth+1),gapEnd=$to.after(depth+1),start=gapStart,end=gapEnd,before=Fragment.empty,openStart=0,d=depth,splitting=!1;d>target;d--)splitting||$from.index(d)>0?(splitting=!0,before=Fragment.from($from.node(d).copy(before)),openStart++):start--;for(var after=Fragment.empty,openEnd=0,_d3=depth,_splitting2=!1;_d3>target;_d3--)_splitting2||$to.after(_d3+1)<$to.end(_d3)?(_splitting2=!0,after=Fragment.from($to.node(_d3).copy(after)),openEnd++):end++;tr.step(new ReplaceAroundStep(start,end,gapStart,gapEnd,new Slice(before.append(after),openStart,openEnd),before.size-openStart,!0))}(this,range,target),this}},{key:"join",value:function join(pos){return function _join(tr,pos,depth){var step=new ReplaceStep(pos-depth,pos+depth,Slice.empty,!0);tr.step(step)}(this,pos,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this}},{key:"wrap",value:function wrap(range,wrappers){return function _wrap4(tr,range,wrappers){for(var content=Fragment.empty,_i160=wrappers.length-1;_i160>=0;_i160--){if(content.size){var match=wrappers[_i160].type.contentMatch.matchFragment(content);if(!match||!match.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}content=Fragment.from(wrappers[_i160].type.create(wrappers[_i160].attrs,content))}var start=range.start,end=range.end;tr.step(new ReplaceAroundStep(start,end,start,end,new Slice(content,0,0),wrappers.length,!0))}(this,range,wrappers),this}},{key:"setBlockType",value:function setBlockType(from){return function setBlockType$1(tr,from,to,type,attrs){if(!type.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var mapFrom=tr.steps.length;tr.doc.nodesBetween(from,to,(function(node,pos){if(node.isTextblock&&!node.hasMarkup(type,attrs)&&function canChangeType(doc,pos,type){var $pos=doc.resolve(pos),index=$pos.index();return $pos.parent.canReplaceWith(index,index+1,type)}(tr.doc,tr.mapping.slice(mapFrom).map(pos),type)){tr.clearIncompatible(tr.mapping.slice(mapFrom).map(pos,1),type);var mapping=tr.mapping.slice(mapFrom),startM=mapping.map(pos,1),endM=mapping.map(pos+node.nodeSize,1);return tr.step(new ReplaceAroundStep(startM,endM,startM+1,endM-1,new Slice(Fragment.from(type.create(attrs,null,node.marks)),0,0),1,!0)),!1}}))}(this,from,arguments.length>1&&void 0!==arguments[1]?arguments[1]:from,arguments.length>2?arguments[2]:void 0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this}},{key:"setNodeMarkup",value:function setNodeMarkup(pos,type){return function _setNodeMarkup(tr,pos,type,attrs,marks){var node=tr.doc.nodeAt(pos);if(!node)throw new RangeError("No node at given position");type||(type=node.type);var newNode=type.create(attrs,null,marks||node.marks);if(node.isLeaf)return tr.replaceWith(pos,pos+node.nodeSize,newNode);if(!type.validContent(node.content))throw new RangeError("Invalid content for node type "+type.name);tr.step(new ReplaceAroundStep(pos,pos+node.nodeSize,pos+1,pos+node.nodeSize-1,new Slice(Fragment.from(newNode),0,0),1,!0))}(this,pos,type,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0),this}},{key:"setNodeAttribute",value:function setNodeAttribute(pos,attr,value){return this.step(new AttrStep(pos,attr,value)),this}},{key:"setDocAttribute",value:function setDocAttribute(attr,value){return this.step(new DocAttrStep(attr,value)),this}},{key:"addNodeMark",value:function addNodeMark(pos,mark){return this.step(new AddNodeMarkStep(pos,mark)),this}},{key:"removeNodeMark",value:function removeNodeMark(pos,mark){if(!(mark instanceof Mark$1)){var node=this.doc.nodeAt(pos);if(!node)throw new RangeError("No node at position "+pos);if(!(mark=mark.isInSet(node.marks)))return this}return this.step(new RemoveNodeMarkStep(pos,mark)),this}},{key:"split",value:function split(pos){return function _split(tr,pos){for(var depth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,typesAfter=arguments.length>3?arguments[3]:void 0,$pos=tr.doc.resolve(pos),before=Fragment.empty,after=Fragment.empty,d=$pos.depth,e=$pos.depth-depth,_i164=depth-1;d>e;d--,_i164--){before=Fragment.from($pos.node(d).copy(before));var typeAfter=typesAfter&&typesAfter[_i164];after=Fragment.from(typeAfter?typeAfter.type.create(typeAfter.attrs,after):$pos.node(d).copy(after))}tr.step(new ReplaceStep(pos,pos,new Slice(before.append(after),depth,depth),!0))}(this,pos,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0),this}},{key:"addMark",value:function addMark(from,to,mark){return function _addMark(tr,from,to,mark){var removing,adding,removed=[],added=[];tr.doc.nodesBetween(from,to,(function(node,pos,parent){if(node.isInline){var marks=node.marks;if(!mark.isInSet(marks)&&parent.type.allowsMarkType(mark.type)){for(var start=Math.max(pos,from),end=Math.min(pos+node.nodeSize,to),newSet=mark.addToSet(marks),_i150=0;_i150<marks.length;_i150++)marks[_i150].isInSet(newSet)||(removing&&removing.to==start&&removing.mark.eq(marks[_i150])?removing.to=end:removed.push(removing=new RemoveMarkStep(start,end,marks[_i150])));adding&&adding.to==start?adding.to=end:added.push(adding=new AddMarkStep(start,end,mark))}}})),removed.forEach((function(s){return tr.step(s)})),added.forEach((function(s){return tr.step(s)}))}(this,from,to,mark),this}},{key:"removeMark",value:function removeMark(from,to,mark){return function _removeMark(tr,from,to,mark){var matched=[],step=0;tr.doc.nodesBetween(from,to,(function(node,pos){if(node.isInline){step++;var toRemove=null;if(mark instanceof MarkType)for(var _found4,set=node.marks;_found4=mark.isInSet(set);)(toRemove||(toRemove=[])).push(_found4),set=_found4.removeFromSet(set);else mark?mark.isInSet(node.marks)&&(toRemove=[mark]):toRemove=node.marks;if(toRemove&&toRemove.length)for(var end=Math.min(pos+node.nodeSize,to),_i152=0;_i152<toRemove.length;_i152++){for(var _style2=toRemove[_i152],_found5=void 0,j=0;j<matched.length;j++){var m=matched[j];m.step==step-1&&_style2.eq(matched[j].style)&&(_found5=m)}_found5?(_found5.to=end,_found5.step=step):matched.push({style:_style2,from:Math.max(pos,from),to:end,step})}}})),matched.forEach((function(m){return tr.step(new RemoveMarkStep(m.from,m.to,m.style))}))}(this,from,to,mark),this}},{key:"clearIncompatible",value:function clearIncompatible(pos,parentType,match){return function _clearIncompatible(tr,pos,parentType){for(var match=arguments.length>3&&void 0!==arguments[3]?arguments[3]:parentType.contentMatch,node=tr.doc.nodeAt(pos),replSteps=[],cur=pos+1,_i154=0;_i154<node.childCount;_i154++){var child=node.child(_i154),end=cur+child.nodeSize,allowed=match.matchType(child.type);if(allowed){match=allowed;for(var j=0;j<child.marks.length;j++)parentType.allowsMarkType(child.marks[j].type)||tr.step(new RemoveMarkStep(cur,end,child.marks[j]));if(child.isText&&!parentType.spec.code)for(var m=void 0,_newline=/\r?\n|\r/g,slice=void 0;m=_newline.exec(child.text);)slice||(slice=new Slice(Fragment.from(parentType.schema.text(" ",parentType.allowedMarks(child.marks))),0,0)),replSteps.push(new ReplaceStep(cur+m.index,cur+m.index+m[0].length,slice))}else replSteps.push(new ReplaceStep(cur,end,Slice.empty));cur=end}if(!match.validEnd){var fill=match.fillBefore(Fragment.empty,!0);tr.replace(cur,cur,new Slice(fill,0,0))}for(var _i156=replSteps.length-1;_i156>=0;_i156--)tr.step(replSteps[_i156])}(this,pos,parentType,match),this}}]),Transform}(),classesById=Object.create(null),Selection=function(){function Selection($anchor,$head,ranges){_classCallCheck(this,Selection),this.$anchor=$anchor,this.$head=$head,this.ranges=ranges||[new SelectionRange($anchor.min($head),$anchor.max($head))]}return _createClass(Selection,[{key:"anchor",get:function get(){return this.$anchor.pos}},{key:"head",get:function get(){return this.$head.pos}},{key:"from",get:function get(){return this.$from.pos}},{key:"to",get:function get(){return this.$to.pos}},{key:"$from",get:function get(){return this.ranges[0].$from}},{key:"$to",get:function get(){return this.ranges[0].$to}},{key:"empty",get:function get(){for(var ranges=this.ranges,_i192=0;_i192<ranges.length;_i192++)if(ranges[_i192].$from.pos!=ranges[_i192].$to.pos)return!1;return!0}},{key:"content",value:function content(){return this.$from.doc.slice(this.from,this.to,!0)}},{key:"replace",value:function replace(tr){for(var content=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Slice.empty,lastNode=content.content.lastChild,lastParent=null,_i194=0;_i194<content.openEnd;_i194++)lastParent=lastNode,lastNode=lastNode.lastChild;for(var mapFrom=tr.steps.length,ranges=this.ranges,_i196=0;_i196<ranges.length;_i196++){var _ranges$_i=ranges[_i196],$from=_ranges$_i.$from,$to=_ranges$_i.$to,mapping=tr.mapping.slice(mapFrom);tr.replaceRange(mapping.map($from.pos),mapping.map($to.pos),_i196?Slice.empty:content),0==_i196&&selectionToInsertionEnd$1(tr,mapFrom,(lastNode?lastNode.isInline:lastParent&&lastParent.isTextblock)?-1:1)}}},{key:"replaceWith",value:function replaceWith(tr,node){for(var mapFrom=tr.steps.length,ranges=this.ranges,_i198=0;_i198<ranges.length;_i198++){var _ranges$_i2=ranges[_i198],$from=_ranges$_i2.$from,$to=_ranges$_i2.$to,mapping=tr.mapping.slice(mapFrom),from=mapping.map($from.pos),to=mapping.map($to.pos);_i198?tr.deleteRange(from,to):(tr.replaceRangeWith(from,to,node),selectionToInsertionEnd$1(tr,mapFrom,node.isInline?-1:1))}}},{key:"getBookmark",value:function getBookmark(){return TextSelection.between(this.$anchor,this.$head).getBookmark()}}],[{key:"findFrom",value:function findFrom($pos,dir){var textOnly=arguments.length>2&&void 0!==arguments[2]&&arguments[2],inner=$pos.parent.inlineContent?new TextSelection($pos):findSelectionIn($pos.node(0),$pos.parent,$pos.pos,$pos.index(),dir,textOnly);if(inner)return inner;for(var depth=$pos.depth-1;depth>=0;depth--){var _found6=dir<0?findSelectionIn($pos.node(0),$pos.node(depth),$pos.before(depth+1),$pos.index(depth),dir,textOnly):findSelectionIn($pos.node(0),$pos.node(depth),$pos.after(depth+1),$pos.index(depth)+1,dir,textOnly);if(_found6)return _found6}return null}},{key:"near",value:function near($pos){var bias=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom($pos,bias)||this.findFrom($pos,-bias)||new AllSelection($pos.node(0))}},{key:"atStart",value:function atStart(doc){return findSelectionIn(doc,doc,0,0,1)||new AllSelection(doc)}},{key:"atEnd",value:function atEnd(doc){return findSelectionIn(doc,doc,doc.content.size,doc.childCount,-1)||new AllSelection(doc)}},{key:"fromJSON",value:function fromJSON(doc,json){if(!json||!json.type)throw new RangeError("Invalid input for Selection.fromJSON");var cls=classesById[json.type];if(!cls)throw new RangeError("No selection type "+json.type+" defined");return cls.fromJSON(doc,json)}},{key:"jsonID",value:function jsonID(id,selectionClass){if(id in classesById)throw new RangeError("Duplicate use of selection JSON ID "+id);return classesById[id]=selectionClass,selectionClass.prototype.jsonID=id,selectionClass}}]),Selection}();Selection.prototype.visible=!0;var SelectionRange=_createClass((function SelectionRange($from,$to){_classCallCheck(this,SelectionRange),this.$from=$from,this.$to=$to})),warnedAboutTextSelection=!1;function checkTextSelection($pos){warnedAboutTextSelection||$pos.parent.inlineContent||(warnedAboutTextSelection=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+$pos.parent.type.name+")"))}var TextSelection=function(_Selection){_inherits(TextSelection,_Selection);var _super12=_createSuper(TextSelection);function TextSelection($anchor){var $head=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$anchor;return _classCallCheck(this,TextSelection),checkTextSelection($anchor),checkTextSelection($head),_super12.call(this,$anchor,$head)}return _createClass(TextSelection,[{key:"$cursor",get:function get(){return this.$anchor.pos==this.$head.pos?this.$head:null}},{key:"map",value:function map(doc,mapping){var $head=doc.resolve(mapping.map(this.head));if(!$head.parent.inlineContent)return Selection.near($head);var $anchor=doc.resolve(mapping.map(this.anchor));return new TextSelection($anchor.parent.inlineContent?$anchor:$head,$head)}},{key:"replace",value:function replace(tr){var content=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Slice.empty;if(_get(_getPrototypeOf(TextSelection.prototype),"replace",this).call(this,tr,content),content==Slice.empty){var marks=this.$from.marksAcross(this.$to);marks&&tr.ensureMarks(marks)}}},{key:"eq",value:function eq(other){return other instanceof TextSelection&&other.anchor==this.anchor&&other.head==this.head}},{key:"getBookmark",value:function getBookmark(){return new TextBookmark(this.anchor,this.head)}},{key:"toJSON",value:function toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function fromJSON(doc,json){if("number"!=typeof json.anchor||"number"!=typeof json.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new TextSelection(doc.resolve(json.anchor),doc.resolve(json.head))}},{key:"create",value:function create(doc,anchor){var head=arguments.length>2&&void 0!==arguments[2]?arguments[2]:anchor,$anchor=doc.resolve(anchor);return new this($anchor,head==anchor?$anchor:doc.resolve(head))}},{key:"between",value:function between($anchor,$head,bias){var dPos=$anchor.pos-$head.pos;if(bias&&!dPos||(bias=dPos>=0?1:-1),!$head.parent.inlineContent){var _found7=Selection.findFrom($head,bias,!0)||Selection.findFrom($head,-bias,!0);if(!_found7)return Selection.near($head,bias);$head=_found7.$head}return $anchor.parent.inlineContent||(0==dPos||($anchor=(Selection.findFrom($anchor,-bias,!0)||Selection.findFrom($anchor,bias,!0)).$anchor).pos<$head.pos!=dPos<0)&&($anchor=$head),new TextSelection($anchor,$head)}}]),TextSelection}(Selection);Selection.jsonID("text",TextSelection);var TextBookmark=function(){function TextBookmark(anchor,head){_classCallCheck(this,TextBookmark),this.anchor=anchor,this.head=head}return _createClass(TextBookmark,[{key:"map",value:function map(mapping){return new TextBookmark(mapping.map(this.anchor),mapping.map(this.head))}},{key:"resolve",value:function resolve(doc){return TextSelection.between(doc.resolve(this.anchor),doc.resolve(this.head))}}]),TextBookmark}(),NodeSelection=function(_Selection2){_inherits(NodeSelection,_Selection2);var _super13=_createSuper(NodeSelection);function NodeSelection($pos){var _this18;_classCallCheck(this,NodeSelection);var node=$pos.nodeAfter,$end=$pos.node(0).resolve($pos.pos+node.nodeSize);return(_this18=_super13.call(this,$pos,$end)).node=node,_this18}return _createClass(NodeSelection,[{key:"map",value:function map(doc,mapping){var _mapping$mapResult=mapping.mapResult(this.anchor),deleted=_mapping$mapResult.deleted,pos=_mapping$mapResult.pos,$pos=doc.resolve(pos);return deleted?Selection.near($pos):new NodeSelection($pos)}},{key:"content",value:function content(){return new Slice(Fragment.from(this.node),0,0)}},{key:"eq",value:function eq(other){return other instanceof NodeSelection&&other.anchor==this.anchor}},{key:"toJSON",value:function toJSON(){return{type:"node",anchor:this.anchor}}},{key:"getBookmark",value:function getBookmark(){return new NodeBookmark(this.anchor)}}],[{key:"fromJSON",value:function fromJSON(doc,json){if("number"!=typeof json.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new NodeSelection(doc.resolve(json.anchor))}},{key:"create",value:function create(doc,from){return new NodeSelection(doc.resolve(from))}},{key:"isSelectable",value:function isSelectable(node){return!node.isText&&!1!==node.type.spec.selectable}}]),NodeSelection}(Selection);NodeSelection.prototype.visible=!1,Selection.jsonID("node",NodeSelection);var NodeBookmark=function(){function NodeBookmark(anchor){_classCallCheck(this,NodeBookmark),this.anchor=anchor}return _createClass(NodeBookmark,[{key:"map",value:function map(mapping){var _mapping$mapResult2=mapping.mapResult(this.anchor),deleted=_mapping$mapResult2.deleted,pos=_mapping$mapResult2.pos;return deleted?new TextBookmark(pos,pos):new NodeBookmark(pos)}},{key:"resolve",value:function resolve(doc){var $pos=doc.resolve(this.anchor),node=$pos.nodeAfter;return node&&NodeSelection.isSelectable(node)?new NodeSelection($pos):Selection.near($pos)}}]),NodeBookmark}(),AllSelection=function(_Selection3){_inherits(AllSelection,_Selection3);var _super14=_createSuper(AllSelection);function AllSelection(doc){return _classCallCheck(this,AllSelection),_super14.call(this,doc.resolve(0),doc.resolve(doc.content.size))}return _createClass(AllSelection,[{key:"replace",value:function replace(tr){var content=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Slice.empty;if(content==Slice.empty){tr.delete(0,tr.doc.content.size);var sel=Selection.atStart(tr.doc);sel.eq(tr.selection)||tr.setSelection(sel)}else _get(_getPrototypeOf(AllSelection.prototype),"replace",this).call(this,tr,content)}},{key:"toJSON",value:function toJSON(){return{type:"all"}}},{key:"map",value:function map(doc){return new AllSelection(doc)}},{key:"eq",value:function eq(other){return other instanceof AllSelection}},{key:"getBookmark",value:function getBookmark(){return AllBookmark}}],[{key:"fromJSON",value:function fromJSON(doc){return new AllSelection(doc)}}]),AllSelection}(Selection);Selection.jsonID("all",AllSelection);var AllBookmark={map:function map(){return this},resolve:function resolve(doc){return new AllSelection(doc)}};function findSelectionIn(doc,node,pos,index,dir){var text=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(node.inlineContent)return TextSelection.create(doc,pos);for(var _i200=index-(dir>0?0:1);dir>0?_i200<node.childCount:_i200>=0;_i200+=dir){var child=node.child(_i200);if(child.isAtom){if(!text&&NodeSelection.isSelectable(child))return NodeSelection.create(doc,pos-(dir<0?child.nodeSize:0))}else{var inner=findSelectionIn(doc,child,pos+dir,dir<0?child.childCount:0,dir,text);if(inner)return inner}pos+=child.nodeSize*dir}return null}function selectionToInsertionEnd$1(tr,startLen,bias){var last=tr.steps.length-1;if(!(last<startLen)){var end,step=tr.steps[last];if(step instanceof ReplaceStep||step instanceof ReplaceAroundStep)tr.mapping.maps[last].forEach((function(_from,_to,_newFrom,newTo){null==end&&(end=newTo)})),tr.setSelection(Selection.near(tr.doc.resolve(end),bias))}}var Transaction=function(_Transform){_inherits(Transaction,_Transform);var _super15=_createSuper(Transaction);function Transaction(state){var _this19;return _classCallCheck(this,Transaction),(_this19=_super15.call(this,state.doc)).curSelectionFor=0,_this19.updated=0,_this19.meta=Object.create(null),_this19.time=Date.now(),_this19.curSelection=state.selection,_this19.storedMarks=state.storedMarks,_this19}return _createClass(Transaction,[{key:"selection",get:function get(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}},{key:"setSelection",value:function setSelection(selection){if(selection.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=selection,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}},{key:"selectionSet",get:function get(){return(1&this.updated)>0}},{key:"setStoredMarks",value:function setStoredMarks(marks){return this.storedMarks=marks,this.updated|=2,this}},{key:"ensureMarks",value:function ensureMarks(marks){return Mark$1.sameSet(this.storedMarks||this.selection.$from.marks(),marks)||this.setStoredMarks(marks),this}},{key:"addStoredMark",value:function addStoredMark(mark){return this.ensureMarks(mark.addToSet(this.storedMarks||this.selection.$head.marks()))}},{key:"removeStoredMark",value:function removeStoredMark(mark){return this.ensureMarks(mark.removeFromSet(this.storedMarks||this.selection.$head.marks()))}},{key:"storedMarksSet",get:function get(){return(2&this.updated)>0}},{key:"addStep",value:function addStep(step,doc){_get(_getPrototypeOf(Transaction.prototype),"addStep",this).call(this,step,doc),this.updated=-3&this.updated,this.storedMarks=null}},{key:"setTime",value:function setTime(time){return this.time=time,this}},{key:"replaceSelection",value:function replaceSelection(slice){return this.selection.replace(this,slice),this}},{key:"replaceSelectionWith",value:function replaceSelectionWith(node){var inheritMarks=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],selection=this.selection;return inheritMarks&&(node=node.mark(this.storedMarks||(selection.empty?selection.$from.marks():selection.$from.marksAcross(selection.$to)||Mark$1.none))),selection.replaceWith(this,node),this}},{key:"deleteSelection",value:function deleteSelection(){return this.selection.replace(this),this}},{key:"insertText",value:function insertText(text,from,to){var schema=this.doc.type.schema;if(null==from)return text?this.replaceSelectionWith(schema.text(text),!0):this.deleteSelection();if(null==to&&(to=from),to=null==to?from:to,!text)return this.deleteRange(from,to);var marks=this.storedMarks;if(!marks){var $from=this.doc.resolve(from);marks=to==from?$from.marks():$from.marksAcross(this.doc.resolve(to))}return this.replaceRangeWith(from,to,schema.text(text,marks)),this.selection.empty||this.setSelection(Selection.near(this.selection.$to)),this}},{key:"setMeta",value:function setMeta(key,value){return this.meta["string"==typeof key?key:key.key]=value,this}},{key:"getMeta",value:function getMeta(key){return this.meta["string"==typeof key?key:key.key]}},{key:"isGeneric",get:function get(){for(var _ in this.meta)return!1;return!0}},{key:"scrollIntoView",value:function scrollIntoView(){return this.updated|=4,this}},{key:"scrolledIntoView",get:function get(){return(4&this.updated)>0}}]),Transaction}(Transform);function bind(f,self){return self&&f?f.bind(self):f}var FieldDesc=_createClass((function FieldDesc(name,desc,self){_classCallCheck(this,FieldDesc),this.name=name,this.init=bind(desc.init,self),this.apply=bind(desc.apply,self)})),baseFields=[new FieldDesc("doc",{init:function init(config){return config.doc||config.schema.topNodeType.createAndFill()},apply:function apply(tr){return tr.doc}}),new FieldDesc("selection",{init:function init(config,instance){return config.selection||Selection.atStart(instance.doc)},apply:function apply(tr){return tr.selection}}),new FieldDesc("storedMarks",{init:function init(config){return config.storedMarks||null},apply:function apply(tr,_marks,_old,state){return state.selection.$cursor?tr.storedMarks:null}}),new FieldDesc("scrollToSelection",{init:function init(){return 0},apply:function apply(tr,prev){return tr.scrolledIntoView?prev+1:prev}})],Configuration=_createClass((function Configuration(schema,plugins){var _this20=this;_classCallCheck(this,Configuration),this.schema=schema,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=baseFields.slice(),plugins&&plugins.forEach((function(plugin){if(_this20.pluginsByKey[plugin.key])throw new RangeError("Adding different instances of a keyed plugin ("+plugin.key+")");_this20.plugins.push(plugin),_this20.pluginsByKey[plugin.key]=plugin,plugin.spec.state&&_this20.fields.push(new FieldDesc(plugin.key,plugin.spec.state,plugin))}))})),EditorState=function(){function EditorState(config){_classCallCheck(this,EditorState),this.config=config}return _createClass(EditorState,[{key:"schema",get:function get(){return this.config.schema}},{key:"plugins",get:function get(){return this.config.plugins}},{key:"apply",value:function apply(tr){return this.applyTransaction(tr).state}},{key:"filterTransaction",value:function filterTransaction(tr){for(var ignore=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,_i202=0;_i202<this.config.plugins.length;_i202++)if(_i202!=ignore){var plugin=this.config.plugins[_i202];if(plugin.spec.filterTransaction&&!plugin.spec.filterTransaction.call(plugin,tr,this))return!1}return!0}},{key:"applyTransaction",value:function applyTransaction(rootTr){if(!this.filterTransaction(rootTr))return{state:this,transactions:[]};for(var trs=[rootTr],newState=this.applyInner(rootTr),seen=null;;){for(var haveNew=!1,_i204=0;_i204<this.config.plugins.length;_i204++){var plugin=this.config.plugins[_i204];if(plugin.spec.appendTransaction){var n=seen?seen[_i204].n:0,oldState=seen?seen[_i204].state:this,_tr=n<trs.length&&plugin.spec.appendTransaction.call(plugin,n?trs.slice(n):trs,oldState,newState);if(_tr&&newState.filterTransaction(_tr,_i204)){if(_tr.setMeta("appendedTransaction",rootTr),!seen){seen=[];for(var j=0;j<this.config.plugins.length;j++)seen.push(j<_i204?{state:newState,n:trs.length}:{state:this,n:0})}trs.push(_tr),newState=newState.applyInner(_tr),haveNew=!0}seen&&(seen[_i204]={state:newState,n:trs.length})}}if(!haveNew)return{state:newState,transactions:trs}}}},{key:"applyInner",value:function applyInner(tr){if(!tr.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var newInstance=new EditorState(this.config),fields=this.config.fields,_i206=0;_i206<fields.length;_i206++){var field=fields[_i206];newInstance[field.name]=field.apply(tr,this[field.name],this,newInstance)}return newInstance}},{key:"tr",get:function get(){return new Transaction(this)}},{key:"reconfigure",value:function reconfigure(config){for(var $config=new Configuration(this.schema,config.plugins),fields=$config.fields,instance=new EditorState($config),_i208=0;_i208<fields.length;_i208++){var name=fields[_i208].name;instance[name]=this.hasOwnProperty(name)?this[name]:fields[_i208].init(config,instance)}return instance}},{key:"toJSON",value:function toJSON(pluginFields){var result={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(result.storedMarks=this.storedMarks.map((function(m){return m.toJSON()}))),pluginFields&&"object"==typeof pluginFields)for(var _prop12 in pluginFields){if("doc"==_prop12||"selection"==_prop12)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var plugin=pluginFields[_prop12],state=plugin.spec.state;state&&state.toJSON&&(result[_prop12]=state.toJSON.call(plugin,this[plugin.key]))}return result}}],[{key:"create",value:function create(config){for(var $config=new Configuration(config.doc?config.doc.type.schema:config.schema,config.plugins),instance=new EditorState($config),_i210=0;_i210<$config.fields.length;_i210++)instance[$config.fields[_i210].name]=$config.fields[_i210].init(config,instance);return instance}},{key:"fromJSON",value:function fromJSON(config,json,pluginFields){if(!json)throw new RangeError("Invalid input for EditorState.fromJSON");if(!config.schema)throw new RangeError("Required config field 'schema' missing");var $config=new Configuration(config.schema,config.plugins),instance=new EditorState($config);return $config.fields.forEach((function(field){if("doc"==field.name)instance.doc=Node$1.fromJSON(config.schema,json.doc);else if("selection"==field.name)instance.selection=Selection.fromJSON(instance.doc,json.selection);else if("storedMarks"==field.name)json.storedMarks&&(instance.storedMarks=json.storedMarks.map(config.schema.markFromJSON));else{if(pluginFields)for(var _prop14 in pluginFields){var plugin=pluginFields[_prop14],state=plugin.spec.state;if(plugin.key==field.name&&state&&state.fromJSON&&Object.prototype.hasOwnProperty.call(json,_prop14))return void(instance[field.name]=state.fromJSON.call(plugin,config,json[_prop14],instance))}instance[field.name]=field.init(config,instance)}})),instance}}]),EditorState}();function bindProps(obj,self,target){for(var _prop16 in obj){var val=obj[_prop16];val instanceof Function?val=val.bind(self):"handleDOMEvents"==_prop16&&(val=bindProps(val,self,{})),target[_prop16]=val}return target}var Plugin=function(){function Plugin(spec){_classCallCheck(this,Plugin),this.spec=spec,this.props={},spec.props&&bindProps(spec.props,this,this.props),this.key=spec.key?spec.key.key:createKey("plugin")}return _createClass(Plugin,[{key:"getState",value:function getState(state){return state[this.key]}}]),Plugin}(),keys=Object.create(null);function createKey(name){return name in keys?name+"$"+ ++keys[name]:(keys[name]=0,name+"$")}var PluginKey=function(){function PluginKey(){var name=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";_classCallCheck(this,PluginKey),this.key=createKey(name)}return _createClass(PluginKey,[{key:"get",value:function get(state){return state.config.pluginsByKey[this.key]}},{key:"getState",value:function getState(state){return state[this.key]}}]),PluginKey}(),domIndex=function domIndex(node){for(var index=0;;index++)if(!(node=node.previousSibling))return index},parentNode=function parentNode(node){var parent=node.assignedSlot||node.parentNode;return parent&&11==parent.nodeType?parent.host:parent},reusedRange=null,textRange=function textRange(node,from,to){var range=reusedRange||(reusedRange=document.createRange());return range.setEnd(node,null==to?node.nodeValue.length:to),range.setStart(node,from||0),range},isEquivalentPosition=function isEquivalentPosition(node,off,targetNode,targetOff){return targetNode&&(scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1))},atomElements=/^(img|br|input|textarea|hr)$/i;function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return!0;if(off==(dir<0?0:nodeSize(node))){var parent=node.parentNode;if(!parent||1!=parent.nodeType||hasBlockDesc(node)||atomElements.test(node.nodeName)||"false"==node.contentEditable)return!1;off=domIndex(node)+(dir<0?0:1),node=parent}else{if(1!=node.nodeType)return!1;if("false"==(node=node.childNodes[off+(dir<0?-1:0)]).contentEditable)return!1;off=dir<0?nodeSize(node):0}}}function nodeSize(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function hasBlockDesc(dom){for(var desc,cur=dom;cur&&!(desc=cur.pmViewDesc);cur=cur.parentNode);return desc&&desc.node&&desc.node.isBlock&&(desc.dom==dom||desc.contentDOM==dom)}var selectionCollapsed=function selectionCollapsed(domSel){return domSel.focusNode&&isEquivalentPosition(domSel.focusNode,domSel.focusOffset,domSel.anchorNode,domSel.anchorOffset)};function keyEvent(keyCode,key){var event=document.createEvent("Event");return event.initEvent("keydown",!0,!0),event.keyCode=keyCode,event.key=event.code=key,event}var nav="undefined"!=typeof navigator?navigator:null,doc="undefined"!=typeof document?document:null,agent=nav&&nav.userAgent||"",ie_edge=/Edge\/(\d+)/.exec(agent),ie_upto10=/MSIE \d/.exec(agent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(agent),ie$1=!!(ie_upto10||ie_11up||ie_edge),ie_version=ie_upto10?document.documentMode:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko=!ie$1&&/gecko\/(\d+)/i.test(agent);gecko&&(/Firefox\/(\d+)/.exec(agent)||[0,0])[1];var _chrome=!ie$1&&/Chrome\/(\d+)/.exec(agent),chrome=!!_chrome,chrome_version=_chrome?+_chrome[1]:0,safari=!ie$1&&!!nav&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(agent)||!!nav&&nav.maxTouchPoints>2),mac$2=ios||!!nav&&/Mac/.test(nav.platform),windows=!!nav&&/Win/.test(nav.platform),android=/Android \d/.test(agent),webkit=!!doc&&"webkitFontSmoothing"in doc.documentElement.style,webkit_version=webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function windowRect(doc){return{left:0,right:doc.documentElement.clientWidth,top:0,bottom:doc.documentElement.clientHeight}}function getSide(value,side){return"number"==typeof value?value:value[side]}function clientRect(node){var rect=node.getBoundingClientRect(),scaleX=rect.width/node.offsetWidth||1,scaleY=rect.height/node.offsetHeight||1;return{left:rect.left,right:rect.left+node.clientWidth*scaleX,top:rect.top,bottom:rect.top+node.clientHeight*scaleY}}function scrollRectIntoView(view,rect,startDOM){for(var scrollThreshold=view.someProp("scrollThreshold")||0,scrollMargin=view.someProp("scrollMargin")||5,doc=view.dom.ownerDocument,parent=startDOM||view.dom;parent;parent=parentNode(parent))if(1==parent.nodeType){var elt=parent,atTop=elt==doc.body,bounding=atTop?windowRect(doc):clientRect(elt),moveX=0,moveY=0;if(rect.top<bounding.top+getSide(scrollThreshold,"top")?moveY=-(bounding.top-rect.top+getSide(scrollMargin,"top")):rect.bottom>bounding.bottom-getSide(scrollThreshold,"bottom")&&(moveY=rect.bottom-rect.top>bounding.bottom-bounding.top?rect.top+getSide(scrollMargin,"top")-bounding.top:rect.bottom-bounding.bottom+getSide(scrollMargin,"bottom")),rect.left<bounding.left+getSide(scrollThreshold,"left")?moveX=-(bounding.left-rect.left+getSide(scrollMargin,"left")):rect.right>bounding.right-getSide(scrollThreshold,"right")&&(moveX=rect.right-bounding.right+getSide(scrollMargin,"right")),moveX||moveY)if(atTop)doc.defaultView.scrollBy(moveX,moveY);else{var startX=elt.scrollLeft,startY=elt.scrollTop;moveY&&(elt.scrollTop+=moveY),moveX&&(elt.scrollLeft+=moveX);var dX=elt.scrollLeft-startX,dY=elt.scrollTop-startY;rect={left:rect.left-dX,top:rect.top-dY,right:rect.right-dX,bottom:rect.bottom-dY}}if(atTop||/^(fixed|sticky)$/.test(getComputedStyle(parent).position))break}}function scrollStack(dom){for(var stack=[],doc=dom.ownerDocument,cur=dom;cur&&(stack.push({dom:cur,top:cur.scrollTop,left:cur.scrollLeft}),dom!=doc);cur=parentNode(cur));return stack}function restoreScrollStack(stack,dTop){for(var _i212=0;_i212<stack.length;_i212++){var _stack$_i=stack[_i212],dom=_stack$_i.dom,_top3=_stack$_i.top,left=_stack$_i.left;dom.scrollTop!=_top3+dTop&&(dom.scrollTop=_top3+dTop),dom.scrollLeft!=left&&(dom.scrollLeft=left)}}var preventScrollSupported=null;function findOffsetInNode(node,coords){for(var closest,coordsClosest,firstBelow,coordsBelow,dxClosest=2e8,offset=0,rowBot=coords.top,rowTop=coords.top,child=node.firstChild,childIndex=0;child;child=child.nextSibling,childIndex++){var rects=void 0;if(1==child.nodeType)rects=child.getClientRects();else{if(3!=child.nodeType)continue;rects=textRange(child).getClientRects()}for(var _i214=0;_i214<rects.length;_i214++){var _rect=rects[_i214];if(_rect.top<=rowBot&&_rect.bottom>=rowTop){rowBot=Math.max(_rect.bottom,rowBot),rowTop=Math.min(_rect.top,rowTop);var dx=_rect.left>coords.left?_rect.left-coords.left:_rect.right<coords.left?coords.left-_rect.right:0;if(dx<dxClosest){closest=child,dxClosest=dx,coordsClosest=dx&&3==closest.nodeType?{left:_rect.right<coords.left?_rect.right:_rect.left,top:coords.top}:coords,1==child.nodeType&&dx&&(offset=childIndex+(coords.left>=(_rect.left+_rect.right)/2?1:0));continue}}else _rect.top>coords.top&&!firstBelow&&_rect.left<=coords.left&&_rect.right>=coords.left&&(firstBelow=child,coordsBelow={left:Math.max(_rect.left,Math.min(_rect.right,coords.left)),top:_rect.top});!closest&&(coords.left>=_rect.right&&coords.top>=_rect.top||coords.left>=_rect.left&&coords.top>=_rect.bottom)&&(offset=childIndex+1)}}return!closest&&firstBelow&&(closest=firstBelow,coordsClosest=coordsBelow,dxClosest=0),closest&&3==closest.nodeType?function findOffsetInText(node,coords){for(var len=node.nodeValue.length,range=document.createRange(),_i216=0;_i216<len;_i216++){range.setEnd(node,_i216+1),range.setStart(node,_i216);var _rect2=singleRect(range,1);if(_rect2.top!=_rect2.bottom&&inRect(coords,_rect2))return{node,offset:_i216+(coords.left>=(_rect2.left+_rect2.right)/2?1:0)}}return{node,offset:0}}(closest,coordsClosest):!closest||dxClosest&&1==closest.nodeType?{node,offset}:findOffsetInNode(closest,coordsClosest)}function inRect(coords,rect){return coords.left>=rect.left-1&&coords.left<=rect.right+1&&coords.top>=rect.top-1&&coords.top<=rect.bottom+1}function elementFromPoint(element,coords,box){var len=element.childNodes.length;if(len&&box.top<box.bottom)for(var startI=Math.max(0,Math.min(len-1,Math.floor(len*(coords.top-box.top)/(box.bottom-box.top))-2)),_i218=startI;;){var child=element.childNodes[_i218];if(1==child.nodeType)for(var rects=child.getClientRects(),j=0;j<rects.length;j++){var _rect5=rects[j];if(inRect(coords,_rect5))return elementFromPoint(child,coords,_rect5)}if((_i218=(_i218+1)%len)==startI)break}return element}function _posAtCoords(view,coords){var node,doc=view.dom.ownerDocument,offset=0,caret=function caretFromPoint(doc,x,y){if(doc.caretPositionFromPoint)try{var pos=doc.caretPositionFromPoint(x,y);if(pos)return{node:pos.offsetNode,offset:pos.offset}}catch(_){}if(doc.caretRangeFromPoint){var _range=doc.caretRangeFromPoint(x,y);if(_range)return{node:_range.startContainer,offset:_range.startOffset}}}(doc,coords.left,coords.top);caret&&(node=caret.node,offset=caret.offset);var pos,elt=(view.root.elementFromPoint?view.root:doc).elementFromPoint(coords.left,coords.top);if(!elt||!view.dom.contains(1!=elt.nodeType?elt.parentNode:elt)){var box=view.dom.getBoundingClientRect();if(!inRect(coords,box))return null;if(!(elt=elementFromPoint(view.dom,coords,box)))return null}if(safari)for(var p=elt;node&&p;p=parentNode(p))p.draggable&&(node=void 0);if(elt=function targetKludge(dom,coords){var parent=dom.parentNode;return parent&&/^li$/i.test(parent.nodeName)&&coords.left<dom.getBoundingClientRect().left?parent:dom}(elt,coords),node){if(gecko&&1==node.nodeType&&(offset=Math.min(offset,node.childNodes.length))<node.childNodes.length){var _box,next=node.childNodes[offset];"IMG"==next.nodeName&&(_box=next.getBoundingClientRect()).right<=coords.left&&_box.bottom>coords.top&&offset++}var prev;webkit&&offset&&1==node.nodeType&&1==(prev=node.childNodes[offset-1]).nodeType&&"false"==prev.contentEditable&&prev.getBoundingClientRect().top>=coords.top&&offset--,node==view.dom&&offset==node.childNodes.length-1&&1==node.lastChild.nodeType&&coords.top>node.lastChild.getBoundingClientRect().bottom?pos=view.state.doc.content.size:0!=offset&&1==node.nodeType&&"BR"==node.childNodes[offset-1].nodeName||(pos=function posFromCaret(view,node,offset,coords){for(var outsideBlock=-1,cur=node,sawBlock=!1;cur!=view.dom;){var desc=view.docView.nearestDesc(cur,!0);if(!desc)return null;if(1==desc.dom.nodeType&&(desc.node.isBlock&&desc.parent&&!sawBlock||!desc.contentDOM)){var _rect4=desc.dom.getBoundingClientRect();if(desc.node.isBlock&&desc.parent&&!sawBlock&&(sawBlock=!0,_rect4.left>coords.left||_rect4.top>coords.top?outsideBlock=desc.posBefore:(_rect4.right<coords.left||_rect4.bottom<coords.top)&&(outsideBlock=desc.posAfter)),!desc.contentDOM&&outsideBlock<0&&!desc.node.isText)return(desc.node.isBlock?coords.top<(_rect4.top+_rect4.bottom)/2:coords.left<(_rect4.left+_rect4.right)/2)?desc.posBefore:desc.posAfter}cur=desc.dom.parentNode}return outsideBlock>-1?outsideBlock:view.docView.posFromDOM(node,offset,-1)}(view,node,offset,coords))}null==pos&&(pos=function posFromElement(view,elt,coords){var _findOffsetInNode=findOffsetInNode(elt,coords),node=_findOffsetInNode.node,offset=_findOffsetInNode.offset,bias=-1;if(1==node.nodeType&&!node.firstChild){var _rect3=node.getBoundingClientRect();bias=_rect3.left!=_rect3.right&&coords.left>(_rect3.left+_rect3.right)/2?1:-1}return view.docView.posFromDOM(node,offset,bias)}(view,elt,coords));var desc=view.docView.nearestDesc(elt,!0);return{pos,inside:desc?desc.posAtStart-desc.border:-1}}function nonZero(rect){return rect.top<rect.bottom||rect.left<rect.right}function singleRect(target,bias){var rects=target.getClientRects();if(rects.length){var _first3=rects[bias<0?0:rects.length-1];if(nonZero(_first3))return _first3}return Array.prototype.find.call(rects,nonZero)||target.getBoundingClientRect()}var BIDI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function _coordsAtPos(view,pos,side){var _view$docView$domFrom=view.docView.domFromPos(pos,side<0?-1:1),node=_view$docView$domFrom.node,offset=_view$docView$domFrom.offset,atom=_view$docView$domFrom.atom,supportEmptyRange=webkit||gecko;if(3==node.nodeType){if(!supportEmptyRange||!BIDI.test(node.nodeValue)&&(side<0?offset:offset!=node.nodeValue.length)){var from=offset,to=offset,takeSide=side<0?1:-1;return side<0&&!offset?(to++,takeSide=-1):side>=0&&offset==node.nodeValue.length?(from--,takeSide=1):side<0?from--:to++,flattenV(singleRect(textRange(node,from,to),takeSide),takeSide<0)}var _rect6=singleRect(textRange(node,offset,offset),side);if(gecko&&offset&&/\s/.test(node.nodeValue[offset-1])&&offset<node.nodeValue.length){var rectBefore=singleRect(textRange(node,offset-1,offset-1),-1);if(rectBefore.top==_rect6.top){var rectAfter=singleRect(textRange(node,offset,offset+1),-1);if(rectAfter.top!=_rect6.top)return flattenV(rectAfter,rectAfter.left<rectBefore.left)}}return _rect6}if(!view.state.doc.resolve(pos-(atom||0)).parent.inlineContent){if(null==atom&&offset&&(side<0||offset==nodeSize(node))){var before=node.childNodes[offset-1];if(1==before.nodeType)return flattenH(before.getBoundingClientRect(),!1)}if(null==atom&&offset<nodeSize(node)){var after=node.childNodes[offset];if(1==after.nodeType)return flattenH(after.getBoundingClientRect(),!0)}return flattenH(node.getBoundingClientRect(),side>=0)}if(null==atom&&offset&&(side<0||offset==nodeSize(node))){var _before=node.childNodes[offset-1],_target=3==_before.nodeType?textRange(_before,nodeSize(_before)-(supportEmptyRange?0:1)):1!=_before.nodeType||"BR"==_before.nodeName&&_before.nextSibling?null:_before;if(_target)return flattenV(singleRect(_target,1),!1)}if(null==atom&&offset<nodeSize(node)){for(var _after2=node.childNodes[offset];_after2.pmViewDesc&&_after2.pmViewDesc.ignoreForCoords;)_after2=_after2.nextSibling;var _target2=_after2?3==_after2.nodeType?textRange(_after2,0,supportEmptyRange?0:1):1==_after2.nodeType?_after2:null:null;if(_target2)return flattenV(singleRect(_target2,-1),!0)}return flattenV(singleRect(3==node.nodeType?textRange(node):node,-side),side>=0)}function flattenV(rect,left){if(0==rect.width)return rect;var x=left?rect.left:rect.right;return{top:rect.top,bottom:rect.bottom,left:x,right:x}}function flattenH(rect,top){if(0==rect.height)return rect;var y=top?rect.top:rect.bottom;return{top:y,bottom:y,left:rect.left,right:rect.right}}function withFlushedState(view,state,f){var viewState=view.state,active=view.root.activeElement;viewState!=state&&view.updateState(state),active!=view.dom&&view.focus();try{return f()}finally{viewState!=state&&view.updateState(viewState),active!=view.dom&&active&&active.focus()}}var maybeRTL=/[\u0590-\u08ac]/;var cachedState=null,cachedDir=null,cachedResult=!1;function _endOfTextblock(view,state,dir){return cachedState==state&&cachedDir==dir?cachedResult:(cachedState=state,cachedDir=dir,cachedResult="up"==dir||"down"==dir?function endOfTextblockVertical(view,state,dir){var sel=state.selection,$pos="up"==dir?sel.$from:sel.$to;return withFlushedState(view,state,(function(){for(var dom=view.docView.domFromPos($pos.pos,"up"==dir?-1:1).node;;){var nearest=view.docView.nearestDesc(dom,!0);if(!nearest)break;if(nearest.node.isBlock){dom=nearest.contentDOM||nearest.dom;break}dom=nearest.dom.parentNode}for(var coords=_coordsAtPos(view,$pos.pos,1),child=dom.firstChild;child;child=child.nextSibling){var boxes=void 0;if(1==child.nodeType)boxes=child.getClientRects();else{if(3!=child.nodeType)continue;boxes=textRange(child,0,child.nodeValue.length).getClientRects()}for(var _i220=0;_i220<boxes.length;_i220++){var box=boxes[_i220];if(box.bottom>box.top+1&&("up"==dir?coords.top-box.top>2*(box.bottom-coords.top):box.bottom-coords.bottom>2*(coords.bottom-box.top)))return!1}}return!0}))}(view,state,dir):function endOfTextblockHorizontal(view,state,dir){var $head=state.selection.$head;if(!$head.parent.isTextblock)return!1;var offset=$head.parentOffset,atStart=!offset,atEnd=offset==$head.parent.content.size,sel=view.domSelection();return maybeRTL.test($head.parent.textContent)&&sel.modify?withFlushedState(view,state,(function(){var _view$domSelectionRan=view.domSelectionRange(),oldNode=_view$domSelectionRan.focusNode,oldOff=_view$domSelectionRan.focusOffset,anchorNode=_view$domSelectionRan.anchorNode,anchorOffset=_view$domSelectionRan.anchorOffset,oldBidiLevel=sel.caretBidiLevel;sel.modify("move",dir,"character");var parentDOM=$head.depth?view.docView.domAfterPos($head.before()):view.dom,_view$domSelectionRan2=view.domSelectionRange(),newNode=_view$domSelectionRan2.focusNode,newOff=_view$domSelectionRan2.focusOffset,result=newNode&&!parentDOM.contains(1==newNode.nodeType?newNode:newNode.parentNode)||oldNode==newNode&&oldOff==newOff;try{sel.collapse(anchorNode,anchorOffset),oldNode&&(oldNode!=anchorNode||oldOff!=anchorOffset)&&sel.extend&&sel.extend(oldNode,oldOff)}catch(_){}return null!=oldBidiLevel&&(sel.caretBidiLevel=oldBidiLevel),result})):"left"==dir||"backward"==dir?atStart:atEnd}(view,state,dir))}var ViewDesc=function(){function ViewDesc(parent,children,dom,contentDOM){_classCallCheck(this,ViewDesc),this.parent=parent,this.children=children,this.dom=dom,this.contentDOM=contentDOM,this.dirty=0,dom.pmViewDesc=this}return _createClass(ViewDesc,[{key:"matchesWidget",value:function matchesWidget(widget){return!1}},{key:"matchesMark",value:function matchesMark(mark){return!1}},{key:"matchesNode",value:function matchesNode(node,outerDeco,innerDeco){return!1}},{key:"matchesHack",value:function matchesHack(nodeName){return!1}},{key:"parseRule",value:function parseRule(){return null}},{key:"stopEvent",value:function stopEvent(event){return!1}},{key:"size",get:function get(){for(var size=0,_i222=0;_i222<this.children.length;_i222++)size+=this.children[_i222].size;return size}},{key:"border",get:function get(){return 0}},{key:"destroy",value:function destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(var _i224=0;_i224<this.children.length;_i224++)this.children[_i224].destroy()}},{key:"posBeforeChild",value:function posBeforeChild(child){for(var _i226=0,pos=this.posAtStart;;_i226++){var cur=this.children[_i226];if(cur==child)return pos;pos+=cur.size}}},{key:"posBefore",get:function get(){return this.parent.posBeforeChild(this)}},{key:"posAtStart",get:function get(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}},{key:"posAfter",get:function get(){return this.posBefore+this.size}},{key:"posAtEnd",get:function get(){return this.posAtStart+this.size-2*this.border}},{key:"localPosFromDOM",value:function localPosFromDOM(dom,offset,bias){if(this.contentDOM&&this.contentDOM.contains(1==dom.nodeType?dom:dom.parentNode)){if(bias<0){var domBefore,desc;if(dom==this.contentDOM)domBefore=dom.childNodes[offset-1];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domBefore=dom.previousSibling}for(;domBefore&&(!(desc=domBefore.pmViewDesc)||desc.parent!=this);)domBefore=domBefore.previousSibling;return domBefore?this.posBeforeChild(desc)+desc.size:this.posAtStart}var domAfter,_desc;if(dom==this.contentDOM)domAfter=dom.childNodes[offset];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domAfter=dom.nextSibling}for(;domAfter&&(!(_desc=domAfter.pmViewDesc)||_desc.parent!=this);)domAfter=domAfter.nextSibling;return domAfter?this.posBeforeChild(_desc):this.posAtEnd}var atEnd;if(dom==this.dom&&this.contentDOM)atEnd=offset>domIndex(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))atEnd=2&dom.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==offset)for(var search=dom;;search=search.parentNode){if(search==this.dom){atEnd=!1;break}if(search.previousSibling)break}if(null==atEnd&&offset==dom.childNodes.length)for(var _search2=dom;;_search2=_search2.parentNode){if(_search2==this.dom){atEnd=!0;break}if(_search2.nextSibling)break}}return(null==atEnd?bias>0:atEnd)?this.posAtEnd:this.posAtStart}},{key:"nearestDesc",value:function nearestDesc(dom){for(var onlyNodes=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_first5=!0,cur=dom;cur;cur=cur.parentNode){var desc=this.getDesc(cur),nodeDOM=void 0;if(desc&&(!onlyNodes||desc.node)){if(!_first5||!(nodeDOM=desc.nodeDOM)||(1==nodeDOM.nodeType?nodeDOM.contains(1==dom.nodeType?dom:dom.parentNode):nodeDOM==dom))return desc;_first5=!1}}}},{key:"getDesc",value:function getDesc(dom){for(var desc=dom.pmViewDesc,cur=desc;cur;cur=cur.parent)if(cur==this)return desc}},{key:"posFromDOM",value:function posFromDOM(dom,offset,bias){for(var scan=dom;scan;scan=scan.parentNode){var desc=this.getDesc(scan);if(desc)return desc.localPosFromDOM(dom,offset,bias)}return-1}},{key:"descAt",value:function descAt(pos){for(var _i228=0,offset=0;_i228<this.children.length;_i228++){var child=this.children[_i228],end=offset+child.size;if(offset==pos&&end!=offset){for(;!child.border&&child.children.length;)child=child.children[0];return child}if(pos<end)return child.descAt(pos-offset-child.border);offset=end}}},{key:"domFromPos",value:function domFromPos(pos,side){if(!this.contentDOM)return{node:this.dom,offset:0,atom:pos+1};for(var prev,i=0,offset=0,curPos=0;i<this.children.length;i++){var child=this.children[i],end=curPos+child.size;if(end>pos||child instanceof TrailingHackViewDesc){offset=pos-curPos;break}curPos=end}if(offset)return this.children[i].domFromPos(offset-this.children[i].border,side);for(;i&&!(prev=this.children[i-1]).size&&prev instanceof WidgetViewDesc&&prev.side>=0;i--);if(side<=0){for(var _prev,_enter=!0;(_prev=i?this.children[i-1]:null)&&_prev.dom.parentNode!=this.contentDOM;i--,_enter=!1);return _prev&&side&&_enter&&!_prev.border&&!_prev.domAtom?_prev.domFromPos(_prev.size,side):{node:this.contentDOM,offset:_prev?domIndex(_prev.dom)+1:0}}for(var next,_enter2=!0;(next=i<this.children.length?this.children[i]:null)&&next.dom.parentNode!=this.contentDOM;i++,_enter2=!1);return next&&_enter2&&!next.border&&!next.domAtom?next.domFromPos(0,side):{node:this.contentDOM,offset:next?domIndex(next.dom):this.contentDOM.childNodes.length}}},{key:"parseRange",value:function parseRange(from,to){var base=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from,to,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var fromOffset=-1,toOffset=-1,offset=base,_i230=0;;_i230++){var child=this.children[_i230],end=offset+child.size;if(-1==fromOffset&&from<=end){var childBase=offset+child.border;if(from>=childBase&&to<=end-child.border&&child.node&&child.contentDOM&&this.contentDOM.contains(child.contentDOM))return child.parseRange(from,to,childBase);from=offset;for(var j=_i230;j>0;j--){var prev=this.children[j-1];if(prev.size&&prev.dom.parentNode==this.contentDOM&&!prev.emptyChildAt(1)){fromOffset=domIndex(prev.dom)+1;break}from-=prev.size}-1==fromOffset&&(fromOffset=0)}if(fromOffset>-1&&(end>to||_i230==this.children.length-1)){to=end;for(var _j3=_i230+1;_j3<this.children.length;_j3++){var next=this.children[_j3];if(next.size&&next.dom.parentNode==this.contentDOM&&!next.emptyChildAt(-1)){toOffset=domIndex(next.dom);break}to+=next.size}-1==toOffset&&(toOffset=this.contentDOM.childNodes.length);break}offset=end}return{node:this.contentDOM,from,to,fromOffset,toOffset}}},{key:"emptyChildAt",value:function emptyChildAt(side){if(this.border||!this.contentDOM||!this.children.length)return!1;var child=this.children[side<0?0:this.children.length-1];return 0==child.size||child.emptyChildAt(side)}},{key:"domAfterPos",value:function domAfterPos(pos){var _this$domFromPos=this.domFromPos(pos,0),node=_this$domFromPos.node,offset=_this$domFromPos.offset;if(1!=node.nodeType||offset==node.childNodes.length)throw new RangeError("No node after pos "+pos);return node.childNodes[offset]}},{key:"setSelection",value:function setSelection(anchor,head,root){for(var force=arguments.length>3&&void 0!==arguments[3]&&arguments[3],from=Math.min(anchor,head),to=Math.max(anchor,head),_i232=0,offset=0;_i232<this.children.length;_i232++){var child=this.children[_i232],end=offset+child.size;if(from>offset&&to<end)return child.setSelection(anchor-offset-child.border,head-offset-child.border,root,force);offset=end}var anchorDOM=this.domFromPos(anchor,anchor?-1:1),headDOM=head==anchor?anchorDOM:this.domFromPos(head,head?-1:1),domSel=root.getSelection(),brKludge=!1;if((gecko||safari)&&anchor==head){var _anchorDOM=anchorDOM,node=_anchorDOM.node,_offset=_anchorDOM.offset;if(3==node.nodeType){if((brKludge=!(!_offset||"\n"!=node.nodeValue[_offset-1]))&&_offset==node.nodeValue.length)for(var after,scan=node;scan;scan=scan.parentNode){if(after=scan.nextSibling){"BR"==after.nodeName&&(anchorDOM=headDOM={node:after.parentNode,offset:domIndex(after)+1});break}var desc=scan.pmViewDesc;if(desc&&desc.node&&desc.node.isBlock)break}}else{var prev=node.childNodes[_offset-1];brKludge=prev&&("BR"==prev.nodeName||"false"==prev.contentEditable)}}if(gecko&&domSel.focusNode&&domSel.focusNode!=headDOM.node&&1==domSel.focusNode.nodeType){var _after3=domSel.focusNode.childNodes[domSel.focusOffset];_after3&&"false"==_after3.contentEditable&&(force=!0)}if(force||brKludge&&safari||!isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)||!isEquivalentPosition(headDOM.node,headDOM.offset,domSel.focusNode,domSel.focusOffset)){var domSelExtended=!1;if((domSel.extend||anchor==head)&&!brKludge){domSel.collapse(anchorDOM.node,anchorDOM.offset);try{anchor!=head&&domSel.extend(headDOM.node,headDOM.offset),domSelExtended=!0}catch(_){}}if(!domSelExtended){if(anchor>head){var tmp=anchorDOM;anchorDOM=headDOM,headDOM=tmp}var _range2=document.createRange();_range2.setEnd(headDOM.node,headDOM.offset),_range2.setStart(anchorDOM.node,anchorDOM.offset),domSel.removeAllRanges(),domSel.addRange(_range2)}}}},{key:"ignoreMutation",value:function ignoreMutation(mutation){return!this.contentDOM&&"selection"!=mutation.type}},{key:"contentLost",get:function get(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}},{key:"markDirty",value:function markDirty(from,to){for(var offset=0,_i234=0;_i234<this.children.length;_i234++){var child=this.children[_i234],end=offset+child.size;if(offset==end?from<=end&&to>=offset:from<end&&to>offset){var startInside=offset+child.border,endInside=end-child.border;if(from>=startInside&&to<=endInside)return this.dirty=from==offset||to==end?2:1,void(from!=startInside||to!=endInside||!child.contentLost&&child.dom.parentNode==this.contentDOM?child.markDirty(from-startInside,to-startInside):child.dirty=3);child.dirty=child.dom!=child.contentDOM||child.dom.parentNode!=this.contentDOM||child.children.length?3:2}offset=end}this.dirty=2}},{key:"markParentsDirty",value:function markParentsDirty(){for(var level=1,node=this.parent;node;node=node.parent,level++){var dirty=1==level?2:1;node.dirty<dirty&&(node.dirty=dirty)}}},{key:"domAtom",get:function get(){return!1}},{key:"ignoreForCoords",get:function get(){return!1}}]),ViewDesc}(),WidgetViewDesc=function(_ViewDesc){_inherits(WidgetViewDesc,_ViewDesc);var _super16=_createSuper(WidgetViewDesc);function WidgetViewDesc(parent,widget,view,pos){var _this21;_classCallCheck(this,WidgetViewDesc);var self,dom=widget.type.toDOM;if("function"==typeof dom&&(dom=dom(view,(function(){return self?self.parent?self.parent.posBeforeChild(self):void 0:pos}))),!widget.type.spec.raw){if(1!=dom.nodeType){var wrap=document.createElement("span");wrap.appendChild(dom),dom=wrap}dom.contentEditable="false",dom.classList.add("ProseMirror-widget")}return(_this21=_super16.call(this,parent,[],dom,null)).widget=widget,_this21.widget=widget,self=_assertThisInitialized(_this21),_this21}return _createClass(WidgetViewDesc,[{key:"matchesWidget",value:function matchesWidget(widget){return 0==this.dirty&&widget.type.eq(this.widget.type)}},{key:"parseRule",value:function parseRule(){return{ignore:!0}}},{key:"stopEvent",value:function stopEvent(event){var stop=this.widget.spec.stopEvent;return!!stop&&stop(event)}},{key:"ignoreMutation",value:function ignoreMutation(mutation){return"selection"!=mutation.type||this.widget.spec.ignoreSelection}},{key:"destroy",value:function destroy(){this.widget.type.destroy(this.dom),_get(_getPrototypeOf(WidgetViewDesc.prototype),"destroy",this).call(this)}},{key:"domAtom",get:function get(){return!0}},{key:"side",get:function get(){return this.widget.type.side}}]),WidgetViewDesc}(ViewDesc),CompositionViewDesc=function(_ViewDesc2){_inherits(CompositionViewDesc,_ViewDesc2);var _super17=_createSuper(CompositionViewDesc);function CompositionViewDesc(parent,dom,textDOM,text){var _this22;return _classCallCheck(this,CompositionViewDesc),(_this22=_super17.call(this,parent,[],dom,null)).textDOM=textDOM,_this22.text=text,_this22}return _createClass(CompositionViewDesc,[{key:"size",get:function get(){return this.text.length}},{key:"localPosFromDOM",value:function localPosFromDOM(dom,offset){return dom!=this.textDOM?this.posAtStart+(offset?this.size:0):this.posAtStart+offset}},{key:"domFromPos",value:function domFromPos(pos){return{node:this.textDOM,offset:pos}}},{key:"ignoreMutation",value:function ignoreMutation(mut){return"characterData"===mut.type&&mut.target.nodeValue==mut.oldValue}}]),CompositionViewDesc}(ViewDesc),MarkViewDesc=function(_ViewDesc3){_inherits(MarkViewDesc,_ViewDesc3);var _super18=_createSuper(MarkViewDesc);function MarkViewDesc(parent,mark,dom,contentDOM){var _this23;return _classCallCheck(this,MarkViewDesc),(_this23=_super18.call(this,parent,[],dom,contentDOM)).mark=mark,_this23}return _createClass(MarkViewDesc,[{key:"parseRule",value:function parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}},{key:"matchesMark",value:function matchesMark(mark){return 3!=this.dirty&&this.mark.eq(mark)}},{key:"markDirty",value:function markDirty(from,to){if(_get(_getPrototypeOf(MarkViewDesc.prototype),"markDirty",this).call(this,from,to),0!=this.dirty){for(var parent=this.parent;!parent.node;)parent=parent.parent;parent.dirty<this.dirty&&(parent.dirty=this.dirty),this.dirty=0}}},{key:"slice",value:function slice(from,to,view){var copy=MarkViewDesc.create(this.parent,this.mark,!0,view),nodes=this.children,size=this.size;to<size&&(nodes=replaceNodes(nodes,to,size,view)),from>0&&(nodes=replaceNodes(nodes,0,from,view));for(var _i236=0;_i236<nodes.length;_i236++)nodes[_i236].parent=copy;return copy.children=nodes,copy}}],[{key:"create",value:function create(parent,mark,inline,view){var custom=view.nodeViews[mark.type.name],spec=custom&&custom(mark,view,inline);return spec&&spec.dom||(spec=DOMSerializer.renderSpec(document,mark.type.spec.toDOM(mark,inline))),new MarkViewDesc(parent,mark,spec.dom,spec.contentDOM||spec.dom)}}]),MarkViewDesc}(ViewDesc),NodeViewDesc=function(_ViewDesc4){_inherits(NodeViewDesc,_ViewDesc4);var _super19=_createSuper(NodeViewDesc);function NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos){var _this24;return _classCallCheck(this,NodeViewDesc),(_this24=_super19.call(this,parent,[],dom,contentDOM)).node=node,_this24.outerDeco=outerDeco,_this24.innerDeco=innerDeco,_this24.nodeDOM=nodeDOM,_this24}return _createClass(NodeViewDesc,[{key:"parseRule",value:function parseRule(){var _this25=this;if(this.node.type.spec.reparseInView)return null;var rule={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(rule.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(var _i238=this.children.length-1;_i238>=0;_i238--){var child=this.children[_i238];if(this.dom.contains(child.dom.parentNode)){rule.contentElement=child.dom.parentNode;break}}rule.contentElement||(rule.getContent=function(){return Fragment.empty})}else rule.contentElement=this.contentDOM;else rule.getContent=function(){return _this25.node.content};return rule}},{key:"matchesNode",value:function matchesNode(node,outerDeco,innerDeco){return 0==this.dirty&&node.eq(this.node)&&sameOuterDeco(outerDeco,this.outerDeco)&&innerDeco.eq(this.innerDeco)}},{key:"size",get:function get(){return this.node.nodeSize}},{key:"border",get:function get(){return this.node.isLeaf?0:1}},{key:"updateChildren",value:function updateChildren(view,pos){var _this26=this,inline=this.node.inlineContent,off=pos,composition=view.composing?this.localCompositionInfo(view,pos):null,localComposition=composition&&composition.pos>-1?composition:null,compositionInChild=composition&&composition.pos<0,updater=new ViewTreeUpdater(this,localComposition&&localComposition.node,view);!function iterDeco(parent,deco,onWidget,onNode){var locals=deco.locals(parent),offset=0;if(0==locals.length){for(var _i262=0;_i262<parent.childCount;_i262++){var child=parent.child(_i262);onNode(child,locals,deco.forChild(offset,child),_i262),offset+=child.nodeSize}return}for(var decoIndex=0,active=[],restNode=null,parentIndex=0;;){for(var widget=void 0,widgets=void 0;decoIndex<locals.length&&locals[decoIndex].to==offset;){var next=locals[decoIndex++];next.widget&&(widget?(widgets||(widgets=[widget])).push(next):widget=next)}if(widget)if(widgets){widgets.sort(compareSide);for(var _i264=0;_i264<widgets.length;_i264++)onWidget(widgets[_i264],parentIndex,!!restNode)}else onWidget(widget,parentIndex,!!restNode);var _child=void 0,index=void 0;if(restNode)index=-1,_child=restNode,restNode=null;else{if(!(parentIndex<parent.childCount))break;index=parentIndex,_child=parent.child(parentIndex++)}for(var _i266=0;_i266<active.length;_i266++)active[_i266].to<=offset&&active.splice(_i266--,1);for(;decoIndex<locals.length&&locals[decoIndex].from<=offset&&locals[decoIndex].to>offset;)active.push(locals[decoIndex++]);var end=offset+_child.nodeSize;if(_child.isText){var cutAt=end;decoIndex<locals.length&&locals[decoIndex].from<cutAt&&(cutAt=locals[decoIndex].from);for(var _i268=0;_i268<active.length;_i268++)active[_i268].to<cutAt&&(cutAt=active[_i268].to);cutAt<end&&(restNode=_child.cut(cutAt-offset),_child=_child.cut(0,cutAt-offset),end=cutAt,index=-1)}onNode(_child,_child.isInline&&!_child.isLeaf?active.filter((function(d){return!d.inline})):active.slice(),deco.forChild(offset,_child),index),offset=end}}(this.node,this.innerDeco,(function(widget,i,insideNode){widget.spec.marks?updater.syncToMarks(widget.spec.marks,inline,view):widget.type.side>=0&&!insideNode&&updater.syncToMarks(i==_this26.node.childCount?Mark$1.none:_this26.node.child(i).marks,inline,view),updater.placeWidget(widget,view,off)}),(function(child,outerDeco,innerDeco,i){var compIndex;updater.syncToMarks(child.marks,inline,view),updater.findNodeMatch(child,outerDeco,innerDeco,i)||compositionInChild&&view.state.selection.from>off&&view.state.selection.to<off+child.nodeSize&&(compIndex=updater.findIndexWithChild(composition.node))>-1&&updater.updateNodeAt(child,outerDeco,innerDeco,compIndex,view)||updater.updateNextNode(child,outerDeco,innerDeco,view,i,off)||updater.addNode(child,outerDeco,innerDeco,view,off),off+=child.nodeSize})),updater.syncToMarks([],inline,view),this.node.isTextblock&&updater.addTextblockHacks(),updater.destroyRest(),(updater.changed||2==this.dirty)&&(localComposition&&this.protectLocalComposition(view,localComposition),renderDescs(this.contentDOM,this.children,view),ios&&function iosHacks(dom){if("UL"==dom.nodeName||"OL"==dom.nodeName){var oldCSS=dom.style.cssText;dom.style.cssText=oldCSS+"; list-style: square !important",window.getComputedStyle(dom).listStyle,dom.style.cssText=oldCSS}}(this.dom))}},{key:"localCompositionInfo",value:function localCompositionInfo(view,pos){var _view$state$selection=view.state.selection,from=_view$state$selection.from,to=_view$state$selection.to;if(!(view.state.selection instanceof TextSelection)||from<pos||to>pos+this.node.content.size)return null;var sel=view.domSelectionRange(),textNode=function nearbyTextNode(node,offset){for(;;){if(3==node.nodeType)return node;if(1==node.nodeType&&offset>0){if(node.childNodes.length>offset&&3==node.childNodes[offset].nodeType)return node.childNodes[offset];offset=nodeSize(node=node.childNodes[offset-1])}else{if(!(1==node.nodeType&&offset<node.childNodes.length))return null;node=node.childNodes[offset],offset=0}}}(sel.focusNode,sel.focusOffset);if(!textNode||!this.dom.contains(textNode.parentNode))return null;if(this.node.inlineContent){var _text3=textNode.nodeValue,textPos=function findTextInFragment(frag,text,from,to){for(var _i270=0,pos=0;_i270<frag.childCount&&pos<=to;){var child=frag.child(_i270++),childStart=pos;if(pos+=child.nodeSize,child.isText){for(var str=child.text;_i270<frag.childCount;){var next=frag.child(_i270++);if(pos+=next.nodeSize,!next.isText)break;str+=next.text}if(pos>=from){if(pos>=to&&str.slice(to-text.length-childStart,to-childStart)==text)return to-text.length;var _found9=childStart<to?str.lastIndexOf(text,to-childStart-1):-1;if(_found9>=0&&_found9+text.length+childStart>=from)return childStart+_found9;if(from==to&&str.length>=to+text.length-childStart&&str.slice(to-childStart,to-childStart+text.length)==text)return to}}}return-1}(this.node.content,_text3,from-pos,to-pos);return textPos<0?null:{node:textNode,pos:textPos,text:_text3}}return{node:textNode,pos:-1,text:""}}},{key:"protectLocalComposition",value:function protectLocalComposition(view,_ref5){var node=_ref5.node,pos=_ref5.pos,text=_ref5.text;if(!this.getDesc(node)){for(var topNode=node;topNode.parentNode!=this.contentDOM;topNode=topNode.parentNode){for(;topNode.previousSibling;)topNode.parentNode.removeChild(topNode.previousSibling);for(;topNode.nextSibling;)topNode.parentNode.removeChild(topNode.nextSibling);topNode.pmViewDesc&&(topNode.pmViewDesc=void 0)}var desc=new CompositionViewDesc(this,topNode,node,text);view.input.compositionNodes.push(desc),this.children=replaceNodes(this.children,pos,pos+text.length,view,desc)}}},{key:"update",value:function update(node,outerDeco,innerDeco,view){return!(3==this.dirty||!node.sameMarkup(this.node))&&(this.updateInner(node,outerDeco,innerDeco,view),!0)}},{key:"updateInner",value:function updateInner(node,outerDeco,innerDeco,view){this.updateOuterDeco(outerDeco),this.node=node,this.innerDeco=innerDeco,this.contentDOM&&this.updateChildren(view,this.posAtStart),this.dirty=0}},{key:"updateOuterDeco",value:function updateOuterDeco(outerDeco){if(!sameOuterDeco(outerDeco,this.outerDeco)){var needsWrap=1!=this.nodeDOM.nodeType,oldDOM=this.dom;this.dom=patchOuterDeco(this.dom,this.nodeDOM,computeOuterDeco(this.outerDeco,this.node,needsWrap),computeOuterDeco(outerDeco,this.node,needsWrap)),this.dom!=oldDOM&&(oldDOM.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=outerDeco}}},{key:"selectNode",value:function selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}},{key:"deselectNode",value:function deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")}},{key:"domAtom",get:function get(){return this.node.isAtom}}],[{key:"create",value:function create(parent,node,outerDeco,innerDeco,view,pos){var descObj,custom=view.nodeViews[node.type.name],spec=custom&&custom(node,view,(function(){return descObj?descObj.parent?descObj.parent.posBeforeChild(descObj):void 0:pos}),outerDeco,innerDeco),dom=spec&&spec.dom,contentDOM=spec&&spec.contentDOM;if(node.isText)if(dom){if(3!=dom.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else dom=document.createTextNode(node.text);else if(!dom){var _DOMSerializer$render3=DOMSerializer.renderSpec(document,node.type.spec.toDOM(node));dom=_DOMSerializer$render3.dom,contentDOM=_DOMSerializer$render3.contentDOM}contentDOM||node.isText||"BR"==dom.nodeName||(dom.hasAttribute("contenteditable")||(dom.contentEditable="false"),node.type.spec.draggable&&(dom.draggable=!0));var nodeDOM=dom;return dom=applyOuterDeco(dom,outerDeco,node),spec?descObj=new CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM||null,nodeDOM,spec,view,pos+1):node.isText?new TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view):new NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM||null,nodeDOM,view,pos+1)}}]),NodeViewDesc}(ViewDesc);function docViewDesc(doc,outerDeco,innerDeco,dom,view){applyOuterDeco(dom,outerDeco,doc);var docView=new NodeViewDesc(void 0,doc,outerDeco,innerDeco,dom,dom,dom,view,0);return docView.contentDOM&&docView.updateChildren(view,0),docView}var TextViewDesc=function(_NodeViewDesc){_inherits(TextViewDesc,_NodeViewDesc);var _super20=_createSuper(TextViewDesc);function TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view){return _classCallCheck(this,TextViewDesc),_super20.call(this,parent,node,outerDeco,innerDeco,dom,null,nodeDOM,view,0)}return _createClass(TextViewDesc,[{key:"parseRule",value:function parseRule(){for(var skip=this.nodeDOM.parentNode;skip&&skip!=this.dom&&!skip.pmIsDeco;)skip=skip.parentNode;return{skip:skip||!0}}},{key:"update",value:function update(node,outerDeco,innerDeco,view){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!node.sameMarkup(this.node))&&(this.updateOuterDeco(outerDeco),0==this.dirty&&node.text==this.node.text||node.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=node.text,view.trackWrites==this.nodeDOM&&(view.trackWrites=null)),this.node=node,this.dirty=0,!0)}},{key:"inParent",value:function inParent(){for(var parentDOM=this.parent.contentDOM,n=this.nodeDOM;n;n=n.parentNode)if(n==parentDOM)return!0;return!1}},{key:"domFromPos",value:function domFromPos(pos){return{node:this.nodeDOM,offset:pos}}},{key:"localPosFromDOM",value:function localPosFromDOM(dom,offset,bias){return dom==this.nodeDOM?this.posAtStart+Math.min(offset,this.node.text.length):_get(_getPrototypeOf(TextViewDesc.prototype),"localPosFromDOM",this).call(this,dom,offset,bias)}},{key:"ignoreMutation",value:function ignoreMutation(mutation){return"characterData"!=mutation.type&&"selection"!=mutation.type}},{key:"slice",value:function slice(from,to,view){var node=this.node.cut(from,to),dom=document.createTextNode(node.text);return new TextViewDesc(this.parent,node,this.outerDeco,this.innerDeco,dom,dom,view)}},{key:"markDirty",value:function markDirty(from,to){_get(_getPrototypeOf(TextViewDesc.prototype),"markDirty",this).call(this,from,to),this.dom==this.nodeDOM||0!=from&&to!=this.nodeDOM.nodeValue.length||(this.dirty=3)}},{key:"domAtom",get:function get(){return!1}}]),TextViewDesc}(NodeViewDesc),TrailingHackViewDesc=function(_ViewDesc5){_inherits(TrailingHackViewDesc,_ViewDesc5);var _super21=_createSuper(TrailingHackViewDesc);function TrailingHackViewDesc(){return _classCallCheck(this,TrailingHackViewDesc),_super21.apply(this,arguments)}return _createClass(TrailingHackViewDesc,[{key:"parseRule",value:function parseRule(){return{ignore:!0}}},{key:"matchesHack",value:function matchesHack(nodeName){return 0==this.dirty&&this.dom.nodeName==nodeName}},{key:"domAtom",get:function get(){return!0}},{key:"ignoreForCoords",get:function get(){return"IMG"==this.dom.nodeName}}]),TrailingHackViewDesc}(ViewDesc),CustomNodeViewDesc=function(_NodeViewDesc2){_inherits(CustomNodeViewDesc,_NodeViewDesc2);var _super22=_createSuper(CustomNodeViewDesc);function CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,spec,view,pos){var _this27;return _classCallCheck(this,CustomNodeViewDesc),(_this27=_super22.call(this,parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos)).spec=spec,_this27}return _createClass(CustomNodeViewDesc,[{key:"update",value:function update(node,outerDeco,innerDeco,view){if(3==this.dirty)return!1;if(this.spec.update){var result=this.spec.update(node,outerDeco,innerDeco);return result&&this.updateInner(node,outerDeco,innerDeco,view),result}return!(!this.contentDOM&&!node.isLeaf)&&_get(_getPrototypeOf(CustomNodeViewDesc.prototype),"update",this).call(this,node,outerDeco,innerDeco,view)}},{key:"selectNode",value:function selectNode(){this.spec.selectNode?this.spec.selectNode():_get(_getPrototypeOf(CustomNodeViewDesc.prototype),"selectNode",this).call(this)}},{key:"deselectNode",value:function deselectNode(){this.spec.deselectNode?this.spec.deselectNode():_get(_getPrototypeOf(CustomNodeViewDesc.prototype),"deselectNode",this).call(this)}},{key:"setSelection",value:function setSelection(anchor,head,root,force){this.spec.setSelection?this.spec.setSelection(anchor,head,root):_get(_getPrototypeOf(CustomNodeViewDesc.prototype),"setSelection",this).call(this,anchor,head,root,force)}},{key:"destroy",value:function destroy(){this.spec.destroy&&this.spec.destroy(),_get(_getPrototypeOf(CustomNodeViewDesc.prototype),"destroy",this).call(this)}},{key:"stopEvent",value:function stopEvent(event){return!!this.spec.stopEvent&&this.spec.stopEvent(event)}},{key:"ignoreMutation",value:function ignoreMutation(mutation){return this.spec.ignoreMutation?this.spec.ignoreMutation(mutation):_get(_getPrototypeOf(CustomNodeViewDesc.prototype),"ignoreMutation",this).call(this,mutation)}}]),CustomNodeViewDesc}(NodeViewDesc);function renderDescs(parentDOM,descs,view){for(var dom=parentDOM.firstChild,written=!1,_i240=0;_i240<descs.length;_i240++){var desc=descs[_i240],childDOM=desc.dom;if(childDOM.parentNode==parentDOM){for(;childDOM!=dom;)dom=rm(dom),written=!0;dom=dom.nextSibling}else written=!0,parentDOM.insertBefore(childDOM,dom);if(desc instanceof MarkViewDesc){var pos=dom?dom.previousSibling:parentDOM.lastChild;renderDescs(desc.contentDOM,desc.children,view),dom=pos?pos.nextSibling:parentDOM.firstChild}}for(;dom;)dom=rm(dom),written=!0;written&&view.trackWrites==parentDOM&&(view.trackWrites=null)}var OuterDecoLevel=function OuterDecoLevel(nodeName){nodeName&&(this.nodeName=nodeName)};OuterDecoLevel.prototype=Object.create(null);var noDeco=[new OuterDecoLevel];function computeOuterDeco(outerDeco,node,needsWrap){if(0==outerDeco.length)return noDeco;for(var top=needsWrap?noDeco[0]:new OuterDecoLevel,result=[top],_i242=0;_i242<outerDeco.length;_i242++){var _attrs=outerDeco[_i242].type.attrs;if(_attrs)for(var name in _attrs.nodeName&&result.push(top=new OuterDecoLevel(_attrs.nodeName)),_attrs){var val=_attrs[name];null!=val&&(needsWrap&&1==result.length&&result.push(top=new OuterDecoLevel(node.isInline?"span":"div")),"class"==name?top.class=(top.class?top.class+" ":"")+val:"style"==name?top.style=(top.style?top.style+";":"")+val:"nodeName"!=name&&(top[name]=val))}}return result}function patchOuterDeco(outerDOM,nodeDOM,prevComputed,curComputed){if(prevComputed==noDeco&&curComputed==noDeco)return nodeDOM;for(var curDOM=nodeDOM,_i244=0;_i244<curComputed.length;_i244++){var deco=curComputed[_i244],prev=prevComputed[_i244];if(_i244){var parent=void 0;prev&&prev.nodeName==deco.nodeName&&curDOM!=outerDOM&&(parent=curDOM.parentNode)&&parent.nodeName.toLowerCase()==deco.nodeName||((parent=document.createElement(deco.nodeName)).pmIsDeco=!0,parent.appendChild(curDOM),prev=noDeco[0]),curDOM=parent}patchAttributes(curDOM,prev||noDeco[0],deco)}return curDOM}function patchAttributes(dom,prev,cur){for(var name in prev)"class"==name||"style"==name||"nodeName"==name||name in cur||dom.removeAttribute(name);for(var _name3 in cur)"class"!=_name3&&"style"!=_name3&&"nodeName"!=_name3&&cur[_name3]!=prev[_name3]&&dom.setAttribute(_name3,cur[_name3]);if(prev.class!=cur.class){for(var prevList=prev.class?prev.class.split(" ").filter(Boolean):[],curList=cur.class?cur.class.split(" ").filter(Boolean):[],_i246=0;_i246<prevList.length;_i246++)-1==curList.indexOf(prevList[_i246])&&dom.classList.remove(prevList[_i246]);for(var _i248=0;_i248<curList.length;_i248++)-1==prevList.indexOf(curList[_i248])&&dom.classList.add(curList[_i248]);0==dom.classList.length&&dom.removeAttribute("class")}if(prev.style!=cur.style){if(prev.style)for(var m,_prop17=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;m=_prop17.exec(prev.style);)dom.style.removeProperty(m[1]);cur.style&&(dom.style.cssText+=cur.style)}}function applyOuterDeco(dom,deco,node){return patchOuterDeco(dom,dom,noDeco,computeOuterDeco(deco,node,1!=dom.nodeType))}function sameOuterDeco(a,b){if(a.length!=b.length)return!1;for(var _i250=0;_i250<a.length;_i250++)if(!a[_i250].type.eq(b[_i250].type))return!1;return!0}function rm(dom){var next=dom.nextSibling;return dom.parentNode.removeChild(dom),next}var ViewTreeUpdater=function(){function ViewTreeUpdater(top,lock,view){_classCallCheck(this,ViewTreeUpdater),this.lock=lock,this.view=view,this.index=0,this.stack=[],this.changed=!1,this.top=top,this.preMatch=function preMatch(frag,parentDesc){var curDesc=parentDesc,descI=curDesc.children.length,fI=frag.childCount,matched=new Map,matches=[];outer:for(;fI>0;){for(var desc=void 0;;)if(descI){var next=curDesc.children[descI-1];if(!(next instanceof MarkViewDesc)){desc=next,descI--;break}curDesc=next,descI=next.children.length}else{if(curDesc==parentDesc)break outer;descI=curDesc.parent.children.indexOf(curDesc),curDesc=curDesc.parent}var node=desc.node;if(node){if(node!=frag.child(fI-1))break;--fI,matched.set(desc,fI),matches.push(desc)}}return{index:fI,matched,matches:matches.reverse()}}(top.node.content,top)}return _createClass(ViewTreeUpdater,[{key:"destroyBetween",value:function destroyBetween(start,end){if(start!=end){for(var _i252=start;_i252<end;_i252++)this.top.children[_i252].destroy();this.top.children.splice(start,end-start),this.changed=!0}}},{key:"destroyRest",value:function destroyRest(){this.destroyBetween(this.index,this.top.children.length)}},{key:"syncToMarks",value:function syncToMarks(marks,inline,view){for(var keep=0,depth=this.stack.length>>1,maxKeep=Math.min(depth,marks.length);keep<maxKeep&&(keep==depth-1?this.top:this.stack[keep+1<<1]).matchesMark(marks[keep])&&!1!==marks[keep].type.spec.spanning;)keep++;for(;keep<depth;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),depth--;for(;depth<marks.length;){this.stack.push(this.top,this.index+1);for(var _found8=-1,_i254=this.index;_i254<Math.min(this.index+3,this.top.children.length);_i254++){var next=this.top.children[_i254];if(next.matchesMark(marks[depth])&&!this.isLocked(next.dom)){_found8=_i254;break}}if(_found8>-1)_found8>this.index&&(this.changed=!0,this.destroyBetween(this.index,_found8)),this.top=this.top.children[this.index];else{var markDesc=MarkViewDesc.create(this.top,marks[depth],inline,view);this.top.children.splice(this.index,0,markDesc),this.top=markDesc,this.changed=!0}this.index=0,depth++}}},{key:"findNodeMatch",value:function findNodeMatch(node,outerDeco,innerDeco,index){var targetDesc,found=-1;if(index>=this.preMatch.index&&(targetDesc=this.preMatch.matches[index-this.preMatch.index]).parent==this.top&&targetDesc.matchesNode(node,outerDeco,innerDeco))found=this.top.children.indexOf(targetDesc,this.index);else for(var _i256=this.index,e=Math.min(this.top.children.length,_i256+5);_i256<e;_i256++){var child=this.top.children[_i256];if(child.matchesNode(node,outerDeco,innerDeco)&&!this.preMatch.matched.has(child)){found=_i256;break}}return!(found<0)&&(this.destroyBetween(this.index,found),this.index++,!0)}},{key:"updateNodeAt",value:function updateNodeAt(node,outerDeco,innerDeco,index,view){var child=this.top.children[index];return 3==child.dirty&&child.dom==child.contentDOM&&(child.dirty=2),!!child.update(node,outerDeco,innerDeco,view)&&(this.destroyBetween(this.index,index),this.index++,!0)}},{key:"findIndexWithChild",value:function findIndexWithChild(domNode){for(;;){var parent=domNode.parentNode;if(!parent)return-1;if(parent==this.top.contentDOM){var desc=domNode.pmViewDesc;if(desc)for(var _i258=this.index;_i258<this.top.children.length;_i258++)if(this.top.children[_i258]==desc)return _i258;return-1}domNode=parent}}},{key:"updateNextNode",value:function updateNextNode(node,outerDeco,innerDeco,view,index,pos){for(var _i260=this.index;_i260<this.top.children.length;_i260++){var next=this.top.children[_i260];if(next instanceof NodeViewDesc){var _preMatch=this.preMatch.matched.get(next);if(null!=_preMatch&&_preMatch!=index)return!1;var nextDOM=next.dom,updated=void 0,locked=this.isLocked(nextDOM)&&!(node.isText&&next.node&&next.node.isText&&next.nodeDOM.nodeValue==node.text&&3!=next.dirty&&sameOuterDeco(outerDeco,next.outerDeco));if(!locked&&next.update(node,outerDeco,innerDeco,view))return this.destroyBetween(this.index,_i260),next.dom!=nextDOM&&(this.changed=!0),this.index++,!0;if(!locked&&(updated=this.recreateWrapper(next,node,outerDeco,innerDeco,view,pos)))return this.top.children[this.index]=updated,updated.contentDOM&&(updated.dirty=2,updated.updateChildren(view,pos+1),updated.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}},{key:"recreateWrapper",value:function recreateWrapper(next,node,outerDeco,innerDeco,view,pos){if(next.dirty||node.isAtom||!next.children.length||!next.node.content.eq(node.content))return null;var wrapper=NodeViewDesc.create(this.top,node,outerDeco,innerDeco,view,pos);if(wrapper.contentDOM){wrapper.children=next.children,next.children=[];var _step2,_iterator=_createForOfIteratorHelper(wrapper.children);try{for(_iterator.s();!(_step2=_iterator.n()).done;){_step2.value.parent=wrapper}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return next.destroy(),wrapper}},{key:"addNode",value:function addNode(node,outerDeco,innerDeco,view,pos){var desc=NodeViewDesc.create(this.top,node,outerDeco,innerDeco,view,pos);desc.contentDOM&&desc.updateChildren(view,pos+1),this.top.children.splice(this.index++,0,desc),this.changed=!0}},{key:"placeWidget",value:function placeWidget(widget,view,pos){var next=this.index<this.top.children.length?this.top.children[this.index]:null;if(!next||!next.matchesWidget(widget)||widget!=next.widget&&next.widget.type.toDOM.parentNode){var desc=new WidgetViewDesc(this.top,widget,view,pos);this.top.children.splice(this.index++,0,desc),this.changed=!0}else this.index++}},{key:"addTextblockHacks",value:function addTextblockHacks(){for(var lastChild=this.top.children[this.index-1],parent=this.top;lastChild instanceof MarkViewDesc;)lastChild=(parent=lastChild).children[parent.children.length-1];(!lastChild||!(lastChild instanceof TextViewDesc)||/\n$/.test(lastChild.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(lastChild.node.text))&&((safari||chrome)&&lastChild&&"false"==lastChild.dom.contentEditable&&this.addHackNode("IMG",parent),this.addHackNode("BR",this.top))}},{key:"addHackNode",value:function addHackNode(nodeName,parent){if(parent==this.top&&this.index<parent.children.length&&parent.children[this.index].matchesHack(nodeName))this.index++;else{var dom=document.createElement(nodeName);"IMG"==nodeName&&(dom.className="ProseMirror-separator",dom.alt=""),"BR"==nodeName&&(dom.className="ProseMirror-trailingBreak");var hack=new TrailingHackViewDesc(this.top,[],dom,null);parent!=this.top?parent.children.push(hack):parent.children.splice(this.index++,0,hack),this.changed=!0}}},{key:"isLocked",value:function isLocked(node){return this.lock&&(node==this.lock||1==node.nodeType&&node.contains(this.lock.parentNode))}}]),ViewTreeUpdater}();function compareSide(a,b){return a.type.side-b.type.side}function replaceNodes(nodes,from,to,view,replacement){for(var result=[],_i272=0,off=0;_i272<nodes.length;_i272++){var child=nodes[_i272],start=off,end=off+=child.size;start>=to||end<=from?result.push(child):(start<from&&result.push(child.slice(0,from-start,view)),replacement&&(result.push(replacement),replacement=void 0),end>to&&result.push(child.slice(to-start,child.size,view)))}return result}function selectionFromDOM(view){var origin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,domSel=view.domSelectionRange(),doc=view.state.doc;if(!domSel.focusNode)return null;var nearestDesc=view.docView.nearestDesc(domSel.focusNode),inWidget=nearestDesc&&0==nearestDesc.size,head=view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset,1);if(head<0)return null;var $anchor,selection,$head=doc.resolve(head);if(selectionCollapsed(domSel)){for($anchor=$head;nearestDesc&&!nearestDesc.node;)nearestDesc=nearestDesc.parent;var nearestDescNode=nearestDesc.node;if(nearestDesc&&nearestDescNode.isAtom&&NodeSelection.isSelectable(nearestDescNode)&&nearestDesc.parent&&(!nearestDescNode.isInline||!function isOnEdge(node,offset,parent){for(var atStart=0==offset,atEnd=offset==nodeSize(node);atStart||atEnd;){if(node==parent)return!0;var index=domIndex(node);if(!(node=node.parentNode))return!1;atStart=atStart&&0==index,atEnd=atEnd&&index==nodeSize(node)}}(domSel.focusNode,domSel.focusOffset,nearestDesc.dom))){var pos=nearestDesc.posBefore;selection=new NodeSelection(head==pos?$head:doc.resolve(pos))}}else{var anchor=view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset,1);if(anchor<0)return null;$anchor=doc.resolve(anchor)}selection||(selection=selectionBetween(view,$anchor,$head,"pointer"==origin||view.state.selection.head<$head.pos&&!inWidget?1:-1));return selection}function editorOwnsSelection(view){return view.editable?view.hasFocus():hasSelection(view)&&document.activeElement&&document.activeElement.contains(view.dom)}function selectionToDOM(view){var force=arguments.length>1&&void 0!==arguments[1]&&arguments[1],sel=view.state.selection;if(syncNodeSelection(view,sel),editorOwnsSelection(view)){if(!force&&view.input.mouseDown&&view.input.mouseDown.allowDefault&&chrome){var domSel=view.domSelectionRange(),curSel=view.domObserver.currentSelection;if(domSel.anchorNode&&curSel.anchorNode&&isEquivalentPosition(domSel.anchorNode,domSel.anchorOffset,curSel.anchorNode,curSel.anchorOffset))return view.input.mouseDown.delayedSelectionSync=!0,void view.domObserver.setCurSelection()}if(view.domObserver.disconnectSelection(),view.cursorWrapper)!function selectCursorWrapper(view){var domSel=view.domSelection(),range=document.createRange(),node=view.cursorWrapper.dom,img="IMG"==node.nodeName;img?range.setEnd(node.parentNode,domIndex(node)+1):range.setEnd(node,0);range.collapse(!1),domSel.removeAllRanges(),domSel.addRange(range),!img&&!view.state.selection.visible&&ie$1&&ie_version<=11&&(node.disabled=!0,node.disabled=!1)}(view);else{var resetEditableFrom,resetEditableTo,anchor=sel.anchor,head=sel.head;!brokenSelectBetweenUneditable||sel instanceof TextSelection||(sel.$from.parent.inlineContent||(resetEditableFrom=temporarilyEditableNear(view,sel.from)),sel.empty||sel.$from.parent.inlineContent||(resetEditableTo=temporarilyEditableNear(view,sel.to))),view.docView.setSelection(anchor,head,view.root,force),brokenSelectBetweenUneditable&&(resetEditableFrom&&resetEditable(resetEditableFrom),resetEditableTo&&resetEditable(resetEditableTo)),sel.visible?view.dom.classList.remove("ProseMirror-hideselection"):(view.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function removeClassOnSelectionChange(view){var doc=view.dom.ownerDocument;doc.removeEventListener("selectionchange",view.input.hideSelectionGuard);var domSel=view.domSelectionRange(),node=domSel.anchorNode,offset=domSel.anchorOffset;doc.addEventListener("selectionchange",view.input.hideSelectionGuard=function(){domSel.anchorNode==node&&domSel.anchorOffset==offset||(doc.removeEventListener("selectionchange",view.input.hideSelectionGuard),setTimeout((function(){editorOwnsSelection(view)&&!view.state.selection.visible||view.dom.classList.remove("ProseMirror-hideselection")}),20))})}(view))}view.domObserver.setCurSelection(),view.domObserver.connectSelection()}}var brokenSelectBetweenUneditable=safari||chrome&&chrome_version<63;function temporarilyEditableNear(view,pos){var _view$docView$domFrom3=view.docView.domFromPos(pos,0),node=_view$docView$domFrom3.node,offset=_view$docView$domFrom3.offset,after=offset<node.childNodes.length?node.childNodes[offset]:null,before=offset?node.childNodes[offset-1]:null;if(safari&&after&&"false"==after.contentEditable)return setEditable(after);if(!(after&&"false"!=after.contentEditable||before&&"false"!=before.contentEditable)){if(after)return setEditable(after);if(before)return setEditable(before)}}function setEditable(element){return element.contentEditable="true",safari&&element.draggable&&(element.draggable=!1,element.wasDraggable=!0),element}function resetEditable(element){element.contentEditable="false",element.wasDraggable&&(element.draggable=!0,element.wasDraggable=null)}function syncNodeSelection(view,sel){if(sel instanceof NodeSelection){var desc=view.docView.descAt(sel.from);desc!=view.lastSelectedViewDesc&&(clearNodeSelection(view),desc&&desc.selectNode(),view.lastSelectedViewDesc=desc)}else clearNodeSelection(view)}function clearNodeSelection(view){view.lastSelectedViewDesc&&(view.lastSelectedViewDesc.parent&&view.lastSelectedViewDesc.deselectNode(),view.lastSelectedViewDesc=void 0)}function selectionBetween(view,$anchor,$head,bias){return view.someProp("createSelectionBetween",(function(f){return f(view,$anchor,$head)}))||TextSelection.between($anchor,$head,bias)}function hasFocusAndSelection(view){return!(view.editable&&!view.hasFocus())&&hasSelection(view)}function hasSelection(view){var sel=view.domSelectionRange();if(!sel.anchorNode)return!1;try{return view.dom.contains(3==sel.anchorNode.nodeType?sel.anchorNode.parentNode:sel.anchorNode)&&(view.editable||view.dom.contains(3==sel.focusNode.nodeType?sel.focusNode.parentNode:sel.focusNode))}catch(_){return!1}}function moveSelectionBlock(state,dir){var _state$selection=state.selection,$anchor=_state$selection.$anchor,$head=_state$selection.$head,$side=dir>0?$anchor.max($head):$anchor.min($head),$start=$side.parent.inlineContent?$side.depth?state.doc.resolve(dir>0?$side.after():$side.before()):null:$side;return $start&&Selection.findFrom($start,dir)}function apply(view,sel){return view.dispatch(view.state.tr.setSelection(sel).scrollIntoView()),!0}function selectHorizontally(view,dir,mods){var sel=view.state.selection;if(!(sel instanceof TextSelection)){if(sel instanceof NodeSelection&&sel.node.isInline)return apply(view,new TextSelection(dir>0?sel.$to:sel.$from));var _next3=moveSelectionBlock(view.state,dir);return!!_next3&&apply(view,_next3)}if(!sel.empty||mods.indexOf("s")>-1)return!1;if(view.endOfTextblock(dir>0?"forward":"backward")){var next=moveSelectionBlock(view.state,dir);return!!(next&&next instanceof NodeSelection)&&apply(view,next)}if(!(mac$2&&mods.indexOf("m")>-1)){var desc,$head=sel.$head,node=$head.textOffset?null:dir<0?$head.nodeBefore:$head.nodeAfter;if(!node||node.isText)return!1;var nodePos=dir<0?$head.pos-node.nodeSize:$head.pos;return!!(node.isAtom||(desc=view.docView.descAt(nodePos))&&!desc.contentDOM)&&(NodeSelection.isSelectable(node)?apply(view,new NodeSelection(dir<0?view.state.doc.resolve($head.pos-node.nodeSize):$head)):!!webkit&&apply(view,new TextSelection(view.state.doc.resolve(dir<0?nodePos:nodePos+node.nodeSize))))}}function nodeLen(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function isIgnorable(dom,dir){if("false"==dom.contentEditable)return!0;var desc=dom.pmViewDesc;return desc&&0==desc.size&&(dir<0||dom.nextSibling||"BR"!=dom.nodeName)}function skipIgnoredNodes(view,dir){return dir<0?function skipIgnoredNodesBefore(view){var sel=view.domSelectionRange(),node=sel.focusNode,offset=sel.focusOffset;if(!node)return;var moveNode,moveOffset,force=!1;gecko&&1==node.nodeType&&offset<nodeLen(node)&&isIgnorable(node.childNodes[offset],-1)&&(force=!0);for(;;)if(offset>0){if(1!=node.nodeType)break;var before=node.childNodes[offset-1];if(isIgnorable(before,-1))moveNode=node,moveOffset=--offset;else{if(3!=before.nodeType)break;offset=(node=before).nodeValue.length}}else{if(isBlockNode(node))break;for(var prev=node.previousSibling;prev&&isIgnorable(prev,-1);)moveNode=node.parentNode,moveOffset=domIndex(prev),prev=prev.previousSibling;if(prev)offset=nodeLen(node=prev);else{if((node=node.parentNode)==view.dom)break;offset=0}}force?setSelFocus(view,node,offset):moveNode&&setSelFocus(view,moveNode,moveOffset)}(view):function skipIgnoredNodesAfter(view){var sel=view.domSelectionRange(),node=sel.focusNode,offset=sel.focusOffset;if(!node)return;for(var moveNode,moveOffset,len=nodeLen(node);;)if(offset<len){if(1!=node.nodeType)break;if(!isIgnorable(node.childNodes[offset],1))break;moveNode=node,moveOffset=++offset}else{if(isBlockNode(node))break;for(var next=node.nextSibling;next&&isIgnorable(next,1);)moveNode=next.parentNode,moveOffset=domIndex(next)+1,next=next.nextSibling;if(next)offset=0,len=nodeLen(node=next);else{if((node=node.parentNode)==view.dom)break;offset=len=0}}moveNode&&setSelFocus(view,moveNode,moveOffset)}(view)}function isBlockNode(dom){var desc=dom.pmViewDesc;return desc&&desc.node&&desc.node.isBlock}function setSelFocus(view,node,offset){var before,after;3!=node.nodeType&&((after=function textNodeAfter(node,offset){for(;node&&offset==node.childNodes.length&&!hasBlockDesc(node);)offset=domIndex(node)+1,node=node.parentNode;for(;node&&offset<node.childNodes.length;){var next=node.childNodes[offset];if(3==next.nodeType)return next;if(1==next.nodeType&&"false"==next.contentEditable)break;node=next,offset=0}}(node,offset))?(node=after,offset=0):(before=function textNodeBefore(node,offset){for(;node&&!offset&&!hasBlockDesc(node);)offset=domIndex(node),node=node.parentNode;for(;node&&offset;){var next=node.childNodes[offset-1];if(3==next.nodeType)return next;if(1==next.nodeType&&"false"==next.contentEditable)break;offset=(node=next).childNodes.length}}(node,offset))&&(node=before,offset=before.nodeValue.length));var sel=view.domSelection();if(selectionCollapsed(sel)){var _range3=document.createRange();_range3.setEnd(node,offset),_range3.setStart(node,offset),sel.removeAllRanges(),sel.addRange(_range3)}else sel.extend&&sel.extend(node,offset);view.domObserver.setCurSelection();var state=view.state;setTimeout((function(){view.state==state&&selectionToDOM(view)}),50)}function findDirection(view,pos){var $pos=view.state.doc.resolve(pos);if(!chrome&&!windows&&$pos.parent.inlineContent){var coords=view.coordsAtPos(pos);if(pos>$pos.start()){var before=view.coordsAtPos(pos-1),_mid=(before.top+before.bottom)/2;if(_mid>coords.top&&_mid<coords.bottom&&Math.abs(before.left-coords.left)>1)return before.left<coords.left?"ltr":"rtl"}if(pos<$pos.end()){var after=view.coordsAtPos(pos+1),_mid2=(after.top+after.bottom)/2;if(_mid2>coords.top&&_mid2<coords.bottom&&Math.abs(after.left-coords.left)>1)return after.left>coords.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(view.dom).direction?"rtl":"ltr"}function selectVertically(view,dir,mods){var sel=view.state.selection;if(sel instanceof TextSelection&&!sel.empty||mods.indexOf("s")>-1)return!1;if(mac$2&&mods.indexOf("m")>-1)return!1;var $from=sel.$from,$to=sel.$to;if(!$from.parent.inlineContent||view.endOfTextblock(dir<0?"up":"down")){var next=moveSelectionBlock(view.state,dir);if(next&&next instanceof NodeSelection)return apply(view,next)}if(!$from.parent.inlineContent){var side=dir<0?$from:$to,beyond=sel instanceof AllSelection?Selection.near(side,dir):Selection.findFrom(side,dir);return!!beyond&&apply(view,beyond)}return!1}function stopNativeHorizontalDelete(view,dir){if(!(view.state.selection instanceof TextSelection))return!0;var _view$state$selection2=view.state.selection,$head=_view$state$selection2.$head,$anchor=_view$state$selection2.$anchor,empty=_view$state$selection2.empty;if(!$head.sameParent($anchor))return!0;if(!empty)return!1;if(view.endOfTextblock(dir>0?"forward":"backward"))return!0;var nextNode=!$head.textOffset&&(dir<0?$head.nodeBefore:$head.nodeAfter);if(nextNode&&!nextNode.isText){var _tr2=view.state.tr;return dir<0?_tr2.delete($head.pos-nextNode.nodeSize,$head.pos):_tr2.delete($head.pos,$head.pos+nextNode.nodeSize),view.dispatch(_tr2),!0}return!1}function switchEditable(view,node,state){view.domObserver.stop(),node.contentEditable=state,view.domObserver.start()}function captureKeyDown(view,event){var code=event.keyCode,mods=function getMods(event){var result="";return event.ctrlKey&&(result+="c"),event.metaKey&&(result+="m"),event.altKey&&(result+="a"),event.shiftKey&&(result+="s"),result}(event);if(8==code||mac$2&&72==code&&"c"==mods)return stopNativeHorizontalDelete(view,-1)||skipIgnoredNodes(view,-1);if(46==code&&!event.shiftKey||mac$2&&68==code&&"c"==mods)return stopNativeHorizontalDelete(view,1)||skipIgnoredNodes(view,1);if(13==code||27==code)return!0;if(37==code||mac$2&&66==code&&"c"==mods){var dir=37==code?"ltr"==findDirection(view,view.state.selection.from)?-1:1:-1;return selectHorizontally(view,dir,mods)||skipIgnoredNodes(view,dir)}if(39==code||mac$2&&70==code&&"c"==mods){var _dir=39==code?"ltr"==findDirection(view,view.state.selection.from)?1:-1:1;return selectHorizontally(view,_dir,mods)||skipIgnoredNodes(view,_dir)}return 38==code||mac$2&&80==code&&"c"==mods?selectVertically(view,-1,mods)||skipIgnoredNodes(view,-1):40==code||mac$2&&78==code&&"c"==mods?function safariDownArrowBug(view){if(!safari||view.state.selection.$head.parentOffset>0)return!1;var _view$domSelectionRan3=view.domSelectionRange(),focusNode=_view$domSelectionRan3.focusNode,focusOffset=_view$domSelectionRan3.focusOffset;if(focusNode&&1==focusNode.nodeType&&0==focusOffset&&focusNode.firstChild&&"false"==focusNode.firstChild.contentEditable){var child=focusNode.firstChild;switchEditable(view,child,"true"),setTimeout((function(){return switchEditable(view,child,"false")}),20)}return!1}(view)||selectVertically(view,1,mods)||skipIgnoredNodes(view,1):mods==(mac$2?"m":"c")&&(66==code||73==code||89==code||90==code)}function serializeForClipboard(view,slice){view.someProp("transformCopied",(function(f){slice=f(slice,view)}));for(var context=[],_slice2=slice,content=_slice2.content,openStart=_slice2.openStart,openEnd=_slice2.openEnd;openStart>1&&openEnd>1&&1==content.childCount&&1==content.firstChild.childCount;){openStart--,openEnd--;var node=content.firstChild;context.push(node.type.name,node.attrs!=node.type.defaultAttrs?node.attrs:null),content=node.content}var serializer=view.someProp("clipboardSerializer")||DOMSerializer.fromSchema(view.state.schema),doc=detachedDoc(),wrap=doc.createElement("div");wrap.appendChild(serializer.serializeFragment(content,{document:doc}));for(var needsWrap,firstChild=wrap.firstChild,wrappers=0;firstChild&&1==firstChild.nodeType&&(needsWrap=wrapMap[firstChild.nodeName.toLowerCase()]);){for(var _i274=needsWrap.length-1;_i274>=0;_i274--){for(var wrapper=doc.createElement(needsWrap[_i274]);wrap.firstChild;)wrapper.appendChild(wrap.firstChild);wrap.appendChild(wrapper),wrappers++}firstChild=wrap.firstChild}return firstChild&&1==firstChild.nodeType&&firstChild.setAttribute("data-pm-slice",openStart+" "+openEnd+(wrappers?" -"+wrappers:"")+" "+JSON.stringify(context)),{dom:wrap,text:view.someProp("clipboardTextSerializer",(function(f){return f(slice,view)}))||slice.content.textBetween(0,slice.content.size,"\n\n")}}function parseFromClipboard(view,text,html,plainText,$context){var dom,slice,inCode=$context.parent.type.spec.code;if(!html&&!text)return null;var asText=text&&(plainText||inCode||!html);if(asText){if(view.someProp("transformPastedText",(function(f){text=f(text,inCode||plainText,view)})),inCode)return text?new Slice(Fragment.from(view.state.schema.text(text.replace(/\r\n?/g,"\n"))),0,0):Slice.empty;var parsed=view.someProp("clipboardTextParser",(function(f){return f(text,$context,plainText,view)}));if(parsed)slice=parsed;else{var marks=$context.marks(),_schema=view.state.schema,serializer=DOMSerializer.fromSchema(_schema);dom=document.createElement("div"),text.split(/(?:\r\n?|\n)+/).forEach((function(block){var p=dom.appendChild(document.createElement("p"));block&&p.appendChild(serializer.serializeNode(_schema.text(block,marks)))}))}}else view.someProp("transformPastedHTML",(function(f){html=f(html,view)})),dom=function readHTML(html){var metas=/^(\s*<meta [^>]*>)*/.exec(html);metas&&(html=html.slice(metas[0].length));var wrap,elt=detachedDoc().createElement("div"),firstTag=/<([a-z][^>\s]+)/i.exec(html);(wrap=firstTag&&wrapMap[firstTag[1].toLowerCase()])&&(html=wrap.map((function(n){return"<"+n+">"})).join("")+html+wrap.map((function(n){return"</"+n+">"})).reverse().join(""));if(elt.innerHTML=html,wrap)for(var _i280=0;_i280<wrap.length;_i280++)elt=elt.querySelector(wrap[_i280])||elt;return elt}(html),webkit&&function restoreReplacedSpaces(dom){for(var nodes=dom.querySelectorAll(chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),_i282=0;_i282<nodes.length;_i282++){var node=nodes[_i282];1==node.childNodes.length&&" "==node.textContent&&node.parentNode&&node.parentNode.replaceChild(dom.ownerDocument.createTextNode(" "),node)}}(dom);var contextNode=dom&&dom.querySelector("[data-pm-slice]"),sliceData=contextNode&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(contextNode.getAttribute("data-pm-slice")||"");if(sliceData&&sliceData[3])for(var _i276=+sliceData[3];_i276>0;_i276--){for(var child=dom.firstChild;child&&1!=child.nodeType;)child=child.nextSibling;if(!child)break;dom=child}if(!slice){var parser=view.someProp("clipboardParser")||view.someProp("domParser")||DOMParser.fromSchema(view.state.schema);slice=parser.parseSlice(dom,{preserveWhitespace:!(!asText&&!sliceData),context:$context,ruleFromNode:function ruleFromNode(dom){return"BR"!=dom.nodeName||dom.nextSibling||!dom.parentNode||inlineParents.test(dom.parentNode.nodeName)?null:{ignore:!0}}})}if(sliceData)slice=function addContext(slice,context){if(!slice.size)return slice;var array,schema=slice.content.firstChild.type.schema;try{array=JSON.parse(context)}catch(e){return slice}for(var content=slice.content,openStart=slice.openStart,openEnd=slice.openEnd,_i284=array.length-2;_i284>=0;_i284-=2){var type=schema.nodes[array[_i284]];if(!type||type.hasRequiredAttrs())break;content=Fragment.from(type.create(array[_i284+1],content)),openStart++,openEnd++}return new Slice(content,openStart,openEnd)}(closeSlice(slice,+sliceData[1],+sliceData[2]),sliceData[4]);else if(slice=Slice.maxOpen(function normalizeSiblings(fragment,$context){if(fragment.childCount<2)return fragment;for(var _ret3,_loop6=function _loop6(){var lastWrap,match=$context.node(d).contentMatchAt($context.index(d)),result=[];if(fragment.forEach((function(node){if(result){var inLast,wrap=match.findWrapping(node.type);if(!wrap)return result=null;if(inLast=result.length&&lastWrap.length&&addToSibling(wrap,lastWrap,node,result[result.length-1],0))result[result.length-1]=inLast;else{result.length&&(result[result.length-1]=closeRight(result[result.length-1],lastWrap.length));var wrapped=withWrappers(node,wrap);result.push(wrapped),match=match.matchType(wrapped.type),lastWrap=wrap}}})),result)return{v:Fragment.from(result)}},d=$context.depth;d>=0;d--)if(_ret3=_loop6())return _ret3.v;return fragment}(slice.content,$context),!0),slice.openStart||slice.openEnd){for(var openStart=0,openEnd=0,node=slice.content.firstChild;openStart<slice.openStart&&!node.type.spec.isolating;openStart++,node=node.firstChild);for(var _node2=slice.content.lastChild;openEnd<slice.openEnd&&!_node2.type.spec.isolating;openEnd++,_node2=_node2.lastChild);slice=closeSlice(slice,openStart,openEnd)}return view.someProp("transformPasted",(function(f){slice=f(slice,view)})),slice}var inlineParents=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function withWrappers(node,wrap){for(var from=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,_i278=wrap.length-1;_i278>=from;_i278--)node=wrap[_i278].create(null,Fragment.from(node));return node}function addToSibling(wrap,lastWrap,node,sibling,depth){if(depth<wrap.length&&depth<lastWrap.length&&wrap[depth]==lastWrap[depth]){var inner=addToSibling(wrap,lastWrap,node,sibling.lastChild,depth+1);if(inner)return sibling.copy(sibling.content.replaceChild(sibling.childCount-1,inner));if(sibling.contentMatchAt(sibling.childCount).matchType(depth==wrap.length-1?node.type:wrap[depth+1]))return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node,wrap,depth+1))))}}function closeRight(node,depth){if(0==depth)return node;var fragment=node.content.replaceChild(node.childCount-1,closeRight(node.lastChild,depth-1)),fill=node.contentMatchAt(node.childCount).fillBefore(Fragment.empty,!0);return node.copy(fragment.append(fill))}function closeRange(fragment,side,from,to,depth,openEnd){var node=side<0?fragment.firstChild:fragment.lastChild,inner=node.content;return fragment.childCount>1&&(openEnd=0),depth<to-1&&(inner=closeRange(inner,side,from,to,depth+1,openEnd)),depth>=from&&(inner=side<0?node.contentMatchAt(0).fillBefore(inner,openEnd<=depth).append(inner):inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty,!0))),fragment.replaceChild(side<0?0:fragment.childCount-1,node.copy(inner))}function closeSlice(slice,openStart,openEnd){return openStart<slice.openStart&&(slice=new Slice(closeRange(slice.content,-1,openStart,slice.openStart,0,slice.openEnd),openStart,slice.openEnd)),openEnd<slice.openEnd&&(slice=new Slice(closeRange(slice.content,1,openEnd,slice.openEnd,0,0),slice.openStart,openEnd)),slice}var wrapMap={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},_detachedDoc=null;function detachedDoc(){return _detachedDoc||(_detachedDoc=document.implementation.createHTMLDocument("title"))}var handlers={},editHandlers={},passiveHandlers={touchstart:!0,touchmove:!0},InputState=_createClass((function InputState(){_classCallCheck(this,InputState),this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}));function setSelectionOrigin(view,origin){view.input.lastSelectionOrigin=origin,view.input.lastSelectionTime=Date.now()}function ensureListeners(view){view.someProp("handleDOMEvents",(function(currentHandlers){for(var type in currentHandlers)view.input.eventHandlers[type]||view.dom.addEventListener(type,view.input.eventHandlers[type]=function(event){return runCustomHandler(view,event)})}))}function runCustomHandler(view,event){return view.someProp("handleDOMEvents",(function(handlers){var handler=handlers[event.type];return!!handler&&(handler(view,event)||event.defaultPrevented)}))}function eventCoords(event){return{left:event.clientX,top:event.clientY}}function runHandlerOnContext(view,propName,pos,inside,event){if(-1==inside)return!1;for(var _ret4,$pos=view.state.doc.resolve(inside),_loop8=function _loop8(_i285){if(view.someProp(propName,(function(f){return _i285>$pos.depth?f(view,pos,$pos.nodeAfter,$pos.before(_i285),event,!0):f(view,pos,$pos.node(_i285),$pos.before(_i285),event,!1)})))return{v:!0}},_i285=$pos.depth+1;_i285>0;_i285--)if(_ret4=_loop8(_i285))return _ret4.v;return!1}function updateSelection(view,selection,origin){view.focused||view.focus();var tr=view.state.tr.setSelection(selection);"pointer"==origin&&tr.setMeta("pointer",!0),view.dispatch(tr)}function handleSingleClick(view,pos,inside,event,selectNode){return runHandlerOnContext(view,"handleClickOn",pos,inside,event)||view.someProp("handleClick",(function(f){return f(view,pos,event)}))||(selectNode?function selectClickedNode(view,inside){if(-1==inside)return!1;var selectedNode,selectAt,sel=view.state.selection;sel instanceof NodeSelection&&(selectedNode=sel.node);for(var $pos=view.state.doc.resolve(inside),_i287=$pos.depth+1;_i287>0;_i287--){var node=_i287>$pos.depth?$pos.nodeAfter:$pos.node(_i287);if(NodeSelection.isSelectable(node)){selectAt=selectedNode&&sel.$from.depth>0&&_i287>=sel.$from.depth&&$pos.before(sel.$from.depth+1)==sel.$from.pos?$pos.before(sel.$from.depth):$pos.before(_i287);break}}return null!=selectAt&&(updateSelection(view,NodeSelection.create(view.state.doc,selectAt),"pointer"),!0)}(view,inside):function selectClickedLeaf(view,inside){if(-1==inside)return!1;var $pos=view.state.doc.resolve(inside),node=$pos.nodeAfter;return!!(node&&node.isAtom&&NodeSelection.isSelectable(node))&&(updateSelection(view,new NodeSelection($pos),"pointer"),!0)}(view,inside))}function handleDoubleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleDoubleClickOn",pos,inside,event)||view.someProp("handleDoubleClick",(function(f){return f(view,pos,event)}))}function handleTripleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleTripleClickOn",pos,inside,event)||view.someProp("handleTripleClick",(function(f){return f(view,pos,event)}))||function defaultTripleClick(view,inside,event){if(0!=event.button)return!1;var doc=view.state.doc;if(-1==inside)return!!doc.inlineContent&&(updateSelection(view,TextSelection.create(doc,0,doc.content.size),"pointer"),!0);for(var $pos=doc.resolve(inside),_i289=$pos.depth+1;_i289>0;_i289--){var node=_i289>$pos.depth?$pos.nodeAfter:$pos.node(_i289),nodePos=$pos.before(_i289);if(node.inlineContent)updateSelection(view,TextSelection.create(doc,nodePos+1,nodePos+1+node.content.size),"pointer");else{if(!NodeSelection.isSelectable(node))continue;updateSelection(view,NodeSelection.create(doc,nodePos),"pointer")}return!0}}(view,inside,event)}function forceDOMFlush(view){return endComposition(view)}editHandlers.keydown=function(view,_event){var event=_event;if(view.input.shiftKey=16==event.keyCode||event.shiftKey,!inOrNearComposition(view,event)&&(view.input.lastKeyCode=event.keyCode,view.input.lastKeyCodeTime=Date.now(),!android||!chrome||13!=event.keyCode))if(229!=event.keyCode&&view.domObserver.forceFlush(),!ios||13!=event.keyCode||event.ctrlKey||event.altKey||event.metaKey)view.someProp("handleKeyDown",(function(f){return f(view,event)}))||captureKeyDown(view,event)?event.preventDefault():setSelectionOrigin(view,"key");else{var now=Date.now();view.input.lastIOSEnter=now,view.input.lastIOSEnterFallbackTimeout=setTimeout((function(){view.input.lastIOSEnter==now&&(view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})),view.input.lastIOSEnter=0)}),200)}},editHandlers.keyup=function(view,event){16==event.keyCode&&(view.input.shiftKey=!1)},editHandlers.keypress=function(view,_event){var event=_event;if(!(inOrNearComposition(view,event)||!event.charCode||event.ctrlKey&&!event.altKey||mac$2&&event.metaKey))if(view.someProp("handleKeyPress",(function(f){return f(view,event)})))event.preventDefault();else{var sel=view.state.selection;if(!(sel instanceof TextSelection&&sel.$from.sameParent(sel.$to))){var _text4=String.fromCharCode(event.charCode);/[\r\n]/.test(_text4)||view.someProp("handleTextInput",(function(f){return f(view,sel.$from.pos,sel.$to.pos,_text4)}))||view.dispatch(view.state.tr.insertText(_text4).scrollIntoView()),event.preventDefault()}}};var selectNodeModifier=mac$2?"metaKey":"ctrlKey";handlers.mousedown=function(view,_event){var event=_event;view.input.shiftKey=event.shiftKey;var flushed=forceDOMFlush(view),now=Date.now(),type="singleClick";now-view.input.lastClick.time<500&&function isNear(event,click){var dx=click.x-event.clientX,dy=click.y-event.clientY;return dx*dx+dy*dy<100}(event,view.input.lastClick)&&!event[selectNodeModifier]&&("singleClick"==view.input.lastClick.type?type="doubleClick":"doubleClick"==view.input.lastClick.type&&(type="tripleClick")),view.input.lastClick={time:now,x:event.clientX,y:event.clientY,type};var pos=view.posAtCoords(eventCoords(event));pos&&("singleClick"==type?(view.input.mouseDown&&view.input.mouseDown.done(),view.input.mouseDown=new MouseDown(view,pos,event,!!flushed)):("doubleClick"==type?handleDoubleClick:handleTripleClick)(view,pos.pos,pos.inside,event)?event.preventDefault():setSelectionOrigin(view,"pointer"))};var MouseDown=function(){function MouseDown(view,pos,event,flushed){var targetNode,targetPos,_this28=this;if(_classCallCheck(this,MouseDown),this.view=view,this.pos=pos,this.event=event,this.flushed=flushed,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=view.state.doc,this.selectNode=!!event[selectNodeModifier],this.allowDefault=event.shiftKey,pos.inside>-1)targetNode=view.state.doc.nodeAt(pos.inside),targetPos=pos.inside;else{var $pos=view.state.doc.resolve(pos.pos);targetNode=$pos.parent,targetPos=$pos.depth?$pos.before():0}var target=flushed?null:event.target,targetDesc=target?view.docView.nearestDesc(target,!0):null;this.target=targetDesc?targetDesc.dom:null;var selection=view.state.selection;(0==event.button&&targetNode.type.spec.draggable&&!1!==targetNode.type.spec.selectable||selection instanceof NodeSelection&&selection.from<=targetPos&&selection.to>targetPos)&&(this.mightDrag={node:targetNode,pos:targetPos,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!gecko||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){_this28.view.input.mouseDown==_this28&&_this28.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),view.root.addEventListener("mouseup",this.up=this.up.bind(this)),view.root.addEventListener("mousemove",this.move=this.move.bind(this)),setSelectionOrigin(view,"pointer")}return _createClass(MouseDown,[{key:"done",value:function done(){var _this29=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return selectionToDOM(_this29.view)})),this.view.input.mouseDown=null}},{key:"up",value:function up(event){if(this.done(),this.view.dom.contains(event.target)){var pos=this.pos;this.view.state.doc!=this.startDoc&&(pos=this.view.posAtCoords(eventCoords(event))),this.updateAllowDefault(event),this.allowDefault||!pos?setSelectionOrigin(this.view,"pointer"):handleSingleClick(this.view,pos.pos,pos.inside,event,this.selectNode)?event.preventDefault():0==event.button&&(this.flushed||safari&&this.mightDrag&&!this.mightDrag.node.isAtom||chrome&&!this.view.state.selection.visible&&Math.min(Math.abs(pos.pos-this.view.state.selection.from),Math.abs(pos.pos-this.view.state.selection.to))<=2)?(updateSelection(this.view,Selection.near(this.view.state.doc.resolve(pos.pos)),"pointer"),event.preventDefault()):setSelectionOrigin(this.view,"pointer")}}},{key:"move",value:function move(event){this.updateAllowDefault(event),setSelectionOrigin(this.view,"pointer"),0==event.buttons&&this.done()}},{key:"updateAllowDefault",value:function updateAllowDefault(event){!this.allowDefault&&(Math.abs(this.event.x-event.clientX)>4||Math.abs(this.event.y-event.clientY)>4)&&(this.allowDefault=!0)}}]),MouseDown}();function inOrNearComposition(view,event){return!!view.composing||!!(safari&&Math.abs(event.timeStamp-view.input.compositionEndedAt)<500)&&(view.input.compositionEndedAt=-2e8,!0)}handlers.touchstart=function(view){view.input.lastTouch=Date.now(),forceDOMFlush(view),setSelectionOrigin(view,"pointer")},handlers.touchmove=function(view){view.input.lastTouch=Date.now(),setSelectionOrigin(view,"pointer")},handlers.contextmenu=function(view){return forceDOMFlush(view)};var timeoutComposition=android?5e3:-1;function scheduleComposeEnd(view,delay){clearTimeout(view.input.composingTimeout),delay>-1&&(view.input.composingTimeout=setTimeout((function(){return endComposition(view)}),delay))}function clearComposition(view){for(view.composing&&(view.input.composing=!1,view.input.compositionEndedAt=function timestampFromCustomEvent(){var event=document.createEvent("Event");return event.initEvent("event",!0,!0),event.timeStamp}());view.input.compositionNodes.length>0;)view.input.compositionNodes.pop().markParentsDirty()}function endComposition(view){var forceUpdate=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(android&&view.domObserver.flushingSoon>=0)){if(view.domObserver.forceFlush(),clearComposition(view),forceUpdate||view.docView&&view.docView.dirty){var sel=selectionFromDOM(view);return sel&&!sel.eq(view.state.selection)?view.dispatch(view.state.tr.setSelection(sel)):view.updateState(view.state),!0}return!1}}editHandlers.compositionstart=editHandlers.compositionupdate=function(view){if(!view.composing){view.domObserver.flush();var state=view.state,$pos=state.selection.$from;if(state.selection.empty&&(state.storedMarks||!$pos.textOffset&&$pos.parentOffset&&$pos.nodeBefore.marks.some((function(m){return!1===m.type.spec.inclusive}))))view.markCursor=view.state.storedMarks||$pos.marks(),endComposition(view,!0),view.markCursor=null;else if(endComposition(view),gecko&&state.selection.empty&&$pos.parentOffset&&!$pos.textOffset&&$pos.nodeBefore.marks.length)for(var sel=view.domSelectionRange(),node=sel.focusNode,offset=sel.focusOffset;node&&1==node.nodeType&&0!=offset;){var before=offset<0?node.lastChild:node.childNodes[offset-1];if(!before)break;if(3==before.nodeType){view.domSelection().collapse(before,before.nodeValue.length);break}node=before,offset=-1}view.input.composing=!0}scheduleComposeEnd(view,timeoutComposition)},editHandlers.compositionend=function(view,event){view.composing&&(view.input.composing=!1,view.input.compositionEndedAt=event.timeStamp,view.input.compositionPendingChanges=view.domObserver.pendingRecords().length?view.input.compositionID:0,view.input.compositionPendingChanges&&Promise.resolve().then((function(){return view.domObserver.flush()})),view.input.compositionID++,scheduleComposeEnd(view,20))};var brokenClipboardAPI=ie$1&&ie_version<15||ios&&webkit_version<604;function doPaste(view,text,html,preferPlain,event){var slice=parseFromClipboard(view,text,html,preferPlain,view.state.selection.$from);if(view.someProp("handlePaste",(function(f){return f(view,event,slice||Slice.empty)})))return!0;if(!slice)return!1;var singleNode=function sliceSingleNode(slice){return 0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount?slice.content.firstChild:null}(slice),tr=singleNode?view.state.tr.replaceSelectionWith(singleNode,preferPlain):view.state.tr.replaceSelection(slice);return view.dispatch(tr.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}handlers.copy=editHandlers.cut=function(view,_event){var event=_event,sel=view.state.selection,cut="cut"==event.type;if(!sel.empty){var data=brokenClipboardAPI?null:event.clipboardData,_serializeForClipboar=serializeForClipboard(view,sel.content()),dom=_serializeForClipboar.dom,text=_serializeForClipboar.text;data?(event.preventDefault(),data.clearData(),data.setData("text/html",dom.innerHTML),data.setData("text/plain",text)):function captureCopy(view,dom){if(view.dom.parentNode){var wrap=view.dom.parentNode.appendChild(document.createElement("div"));wrap.appendChild(dom),wrap.style.cssText="position: fixed; left: -10000px; top: 10px";var sel=getSelection(),range=document.createRange();range.selectNodeContents(dom),view.dom.blur(),sel.removeAllRanges(),sel.addRange(range),setTimeout((function(){wrap.parentNode&&wrap.parentNode.removeChild(wrap),view.focus()}),50)}}(view,dom),cut&&view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},editHandlers.paste=function(view,_event){var event=_event;if(!view.composing||android){var data=brokenClipboardAPI?null:event.clipboardData,plain=view.input.shiftKey&&45!=view.input.lastKeyCode;data&&doPaste(view,data.getData("text/plain"),data.getData("text/html"),plain,event)?event.preventDefault():function capturePaste(view,event){if(view.dom.parentNode){var plainText=view.input.shiftKey||view.state.selection.$from.parent.type.spec.code,target=view.dom.parentNode.appendChild(document.createElement(plainText?"textarea":"div"));plainText||(target.contentEditable="true"),target.style.cssText="position: fixed; left: -10000px; top: 10px",target.focus();var plain=view.input.shiftKey&&45!=view.input.lastKeyCode;setTimeout((function(){view.focus(),target.parentNode&&target.parentNode.removeChild(target),plainText?doPaste(view,target.value,null,plain,event):doPaste(view,target.textContent,target.innerHTML,plain,event)}),50)}}(view,event)}};var Dragging=_createClass((function Dragging(slice,move){_classCallCheck(this,Dragging),this.slice=slice,this.move=move})),dragCopyModifier=mac$2?"altKey":"ctrlKey";for(var _prop19 in handlers.dragstart=function(view,_event){var event=_event,mouseDown=view.input.mouseDown;if(mouseDown&&mouseDown.done(),event.dataTransfer){var sel=view.state.selection,pos=sel.empty?null:view.posAtCoords(eventCoords(event));if(pos&&pos.pos>=sel.from&&pos.pos<=(sel instanceof NodeSelection?sel.to-1:sel.to));else if(mouseDown&&mouseDown.mightDrag)view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc,mouseDown.mightDrag.pos)));else if(event.target&&1==event.target.nodeType){var desc=view.docView.nearestDesc(event.target,!0);desc&&desc.node.type.spec.draggable&&desc!=view.docView&&view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc,desc.posBefore)))}var slice=view.state.selection.content(),_serializeForClipboar2=serializeForClipboard(view,slice),dom=_serializeForClipboar2.dom,text=_serializeForClipboar2.text;event.dataTransfer.clearData(),event.dataTransfer.setData(brokenClipboardAPI?"Text":"text/html",dom.innerHTML),event.dataTransfer.effectAllowed="copyMove",brokenClipboardAPI||event.dataTransfer.setData("text/plain",text),view.dragging=new Dragging(slice,!event[dragCopyModifier])}},handlers.dragend=function(view){var dragging=view.dragging;window.setTimeout((function(){view.dragging==dragging&&(view.dragging=null)}),50)},editHandlers.dragover=editHandlers.dragenter=function(_,e){return e.preventDefault()},editHandlers.drop=function(view,_event){var event=_event,dragging=view.dragging;if(view.dragging=null,event.dataTransfer){var eventPos=view.posAtCoords(eventCoords(event));if(eventPos){var $mouse=view.state.doc.resolve(eventPos.pos),slice=dragging&&dragging.slice;slice?view.someProp("transformPasted",(function(f){slice=f(slice,view)})):slice=parseFromClipboard(view,event.dataTransfer.getData(brokenClipboardAPI?"Text":"text/plain"),brokenClipboardAPI?null:event.dataTransfer.getData("text/html"),!1,$mouse);var move=!(!dragging||event[dragCopyModifier]);if(view.someProp("handleDrop",(function(f){return f(view,event,slice||Slice.empty,move)})))event.preventDefault();else if(slice){event.preventDefault();var insertPos=slice?dropPoint(view.state.doc,$mouse.pos,slice):$mouse.pos;null==insertPos&&(insertPos=$mouse.pos);var tr=view.state.tr;move&&tr.deleteSelection();var pos=tr.mapping.map(insertPos),isNode=0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount,beforeInsert=tr.doc;if(isNode?tr.replaceRangeWith(pos,pos,slice.content.firstChild):tr.replaceRange(pos,pos,slice),!tr.doc.eq(beforeInsert)){var $pos=tr.doc.resolve(pos);if(isNode&&NodeSelection.isSelectable(slice.content.firstChild)&&$pos.nodeAfter&&$pos.nodeAfter.sameMarkup(slice.content.firstChild))tr.setSelection(new NodeSelection($pos));else{var end=tr.mapping.map(insertPos);tr.mapping.maps[tr.mapping.maps.length-1].forEach((function(_from,_to,_newFrom,newTo){return end=newTo})),tr.setSelection(selectionBetween(view,$pos,tr.doc.resolve(end)))}view.focus(),view.dispatch(tr.setMeta("uiEvent","drop"))}}}}},handlers.focus=function(view){view.input.lastFocus=Date.now(),view.focused||(view.domObserver.stop(),view.dom.classList.add("ProseMirror-focused"),view.domObserver.start(),view.focused=!0,setTimeout((function(){view.docView&&view.hasFocus()&&!view.domObserver.currentSelection.eq(view.domSelectionRange())&&selectionToDOM(view)}),20))},handlers.blur=function(view,_event){var event=_event;view.focused&&(view.domObserver.stop(),view.dom.classList.remove("ProseMirror-focused"),view.domObserver.start(),event.relatedTarget&&view.dom.contains(event.relatedTarget)&&view.domObserver.currentSelection.clear(),view.focused=!1)},handlers.beforeinput=function(view,_event){if(chrome&&android&&"deleteContentBackward"==_event.inputType){view.domObserver.flushSoon();var domChangeCount=view.input.domChangeCount;setTimeout((function(){if(view.input.domChangeCount==domChangeCount&&(view.dom.blur(),view.focus(),!view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(8,"Backspace"))})))){var $cursor=view.state.selection.$cursor;$cursor&&$cursor.pos>0&&view.dispatch(view.state.tr.delete($cursor.pos-1,$cursor.pos).scrollIntoView())}}),50)}},editHandlers)handlers[_prop19]=editHandlers[_prop19];function compareObjs(a,b){if(a==b)return!0;for(var p in a)if(a[p]!==b[p])return!1;for(var _p5 in b)if(!(_p5 in a))return!1;return!0}var WidgetType=function(){function WidgetType(toDOM,spec){_classCallCheck(this,WidgetType),this.toDOM=toDOM,this.spec=spec||noSpec,this.side=this.spec.side||0}return _createClass(WidgetType,[{key:"map",value:function map(mapping,span,offset,oldOffset){var _mapping$mapResult3=mapping.mapResult(span.from+oldOffset,this.side<0?-1:1),pos=_mapping$mapResult3.pos;return _mapping$mapResult3.deleted?null:new Decoration(pos-offset,pos-offset,this)}},{key:"valid",value:function valid(){return!0}},{key:"eq",value:function eq(other){return this==other||other instanceof WidgetType&&(this.spec.key&&this.spec.key==other.spec.key||this.toDOM==other.toDOM&&compareObjs(this.spec,other.spec))}},{key:"destroy",value:function destroy(node){this.spec.destroy&&this.spec.destroy(node)}}]),WidgetType}(),InlineType=function(){function InlineType(attrs,spec){_classCallCheck(this,InlineType),this.attrs=attrs,this.spec=spec||noSpec}return _createClass(InlineType,[{key:"map",value:function map(mapping,span,offset,oldOffset){var from=mapping.map(span.from+oldOffset,this.spec.inclusiveStart?-1:1)-offset,to=mapping.map(span.to+oldOffset,this.spec.inclusiveEnd?1:-1)-offset;return from>=to?null:new Decoration(from,to,this)}},{key:"valid",value:function valid(_,span){return span.from<span.to}},{key:"eq",value:function eq(other){return this==other||other instanceof InlineType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)}},{key:"destroy",value:function destroy(){}}],[{key:"is",value:function is(span){return span.type instanceof InlineType}}]),InlineType}(),NodeType=function(){function NodeType(attrs,spec){_classCallCheck(this,NodeType),this.attrs=attrs,this.spec=spec||noSpec}return _createClass(NodeType,[{key:"map",value:function map(mapping,span,offset,oldOffset){var from=mapping.mapResult(span.from+oldOffset,1);if(from.deleted)return null;var to=mapping.mapResult(span.to+oldOffset,-1);return to.deleted||to.pos<=from.pos?null:new Decoration(from.pos-offset,to.pos-offset,this)}},{key:"valid",value:function valid(node,span){var child,_node$content$findInd3=node.content.findIndex(span.from),index=_node$content$findInd3.index,offset=_node$content$findInd3.offset;return offset==span.from&&!(child=node.child(index)).isText&&offset+child.nodeSize==span.to}},{key:"eq",value:function eq(other){return this==other||other instanceof NodeType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)}},{key:"destroy",value:function destroy(){}}]),NodeType}(),Decoration=function(){function Decoration(from,to,type){_classCallCheck(this,Decoration),this.from=from,this.to=to,this.type=type}return _createClass(Decoration,[{key:"copy",value:function copy(from,to){return new Decoration(from,to,this.type)}},{key:"eq",value:function eq(other){var offset=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(other.type)&&this.from+offset==other.from&&this.to+offset==other.to}},{key:"map",value:function map(mapping,offset,oldOffset){return this.type.map(mapping,this,offset,oldOffset)}},{key:"spec",get:function get(){return this.type.spec}},{key:"inline",get:function get(){return this.type instanceof InlineType}},{key:"widget",get:function get(){return this.type instanceof WidgetType}}],[{key:"widget",value:function widget(pos,toDOM,spec){return new Decoration(pos,pos,new WidgetType(toDOM,spec))}},{key:"inline",value:function inline(from,to,attrs,spec){return new Decoration(from,to,new InlineType(attrs,spec))}},{key:"node",value:function node(from,to,attrs,spec){return new Decoration(from,to,new NodeType(attrs,spec))}}]),Decoration}(),none=[],noSpec={},DecorationSet=function(){function DecorationSet(local,children){_classCallCheck(this,DecorationSet),this.local=local.length?local:none,this.children=children.length?children:none}return _createClass(DecorationSet,[{key:"find",value:function find(start,end,predicate){var result=[];return this.findInner(null==start?0:start,null==end?1e9:end,result,0,predicate),result}},{key:"findInner",value:function findInner(start,end,result,offset,predicate){for(var _i291=0;_i291<this.local.length;_i291++){var span=this.local[_i291];span.from<=end&&span.to>=start&&(!predicate||predicate(span.spec))&&result.push(span.copy(span.from+offset,span.to+offset))}for(var _i293=0;_i293<this.children.length;_i293+=3)if(this.children[_i293]<end&&this.children[_i293+1]>start){var childOff=this.children[_i293]+1;this.children[_i293+2].findInner(start-childOff,end-childOff,result,offset+childOff,predicate)}}},{key:"map",value:function map(mapping,doc,options){return this==empty$1||0==mapping.maps.length?this:this.mapInner(mapping,doc,0,0,options||noSpec)}},{key:"mapInner",value:function mapInner(mapping,node,offset,oldOffset,options){for(var newLocal,_i295=0;_i295<this.local.length;_i295++){var mapped=this.local[_i295].map(mapping,offset,oldOffset);mapped&&mapped.type.valid(node,mapped)?(newLocal||(newLocal=[])).push(mapped):options.onRemove&&options.onRemove(this.local[_i295].spec)}return this.children.length?mapChildren(this.children,newLocal||[],mapping,node,offset,oldOffset,options):newLocal?new DecorationSet(newLocal.sort(byPos),none):empty$1}},{key:"add",value:function add(doc,decorations){return decorations.length?this==empty$1?DecorationSet.create(doc,decorations):this.addInner(doc,decorations,0):this}},{key:"addInner",value:function addInner(doc,decorations,offset){var children,_this30=this,childIndex=0;doc.forEach((function(childNode,childOffset){var found,baseOffset=childOffset+offset;if(found=takeSpansForNode(decorations,childNode,baseOffset)){for(children||(children=_this30.children.slice());childIndex<children.length&&children[childIndex]<childOffset;)childIndex+=3;children[childIndex]==childOffset?children[childIndex+2]=children[childIndex+2].addInner(childNode,found,baseOffset+1):children.splice(childIndex,0,childOffset,childOffset+childNode.nodeSize,buildTree(found,childNode,baseOffset+1,noSpec)),childIndex+=3}}));for(var local=moveSpans(childIndex?withoutNulls(decorations):decorations,-offset),_i297=0;_i297<local.length;_i297++)local[_i297].type.valid(doc,local[_i297])||local.splice(_i297--,1);return new DecorationSet(local.length?this.local.concat(local).sort(byPos):this.local,children||this.children)}},{key:"remove",value:function remove(decorations){return 0==decorations.length||this==empty$1?this:this.removeInner(decorations,0)}},{key:"removeInner",value:function removeInner(decorations,offset){for(var children=this.children,local=this.local,_i299=0;_i299<children.length;_i299+=3){for(var span,_found10=void 0,from=children[_i299]+offset,to=children[_i299+1]+offset,j=0;j<decorations.length;j++)(span=decorations[j])&&span.from>from&&span.to<to&&(decorations[j]=null,(_found10||(_found10=[])).push(span));if(_found10){children==this.children&&(children=this.children.slice());var removed=children[_i299+2].removeInner(_found10,from+1);removed!=empty$1?children[_i299+2]=removed:(children.splice(_i299,3),_i299-=3)}}if(local.length)for(var _span2,_i301=0;_i301<decorations.length;_i301++)if(_span2=decorations[_i301])for(var _j5=0;_j5<local.length;_j5++)local[_j5].eq(_span2,offset)&&(local==this.local&&(local=this.local.slice()),local.splice(_j5--,1));return children==this.children&&local==this.local?this:local.length||children.length?new DecorationSet(local,children):empty$1}},{key:"forChild",value:function forChild(offset,node){if(this==empty$1)return this;if(node.isLeaf)return DecorationSet.empty;for(var child,local,_i303=0;_i303<this.children.length;_i303+=3)if(this.children[_i303]>=offset){this.children[_i303]==offset&&(child=this.children[_i303+2]);break}for(var start=offset+1,end=start+node.content.size,_i305=0;_i305<this.local.length;_i305++){var dec=this.local[_i305];if(dec.from<end&&dec.to>start&&dec.type instanceof InlineType){var from=Math.max(start,dec.from)-start,to=Math.min(end,dec.to)-start;from<to&&(local||(local=[])).push(dec.copy(from,to))}}if(local){var localSet=new DecorationSet(local.sort(byPos),none);return child?new DecorationGroup([localSet,child]):localSet}return child||empty$1}},{key:"eq",value:function eq(other){if(this==other)return!0;if(!(other instanceof DecorationSet)||this.local.length!=other.local.length||this.children.length!=other.children.length)return!1;for(var _i307=0;_i307<this.local.length;_i307++)if(!this.local[_i307].eq(other.local[_i307]))return!1;for(var _i309=0;_i309<this.children.length;_i309+=3)if(this.children[_i309]!=other.children[_i309]||this.children[_i309+1]!=other.children[_i309+1]||!this.children[_i309+2].eq(other.children[_i309+2]))return!1;return!0}},{key:"locals",value:function locals(node){return removeOverlap(this.localsInner(node))}},{key:"localsInner",value:function localsInner(node){if(this==empty$1)return none;if(node.inlineContent||!this.local.some(InlineType.is))return this.local;for(var result=[],_i311=0;_i311<this.local.length;_i311++)this.local[_i311].type instanceof InlineType||result.push(this.local[_i311]);return result}}],[{key:"create",value:function create(doc,decorations){return decorations.length?buildTree(decorations,doc,0,noSpec):empty$1}}]),DecorationSet}();DecorationSet.empty=new DecorationSet([],[]),DecorationSet.removeOverlap=removeOverlap;var empty$1=DecorationSet.empty,DecorationGroup=function(){function DecorationGroup(members){_classCallCheck(this,DecorationGroup),this.members=members}return _createClass(DecorationGroup,[{key:"map",value:function map(mapping,doc){var mappedDecos=this.members.map((function(member){return member.map(mapping,doc,noSpec)}));return DecorationGroup.from(mappedDecos)}},{key:"forChild",value:function forChild(offset,child){if(child.isLeaf)return DecorationSet.empty;for(var found=[],_i313=0;_i313<this.members.length;_i313++){var result=this.members[_i313].forChild(offset,child);result!=empty$1&&(result instanceof DecorationGroup?found=found.concat(result.members):found.push(result))}return DecorationGroup.from(found)}},{key:"eq",value:function eq(other){if(!(other instanceof DecorationGroup)||other.members.length!=this.members.length)return!1;for(var _i315=0;_i315<this.members.length;_i315++)if(!this.members[_i315].eq(other.members[_i315]))return!1;return!0}},{key:"locals",value:function locals(node){for(var result,sorted=!0,_i317=0;_i317<this.members.length;_i317++){var locals=this.members[_i317].localsInner(node);if(locals.length)if(result){sorted&&(result=result.slice(),sorted=!1);for(var j=0;j<locals.length;j++)result.push(locals[j])}else result=locals}return result?removeOverlap(sorted?result:result.sort(byPos)):none}}],[{key:"from",value:function from(members){switch(members.length){case 0:return empty$1;case 1:return members[0];default:return new DecorationGroup(members.every((function(m){return m instanceof DecorationSet}))?members:members.reduce((function(r,m){return r.concat(m instanceof DecorationSet?m:m.members)}),[]))}}}]),DecorationGroup}();function mapChildren(oldChildren,newLocal,mapping,node,offset,oldOffset,options){for(var children=oldChildren.slice(),_loop9=function _loop9(_baseOffset){var moved=0;mapping.maps[_i318].forEach((function(oldStart,oldEnd,newStart,newEnd){for(var dSize=newEnd-newStart-(oldEnd-oldStart),_i326=0;_i326<children.length;_i326+=3){var end=children[_i326+1];if(!(end<0||oldStart>end+_baseOffset-moved)){var start=children[_i326]+_baseOffset-moved;oldEnd>=start?children[_i326+1]=oldStart<=start?-2:-1:newStart>=offset&&dSize&&(children[_i326]+=dSize,children[_i326+1]+=dSize)}}moved+=dSize})),_baseOffset=mapping.maps[_i318].map(_baseOffset,-1),baseOffset=_baseOffset},_i318=0,baseOffset=oldOffset;_i318<mapping.maps.length;_i318++)_loop9(baseOffset);for(var mustRebuild=!1,_i320=0;_i320<children.length;_i320+=3)if(children[_i320+1]<0){if(-2==children[_i320+1]){mustRebuild=!0,children[_i320+1]=-1;continue}var from=mapping.map(oldChildren[_i320]+oldOffset),fromLocal=from-offset;if(fromLocal<0||fromLocal>=node.content.size){mustRebuild=!0;continue}var toLocal=mapping.map(oldChildren[_i320+1]+oldOffset,-1)-offset,_node$content$findInd4=node.content.findIndex(fromLocal),index=_node$content$findInd4.index,childOffset=_node$content$findInd4.offset,childNode=node.maybeChild(index);if(childNode&&childOffset==fromLocal&&childOffset+childNode.nodeSize==toLocal){var mapped=children[_i320+2].mapInner(mapping,childNode,from+1,oldChildren[_i320]+oldOffset+1,options);mapped!=empty$1?(children[_i320]=fromLocal,children[_i320+1]=toLocal,children[_i320+2]=mapped):(children[_i320+1]=-2,mustRebuild=!0)}else mustRebuild=!0}if(mustRebuild){var decorations=function mapAndGatherRemainingDecorations(children,oldChildren,decorations,mapping,offset,oldOffset,options){function gather(set,oldOffset){for(var _i330=0;_i330<set.local.length;_i330++){var mapped=set.local[_i330].map(mapping,offset,oldOffset);mapped?decorations.push(mapped):options.onRemove&&options.onRemove(set.local[_i330].spec)}for(var _i332=0;_i332<set.children.length;_i332+=3)gather(set.children[_i332+2],set.children[_i332]+oldOffset+1)}for(var _i334=0;_i334<children.length;_i334+=3)-1==children[_i334+1]&&gather(children[_i334+2],oldChildren[_i334]+oldOffset+1);return decorations}(children,oldChildren,newLocal,mapping,offset,oldOffset,options),built=buildTree(decorations,node,0,options);newLocal=built.local;for(var _i322=0;_i322<children.length;_i322+=3)children[_i322+1]<0&&(children.splice(_i322,3),_i322-=3);for(var _i324=0,j=0;_i324<built.children.length;_i324+=3){for(var _from2=built.children[_i324];j<children.length&&children[j]<_from2;)j+=3;children.splice(j,0,built.children[_i324],built.children[_i324+1],built.children[_i324+2])}}return new DecorationSet(newLocal.sort(byPos),children)}function moveSpans(spans,offset){if(!offset||!spans.length)return spans;for(var result=[],_i328=0;_i328<spans.length;_i328++){var span=spans[_i328];result.push(new Decoration(span.from+offset,span.to+offset,span.type))}return result}function takeSpansForNode(spans,node,offset){if(node.isLeaf)return null;for(var span,end=offset+node.nodeSize,found=null,_i336=0;_i336<spans.length;_i336++)(span=spans[_i336])&&span.from>offset&&span.to<end&&((found||(found=[])).push(span),spans[_i336]=null);return found}function withoutNulls(array){for(var result=[],_i338=0;_i338<array.length;_i338++)null!=array[_i338]&&result.push(array[_i338]);return result}function buildTree(spans,node,offset,options){var children=[],hasNulls=!1;node.forEach((function(childNode,localStart){var found=takeSpansForNode(spans,childNode,localStart+offset);if(found){hasNulls=!0;var subtree=buildTree(found,childNode,offset+localStart+1,options);subtree!=empty$1&&children.push(localStart,localStart+childNode.nodeSize,subtree)}}));for(var locals=moveSpans(hasNulls?withoutNulls(spans):spans,-offset).sort(byPos),_i340=0;_i340<locals.length;_i340++)locals[_i340].type.valid(node,locals[_i340])||(options.onRemove&&options.onRemove(locals[_i340].spec),locals.splice(_i340--,1));return locals.length||children.length?new DecorationSet(locals,children):empty$1}function byPos(a,b){return a.from-b.from||a.to-b.to}function removeOverlap(spans){for(var working=spans,_i342=0;_i342<working.length-1;_i342++){var span=working[_i342];if(span.from!=span.to)for(var j=_i342+1;j<working.length;j++){var next=working[j];if(next.from!=span.from){next.from<span.to&&(working==spans&&(working=spans.slice()),working[_i342]=span.copy(span.from,next.from),insertAhead(working,j,span.copy(next.from,span.to)));break}next.to!=span.to&&(working==spans&&(working=spans.slice()),working[j]=next.copy(next.from,span.to),insertAhead(working,j+1,next.copy(span.to,next.to)))}}return working}function insertAhead(array,i,deco){for(;i<array.length&&byPos(deco,array[i])>0;)i++;array.splice(i,0,deco)}function viewDecorations(view){var found=[];return view.someProp("decorations",(function(f){var result=f(view.state);result&&result!=empty$1&&found.push(result)})),view.cursorWrapper&&found.push(DecorationSet.create(view.state.doc,[view.cursorWrapper.deco])),DecorationGroup.from(found)}var observeOptions={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},useCharData=ie$1&&ie_version<=11,SelectionState=function(){function SelectionState(){_classCallCheck(this,SelectionState),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}return _createClass(SelectionState,[{key:"set",value:function set(sel){this.anchorNode=sel.anchorNode,this.anchorOffset=sel.anchorOffset,this.focusNode=sel.focusNode,this.focusOffset=sel.focusOffset}},{key:"clear",value:function clear(){this.anchorNode=this.focusNode=null}},{key:"eq",value:function eq(sel){return sel.anchorNode==this.anchorNode&&sel.anchorOffset==this.anchorOffset&&sel.focusNode==this.focusNode&&sel.focusOffset==this.focusOffset}}]),SelectionState}(),DOMObserver=function(){function DOMObserver(view,handleDOMChange){var _this31=this;_classCallCheck(this,DOMObserver),this.view=view,this.handleDOMChange=handleDOMChange,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new SelectionState,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver((function(mutations){for(var _i344=0;_i344<mutations.length;_i344++)_this31.queue.push(mutations[_i344]);ie$1&&ie_version<=11&&mutations.some((function(m){return"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length}))?_this31.flushSoon():_this31.flush()})),useCharData&&(this.onCharData=function(e){_this31.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),_this31.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}return _createClass(DOMObserver,[{key:"flushSoon",value:function flushSoon(){var _this32=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){_this32.flushingSoon=-1,_this32.flush()}),20))}},{key:"forceFlush",value:function forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}},{key:"start",value:function start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,observeOptions)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}},{key:"stop",value:function stop(){var _this33=this;if(this.observer){var take=this.observer.takeRecords();if(take.length){for(var _i346=0;_i346<take.length;_i346++)this.queue.push(take[_i346]);window.setTimeout((function(){return _this33.flush()}),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}},{key:"connectSelection",value:function connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}},{key:"disconnectSelection",value:function disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}},{key:"suppressSelectionUpdates",value:function suppressSelectionUpdates(){var _this34=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return _this34.suppressingSelectionUpdates=!1}),50)}},{key:"onSelectionChange",value:function onSelectionChange(){if(hasFocusAndSelection(this.view)){if(this.suppressingSelectionUpdates)return selectionToDOM(this.view);if(ie$1&&ie_version<=11&&!this.view.state.selection.empty){var sel=this.view.domSelectionRange();if(sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset))return this.flushSoon()}this.flush()}}},{key:"setCurSelection",value:function setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}},{key:"ignoreSelectionChange",value:function ignoreSelectionChange(sel){if(!sel.focusNode)return!0;for(var container,ancestors=new Set,scan=sel.focusNode;scan;scan=parentNode(scan))ancestors.add(scan);for(var _scan2=sel.anchorNode;_scan2;_scan2=parentNode(_scan2))if(ancestors.has(_scan2)){container=_scan2;break}var desc=container&&this.view.docView.nearestDesc(container);return desc&&desc.ignoreMutation({type:"selection",target:3==container.nodeType?container.parentNode:container})?(this.setCurSelection(),!0):void 0}},{key:"pendingRecords",value:function pendingRecords(){if(this.observer){var _step3,_iterator2=_createForOfIteratorHelper(this.observer.takeRecords());try{for(_iterator2.s();!(_step3=_iterator2.n()).done;){var mut=_step3.value;this.queue.push(mut)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}return this.queue}},{key:"flush",value:function flush(){var view=this.view;if(view.docView&&!(this.flushingSoon>-1)){var mutations=this.pendingRecords();mutations.length&&(this.queue=[]);var sel=view.domSelectionRange(),newSel=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(sel)&&hasFocusAndSelection(view)&&!this.ignoreSelectionChange(sel),from=-1,to=-1,typeOver=!1,added=[];if(view.editable)for(var _i348=0;_i348<mutations.length;_i348++){var result=this.registerMutation(mutations[_i348],added);result&&(from=from<0?result.from:Math.min(result.from,from),to=to<0?result.to:Math.max(result.to,to),result.typeOver&&(typeOver=!0))}if(gecko&&added.length>1){var brs=added.filter((function(n){return"BR"==n.nodeName}));if(2==brs.length){var a=brs[0],b=brs[1];a.parentNode&&a.parentNode.parentNode==b.parentNode?b.remove():a.remove()}}var readSel=null;from<0&&newSel&&view.input.lastFocus>Date.now()-200&&Math.max(view.input.lastTouch,view.input.lastClick.time)<Date.now()-300&&selectionCollapsed(sel)&&(readSel=selectionFromDOM(view))&&readSel.eq(Selection.near(view.state.doc.resolve(0),1))?(view.input.lastFocus=0,selectionToDOM(view),this.currentSelection.set(sel),view.scrollToSelection()):(from>-1||newSel)&&(from>-1&&(view.docView.markDirty(from,to),function checkCSS(view){if(cssChecked.has(view))return;if(cssChecked.set(view,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(view.dom).whiteSpace)){if(view.requiresGeckoHackNode=gecko,cssCheckWarned)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),cssCheckWarned=!0}}(view)),this.handleDOMChange(from,to,typeOver,added),view.docView&&view.docView.dirty?view.updateState(view.state):this.currentSelection.eq(sel)||selectionToDOM(view),this.currentSelection.set(sel))}}},{key:"registerMutation",value:function registerMutation(mut,added){if(added.indexOf(mut.target)>-1)return null;var desc=this.view.docView.nearestDesc(mut.target);if("attributes"==mut.type&&(desc==this.view.docView||"contenteditable"==mut.attributeName||"style"==mut.attributeName&&!mut.oldValue&&!mut.target.getAttribute("style")))return null;if(!desc||desc.ignoreMutation(mut))return null;if("childList"==mut.type){for(var _i350=0;_i350<mut.addedNodes.length;_i350++)added.push(mut.addedNodes[_i350]);if(desc.contentDOM&&desc.contentDOM!=desc.dom&&!desc.contentDOM.contains(mut.target))return{from:desc.posBefore,to:desc.posAfter};var prev=mut.previousSibling,next=mut.nextSibling;if(ie$1&&ie_version<=11&&mut.addedNodes.length)for(var _i352=0;_i352<mut.addedNodes.length;_i352++){var _mut$addedNodes$_i=mut.addedNodes[_i352],previousSibling=_mut$addedNodes$_i.previousSibling,nextSibling=_mut$addedNodes$_i.nextSibling;(!previousSibling||Array.prototype.indexOf.call(mut.addedNodes,previousSibling)<0)&&(prev=previousSibling),(!nextSibling||Array.prototype.indexOf.call(mut.addedNodes,nextSibling)<0)&&(next=nextSibling)}var fromOffset=prev&&prev.parentNode==mut.target?domIndex(prev)+1:0,from=desc.localPosFromDOM(mut.target,fromOffset,-1),toOffset=next&&next.parentNode==mut.target?domIndex(next):mut.target.childNodes.length;return{from,to:desc.localPosFromDOM(mut.target,toOffset,1)}}return"attributes"==mut.type?{from:desc.posAtStart-desc.border,to:desc.posAtEnd+desc.border}:{from:desc.posAtStart,to:desc.posAtEnd,typeOver:mut.target.nodeValue==mut.oldValue}}}]),DOMObserver}(),cssChecked=new WeakMap,cssCheckWarned=!1;function ruleFromNode(dom){var desc=dom.pmViewDesc;if(desc)return desc.parseRule();if("BR"==dom.nodeName&&dom.parentNode){if(safari&&/^(ul|ol)$/i.test(dom.parentNode.nodeName)){var skip=document.createElement("div");return skip.appendChild(document.createElement("li")),{skip}}if(dom.parentNode.lastChild==dom||safari&&/^(tr|table)$/i.test(dom.parentNode.nodeName))return{ignore:!0}}else if("IMG"==dom.nodeName&&dom.getAttribute("mark-placeholder"))return{ignore:!0};return null}var isInline=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function readDOMChange(view,from,to,typeOver,addedNodes){var compositionID=view.input.compositionPendingChanges||(view.composing?view.input.compositionID:0);if(view.input.compositionPendingChanges=0,from<0){var origin=view.input.lastSelectionTime>Date.now()-50?view.input.lastSelectionOrigin:null,newSel=selectionFromDOM(view,origin);if(newSel&&!view.state.selection.eq(newSel)){if(chrome&&android&&13===view.input.lastKeyCode&&Date.now()-100<view.input.lastKeyCodeTime&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))return;var _tr3=view.state.tr.setSelection(newSel);"pointer"==origin?_tr3.setMeta("pointer",!0):"key"==origin&&_tr3.scrollIntoView(),compositionID&&_tr3.setMeta("composition",compositionID),view.dispatch(_tr3)}}else{var $before=view.state.doc.resolve(from),shared=$before.sharedDepth(to);from=$before.before(shared+1),to=view.state.doc.resolve(to).after(shared+1);var preferredPos,preferredSide,sel=view.state.selection,parse=function parseBetween(view,from_,to_){var find,_view$docView$parseRa=view.docView.parseRange(from_,to_),parent=_view$docView$parseRa.node,fromOffset=_view$docView$parseRa.fromOffset,toOffset=_view$docView$parseRa.toOffset,from=_view$docView$parseRa.from,to=_view$docView$parseRa.to,domSel=view.domSelectionRange(),anchor=domSel.anchorNode;if(anchor&&view.dom.contains(1==anchor.nodeType?anchor:anchor.parentNode)&&(find=[{node:anchor,offset:domSel.anchorOffset}],selectionCollapsed(domSel)||find.push({node:domSel.focusNode,offset:domSel.focusOffset})),chrome&&8===view.input.lastKeyCode)for(var off=toOffset;off>fromOffset;off--){var node=parent.childNodes[off-1],desc=node.pmViewDesc;if("BR"==node.nodeName&&!desc){toOffset=off;break}if(!desc||desc.size)break}var startDoc=view.state.doc,parser=view.someProp("domParser")||DOMParser.fromSchema(view.state.schema),$from=startDoc.resolve(from),sel=null,doc=parser.parse(parent,{topNode:$from.parent,topMatch:$from.parent.contentMatchAt($from.index()),topOpen:!0,from:fromOffset,to:toOffset,preserveWhitespace:"pre"!=$from.parent.type.whitespace||"full",findPositions:find,ruleFromNode,context:$from});if(find&&null!=find[0].pos){var _anchor=find[0].pos,head=find[1]&&find[1].pos;null==head&&(head=_anchor),sel={anchor:_anchor+from,head:head+from}}return{doc,sel,from,to}}(view,from,to),doc=view.state.doc,compare=doc.slice(parse.from,parse.to);8===view.input.lastKeyCode&&Date.now()-100<view.input.lastKeyCodeTime?(preferredPos=view.state.selection.to,preferredSide="end"):(preferredPos=view.state.selection.from,preferredSide="start"),view.input.lastKeyCode=null;var change=function findDiff(a,b,pos,preferredPos,preferredSide){var start=a.findDiffStart(b,pos);if(null==start)return null;var _a$findDiffEnd=a.findDiffEnd(b,pos+a.size,pos+b.size),endA=_a$findDiffEnd.a,endB=_a$findDiffEnd.b;if("end"==preferredSide){preferredPos-=endA+Math.max(0,start-Math.min(endA,endB))-start}if(endA<start&&a.size<b.size){endB=(start-=preferredPos<=start&&preferredPos>=endA?start-preferredPos:0)+(endB-endA),endA=start}else if(endB<start){endA=(start-=preferredPos<=start&&preferredPos>=endB?start-preferredPos:0)+(endA-endB),endB=start}return{start,endA,endB}}(compare.content,parse.doc.content,parse.from,preferredPos,preferredSide);if((ios&&view.input.lastIOSEnter>Date.now()-225||android)&&addedNodes.some((function(n){return 1==n.nodeType&&!isInline.test(n.nodeName)}))&&(!change||change.endA>=change.endB)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))view.input.lastIOSEnter=0;else{if(!change){if(!(typeOver&&sel instanceof TextSelection&&!sel.empty&&sel.$head.sameParent(sel.$anchor))||view.composing||parse.sel&&parse.sel.anchor!=parse.sel.head){if(parse.sel){var _sel=resolveSelection(view,view.state.doc,parse.sel);if(_sel&&!_sel.eq(view.state.selection)){var _tr4=view.state.tr.setSelection(_sel);compositionID&&_tr4.setMeta("composition",compositionID),view.dispatch(_tr4)}}return}change={start:sel.from,endA:sel.to,endB:sel.to}}if(chrome&&view.cursorWrapper&&parse.sel&&parse.sel.anchor==view.cursorWrapper.deco.from&&parse.sel.head==parse.sel.anchor){var size=change.endB-change.start;parse.sel={anchor:parse.sel.anchor+size,head:parse.sel.anchor+size}}view.input.domChangeCount++,view.state.selection.from<view.state.selection.to&&change.start==change.endB&&view.state.selection instanceof TextSelection&&(change.start>view.state.selection.from&&change.start<=view.state.selection.from+2&&view.state.selection.from>=parse.from?change.start=view.state.selection.from:change.endA<view.state.selection.to&&change.endA>=view.state.selection.to-2&&view.state.selection.to<=parse.to&&(change.endB+=view.state.selection.to-change.endA,change.endA=view.state.selection.to)),ie$1&&ie_version<=11&&change.endB==change.start+1&&change.endA==change.start&&change.start>parse.from&&"  "==parse.doc.textBetween(change.start-parse.from-1,change.start-parse.from+1)&&(change.start--,change.endA--,change.endB--);var nextSel,$from=parse.doc.resolveNoCache(change.start-parse.from),$to=parse.doc.resolveNoCache(change.endB-parse.from),$fromA=doc.resolve(change.start),inlineChange=$from.sameParent($to)&&$from.parent.inlineContent&&$fromA.end()>=change.endA;if((ios&&view.input.lastIOSEnter>Date.now()-225&&(!inlineChange||addedNodes.some((function(n){return"DIV"==n.nodeName||"P"==n.nodeName})))||!inlineChange&&$from.pos<parse.doc.content.size&&!$from.sameParent($to)&&(nextSel=Selection.findFrom(parse.doc.resolve($from.pos+1),1,!0))&&nextSel.head==$to.pos)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))view.input.lastIOSEnter=0;else if(view.state.selection.anchor>change.start&&function looksLikeJoin(old,start,end,$newStart,$newEnd){if(!$newStart.parent.isTextblock||end-start<=$newEnd.pos-$newStart.pos||skipClosingAndOpening($newStart,!0,!1)<$newEnd.pos)return!1;var $start=old.resolve(start);if($start.parentOffset<$start.parent.content.size||!$start.parent.isTextblock)return!1;var $next=old.resolve(skipClosingAndOpening($start,!0,!0));return!(!$next.parent.isTextblock||$next.pos>end||skipClosingAndOpening($next,!0,!1)<end)&&$newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)}(doc,change.start,change.endA,$from,$to)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(8,"Backspace"))})))android&&chrome&&view.domObserver.suppressSelectionUpdates();else{chrome&&android&&change.endB==change.start&&(view.input.lastAndroidDelete=Date.now()),android&&!inlineChange&&$from.start()!=$to.start()&&0==$to.parentOffset&&$from.depth==$to.depth&&parse.sel&&parse.sel.anchor==parse.sel.head&&parse.sel.head==change.endA&&(change.endB-=2,$to=parse.doc.resolveNoCache(change.endB-parse.from),setTimeout((function(){view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))}))}),20));var tr,storedMarks,markChange,chFrom=change.start,chTo=change.endA;if(inlineChange)if($from.pos==$to.pos)ie$1&&ie_version<=11&&0==$from.parentOffset&&(view.domObserver.suppressSelectionUpdates(),setTimeout((function(){return selectionToDOM(view)}),20)),tr=view.state.tr.delete(chFrom,chTo),storedMarks=doc.resolve(change.start).marksAcross(doc.resolve(change.endA));else if(change.endA==change.endB&&(markChange=function isMarkChange(cur,prev){for(var type,mark,update,curMarks=cur.firstChild.marks,prevMarks=prev.firstChild.marks,added=curMarks,removed=prevMarks,_i354=0;_i354<prevMarks.length;_i354++)added=prevMarks[_i354].removeFromSet(added);for(var _i356=0;_i356<curMarks.length;_i356++)removed=curMarks[_i356].removeFromSet(removed);if(1==added.length&&0==removed.length)mark=added[0],type="add",update=function update(node){return node.mark(mark.addToSet(node.marks))};else{if(0!=added.length||1!=removed.length)return null;mark=removed[0],type="remove",update=function update(node){return node.mark(mark.removeFromSet(node.marks))}}for(var updated=[],_i358=0;_i358<prev.childCount;_i358++)updated.push(update(prev.child(_i358)));if(Fragment.from(updated).eq(cur))return{mark,type}}($from.parent.content.cut($from.parentOffset,$to.parentOffset),$fromA.parent.content.cut($fromA.parentOffset,change.endA-$fromA.start()))))tr=view.state.tr,"add"==markChange.type?tr.addMark(chFrom,chTo,markChange.mark):tr.removeMark(chFrom,chTo,markChange.mark);else if($from.parent.child($from.index()).isText&&$from.index()==$to.index()-($to.textOffset?0:1)){var _text5=$from.parent.textBetween($from.parentOffset,$to.parentOffset);if(view.someProp("handleTextInput",(function(f){return f(view,chFrom,chTo,_text5)})))return;tr=view.state.tr.insertText(_text5,chFrom,chTo)}if(tr||(tr=view.state.tr.replace(chFrom,chTo,parse.doc.slice(change.start-parse.from,change.endB-parse.from))),parse.sel){var _sel2=resolveSelection(view,tr.doc,parse.sel);_sel2&&!(chrome&&android&&view.composing&&_sel2.empty&&(change.start!=change.endB||view.input.lastAndroidDelete<Date.now()-100)&&(_sel2.head==chFrom||_sel2.head==tr.mapping.map(chTo)-1)||ie$1&&_sel2.empty&&_sel2.head==chFrom)&&tr.setSelection(_sel2)}storedMarks&&tr.ensureMarks(storedMarks),compositionID&&tr.setMeta("composition",compositionID),view.dispatch(tr.scrollIntoView())}}}}function resolveSelection(view,doc,parsedSel){return Math.max(parsedSel.anchor,parsedSel.head)>doc.content.size?null:selectionBetween(view,doc.resolve(parsedSel.anchor),doc.resolve(parsedSel.head))}function skipClosingAndOpening($pos,fromEnd,mayOpen){for(var depth=$pos.depth,end=fromEnd?$pos.end():$pos.pos;depth>0&&(fromEnd||$pos.indexAfter(depth)==$pos.node(depth).childCount);)depth--,end++,fromEnd=!1;if(mayOpen)for(var next=$pos.node(depth).maybeChild($pos.indexAfter(depth));next&&!next.isLeaf;)next=next.firstChild,end++;return end}var EditorView=function(){function EditorView(place,props){var _this35=this;_classCallCheck(this,EditorView),this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new InputState,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=props,this.state=props.state,this.directPlugins=props.plugins||[],this.directPlugins.forEach(checkStateComponent),this.dispatch=this.dispatch.bind(this),this.dom=place&&place.mount||document.createElement("div"),place&&(place.appendChild?place.appendChild(this.dom):"function"==typeof place?place(this.dom):place.mount&&(this.mounted=!0)),this.editable=getEditable(this),updateCursorWrapper(this),this.nodeViews=buildNodeViews(this),this.docView=docViewDesc(this.state.doc,computeDocDeco(this),viewDecorations(this),this.dom,this),this.domObserver=new DOMObserver(this,(function(from,to,typeOver,added){return readDOMChange(_this35,from,to,typeOver,added)})),this.domObserver.start(),function initInput(view){var _loop7=function _loop7(){var handler=handlers[event];view.dom.addEventListener(event,view.input.eventHandlers[event]=function(event){!function eventBelongsToView(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(var node=event.target;node!=view.dom;node=node.parentNode)if(!node||11==node.nodeType||node.pmViewDesc&&node.pmViewDesc.stopEvent(event))return!1;return!0}(view,event)||runCustomHandler(view,event)||!view.editable&&event.type in editHandlers||handler(view,event)},passiveHandlers[event]?{passive:!0}:void 0)};for(var event in handlers)_loop7();safari&&view.dom.addEventListener("input",(function(){return null})),ensureListeners(view)}(this),this.updatePluginViews()}return _createClass(EditorView,[{key:"composing",get:function get(){return this.input.composing}},{key:"props",get:function get(){if(this._props.state!=this.state){var prev=this._props;for(var name in this._props={},prev)this._props[name]=prev[name];this._props.state=this.state}return this._props}},{key:"update",value:function update(props){props.handleDOMEvents!=this._props.handleDOMEvents&&ensureListeners(this);var prevProps=this._props;this._props=props,props.plugins&&(props.plugins.forEach(checkStateComponent),this.directPlugins=props.plugins),this.updateStateInner(props.state,prevProps)}},{key:"setProps",value:function setProps(props){var updated={};for(var name in this._props)updated[name]=this._props[name];for(var _name5 in updated.state=this.state,props)updated[_name5]=props[_name5];this.update(updated)}},{key:"updateState",value:function updateState(state){this.updateStateInner(state,this._props)}},{key:"updateStateInner",value:function updateStateInner(state,prevProps){var prev=this.state,redraw=!1,updateSel=!1;state.storedMarks&&this.composing&&(clearComposition(this),updateSel=!0),this.state=state;var pluginsChanged=prev.plugins!=state.plugins||this._props.plugins!=prevProps.plugins;if(pluginsChanged||this._props.plugins!=prevProps.plugins||this._props.nodeViews!=prevProps.nodeViews){var nodeViews=buildNodeViews(this);(function changedNodeViews(a,b){var nA=0,nB=0;for(var _prop25 in a){if(a[_prop25]!=b[_prop25])return!0;nA++}for(var _ in b)nB++;return nA!=nB})(nodeViews,this.nodeViews)&&(this.nodeViews=nodeViews,redraw=!0)}(pluginsChanged||prevProps.handleDOMEvents!=this._props.handleDOMEvents)&&ensureListeners(this),this.editable=getEditable(this),updateCursorWrapper(this);var innerDeco=viewDecorations(this),outerDeco=computeDocDeco(this),scroll=prev.plugins==state.plugins||prev.doc.eq(state.doc)?state.scrollToSelection>prev.scrollToSelection?"to selection":"preserve":"reset",updateDoc=redraw||!this.docView.matchesNode(state.doc,outerDeco,innerDeco);!updateDoc&&state.selection.eq(prev.selection)||(updateSel=!0);var oldScrollPos="preserve"==scroll&&updateSel&&null==this.dom.style.overflowAnchor&&function storeScrollPos(view){for(var refDOM,refTop,rect=view.dom.getBoundingClientRect(),startY=Math.max(0,rect.top),x=(rect.left+rect.right)/2,y=startY+1;y<Math.min(innerHeight,rect.bottom);y+=5){var dom=view.root.elementFromPoint(x,y);if(dom&&dom!=view.dom&&view.dom.contains(dom)){var localRect=dom.getBoundingClientRect();if(localRect.top>=startY-20){refDOM=dom,refTop=localRect.top;break}}}return{refDOM,refTop,stack:scrollStack(view.dom)}}(this);if(updateSel){this.domObserver.stop();var forceSelUpdate=updateDoc&&(ie$1||chrome)&&!this.composing&&!prev.selection.empty&&!state.selection.empty&&function selectionContextChanged(sel1,sel2){var depth=Math.min(sel1.$anchor.sharedDepth(sel1.head),sel2.$anchor.sharedDepth(sel2.head));return sel1.$anchor.start(depth)!=sel2.$anchor.start(depth)}(prev.selection,state.selection);if(updateDoc){var chromeKludge=chrome?this.trackWrites=this.domSelectionRange().focusNode:null;!redraw&&this.docView.update(state.doc,outerDeco,innerDeco,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=docViewDesc(state.doc,outerDeco,innerDeco,this.dom,this)),chromeKludge&&!this.trackWrites&&(forceSelUpdate=!0)}forceSelUpdate||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function anchorInRightPlace(view){var anchorDOM=view.docView.domFromPos(view.state.selection.anchor,0),domSel=view.domSelectionRange();return isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)}(this))?selectionToDOM(this,forceSelUpdate):(syncNodeSelection(this,state.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(prev),"reset"==scroll?this.dom.scrollTop=0:"to selection"==scroll?this.scrollToSelection():oldScrollPos&&function resetScrollPos(_ref4){var refDOM=_ref4.refDOM,refTop=_ref4.refTop,stack=_ref4.stack,newRefTop=refDOM?refDOM.getBoundingClientRect().top:0;restoreScrollStack(stack,0==newRefTop?0:newRefTop-refTop)}(oldScrollPos)}},{key:"scrollToSelection",value:function scrollToSelection(){var _this36=this,startDOM=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",(function(f){return f(_this36)})));else if(this.state.selection instanceof NodeSelection){var _target3=this.docView.domAfterPos(this.state.selection.from);1==_target3.nodeType&&scrollRectIntoView(this,_target3.getBoundingClientRect(),startDOM)}else scrollRectIntoView(this,this.coordsAtPos(this.state.selection.head,1),startDOM)}},{key:"destroyPluginViews",value:function destroyPluginViews(){for(var view;view=this.pluginViews.pop();)view.destroy&&view.destroy()}},{key:"updatePluginViews",value:function updatePluginViews(prevState){if(prevState&&prevState.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var _i364=0;_i364<this.pluginViews.length;_i364++){var pluginView=this.pluginViews[_i364];pluginView.update&&pluginView.update(this,prevState)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var _i360=0;_i360<this.directPlugins.length;_i360++){var plugin=this.directPlugins[_i360];plugin.spec.view&&this.pluginViews.push(plugin.spec.view(this))}for(var _i362=0;_i362<this.state.plugins.length;_i362++){var _plugin=this.state.plugins[_i362];_plugin.spec.view&&this.pluginViews.push(_plugin.spec.view(this))}}}},{key:"someProp",value:function someProp(propName,f){var value,prop=this._props&&this._props[propName];if(null!=prop&&(value=f?f(prop):prop))return value;for(var _i366=0;_i366<this.directPlugins.length;_i366++){var _prop20=this.directPlugins[_i366].props[propName];if(null!=_prop20&&(value=f?f(_prop20):_prop20))return value}var plugins=this.state.plugins;if(plugins)for(var _i368=0;_i368<plugins.length;_i368++){var _prop21=plugins[_i368].props[propName];if(null!=_prop21&&(value=f?f(_prop21):_prop21))return value}}},{key:"hasFocus",value:function hasFocus(){if(ie$1){var node=this.root.activeElement;if(node==this.dom)return!0;if(!node||!this.dom.contains(node))return!1;for(;node&&this.dom!=node&&this.dom.contains(node);){if("false"==node.contentEditable)return!1;node=node.parentElement}return!0}return this.root.activeElement==this.dom}},{key:"focus",value:function focus(){this.domObserver.stop(),this.editable&&function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported)return dom.focus(preventScrollSupported);var stored=scrollStack(dom);dom.focus(null==preventScrollSupported?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),preventScrollSupported||(preventScrollSupported=!1,restoreScrollStack(stored,0))}(this.dom),selectionToDOM(this),this.domObserver.start()}},{key:"root",get:function get(){var _this37=this,cached=this._root;if(null==cached)for(var _ret5,_loop10=function _loop10(search){if(9==search.nodeType||11==search.nodeType&&search.host)return search.getSelection||(Object.getPrototypeOf(search).getSelection=function(){return search.ownerDocument.getSelection()}),{v:_this37._root=search}},search=this.dom.parentNode;search;search=search.parentNode)if(_ret5=_loop10(search))return _ret5.v;return cached||document}},{key:"updateRoot",value:function updateRoot(){this._root=null}},{key:"posAtCoords",value:function posAtCoords(coords){return _posAtCoords(this,coords)}},{key:"coordsAtPos",value:function coordsAtPos(pos){return _coordsAtPos(this,pos,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}},{key:"domAtPos",value:function domAtPos(pos){var side=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(pos,side)}},{key:"nodeDOM",value:function nodeDOM(pos){var desc=this.docView.descAt(pos);return desc?desc.nodeDOM:null}},{key:"posAtDOM",value:function posAtDOM(node,offset){var bias=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,pos=this.docView.posFromDOM(node,offset,bias);if(null==pos)throw new RangeError("DOM position not inside the editor");return pos}},{key:"endOfTextblock",value:function endOfTextblock(dir,state){return _endOfTextblock(this,state||this.state,dir)}},{key:"pasteHTML",value:function pasteHTML(html,event){return doPaste(this,"",html,!1,event||new ClipboardEvent("paste"))}},{key:"pasteText",value:function pasteText(text,event){return doPaste(this,text,null,!0,event||new ClipboardEvent("paste"))}},{key:"destroy",value:function destroy(){this.docView&&(!function destroyInput(view){for(var type in view.domObserver.stop(),view.input.eventHandlers)view.dom.removeEventListener(type,view.input.eventHandlers[type]);clearTimeout(view.input.composingTimeout),clearTimeout(view.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],viewDecorations(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}},{key:"isDestroyed",get:function get(){return null==this.docView}},{key:"dispatchEvent",value:function dispatchEvent(event){return function _dispatchEvent(view,event){runCustomHandler(view,event)||!handlers[event.type]||!view.editable&&event.type in editHandlers||handlers[event.type](view,event)}(this,event)}},{key:"dispatch",value:function dispatch(tr){var dispatchTransaction=this._props.dispatchTransaction;dispatchTransaction?dispatchTransaction.call(this,tr):this.updateState(this.state.apply(tr))}},{key:"domSelectionRange",value:function domSelectionRange(){return safari&&11===this.root.nodeType&&function deepActiveElement(doc){for(var elt=doc.activeElement;elt&&elt.shadowRoot;)elt=elt.shadowRoot.activeElement;return elt}(this.dom.ownerDocument)==this.dom?function safariShadowSelectionRange(view){var found;function read(event){event.preventDefault(),event.stopImmediatePropagation(),found=event.getTargetRanges()[0]}view.dom.addEventListener("beforeinput",read,!0),document.execCommand("indent"),view.dom.removeEventListener("beforeinput",read,!0);var anchorNode=found.startContainer,anchorOffset=found.startOffset,focusNode=found.endContainer,focusOffset=found.endOffset,currentAnchor=view.domAtPos(view.state.selection.anchor);if(isEquivalentPosition(currentAnchor.node,currentAnchor.offset,focusNode,focusOffset)){var _ref6=[focusNode,focusOffset,anchorNode,anchorOffset];anchorNode=_ref6[0],anchorOffset=_ref6[1],focusNode=_ref6[2],focusOffset=_ref6[3]}return{anchorNode,anchorOffset,focusNode,focusOffset}}(this):this.domSelection()}},{key:"domSelection",value:function domSelection(){return this.root.getSelection()}}]),EditorView}();function computeDocDeco(view){var attrs=Object.create(null);return attrs.class="ProseMirror",attrs.contenteditable=String(view.editable),view.someProp("attributes",(function(value){if("function"==typeof value&&(value=value(view.state)),value)for(var attr in value)"class"==attr?attrs.class+=" "+value[attr]:"style"==attr?attrs.style=(attrs.style?attrs.style+";":"")+value[attr]:attrs[attr]||"contenteditable"==attr||"nodeName"==attr||(attrs[attr]=String(value[attr]))})),attrs.translate||(attrs.translate="no"),[Decoration.node(0,view.state.doc.content.size,attrs)]}function updateCursorWrapper(view){if(view.markCursor){var dom=document.createElement("img");dom.className="ProseMirror-separator",dom.setAttribute("mark-placeholder","true"),dom.setAttribute("alt",""),view.cursorWrapper={dom,deco:Decoration.widget(view.state.selection.head,dom,{raw:!0,marks:view.markCursor})}}else view.cursorWrapper=null}function getEditable(view){return!view.someProp("editable",(function(value){return!1===value(view.state)}))}function buildNodeViews(view){var result=Object.create(null);function add(obj){for(var _prop23 in obj)Object.prototype.hasOwnProperty.call(result,_prop23)||(result[_prop23]=obj[_prop23])}return view.someProp("nodeViews",add),view.someProp("markViews",add),result}function checkStateComponent(plugin){if(plugin.spec.state||plugin.spec.filterTransaction||plugin.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var base$1={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac$1="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ie="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),i$1=0;i$1<10;i$1++)base$1[48+i$1]=base$1[96+i$1]=String(i$1);for(i$1=1;i$1<=24;i$1++)base$1[i$1+111]="F"+i$1;for(i$1=65;i$1<=90;i$1++)base$1[i$1]=String.fromCharCode(i$1+32),shift[i$1]=String.fromCharCode(i$1);for(var code$1 in base$1)shift.hasOwnProperty(code$1)||(shift[code$1]=base$1[code$1]);var mac="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function normalizeKeyName$1(name){var alt,ctrl,shift,meta,parts=name.split(/-(?!$)/),result=parts[parts.length-1];"Space"==result&&(result=" ");for(var _i370=0;_i370<parts.length-1;_i370++){var mod=parts[_i370];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);mac?meta=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta&&(result="Meta-"+result),shift&&(result="Shift-"+result),result}function modifiers(name,event){var shift=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return event.altKey&&(name="Alt-"+name),event.ctrlKey&&(name="Ctrl-"+name),event.metaKey&&(name="Meta-"+name),shift&&event.shiftKey&&(name="Shift-"+name),name}function keydownHandler(bindings){var map=function normalize$1(map){var copy=Object.create(null);for(var _prop27 in map)copy[normalizeKeyName$1(_prop27)]=map[_prop27];return copy}(bindings);return function(view,event){var baseName,name=function keyName(event){var name=!(mac$1&&event.metaKey&&event.shiftKey&&!event.ctrlKey&&!event.altKey||ie&&event.shiftKey&&event.key&&1==event.key.length||"Unidentified"==event.key)&&event.key||(event.shiftKey?shift:base$1)[event.keyCode]||event.key||"Unidentified";return"Esc"==name&&(name="Escape"),"Del"==name&&(name="Delete"),"Left"==name&&(name="ArrowLeft"),"Up"==name&&(name="ArrowUp"),"Right"==name&&(name="ArrowRight"),"Down"==name&&(name="ArrowDown"),name}(event),direct=map[modifiers(name,event)];if(direct&&direct(view.state,view.dispatch,view))return!0;if(1==name.length&&" "!=name){if(event.shiftKey){var noShift=map[modifiers(name,event,!1)];if(noShift&&noShift(view.state,view.dispatch,view))return!0}if((event.shiftKey||event.altKey||event.metaKey||name.charCodeAt(0)>127)&&(baseName=base$1[event.keyCode])&&baseName!=name){var fromCode=map[modifiers(baseName,event)];if(fromCode&&fromCode(view.state,view.dispatch,view))return!0}}return!1}}var deleteSelection$1=function deleteSelection$1(state,dispatch){return!state.selection.empty&&(dispatch&&dispatch(state.tr.deleteSelection().scrollIntoView()),!0)};var joinBackward$1=function joinBackward$1(state,dispatch,view){var $cursor=function atBlockStart(state,view){var $cursor=state.selection.$cursor;return!$cursor||(view?!view.endOfTextblock("backward",state):$cursor.parentOffset>0)?null:$cursor}(state,view);if(!$cursor)return!1;var $cut=findCutBefore($cursor);if(!$cut){var _range4=$cursor.blockRange(),_target4=_range4&&liftTarget(_range4);return null!=_target4&&(dispatch&&dispatch(state.tr.lift(_range4,_target4).scrollIntoView()),!0)}var before=$cut.nodeBefore;if(!before.type.spec.isolating&&deleteBarrier(state,$cut,dispatch))return!0;if(0==$cursor.parent.content.size&&(textblockAt(before,"end")||NodeSelection.isSelectable(before))){var delStep=replaceStep(state.doc,$cursor.before(),$cursor.after(),Slice.empty);if(delStep&&delStep.slice.size<delStep.to-delStep.from){if(dispatch){var _tr5=state.tr.step(delStep);_tr5.setSelection(textblockAt(before,"end")?Selection.findFrom(_tr5.doc.resolve(_tr5.mapping.map($cut.pos,-1)),-1):NodeSelection.create(_tr5.doc,$cut.pos-before.nodeSize)),dispatch(_tr5.scrollIntoView())}return!0}}return!(!before.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos-before.nodeSize,$cut.pos).scrollIntoView()),!0)};function textblockAt(node,side){for(var only=arguments.length>2&&void 0!==arguments[2]&&arguments[2],scan=node;scan;scan="start"==side?scan.firstChild:scan.lastChild){if(scan.isTextblock)return!0;if(only&&1!=scan.childCount)return!1}return!1}var selectNodeBackward$1=function selectNodeBackward$1(state,dispatch,view){var _state$selection2=state.selection,$head=_state$selection2.$head,$cut=$head;if(!_state$selection2.empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("backward",state):$head.parentOffset>0)return!1;$cut=findCutBefore($head)}var node=$cut&&$cut.nodeBefore;return!(!node||!NodeSelection.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(NodeSelection.create(state.doc,$cut.pos-node.nodeSize)).scrollIntoView()),!0)};function findCutBefore($pos){if(!$pos.parent.type.spec.isolating)for(var _i372=$pos.depth-1;_i372>=0;_i372--){if($pos.index(_i372)>0)return $pos.doc.resolve($pos.before(_i372+1));if($pos.node(_i372).type.spec.isolating)break}return null}var joinForward$1=function joinForward$1(state,dispatch,view){var $cursor=function atBlockEnd(state,view){var $cursor=state.selection.$cursor;return!$cursor||(view?!view.endOfTextblock("forward",state):$cursor.parentOffset<$cursor.parent.content.size)?null:$cursor}(state,view);if(!$cursor)return!1;var $cut=findCutAfter($cursor);if(!$cut)return!1;var after=$cut.nodeAfter;if(deleteBarrier(state,$cut,dispatch))return!0;if(0==$cursor.parent.content.size&&(textblockAt(after,"start")||NodeSelection.isSelectable(after))){var delStep=replaceStep(state.doc,$cursor.before(),$cursor.after(),Slice.empty);if(delStep&&delStep.slice.size<delStep.to-delStep.from){if(dispatch){var _tr6=state.tr.step(delStep);_tr6.setSelection(textblockAt(after,"start")?Selection.findFrom(_tr6.doc.resolve(_tr6.mapping.map($cut.pos)),1):NodeSelection.create(_tr6.doc,_tr6.mapping.map($cut.pos))),dispatch(_tr6.scrollIntoView())}return!0}}return!(!after.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos,$cut.pos+after.nodeSize).scrollIntoView()),!0)},selectNodeForward$1=function selectNodeForward$1(state,dispatch,view){var _state$selection3=state.selection,$head=_state$selection3.$head,$cut=$head;if(!_state$selection3.empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("forward",state):$head.parentOffset<$head.parent.content.size)return!1;$cut=findCutAfter($head)}var node=$cut&&$cut.nodeAfter;return!(!node||!NodeSelection.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(NodeSelection.create(state.doc,$cut.pos)).scrollIntoView()),!0)};function findCutAfter($pos){if(!$pos.parent.type.spec.isolating)for(var _i374=$pos.depth-1;_i374>=0;_i374--){var parent=$pos.node(_i374);if($pos.index(_i374)+1<parent.childCount)return $pos.doc.resolve($pos.after(_i374+1));if(parent.type.spec.isolating)break}return null}var newlineInCode$1=function newlineInCode$1(state,dispatch){var _state$selection5=state.selection,$head=_state$selection5.$head,$anchor=_state$selection5.$anchor;return!(!$head.parent.type.spec.code||!$head.sameParent($anchor))&&(dispatch&&dispatch(state.tr.insertText("\n").scrollIntoView()),!0)};function defaultBlockAt$1(match){for(var _i376=0;_i376<match.edgeCount;_i376++){var type=match.edge(_i376).type;if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}var exitCode$1=function exitCode$1(state,dispatch){var _state$selection6=state.selection,$head=_state$selection6.$head,$anchor=_state$selection6.$anchor;if(!$head.parent.type.spec.code||!$head.sameParent($anchor))return!1;var above=$head.node(-1),after=$head.indexAfter(-1),type=defaultBlockAt$1(above.contentMatchAt(after));if(!type||!above.canReplaceWith(after,after,type))return!1;if(dispatch){var pos=$head.after(),_tr8=state.tr.replaceWith(pos,pos,type.createAndFill());_tr8.setSelection(Selection.near(_tr8.doc.resolve(pos),1)),dispatch(_tr8.scrollIntoView())}return!0},createParagraphNear$1=function createParagraphNear$1(state,dispatch){var sel=state.selection,$from=sel.$from,$to=sel.$to;if(sel instanceof AllSelection||$from.parent.inlineContent||$to.parent.inlineContent)return!1;var type=defaultBlockAt$1($to.parent.contentMatchAt($to.indexAfter()));if(!type||!type.isTextblock)return!1;if(dispatch){var side=(!$from.parentOffset&&$to.index()<$to.parent.childCount?$from:$to).pos,_tr9=state.tr.insert(side,type.createAndFill());_tr9.setSelection(TextSelection.create(_tr9.doc,side+1)),dispatch(_tr9.scrollIntoView())}return!0},liftEmptyBlock$1=function liftEmptyBlock$1(state,dispatch){var $cursor=state.selection.$cursor;if(!$cursor||$cursor.parent.content.size)return!1;if($cursor.depth>1&&$cursor.after()!=$cursor.end(-1)){var before=$cursor.before();if(canSplit(state.doc,before))return dispatch&&dispatch(state.tr.split(before).scrollIntoView()),!0}var range=$cursor.blockRange(),target=range&&liftTarget(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)};var splitBlock$1=function splitBlockAs(splitNode){return function(state,dispatch){var _state$selection7=state.selection,$from=_state$selection7.$from,$to=_state$selection7.$to;if(state.selection instanceof NodeSelection&&state.selection.node.isBlock)return!(!$from.parentOffset||!canSplit(state.doc,$from.pos))&&(dispatch&&dispatch(state.tr.split($from.pos).scrollIntoView()),!0);if(!$from.parent.isBlock)return!1;if(dispatch){var atEnd=$to.parentOffset==$to.parent.content.size,_tr10=state.tr;(state.selection instanceof TextSelection||state.selection instanceof AllSelection)&&_tr10.deleteSelection();var deflt=0==$from.depth?null:defaultBlockAt$1($from.node(-1).contentMatchAt($from.indexAfter(-1))),splitType=splitNode&&splitNode($to.parent,atEnd),types=splitType?[splitType]:atEnd&&deflt?[{type:deflt}]:void 0,can=canSplit(_tr10.doc,_tr10.mapping.map($from.pos),1,types);if(types||can||!canSplit(_tr10.doc,_tr10.mapping.map($from.pos),1,deflt?[{type:deflt}]:void 0)||(deflt&&(types=[{type:deflt}]),can=!0),can&&(_tr10.split(_tr10.mapping.map($from.pos),1,types),!atEnd&&!$from.parentOffset&&$from.parent.type!=deflt)){var _first6=_tr10.mapping.map($from.before()),$first=_tr10.doc.resolve(_first6);deflt&&$from.node(-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&_tr10.setNodeMarkup(_tr10.mapping.map($from.before()),deflt)}dispatch(_tr10.scrollIntoView())}return!0}}();function deleteBarrier(state,$cut,dispatch){var conn,match,before=$cut.nodeBefore,after=$cut.nodeAfter;if(before.type.spec.isolating||after.type.spec.isolating)return!1;if(function joinMaybeClear(state,$pos,dispatch){var before=$pos.nodeBefore,after=$pos.nodeAfter,index=$pos.index();return!(!(before&&after&&before.type.compatibleContent(after.type))||(!before.content.size&&$pos.parent.canReplace(index-1,index)?(dispatch&&dispatch(state.tr.delete($pos.pos-before.nodeSize,$pos.pos).scrollIntoView()),0):!$pos.parent.canReplace(index,index+1)||!after.isTextblock&&!canJoin(state.doc,$pos.pos)||(dispatch&&dispatch(state.tr.clearIncompatible($pos.pos,before.type,before.contentMatchAt(before.childCount)).join($pos.pos).scrollIntoView()),0)))}(state,$cut,dispatch))return!0;var canDelAfter=$cut.parent.canReplace($cut.index(),$cut.index()+1);if(canDelAfter&&(conn=(match=before.contentMatchAt(before.childCount)).findWrapping(after.type))&&match.matchType(conn[0]||after.type).validEnd){if(dispatch){for(var end=$cut.pos+after.nodeSize,wrap=Fragment.empty,_i378=conn.length-1;_i378>=0;_i378--)wrap=Fragment.from(conn[_i378].create(null,wrap));wrap=Fragment.from(before.copy(wrap));var _tr11=state.tr.step(new ReplaceAroundStep($cut.pos-1,end,$cut.pos,end,new Slice(wrap,1,0),conn.length,!0)),joinAt=end+2*conn.length;canJoin(_tr11.doc,joinAt)&&_tr11.join(joinAt),dispatch(_tr11.scrollIntoView())}return!0}var selAfter=Selection.findFrom($cut,1),range=selAfter&&selAfter.$from.blockRange(selAfter.$to),target=range&&liftTarget(range);if(null!=target&&target>=$cut.depth)return dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0;if(canDelAfter&&textblockAt(after,"start",!0)&&textblockAt(before,"end")){for(var at=before,_wrap5=[];_wrap5.push(at),!at.isTextblock;)at=at.lastChild;for(var afterText=after,afterDepth=1;!afterText.isTextblock;afterText=afterText.firstChild)afterDepth++;if(at.canReplace(at.childCount,at.childCount,afterText.content)){if(dispatch){for(var _end=Fragment.empty,_i380=_wrap5.length-1;_i380>=0;_i380--)_end=Fragment.from(_wrap5[_i380].copy(_end));dispatch(state.tr.step(new ReplaceAroundStep($cut.pos-_wrap5.length,$cut.pos+after.nodeSize,$cut.pos+afterDepth,$cut.pos+after.nodeSize-afterDepth,new Slice(_end,_wrap5.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function selectTextblockSide(side){return function(state,dispatch){for(var sel=state.selection,$pos=side<0?sel.$from:sel.$to,depth=$pos.depth;$pos.node(depth).isInline;){if(!depth)return!1;depth--}return!!$pos.node(depth).isTextblock&&(dispatch&&dispatch(state.tr.setSelection(TextSelection.create(state.doc,side<0?$pos.start(depth):$pos.end(depth)))),!0)}}var selectTextblockStart$1=selectTextblockSide(-1),selectTextblockEnd$1=selectTextblockSide(1);function setBlockType(nodeType){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(state,dispatch){for(var applicable=!1,_i382=0;_i382<state.selection.ranges.length&&!applicable;_i382++){var _state$selection$rang=state.selection.ranges[_i382],from=_state$selection$rang.$from.pos,to=_state$selection$rang.$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){if(applicable)return!1;if(node.isTextblock&&!node.hasMarkup(nodeType,attrs))if(node.type==nodeType)applicable=!0;else{var $pos=state.doc.resolve(pos),index=$pos.index();applicable=$pos.parent.canReplaceWith(index,index+1,nodeType)}}))}if(!applicable)return!1;if(dispatch){for(var _tr13=state.tr,_i384=0;_i384<state.selection.ranges.length;_i384++){var _state$selection$rang2=state.selection.ranges[_i384],_from3=_state$selection$rang2.$from.pos,_to2=_state$selection$rang2.$to.pos;_tr13.setBlockType(_from3,_to2,nodeType,attrs)}dispatch(_tr13.scrollIntoView())}return!0}}function chainCommands(){for(var _len=arguments.length,commands=new Array(_len),_key=0;_key<_len;_key++)commands[_key]=arguments[_key];return function(state,dispatch,view){for(var _i386=0;_i386<commands.length;_i386++)if(commands[_i386](state,dispatch,view))return!0;return!1}}var backspace=chainCommands(deleteSelection$1,joinBackward$1,selectNodeBackward$1),del=chainCommands(deleteSelection$1,joinForward$1,selectNodeForward$1),pcBaseKeymap={Enter:chainCommands(newlineInCode$1,createParagraphNear$1,liftEmptyBlock$1,splitBlock$1),"Mod-Enter":exitCode$1,Backspace:backspace,"Mod-Backspace":backspace,"Shift-Backspace":backspace,Delete:del,"Mod-Delete":del,"Mod-a":function selectAll$1(state,dispatch){return dispatch&&dispatch(state.tr.setSelection(new AllSelection(state.doc))),!0}},macBaseKeymap={"Ctrl-h":pcBaseKeymap.Backspace,"Alt-Backspace":pcBaseKeymap["Mod-Backspace"],"Ctrl-d":pcBaseKeymap.Delete,"Ctrl-Alt-Backspace":pcBaseKeymap["Mod-Delete"],"Alt-Delete":pcBaseKeymap["Mod-Delete"],"Alt-d":pcBaseKeymap["Mod-Delete"],"Ctrl-a":selectTextblockStart$1,"Ctrl-e":selectTextblockEnd$1};for(var key in pcBaseKeymap)macBaseKeymap[key]=pcBaseKeymap[key];function wrapInList$1(listType){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(state,dispatch){var _state$selection10=state.selection,$from=_state$selection10.$from,$to=_state$selection10.$to,range=$from.blockRange($to),doJoin=!1,outerRange=range;if(!range)return!1;if(range.depth>=2&&$from.node(range.depth-1).type.compatibleContent(listType)&&0==range.startIndex){if(0==$from.index(range.depth-1))return!1;var $insert=state.doc.resolve(range.start-2);outerRange=new NodeRange($insert,$insert,range.depth),range.endIndex<range.parent.childCount&&(range=new NodeRange($from,state.doc.resolve($to.end(range.depth)),range.depth)),doJoin=!0}var wrap=findWrapping(outerRange,listType,attrs,range);return!!wrap&&(dispatch&&dispatch(function doWrapInList(tr,range,wrappers,joinBefore,listType){for(var content=Fragment.empty,_i388=wrappers.length-1;_i388>=0;_i388--)content=Fragment.from(wrappers[_i388].type.create(wrappers[_i388].attrs,content));tr.step(new ReplaceAroundStep(range.start-(joinBefore?2:0),range.end,range.start,range.end,new Slice(content,0,0),wrappers.length,!0));for(var found=0,_i390=0;_i390<wrappers.length;_i390++)wrappers[_i390].type==listType&&(found=_i390+1);for(var splitDepth=wrappers.length-found,splitPos=range.start+wrappers.length-(joinBefore?2:0),parent=range.parent,_i392=range.startIndex,e=range.endIndex,_first8=!0;_i392<e;_i392++,_first8=!1)!_first8&&canSplit(tr.doc,splitPos,splitDepth)&&(tr.split(splitPos,splitDepth),splitPos+=2*splitDepth),splitPos+=parent.child(_i392).nodeSize;return tr}(state.tr,range,wrap,doJoin,listType).scrollIntoView()),!0)}}function liftListItem$1(itemType){return function(state,dispatch){var _state$selection11=state.selection,$from=_state$selection11.$from,$to=_state$selection11.$to,range=$from.blockRange($to,(function(node){return node.childCount>0&&node.firstChild.type==itemType}));return!!range&&(!dispatch||($from.node(range.depth-1).type==itemType?function liftToOuterList(state,dispatch,itemType,range){var tr=state.tr,end=range.end,endOfList=range.$to.end(range.depth);end<endOfList&&(tr.step(new ReplaceAroundStep(end-1,endOfList,end,endOfList,new Slice(Fragment.from(itemType.create(null,range.parent.copy())),1,0),1,!0)),range=new NodeRange(tr.doc.resolve(range.$from.pos),tr.doc.resolve(endOfList),range.depth));var target=liftTarget(range);if(null==target)return!1;tr.lift(range,target);var after=tr.mapping.map(end,-1)-1;canJoin(tr.doc,after)&&tr.join(after);return dispatch(tr.scrollIntoView()),!0}(state,dispatch,itemType,range):function liftOutOfList(state,dispatch,range){for(var tr=state.tr,list=range.parent,pos=range.end,_i394=range.endIndex-1,e=range.startIndex;_i394>e;_i394--)pos-=list.child(_i394).nodeSize,tr.delete(pos-1,pos+1);var $start=tr.doc.resolve(range.start),item=$start.nodeAfter;if(tr.mapping.map(range.end)!=range.start+$start.nodeAfter.nodeSize)return!1;var atStart=0==range.startIndex,atEnd=range.endIndex==list.childCount,parent=$start.node(-1),indexBefore=$start.index(-1);if(!parent.canReplace(indexBefore+(atStart?0:1),indexBefore+1,item.content.append(atEnd?Fragment.empty:Fragment.from(list))))return!1;var start=$start.pos,end=start+item.nodeSize;return tr.step(new ReplaceAroundStep(start-(atStart?1:0),end+(atEnd?1:0),start+1,end-1,new Slice((atStart?Fragment.empty:Fragment.from(list.copy(Fragment.empty))).append(atEnd?Fragment.empty:Fragment.from(list.copy(Fragment.empty))),atStart?0:1,atEnd?0:1),atStart?0:1)),dispatch(tr.scrollIntoView()),!0}(state,dispatch,range)))}}function createChainableState(config){var state=config.state,transaction=config.transaction,selection=transaction.selection,doc=transaction.doc,storedMarks=transaction.storedMarks;return Object.assign({},state,{apply:state.apply.bind(state),applyTransaction:state.applyTransaction.bind(state),filterTransaction:state.filterTransaction,plugins:state.plugins,schema:state.schema,reconfigure:state.reconfigure.bind(state),toJSON:state.toJSON.bind(state),get storedMarks(){return storedMarks},get selection(){return selection},get doc(){return doc},get tr(){return selection=transaction.selection,doc=transaction.doc,storedMarks=transaction.storedMarks,transaction}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();var CommandManager=function(){function CommandManager(props){_classCallCheck(this,CommandManager),this.editor=props.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=props.state}return _createClass(CommandManager,[{key:"hasCustomState",get:function get(){return!!this.customState}},{key:"state",get:function get(){return this.customState||this.editor.state}},{key:"commands",get:function get(){var _this38=this,rawCommands=this.rawCommands,editor=this.editor,state=this.state,view=editor.view,tr=state.tr,props=this.buildProps(tr);return Object.fromEntries(Object.entries(rawCommands).map((function(_ref7){var _ref8=_slicedToArray(_ref7,2),name=_ref8[0],command=_ref8[1];return[name,function method(){var callback=command.apply(void 0,arguments)(props);return tr.getMeta("preventDispatch")||_this38.hasCustomState||view.dispatch(tr),callback}]})))}},{key:"chain",get:function get(){var _this39=this;return function(){return _this39.createChain()}}},{key:"can",get:function get(){var _this40=this;return function(){return _this40.createCan()}}},{key:"createChain",value:function createChain(startTr){var _this41=this,shouldDispatch=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],rawCommands=this.rawCommands,editor=this.editor,state=this.state,view=editor.view,callbacks=[],hasStartTransaction=!!startTr,tr=startTr||state.tr,chain=Object.assign({},Object.fromEntries(Object.entries(rawCommands).map((function(_ref9){var _ref10=_slicedToArray(_ref9,2),name=_ref10[0],command=_ref10[1];return[name,function chainedCommand(){var props=_this41.buildProps(tr,shouldDispatch),callback=command.apply(void 0,arguments)(props);return callbacks.push(callback),chain}]}))),{run:function run(){return hasStartTransaction||!shouldDispatch||tr.getMeta("preventDispatch")||_this41.hasCustomState||view.dispatch(tr),callbacks.every((function(callback){return!0===callback}))}});return chain}},{key:"createCan",value:function createCan(startTr){var _this42=this,rawCommands=this.rawCommands,state=this.state,tr=startTr||state.tr,props=this.buildProps(tr,false),formattedCommands=Object.fromEntries(Object.entries(rawCommands).map((function(_ref11){var _ref12=_slicedToArray(_ref11,2),name=_ref12[0],command=_ref12[1];return[name,function(){return command.apply(void 0,arguments)(Object.assign({},props,{dispatch:void 0}))}]})));return Object.assign({},formattedCommands,{chain:function chain(){return _this42.createChain(tr,false)}})}},{key:"buildProps",value:function buildProps(tr){var _this43=this,shouldDispatch=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],rawCommands=this.rawCommands,editor=this.editor,state=this.state,view=editor.view,props={tr,editor,view,state:createChainableState({state,transaction:tr}),dispatch:shouldDispatch?function(){}:void 0,chain:function chain(){return _this43.createChain(tr,shouldDispatch)},can:function can(){return _this43.createCan(tr)},get commands(){return Object.fromEntries(Object.entries(rawCommands).map((function(_ref13){var _ref14=_slicedToArray(_ref13,2),name=_ref14[0],command=_ref14[1];return[name,function(){return command.apply(void 0,arguments)(props)}]})))}};return props}}]),CommandManager}(),EventEmitter=function(){function EventEmitter(){_classCallCheck(this,EventEmitter),this.callbacks={}}return _createClass(EventEmitter,[{key:"on",value:function on(event,fn){return this.callbacks[event]||(this.callbacks[event]=[]),this.callbacks[event].push(fn),this}},{key:"emit",value:function emit(event){for(var _this44=this,_len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];var callbacks=this.callbacks[event];return callbacks&&callbacks.forEach((function(callback){return callback.apply(_this44,args)})),this}},{key:"off",value:function off(event,fn){var callbacks=this.callbacks[event];return callbacks&&(fn?this.callbacks[event]=callbacks.filter((function(callback){return callback!==fn})):delete this.callbacks[event]),this}},{key:"removeAllListeners",value:function removeAllListeners(){this.callbacks={}}}]),EventEmitter}();function getExtensionField(extension,field,context){return void 0===extension.config[field]&&extension.parent?getExtensionField(extension.parent,field,context):"function"==typeof extension.config[field]?extension.config[field].bind(Object.assign({},context,{parent:extension.parent?getExtensionField(extension.parent,field,context):null})):extension.config[field]}function splitExtensions(extensions){return{baseExtensions:extensions.filter((function(extension){return"extension"===extension.type})),nodeExtensions:extensions.filter((function(extension){return"node"===extension.type})),markExtensions:extensions.filter((function(extension){return"mark"===extension.type}))}}function getAttributesFromExtensions(extensions){var extensionAttributes=[],_splitExtensions=splitExtensions(extensions),nodeExtensions=_splitExtensions.nodeExtensions,markExtensions=_splitExtensions.markExtensions,nodeAndMarkExtensions=[].concat(_toConsumableArray(nodeExtensions),_toConsumableArray(markExtensions)),defaultAttribute={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return extensions.forEach((function(extension){var addGlobalAttributes=getExtensionField(extension,"addGlobalAttributes",{name:extension.name,options:extension.options,storage:extension.storage});addGlobalAttributes&&addGlobalAttributes().forEach((function(globalAttribute){globalAttribute.types.forEach((function(type){Object.entries(globalAttribute.attributes).forEach((function(_ref15){var _ref16=_slicedToArray(_ref15,2),name=_ref16[0],attribute=_ref16[1];extensionAttributes.push({type,name,attribute:Object.assign({},defaultAttribute,attribute)})}))}))}))})),nodeAndMarkExtensions.forEach((function(extension){var context={name:extension.name,options:extension.options,storage:extension.storage},addAttributes=getExtensionField(extension,"addAttributes",context);if(addAttributes){var attributes=addAttributes();Object.entries(attributes).forEach((function(_ref17){var _ref18=_slicedToArray(_ref17,2),name=_ref18[0],attribute=_ref18[1],mergedAttr=Object.assign({},defaultAttribute,attribute);"function"==typeof(null==mergedAttr?void 0:mergedAttr.default)&&(mergedAttr.default=mergedAttr.default()),(null==mergedAttr?void 0:mergedAttr.isRequired)&&void 0===(null==mergedAttr?void 0:mergedAttr.default)&&delete mergedAttr.default,extensionAttributes.push({type:extension.name,name,attribute:mergedAttr})}))}})),extensionAttributes}function getNodeType(nameOrType,schema){if("string"==typeof nameOrType){if(!schema.nodes[nameOrType])throw Error("There is no node type named '"+nameOrType+"'. Maybe you forgot to add the extension?");return schema.nodes[nameOrType]}return nameOrType}function mergeAttributes(){for(var _len3=arguments.length,objects=new Array(_len3),_key3=0;_key3<_len3;_key3++)objects[_key3]=arguments[_key3];return objects.filter((function(item){return!!item})).reduce((function(items,item){var mergedAttributes=Object.assign({},items);return Object.entries(item).forEach((function(_ref19){var _ref20=_slicedToArray(_ref19,2),key=_ref20[0],value=_ref20[1];if(mergedAttributes[key])if("class"===key){var valueClasses=value?value.split(" "):[],existingClasses=mergedAttributes[key]?mergedAttributes[key].split(" "):[],insertClasses=valueClasses.filter((function(valueClass){return!existingClasses.includes(valueClass)}));mergedAttributes[key]=[].concat(_toConsumableArray(existingClasses),_toConsumableArray(insertClasses)).join(" ")}else mergedAttributes[key]="style"===key?[mergedAttributes[key],value].join("; "):value;else mergedAttributes[key]=value})),mergedAttributes}),{})}function getRenderedAttributes(nodeOrMark,extensionAttributes){return extensionAttributes.filter((function(item){return item.attribute.rendered})).map((function(item){var _ref21;return item.attribute.renderHTML?item.attribute.renderHTML(nodeOrMark.attrs)||{}:((_ref21={})[item.name]=nodeOrMark.attrs[item.name],_ref21)})).reduce((function(attributes,attribute){return mergeAttributes(attributes,attribute)}),{})}function isFunction$1(value){return"function"==typeof value}function callOrReturn(value){var context=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(isFunction$1(value)){for(var _len4=arguments.length,props=new Array(_len4>2?_len4-2:0),_key4=2;_key4<_len4;_key4++)props[_key4-2]=arguments[_key4];return context?value.bind(context).apply(void 0,props):value.apply(void 0,props)}return value}function injectExtensionAttributesToParseRule(parseRule,extensionAttributes){return parseRule.style?parseRule:Object.assign({},parseRule,{getAttrs:function getAttrs(node){var oldAttributes=parseRule.getAttrs?parseRule.getAttrs(node):parseRule.attrs;if(!1===oldAttributes)return!1;var newAttributes=extensionAttributes.reduce((function(items,item){var _Object$assign,value=item.attribute.parseHTML?item.attribute.parseHTML(node):function fromString(value){return"string"!=typeof value?value:value.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(value):"true"===value||"false"!==value&&value}(node.getAttribute(item.name));return null==value?items:Object.assign({},items,((_Object$assign={})[item.name]=value,_Object$assign))}),{});return Object.assign({},oldAttributes,newAttributes)}})}function cleanUpSchemaItem(data){return Object.fromEntries(Object.entries(data).filter((function(_ref22){var _ref23=_slicedToArray(_ref22,2),key=_ref23[0],value=_ref23[1];return("attrs"!==key||!function isEmptyObject(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(value).length&&value.constructor===Object}(value))&&null!=value})))}function getSchemaTypeByName(name,schema){return schema.nodes[name]||schema.marks[name]||null}function isExtensionRulesEnabled(extension,enabled){return Array.isArray(enabled)?enabled.some((function(enabledExtension){return("string"==typeof enabledExtension?enabledExtension:enabledExtension.name)===extension.name})):enabled}var getTextContentFromNodes=function getTextContentFromNodes($from){var maxMatch=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,textBefore="",sliceEndPos=$from.parentOffset;return $from.parent.nodesBetween(Math.max(0,sliceEndPos-maxMatch),sliceEndPos,(function(node,pos,parent,index){var _a,_b,chunk=(null===(_b=(_a=node.type.spec).toText)||void 0===_b?void 0:_b.call(_a,{node,pos,parent,index}))||node.textContent||"%leaf%";textBefore+=chunk.slice(0,Math.max(0,sliceEndPos-pos))})),textBefore};function isRegExp$1(value){return"[object RegExp]"===Object.prototype.toString.call(value)}var InputRule=_createClass((function InputRule(config){_classCallCheck(this,InputRule),this.find=config.find,this.handler=config.handler})),inputRuleMatcherHandler=function inputRuleMatcherHandler(text,find){if(isRegExp$1(find))return find.exec(text);var inputRuleMatch=find(text);if(!inputRuleMatch)return null;var result=[inputRuleMatch.text];return result.index=inputRuleMatch.index,result.input=text,result.data=inputRuleMatch.data,inputRuleMatch.replaceWith&&(inputRuleMatch.text.includes(inputRuleMatch.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),result.push(inputRuleMatch.replaceWith)),result};function run$1$1(config){var _a,editor=config.editor,from=config.from,to=config.to,text=config.text,rules=config.rules,plugin=config.plugin,view=editor.view;if(view.composing)return!1;var $from=view.state.doc.resolve(from);if($from.parent.type.spec.code||(null===(_a=$from.nodeBefore||$from.nodeAfter)||void 0===_a?void 0:_a.marks.find((function(mark){return mark.type.spec.code}))))return!1;var matched=!1,textBefore=getTextContentFromNodes($from)+text;return rules.forEach((function(rule){if(!matched){var match=inputRuleMatcherHandler(textBefore,rule.find);if(match){var tr=view.state.tr,state=createChainableState({state:view.state,transaction:tr}),range={from:from-(match[0].length-text.length),to},_CommandManager=new CommandManager({editor,state}),commands=_CommandManager.commands,chain=_CommandManager.chain,can=_CommandManager.can;null!==rule.handler({state,range,match,commands,chain,can})&&tr.steps.length&&(tr.setMeta(plugin,{transform:tr,from,to,text}),view.dispatch(tr),matched=!0)}}})),matched}function inputRulesPlugin(props){var editor=props.editor,rules=props.rules,plugin=new Plugin({state:{init:function init(){return null},apply:function apply(tr,prev){var stored=tr.getMeta(plugin);return stored||(tr.selectionSet||tr.docChanged?null:prev)}},props:{handleTextInput:function handleTextInput(view,from,to,text){return run$1$1({editor,from,to,text,rules,plugin})},handleDOMEvents:{compositionend:function compositionend(view){return setTimeout((function(){var $cursor=view.state.selection.$cursor;$cursor&&run$1$1({editor,from:$cursor.pos,to:$cursor.pos,text:"",rules,plugin})})),!1}},handleKeyDown:function handleKeyDown(view,event){if("Enter"!==event.key)return!1;var $cursor=view.state.selection.$cursor;return!!$cursor&&run$1$1({editor,from:$cursor.pos,to:$cursor.pos,text:"\n",rules,plugin})}},isInputRules:!0});return plugin}var PasteRule=_createClass((function PasteRule(config){_classCallCheck(this,PasteRule),this.find=config.find,this.handler=config.handler})),pasteRuleMatcherHandler=function pasteRuleMatcherHandler(text,find){if(isRegExp$1(find))return _toConsumableArray(text.matchAll(find));var matches=find(text);return matches?matches.map((function(pasteRuleMatch){var result=[pasteRuleMatch.text];return result.index=pasteRuleMatch.index,result.input=text,result.data=pasteRuleMatch.data,pasteRuleMatch.replaceWith&&(pasteRuleMatch.text.includes(pasteRuleMatch.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),result.push(pasteRuleMatch.replaceWith)),result})):[]};function pasteRulesPlugin(props){var editor=props.editor,rules=props.rules,dragSourceElement=null,isPastedFromProseMirror=!1,isDroppedFromProseMirror=!1,pasteEvent=new ClipboardEvent("paste"),dropEvent=new DragEvent("drop"),plugins=rules.map((function(rule){return new Plugin({view:function view(_view2){var handleDragstart=function handleDragstart(event){var _a;dragSourceElement=(null===(_a=_view2.dom.parentElement)||void 0===_a?void 0:_a.contains(event.target))?_view2.dom.parentElement:null};return window.addEventListener("dragstart",handleDragstart),{destroy:function destroy(){window.removeEventListener("dragstart",handleDragstart)}}},props:{handleDOMEvents:{drop:function drop(view,event){return isDroppedFromProseMirror=dragSourceElement===view.dom.parentElement,dropEvent=event,!1},paste:function paste(_view,event){var _a,html=null===(_a=event.clipboardData)||void 0===_a?void 0:_a.getData("text/html");return pasteEvent=event,isPastedFromProseMirror=!!(null==html?void 0:html.includes("data-pm-slice")),!1}}},appendTransaction:function appendTransaction(transactions,oldState,state){var transaction=transactions[0],isPaste="paste"===transaction.getMeta("uiEvent")&&!isPastedFromProseMirror,isDrop="drop"===transaction.getMeta("uiEvent")&&!isDroppedFromProseMirror;if(isPaste||isDrop){var from=oldState.doc.content.findDiffStart(state.doc.content),to=oldState.doc.content.findDiffEnd(state.doc.content);if(function isNumber(value){return"number"==typeof value}(from)&&to&&from!==to.b){var tr=state.tr,chainableState=createChainableState({state,transaction:tr}),handler=function run$2(config){var editor=config.editor,state=config.state,from=config.from,to=config.to,rule=config.rule,pasteEvent=config.pasteEvent,dropEvent=config.dropEvent,_CommandManager2=new CommandManager({editor,state}),commands=_CommandManager2.commands,chain=_CommandManager2.chain,can=_CommandManager2.can,handlers=[];return state.doc.nodesBetween(from,to,(function(node,pos){if(node.isTextblock&&!node.type.spec.code){var resolvedFrom=Math.max(from,pos),resolvedTo=Math.min(to,pos+node.content.size),textToMatch=node.textBetween(resolvedFrom-pos,resolvedTo-pos,void 0,"￼");pasteRuleMatcherHandler(textToMatch,rule.find).forEach((function(match){if(void 0!==match.index){var start=resolvedFrom+match.index+1,end=start+match[0].length,range={from:state.tr.mapping.map(start),to:state.tr.mapping.map(end)},handler=rule.handler({state,range,match,commands,chain,can,pasteEvent,dropEvent});handlers.push(handler)}}))}})),handlers.every((function(handler){return null!==handler}))}({editor,state:chainableState,from:Math.max(from-1,0),to:to.b-1,rule,pasteEvent,dropEvent});if(handler&&tr.steps.length)return dropEvent=new DragEvent("drop"),pasteEvent=new ClipboardEvent("paste"),tr}}}})}));return plugins}var ExtensionManager=function(){function ExtensionManager(extensions,editor){var _this45=this;_classCallCheck(this,ExtensionManager),this.splittableMarks=[],this.editor=editor,this.extensions=ExtensionManager.resolve(extensions),this.schema=function getSchemaByResolvedExtensions(extensions,editor){var _a,allAttributes=getAttributesFromExtensions(extensions),_splitExtensions2=splitExtensions(extensions),nodeExtensions=_splitExtensions2.nodeExtensions,markExtensions=_splitExtensions2.markExtensions,topNode=null===(_a=nodeExtensions.find((function(extension){return getExtensionField(extension,"topNode")})))||void 0===_a?void 0:_a.name,nodes=Object.fromEntries(nodeExtensions.map((function(extension){var extensionAttributes=allAttributes.filter((function(attribute){return attribute.type===extension.name})),context={name:extension.name,options:extension.options,storage:extension.storage,editor},extraNodeFields=extensions.reduce((function(fields,e){var extendNodeSchema=getExtensionField(e,"extendNodeSchema",context);return Object.assign({},fields,extendNodeSchema?extendNodeSchema(extension):{})}),{}),schema=cleanUpSchemaItem(Object.assign({},extraNodeFields,{content:callOrReturn(getExtensionField(extension,"content",context)),marks:callOrReturn(getExtensionField(extension,"marks",context)),group:callOrReturn(getExtensionField(extension,"group",context)),inline:callOrReturn(getExtensionField(extension,"inline",context)),atom:callOrReturn(getExtensionField(extension,"atom",context)),selectable:callOrReturn(getExtensionField(extension,"selectable",context)),draggable:callOrReturn(getExtensionField(extension,"draggable",context)),code:callOrReturn(getExtensionField(extension,"code",context)),defining:callOrReturn(getExtensionField(extension,"defining",context)),isolating:callOrReturn(getExtensionField(extension,"isolating",context)),attrs:Object.fromEntries(extensionAttributes.map((function(extensionAttribute){var _a;return[extensionAttribute.name,{default:null===(_a=null==extensionAttribute?void 0:extensionAttribute.attribute)||void 0===_a?void 0:_a.default}]})))})),parseHTML=callOrReturn(getExtensionField(extension,"parseHTML",context));parseHTML&&(schema.parseDOM=parseHTML.map((function(parseRule){return injectExtensionAttributesToParseRule(parseRule,extensionAttributes)})));var renderHTML=getExtensionField(extension,"renderHTML",context);renderHTML&&(schema.toDOM=function(node){return renderHTML({node,HTMLAttributes:getRenderedAttributes(node,extensionAttributes)})});var renderText=getExtensionField(extension,"renderText",context);return renderText&&(schema.toText=renderText),[extension.name,schema]}))),marks=Object.fromEntries(markExtensions.map((function(extension){var extensionAttributes=allAttributes.filter((function(attribute){return attribute.type===extension.name})),context={name:extension.name,options:extension.options,storage:extension.storage,editor},extraMarkFields=extensions.reduce((function(fields,e){var extendMarkSchema=getExtensionField(e,"extendMarkSchema",context);return Object.assign({},fields,extendMarkSchema?extendMarkSchema(extension):{})}),{}),schema=cleanUpSchemaItem(Object.assign({},extraMarkFields,{inclusive:callOrReturn(getExtensionField(extension,"inclusive",context)),excludes:callOrReturn(getExtensionField(extension,"excludes",context)),group:callOrReturn(getExtensionField(extension,"group",context)),spanning:callOrReturn(getExtensionField(extension,"spanning",context)),code:callOrReturn(getExtensionField(extension,"code",context)),attrs:Object.fromEntries(extensionAttributes.map((function(extensionAttribute){var _a;return[extensionAttribute.name,{default:null===(_a=null==extensionAttribute?void 0:extensionAttribute.attribute)||void 0===_a?void 0:_a.default}]})))})),parseHTML=callOrReturn(getExtensionField(extension,"parseHTML",context));parseHTML&&(schema.parseDOM=parseHTML.map((function(parseRule){return injectExtensionAttributesToParseRule(parseRule,extensionAttributes)})));var renderHTML=getExtensionField(extension,"renderHTML",context);return renderHTML&&(schema.toDOM=function(mark){return renderHTML({mark,HTMLAttributes:getRenderedAttributes(mark,extensionAttributes)})}),[extension.name,schema]})));return new Schema({topNode,nodes,marks})}(this.extensions,editor),this.extensions.forEach((function(extension){var _a;_this45.editor.extensionStorage[extension.name]=extension.storage;var context={name:extension.name,options:extension.options,storage:extension.storage,editor:_this45.editor,type:getSchemaTypeByName(extension.name,_this45.schema)};"mark"===extension.type&&((null===(_a=callOrReturn(getExtensionField(extension,"keepOnSplit",context)))||void 0===_a||_a)&&_this45.splittableMarks.push(extension.name));var onBeforeCreate=getExtensionField(extension,"onBeforeCreate",context);onBeforeCreate&&_this45.editor.on("beforeCreate",onBeforeCreate);var onCreate=getExtensionField(extension,"onCreate",context);onCreate&&_this45.editor.on("create",onCreate);var onUpdate=getExtensionField(extension,"onUpdate",context);onUpdate&&_this45.editor.on("update",onUpdate);var onSelectionUpdate=getExtensionField(extension,"onSelectionUpdate",context);onSelectionUpdate&&_this45.editor.on("selectionUpdate",onSelectionUpdate);var onTransaction=getExtensionField(extension,"onTransaction",context);onTransaction&&_this45.editor.on("transaction",onTransaction);var onFocus=getExtensionField(extension,"onFocus",context);onFocus&&_this45.editor.on("focus",onFocus);var onBlur=getExtensionField(extension,"onBlur",context);onBlur&&_this45.editor.on("blur",onBlur);var onDestroy=getExtensionField(extension,"onDestroy",context);onDestroy&&_this45.editor.on("destroy",onDestroy)}))}return _createClass(ExtensionManager,[{key:"commands",get:function get(){var _this46=this;return this.extensions.reduce((function(commands,extension){var addCommands=getExtensionField(extension,"addCommands",{name:extension.name,options:extension.options,storage:extension.storage,editor:_this46.editor,type:getSchemaTypeByName(extension.name,_this46.schema)});return addCommands?Object.assign({},commands,addCommands()):commands}),{})}},{key:"plugins",get:function get(){var _this47=this,editor=this.editor,extensions=ExtensionManager.sort(_toConsumableArray(this.extensions).reverse()),inputRules=[],pasteRules=[],allPlugins=extensions.map((function(extension){var context={name:extension.name,options:extension.options,storage:extension.storage,editor,type:getSchemaTypeByName(extension.name,_this47.schema)},plugins=[],addKeyboardShortcuts=getExtensionField(extension,"addKeyboardShortcuts",context),defaultBindings={};if("mark"===extension.type&&extension.config.exitable&&(defaultBindings.ArrowRight=function(){return Mark.handleExit({editor,mark:extension})}),addKeyboardShortcuts){var bindings=Object.fromEntries(Object.entries(addKeyboardShortcuts()).map((function(_ref24){var _ref25=_slicedToArray(_ref24,2),shortcut=_ref25[0],method=_ref25[1];return[shortcut,function(){return method({editor})}]})));defaultBindings=Object.assign({},defaultBindings,bindings)}var keyMapPlugin=function keymap(bindings){return new Plugin({props:{handleKeyDown:keydownHandler(bindings)}})}(defaultBindings);plugins.push(keyMapPlugin);var addInputRules=getExtensionField(extension,"addInputRules",context);isExtensionRulesEnabled(extension,editor.options.enableInputRules)&&addInputRules&&inputRules.push.apply(inputRules,_toConsumableArray(addInputRules()));var addPasteRules=getExtensionField(extension,"addPasteRules",context);isExtensionRulesEnabled(extension,editor.options.enablePasteRules)&&addPasteRules&&pasteRules.push.apply(pasteRules,_toConsumableArray(addPasteRules()));var addProseMirrorPlugins=getExtensionField(extension,"addProseMirrorPlugins",context);if(addProseMirrorPlugins){var proseMirrorPlugins=addProseMirrorPlugins();plugins.push.apply(plugins,_toConsumableArray(proseMirrorPlugins))}return plugins})).flat();return[inputRulesPlugin({editor,rules:inputRules})].concat(_toConsumableArray(pasteRulesPlugin({editor,rules:pasteRules})),_toConsumableArray(allPlugins))}},{key:"attributes",get:function get(){return getAttributesFromExtensions(this.extensions)}},{key:"nodeViews",get:function get(){var _this48=this,editor=this.editor,nodeExtensions=splitExtensions(this.extensions).nodeExtensions;return Object.fromEntries(nodeExtensions.filter((function(extension){return!!getExtensionField(extension,"addNodeView")})).map((function(extension){var extensionAttributes=_this48.attributes.filter((function(attribute){return attribute.type===extension.name})),context={name:extension.name,options:extension.options,storage:extension.storage,editor,type:getNodeType(extension.name,_this48.schema)},addNodeView=getExtensionField(extension,"addNodeView",context);if(!addNodeView)return[];return[extension.name,function nodeview(node,view,getPos,decorations){var HTMLAttributes=getRenderedAttributes(node,extensionAttributes);return addNodeView()({editor,node,getPos,decorations,HTMLAttributes,extension})}]})))}}],[{key:"resolve",value:function resolve(extensions){var resolvedExtensions=ExtensionManager.sort(ExtensionManager.flatten(extensions)),duplicatedNames=function findDuplicates(items){var filtered=items.filter((function(el,index){return items.indexOf(el)!==index}));return _toConsumableArray(new Set(filtered))}(resolvedExtensions.map((function(extension){return extension.name})));return duplicatedNames.length&&console.warn("[tiptap warn]: Duplicate extension names found: ["+duplicatedNames.map((function(item){return"'"+item+"'"})).join(", ")+"]. This can lead to issues."),resolvedExtensions}},{key:"flatten",value:function flatten(extensions){var _this49=this;return extensions.map((function(extension){var addExtensions=getExtensionField(extension,"addExtensions",{name:extension.name,options:extension.options,storage:extension.storage});return addExtensions?[extension].concat(_toConsumableArray(_this49.flatten(addExtensions()))):extension})).flat(10)}},{key:"sort",value:function sort(extensions){return extensions.sort((function(a,b){var priorityA=getExtensionField(a,"priority")||100,priorityB=getExtensionField(b,"priority")||100;return priorityA>priorityB?-1:priorityA<priorityB?1:0}))}}]),ExtensionManager}();function isPlainObject(value){return"Object"===function getType(value){return Object.prototype.toString.call(value).slice(8,-1)}(value)&&(value.constructor===Object&&Object.getPrototypeOf(value)===Object.prototype)}function mergeDeep(target,source){var output=Object.assign({},target);return isPlainObject(target)&&isPlainObject(source)&&Object.keys(source).forEach((function(key){var _Object$assign2,_Object$assign3;isPlainObject(source[key])?key in target?output[key]=mergeDeep(target[key],source[key]):Object.assign(output,((_Object$assign2={})[key]=source[key],_Object$assign2)):Object.assign(output,((_Object$assign3={})[key]=source[key],_Object$assign3))})),output}var Extension=function(){function Extension(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Extension),this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Object.assign({},this.config,config),this.name=this.config.name,config.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+this.name+'".'),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}return _createClass(Extension,[{key:"configure",value:function configure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}},{key:"extend",value:function extend(){var extendedConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=new Extension(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+extension.name+'".'),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}],[{key:"create",value:function create(){return new Extension(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}}]),Extension}();function getTextBetween(startNode,range,options){var from=range.from,to=range.to,_ref26=options||{},_ref26$blockSeparator=_ref26.blockSeparator,blockSeparator=void 0===_ref26$blockSeparator?"\n\n":_ref26$blockSeparator,_ref26$textSerializer=_ref26.textSerializers,textSerializers=void 0===_ref26$textSerializer?{}:_ref26$textSerializer,text="",separated=!0;return startNode.nodesBetween(from,to,(function(node,pos,parent,index){var _a,textSerializer=null==textSerializers?void 0:textSerializers[node.type.name];textSerializer?(node.isBlock&&!separated&&(text+=blockSeparator,separated=!0),parent&&(text+=textSerializer({node,pos,parent,index,range}))):node.isText?(text+=null===(_a=null==node?void 0:node.text)||void 0===_a?void 0:_a.slice(Math.max(from,pos)-pos,to-pos),separated=!1):node.isBlock&&!separated&&(text+=blockSeparator,separated=!0)})),text}function getTextSerializersFromSchema(schema){return Object.fromEntries(Object.entries(schema.nodes).filter((function(_ref27){return _slicedToArray(_ref27,2)[1].spec.toText})).map((function(_ref29){var _ref30=_slicedToArray(_ref29,2);return[_ref30[0],_ref30[1].spec.toText]})))}var ClipboardTextSerializer=Extension.create({name:"clipboardTextSerializer",addProseMirrorPlugins:function addProseMirrorPlugins(){var _this50=this;return[new Plugin({key:new PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:function clipboardTextSerializer(){var editor=_this50.editor,state=editor.state,schema=editor.schema,doc=state.doc,ranges=state.selection.ranges,from=Math.min.apply(Math,_toConsumableArray(ranges.map((function(range){return range.$from.pos})))),to=Math.max.apply(Math,_toConsumableArray(ranges.map((function(range){return range.$to.pos}))));return getTextBetween(doc,{from,to},{textSerializers:getTextSerializersFromSchema(schema)})}}})]}});function objectIncludes(object1,object2){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0},keys=Object.keys(object2);return!keys.length||keys.every((function(key){return options.strict?object2[key]===object1[key]:isRegExp$1(object2[key])?object2[key].test(object1[key]):object2[key]===object1[key]}))}function findMarkInSet(marks,type){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return marks.find((function(item){return item.type===type&&objectIncludes(item.attrs,attributes)}))}function isMarkInSet(marks,type){return!!findMarkInSet(marks,type,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function getMarkRange($pos,type){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if($pos&&type){var start=$pos.parent.childAfter($pos.parentOffset);if($pos.parentOffset===start.offset&&0!==start.offset&&(start=$pos.parent.childBefore($pos.parentOffset)),start.node){var mark=findMarkInSet(_toConsumableArray(start.node.marks),type,attributes);if(mark){var startIndex=start.index,startPos=$pos.start()+start.offset,endIndex=startIndex+1,endPos=startPos+start.node.nodeSize;for(findMarkInSet(_toConsumableArray(start.node.marks),type,attributes);startIndex>0&&mark.isInSet($pos.parent.child(startIndex-1).marks);)startIndex-=1,startPos-=$pos.parent.child(startIndex).nodeSize;for(;endIndex<$pos.parent.childCount&&isMarkInSet(_toConsumableArray($pos.parent.child(endIndex).marks),type,attributes);)endPos+=$pos.parent.child(endIndex).nodeSize,endIndex+=1;return{from:startPos,to:endPos}}}}}function getMarkType(nameOrType,schema){if("string"==typeof nameOrType){if(!schema.marks[nameOrType])throw Error("There is no mark type named '"+nameOrType+"'. Maybe you forgot to add the extension?");return schema.marks[nameOrType]}return nameOrType}function isTextSelection(value){return value instanceof TextSelection}function minMax(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,min=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,max=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(value,min),max)}function resolveFocusPosition(doc){var position=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!position)return null;var selectionAtStart=Selection.atStart(doc),selectionAtEnd=Selection.atEnd(doc);if("start"===position||!0===position)return selectionAtStart;if("end"===position)return selectionAtEnd;var minPos=selectionAtStart.from,maxPos=selectionAtEnd.to;return"all"===position?TextSelection.create(doc,minMax(0,minPos,maxPos),minMax(doc.content.size,minPos,maxPos)):TextSelection.create(doc,minMax(position,minPos,maxPos),minMax(position,minPos,maxPos))}function isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function elementFromString(value){var wrappedValue="<body>"+value+"</body>";return(new window.DOMParser).parseFromString(wrappedValue,"text/html").body}function createNodeFromContent(content,schema,options){if(options=Object.assign({slice:!0,parseOptions:{}},options),"object"==typeof content&&null!==content)try{return Array.isArray(content)&&content.length>0?Fragment.fromArray(content.map((function(item){return schema.nodeFromJSON(item)}))):schema.nodeFromJSON(content)}catch(error){return console.warn("[tiptap warn]: Invalid content.","Passed value:",content,"Error:",error),createNodeFromContent("",schema,options)}if("string"==typeof content){var parser=DOMParser.fromSchema(schema);return options.slice?parser.parseSlice(elementFromString(content),options.parseOptions).content:parser.parse(elementFromString(content),options.parseOptions)}return createNodeFromContent("",schema,options)}function isMacOS(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function isNodeActive(state,typeOrName){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_state$selection13=state.selection,from=_state$selection13.from,to=_state$selection13.to,empty=_state$selection13.empty,type=typeOrName?getNodeType(typeOrName,state.schema):null,nodeRanges=[];state.doc.nodesBetween(from,to,(function(node,pos){if(!node.isText){var relativeFrom=Math.max(from,pos),relativeTo=Math.min(to,pos+node.nodeSize);nodeRanges.push({node,from:relativeFrom,to:relativeTo})}}));var selectionRange=to-from,matchedNodeRanges=nodeRanges.filter((function(nodeRange){return!type||type.name===nodeRange.node.type.name})).filter((function(nodeRange){return objectIncludes(nodeRange.node.attrs,attributes,{strict:!1})}));if(empty)return!!matchedNodeRanges.length;var range=matchedNodeRanges.reduce((function(sum,nodeRange){return sum+nodeRange.to-nodeRange.from}),0);return range>=selectionRange}function getSchemaTypeNameByName(name,schema){return schema.nodes[name]?"node":schema.marks[name]?"mark":null}function deleteProps(obj,propOrProps){var props="string"==typeof propOrProps?[propOrProps]:propOrProps;return Object.keys(obj).reduce((function(newObj,prop){return props.includes(prop)||(newObj[prop]=obj[prop]),newObj}),{})}function createDocument(content,schema){return createNodeFromContent(content,schema,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}})}function getMarkAttributes(state,typeOrName){var type=getMarkType(typeOrName,state.schema),_state$selection14=state.selection,from=_state$selection14.from,to=_state$selection14.to,empty=_state$selection14.empty,marks=[];empty?(state.storedMarks&&marks.push.apply(marks,_toConsumableArray(state.storedMarks)),marks.push.apply(marks,_toConsumableArray(state.selection.$head.marks()))):state.doc.nodesBetween(from,to,(function(node){marks.push.apply(marks,_toConsumableArray(node.marks))}));var mark=marks.find((function(markItem){return markItem.type.name===type.name}));return mark?Object.assign({},mark.attrs):{}}function findParentNode(predicate){return function(selection){return function findParentNodeClosestToPos($pos,predicate){for(var _i402=$pos.depth;_i402>0;_i402-=1){var node=$pos.node(_i402);if(predicate(node))return{pos:_i402>0?$pos.before(_i402):0,start:$pos.start(_i402),depth:_i402,node}}}(selection.$from,predicate)}}function _getAttributes(state,typeOrName){var schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return"node"===schemaType?function getNodeAttributes(state,typeOrName){var type=getNodeType(typeOrName,state.schema),_state$selection15=state.selection,from=_state$selection15.from,to=_state$selection15.to,nodes=[];state.doc.nodesBetween(from,to,(function(node){nodes.push(node)}));var node=nodes.reverse().find((function(nodeItem){return nodeItem.type.name===type.name}));return node?Object.assign({},node.attrs):{}}(state,typeOrName):"mark"===schemaType?getMarkAttributes(state,typeOrName):{}}function simplifyChangedRanges(changes){var uniqueChanges=function removeDuplicates(array){var by=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify,seen={};return array.filter((function(item){var key=by(item);return!Object.prototype.hasOwnProperty.call(seen,key)&&(seen[key]=!0)}))}(changes);return 1===uniqueChanges.length?uniqueChanges:uniqueChanges.filter((function(change,index){var rest=uniqueChanges.filter((function(_,i){return i!==index}));return!rest.some((function(otherChange){return change.oldRange.from>=otherChange.oldRange.from&&change.oldRange.to<=otherChange.oldRange.to&&change.newRange.from>=otherChange.newRange.from&&change.newRange.to<=otherChange.newRange.to}))}))}function getMarksBetween(from,to,doc){var marks=[];return from===to?doc.resolve(from).marks().forEach((function(mark){var range=getMarkRange(doc.resolve(from-1),mark.type);range&&marks.push(Object.assign({mark},range))})):doc.nodesBetween(from,to,(function(node,pos){marks.push.apply(marks,_toConsumableArray(node.marks.map((function(mark){return{from:pos,to:pos+node.nodeSize,mark}}))))})),marks}function getSplittedAttributes(extensionAttributes,typeName,attributes){return Object.fromEntries(Object.entries(attributes).filter((function(_ref69){var name=_slicedToArray(_ref69,1)[0],extensionAttribute=extensionAttributes.find((function(item){return item.type===typeName&&item.name===name}));return!!extensionAttribute&&extensionAttribute.attribute.keepOnSplit})))}function isMarkActive(state,typeOrName){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_state$selection16=state.selection,empty=_state$selection16.empty,ranges=_state$selection16.ranges,type=typeOrName?getMarkType(typeOrName,state.schema):null;if(empty)return!!(state.storedMarks||state.selection.$from.marks()).filter((function(mark){return!type||type.name===mark.type.name})).find((function(mark){return objectIncludes(mark.attrs,attributes,{strict:!1})}));var selectionRange=0,markRanges=[];if(ranges.forEach((function(_ref71){var $from=_ref71.$from,$to=_ref71.$to,from=$from.pos,to=$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){if(node.isText||node.marks.length){var relativeFrom=Math.max(from,pos),relativeTo=Math.min(to,pos+node.nodeSize);selectionRange+=relativeTo-relativeFrom,markRanges.push.apply(markRanges,_toConsumableArray(node.marks.map((function(mark){return{mark,from:relativeFrom,to:relativeTo}}))))}}))})),0===selectionRange)return!1;var matchedRange=markRanges.filter((function(markRange){return!type||type.name===markRange.mark.type.name})).filter((function(markRange){return objectIncludes(markRange.mark.attrs,attributes,{strict:!1})})).reduce((function(sum,markRange){return sum+markRange.to-markRange.from}),0),excludedRange=markRanges.filter((function(markRange){return!type||markRange.mark.type!==type&&markRange.mark.type.excludes(type)})).reduce((function(sum,markRange){return sum+markRange.to-markRange.from}),0);return(matchedRange>0?matchedRange+excludedRange:matchedRange)>=selectionRange}function isList(name,extensions){var extension=splitExtensions(extensions).nodeExtensions.find((function(item){return item.name===name}));if(!extension)return!1;var group=callOrReturn(getExtensionField(extension,"group",{name:extension.name,options:extension.options,storage:extension.storage}));return"string"==typeof group&&group.split(" ").includes("list")}function ensureMarks(state,splittableMarks){var marks=state.storedMarks||state.selection.$to.parentOffset&&state.selection.$from.marks();if(marks){var filteredMarks=marks.filter((function(mark){return null==splittableMarks?void 0:splittableMarks.includes(mark.type.name)}));state.tr.ensureMarks(filteredMarks)}}var joinListBackwards=function joinListBackwards(tr,listType){var list=findParentNode((function(node){return node.type===listType}))(tr.selection);if(!list)return!0;var before=tr.doc.resolve(Math.max(0,list.pos-1)).before(list.depth);if(void 0===before)return!0;var nodeBefore=tr.doc.nodeAt(before);return list.node.type!==(null==nodeBefore?void 0:nodeBefore.type)||!canJoin(tr.doc,list.pos)||(tr.join(list.pos),!0)},joinListForwards=function joinListForwards(tr,listType){var list=findParentNode((function(node){return node.type===listType}))(tr.selection);if(!list)return!0;var after=tr.doc.resolve(list.start).after(list.depth);if(void 0===after)return!0;var nodeAfter=tr.doc.nodeAt(after);return list.node.type!==(null==nodeAfter?void 0:nodeAfter.type)||!canJoin(tr.doc,after)||(tr.join(after),!0)},commands=Object.freeze({__proto__:null,blur:function blur(){return function(_ref31){var editor=_ref31.editor,view=_ref31.view;return requestAnimationFrame((function(){var _a;editor.isDestroyed||(view.dom.blur(),null===(_a=null===window||void 0===window?void 0:window.getSelection())||void 0===_a||_a.removeAllRanges())})),!0}},clearContent:function clearContent(){var emitUpdate=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(_ref32){return _ref32.commands.setContent("",emitUpdate)}},clearNodes:function clearNodes(){return function(_ref33){var state=_ref33.state,tr=_ref33.tr,dispatch=_ref33.dispatch,ranges=tr.selection.ranges;return!dispatch||(ranges.forEach((function(_ref34){var $from=_ref34.$from,$to=_ref34.$to;state.doc.nodesBetween($from.pos,$to.pos,(function(node,pos){if(!node.type.isText){var doc=tr.doc,mapping=tr.mapping,$mappedFrom=doc.resolve(mapping.map(pos)),$mappedTo=doc.resolve(mapping.map(pos+node.nodeSize)),nodeRange=$mappedFrom.blockRange($mappedTo);if(nodeRange){var targetLiftDepth=liftTarget(nodeRange);if(node.type.isTextblock){var defaultType=$mappedFrom.parent.contentMatchAt($mappedFrom.index()).defaultType;tr.setNodeMarkup(nodeRange.start,defaultType)}(targetLiftDepth||0===targetLiftDepth)&&tr.lift(nodeRange,targetLiftDepth)}}}))})),!0)}},command:function command(fn){return function(props){return fn(props)}},createParagraphNear:function createParagraphNear(){return function(_ref35){var state=_ref35.state,dispatch=_ref35.dispatch;return createParagraphNear$1(state,dispatch)}},cut:function cut(originRange,targetPos){return function(_ref36){var editor=_ref36.editor,tr=_ref36.tr,contentSlice=editor.state.doc.slice(originRange.from,originRange.to);tr.deleteRange(originRange.from,originRange.to);var newPos=tr.mapping.map(targetPos);return tr.insert(newPos,contentSlice.content),tr.setSelection(new TextSelection(tr.doc.resolve(newPos-1))),!0}},deleteCurrentNode:function deleteCurrentNode(){return function(_ref37){var tr=_ref37.tr,dispatch=_ref37.dispatch,currentNode=tr.selection.$anchor.node();if(currentNode.content.size>0)return!1;for(var $pos=tr.selection.$anchor,depth=$pos.depth;depth>0;depth-=1){if($pos.node(depth).type===currentNode.type){if(dispatch){var from=$pos.before(depth),to=$pos.after(depth);tr.delete(from,to).scrollIntoView()}return!0}}return!1}},deleteNode:function deleteNode(typeOrName){return function(_ref38){for(var tr=_ref38.tr,state=_ref38.state,dispatch=_ref38.dispatch,type=getNodeType(typeOrName,state.schema),$pos=tr.selection.$anchor,depth=$pos.depth;depth>0;depth-=1){if($pos.node(depth).type===type){if(dispatch){var from=$pos.before(depth),to=$pos.after(depth);tr.delete(from,to).scrollIntoView()}return!0}}return!1}},deleteRange:function deleteRange(range){return function(_ref39){var tr=_ref39.tr,dispatch=_ref39.dispatch,from=range.from,to=range.to;return dispatch&&tr.delete(from,to),!0}},deleteSelection:function deleteSelection(){return function(_ref40){var state=_ref40.state,dispatch=_ref40.dispatch;return deleteSelection$1(state,dispatch)}},enter:function enter(){return function(_ref41){return _ref41.commands.keyboardShortcut("Enter")}},exitCode:function exitCode(){return function(_ref42){var state=_ref42.state,dispatch=_ref42.dispatch;return exitCode$1(state,dispatch)}},extendMarkRange:function extendMarkRange(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref43){var tr=_ref43.tr,state=_ref43.state,dispatch=_ref43.dispatch,type=getMarkType(typeOrName,state.schema),doc=tr.doc,selection=tr.selection,$from=selection.$from,from=selection.from,to=selection.to;if(dispatch){var _range5=getMarkRange($from,type,attributes);if(_range5&&_range5.from<=from&&_range5.to>=to){var newSelection=TextSelection.create(doc,_range5.from,_range5.to);tr.setSelection(newSelection)}}return!0}},first:function first(commands){return function(props){for(var items="function"==typeof commands?commands(props):commands,_i396=0;_i396<items.length;_i396+=1)if(items[_i396](props))return!0;return!1}},focus:function focus(){var position=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref44){var editor=_ref44.editor,view=_ref44.view,tr=_ref44.tr,dispatch=_ref44.dispatch;options=Object.assign({scrollIntoView:!0},options);var delayedFocus=function delayedFocus(){isiOS()&&view.dom.focus(),requestAnimationFrame((function(){editor.isDestroyed||(view.focus(),(null==options?void 0:options.scrollIntoView)&&editor.commands.scrollIntoView())}))};if(view.hasFocus()&&null===position||!1===position)return!0;if(dispatch&&null===position&&!isTextSelection(editor.state.selection))return delayedFocus(),!0;var selection=resolveFocusPosition(tr.doc,position)||editor.state.selection,isSameSelection=editor.state.selection.eq(selection);return dispatch&&(isSameSelection||tr.setSelection(selection),isSameSelection&&tr.storedMarks&&tr.setStoredMarks(tr.storedMarks),delayedFocus()),!0}},forEach:function forEach(items,fn){return function(props){return items.every((function(item,index){return fn(item,Object.assign({},props,{index}))}))}},insertContent:function insertContent(value,options){return function(_ref45){var tr=_ref45.tr;return _ref45.commands.insertContentAt({from:tr.selection.from,to:tr.selection.to},value,options)}},insertContentAt:function insertContentAt(position,value,options){return function(_ref46){var tr=_ref46.tr,dispatch=_ref46.dispatch,editor=_ref46.editor;if(dispatch){options=Object.assign({parseOptions:{},updateSelection:!0},options);var content=createNodeFromContent(value,editor.schema,{parseOptions:Object.assign({preserveWhitespace:"full"},options.parseOptions)});if("<>"===content.toString())return!0;var _ref47="number"==typeof position?{from:position,to:position}:{from:position.from,to:position.to},from=_ref47.from,to=_ref47.to,isOnlyTextContent=!0,isOnlyBlockContent=!0;if((function isFragment(nodeOrFragment){return nodeOrFragment.toString().startsWith("<")}(content)?content:[content]).forEach((function(node){node.check(),isOnlyTextContent=!!isOnlyTextContent&&(node.isText&&0===node.marks.length),isOnlyBlockContent=!!isOnlyBlockContent&&node.isBlock})),from===to&&isOnlyBlockContent){var parent=tr.doc.resolve(from).parent;parent.isTextblock&&!parent.type.spec.code&&!parent.childCount&&(from-=1,to+=1)}isOnlyTextContent?Array.isArray(value)?tr.insertText(value.map((function(v){return v.text||""})).join(""),from,to):"object"==typeof value&&value&&value.text?tr.insertText(value.text,from,to):tr.insertText(value,from,to):tr.replaceWith(from,to,content),options.updateSelection&&function selectionToInsertionEnd(tr,startLen,bias){var last=tr.steps.length-1;if(!(last<startLen)){var step=tr.steps[last];if(step instanceof ReplaceStep||step instanceof ReplaceAroundStep){var map=tr.mapping.maps[last],end=0;map.forEach((function(_from,_to,_newFrom,newTo){0===end&&(end=newTo)})),tr.setSelection(Selection.near(tr.doc.resolve(end),bias))}}}(tr,tr.steps.length-1,-1)}return!0}},joinUp:function joinUp(){return function(_ref48){return function joinUp$1(state,dispatch){var point,sel=state.selection,nodeSel=sel instanceof NodeSelection;if(nodeSel){if(sel.node.isTextblock||!canJoin(state.doc,sel.from))return!1;point=sel.from}else if(null==(point=joinPoint(state.doc,sel.from,-1)))return!1;if(dispatch){var _tr7=state.tr.join(point);nodeSel&&_tr7.setSelection(NodeSelection.create(_tr7.doc,point-state.doc.resolve(point).nodeBefore.nodeSize)),dispatch(_tr7.scrollIntoView())}return!0}(_ref48.state,_ref48.dispatch)}},joinDown:function joinDown(){return function(_ref49){return function joinDown$1(state,dispatch){var point,sel=state.selection;if(sel instanceof NodeSelection){if(sel.node.isTextblock||!canJoin(state.doc,sel.to))return!1;point=sel.to}else if(null==(point=joinPoint(state.doc,sel.to,1)))return!1;return dispatch&&dispatch(state.tr.join(point).scrollIntoView()),!0}(_ref49.state,_ref49.dispatch)}},joinBackward:function joinBackward(){return function(_ref50){var state=_ref50.state,dispatch=_ref50.dispatch;return joinBackward$1(state,dispatch)}},joinForward:function joinForward(){return function(_ref51){var state=_ref51.state,dispatch=_ref51.dispatch;return joinForward$1(state,dispatch)}},joinItemBackward:function joinItemBackward(){return function(_ref52){var tr=_ref52.tr,state=_ref52.state,dispatch=_ref52.dispatch;try{var point=joinPoint(state.doc,state.selection.$from.pos,-1);return null!=point&&(tr.join(point,2),dispatch&&dispatch(tr),!0)}catch(_unused){return!1}}},joinItemForward:function joinItemForward(){return function(_ref53){var state=_ref53.state,dispatch=_ref53.dispatch,tr=_ref53.tr;try{var point=joinPoint(state.doc,state.selection.$from.pos,1);return null!=point&&(tr.join(point,2),dispatch&&dispatch(tr),!0)}catch(e){return!1}}},keyboardShortcut:function keyboardShortcut(name){return function(_ref54){var editor=_ref54.editor,view=_ref54.view,tr=_ref54.tr,dispatch=_ref54.dispatch,keys=function normalizeKeyName(name){var alt,ctrl,shift,meta,parts=name.split(/-(?!$)/),result=parts[parts.length-1];"Space"===result&&(result=" ");for(var _i398=0;_i398<parts.length-1;_i398+=1){var mod=parts[_i398];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);isiOS()||isMacOS()?meta=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta&&(result="Meta-"+result),shift&&(result="Shift-"+result),result}(name).split(/-(?!$)/),key=keys.find((function(item){return!["Alt","Ctrl","Meta","Shift"].includes(item)})),event=new KeyboardEvent("keydown",{key:"Space"===key?" ":key,altKey:keys.includes("Alt"),ctrlKey:keys.includes("Ctrl"),metaKey:keys.includes("Meta"),shiftKey:keys.includes("Shift"),bubbles:!0,cancelable:!0}),capturedTransaction=editor.captureTransaction((function(){view.someProp("handleKeyDown",(function(f){return f(view,event)}))}));return null==capturedTransaction||capturedTransaction.steps.forEach((function(step){var newStep=step.map(tr.mapping);newStep&&dispatch&&tr.maybeStep(newStep)})),!0}},lift:function lift(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref55){var state=_ref55.state,dispatch=_ref55.dispatch;return!!isNodeActive(state,getNodeType(typeOrName,state.schema),attributes)&&function lift$1(state,dispatch){var _state$selection4=state.selection,$from=_state$selection4.$from,$to=_state$selection4.$to,range=$from.blockRange($to),target=range&&liftTarget(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}(state,dispatch)}},liftEmptyBlock:function liftEmptyBlock(){return function(_ref56){var state=_ref56.state,dispatch=_ref56.dispatch;return liftEmptyBlock$1(state,dispatch)}},liftListItem:function liftListItem(typeOrName){return function(_ref57){var state=_ref57.state,dispatch=_ref57.dispatch;return liftListItem$1(getNodeType(typeOrName,state.schema))(state,dispatch)}},newlineInCode:function newlineInCode(){return function(_ref58){var state=_ref58.state,dispatch=_ref58.dispatch;return newlineInCode$1(state,dispatch)}},resetAttributes:function resetAttributes(typeOrName,attributes){return function(_ref59){var tr=_ref59.tr,state=_ref59.state,dispatch=_ref59.dispatch,nodeType=null,markType=null,schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return!!schemaType&&("node"===schemaType&&(nodeType=getNodeType(typeOrName,state.schema)),"mark"===schemaType&&(markType=getMarkType(typeOrName,state.schema)),dispatch&&tr.selection.ranges.forEach((function(range){state.doc.nodesBetween(range.$from.pos,range.$to.pos,(function(node,pos){nodeType&&nodeType===node.type&&tr.setNodeMarkup(pos,void 0,deleteProps(node.attrs,attributes)),markType&&node.marks.length&&node.marks.forEach((function(mark){markType===mark.type&&tr.addMark(pos,pos+node.nodeSize,markType.create(deleteProps(mark.attrs,attributes)))}))}))})),!0)}},scrollIntoView:function scrollIntoView(){return function(_ref60){var tr=_ref60.tr;return _ref60.dispatch&&tr.scrollIntoView(),!0}},selectAll:function selectAll(){return function(_ref61){var tr=_ref61.tr;return _ref61.commands.setTextSelection({from:0,to:tr.doc.content.size})}},selectNodeBackward:function selectNodeBackward(){return function(_ref62){var state=_ref62.state,dispatch=_ref62.dispatch;return selectNodeBackward$1(state,dispatch)}},selectNodeForward:function selectNodeForward(){return function(_ref63){var state=_ref63.state,dispatch=_ref63.dispatch;return selectNodeForward$1(state,dispatch)}},selectParentNode:function selectParentNode(){return function(_ref64){return function selectParentNode$1(state,dispatch){var pos,_state$selection8=state.selection,$from=_state$selection8.$from,to=_state$selection8.to,same=$from.sharedDepth(to);return 0!=same&&(pos=$from.before(same),dispatch&&dispatch(state.tr.setSelection(NodeSelection.create(state.doc,pos))),!0)}(_ref64.state,_ref64.dispatch)}},selectTextblockEnd:function selectTextblockEnd(){return function(_ref65){var state=_ref65.state,dispatch=_ref65.dispatch;return selectTextblockEnd$1(state,dispatch)}},selectTextblockStart:function selectTextblockStart(){return function(_ref66){var state=_ref66.state,dispatch=_ref66.dispatch;return selectTextblockStart$1(state,dispatch)}},setContent:function setContent(content){var emitUpdate=arguments.length>1&&void 0!==arguments[1]&&arguments[1],parseOptions=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(_ref67){var tr=_ref67.tr,editor=_ref67.editor,dispatch=_ref67.dispatch,doc=tr.doc,document=createDocument(content,editor.schema,parseOptions);return dispatch&&tr.replaceWith(0,doc.content.size,document).setMeta("preventUpdate",!emitUpdate),!0}},setMark:function setMark(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref73){var tr=_ref73.tr,state=_ref73.state,dispatch=_ref73.dispatch,selection=tr.selection,empty=selection.empty,ranges=selection.ranges,type=getMarkType(typeOrName,state.schema);if(dispatch)if(empty){var oldAttributes=getMarkAttributes(state,type);tr.addStoredMark(type.create(Object.assign({},oldAttributes,attributes)))}else ranges.forEach((function(range){var from=range.$from.pos,to=range.$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){var trimmedFrom=Math.max(pos,from),trimmedTo=Math.min(pos+node.nodeSize,to);node.marks.find((function(mark){return mark.type===type}))?node.marks.forEach((function(mark){type===mark.type&&tr.addMark(trimmedFrom,trimmedTo,type.create(Object.assign({},mark.attrs,attributes)))})):tr.addMark(trimmedFrom,trimmedTo,type.create(attributes))}))}));return function canSetMark(state,tr,newMarkType){var _a,selection=tr.selection,cursor=null;if(isTextSelection(selection)&&(cursor=selection.$cursor),cursor){var currentMarks=null!==(_a=state.storedMarks)&&void 0!==_a?_a:cursor.marks();return!!newMarkType.isInSet(currentMarks)||!currentMarks.some((function(mark){return mark.type.excludes(newMarkType)}))}return selection.ranges.some((function(_ref72){var $from=_ref72.$from,$to=_ref72.$to,someNodeSupportsMark=0===$from.depth&&state.doc.inlineContent&&state.doc.type.allowsMarkType(newMarkType);return state.doc.nodesBetween($from.pos,$to.pos,(function(node,_pos,parent){if(someNodeSupportsMark)return!1;if(node.isInline){var parentAllowsMarkType=!parent||parent.type.allowsMarkType(newMarkType),currentMarksAllowMarkType=!!newMarkType.isInSet(node.marks)||!node.marks.some((function(otherMark){return otherMark.type.excludes(newMarkType)}));someNodeSupportsMark=parentAllowsMarkType&&currentMarksAllowMarkType}return!someNodeSupportsMark})),someNodeSupportsMark}))}(state,tr,type)}},setMeta:function setMeta(key,value){return function(_ref74){return _ref74.tr.setMeta(key,value),!0}},setNode:function setNode(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref75){var state=_ref75.state,dispatch=_ref75.dispatch,chain=_ref75.chain,type=getNodeType(typeOrName,state.schema);return type.isTextblock?chain().command((function(_ref76){var commands=_ref76.commands;return!!setBlockType(type,attributes)(state)||commands.clearNodes()})).command((function(_ref77){var updatedState=_ref77.state;return setBlockType(type,attributes)(updatedState,dispatch)})).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},setNodeSelection:function setNodeSelection(position){return function(_ref78){var tr=_ref78.tr;if(_ref78.dispatch){var _doc=tr.doc,from=minMax(position,0,_doc.content.size),selection=NodeSelection.create(_doc,from);tr.setSelection(selection)}return!0}},setTextSelection:function setTextSelection(position){return function(_ref79){var tr=_ref79.tr;if(_ref79.dispatch){var _doc2=tr.doc,_ref80="number"==typeof position?{from:position,to:position}:position,from=_ref80.from,to=_ref80.to,minPos=TextSelection.atStart(_doc2).from,maxPos=TextSelection.atEnd(_doc2).to,resolvedFrom=minMax(from,minPos,maxPos),resolvedEnd=minMax(to,minPos,maxPos),selection=TextSelection.create(_doc2,resolvedFrom,resolvedEnd);tr.setSelection(selection)}return!0}},sinkListItem:function sinkListItem(typeOrName){return function(_ref81){var state=_ref81.state,dispatch=_ref81.dispatch;return function sinkListItem$1(itemType){return function(state,dispatch){var _state$selection12=state.selection,$from=_state$selection12.$from,$to=_state$selection12.$to,range=$from.blockRange($to,(function(node){return node.childCount>0&&node.firstChild.type==itemType}));if(!range)return!1;var startIndex=range.startIndex;if(0==startIndex)return!1;var parent=range.parent,nodeBefore=parent.child(startIndex-1);if(nodeBefore.type!=itemType)return!1;if(dispatch){var nestedBefore=nodeBefore.lastChild&&nodeBefore.lastChild.type==parent.type,inner=Fragment.from(nestedBefore?itemType.create():null),slice=new Slice(Fragment.from(itemType.create(null,Fragment.from(parent.type.create(null,inner)))),nestedBefore?3:1,0),before=range.start,after=range.end;dispatch(state.tr.step(new ReplaceAroundStep(before-(nestedBefore?3:1),after,before,after,slice,1,!0)).scrollIntoView())}return!0}}(getNodeType(typeOrName,state.schema))(state,dispatch)}},splitBlock:function splitBlock(){var _ref82$keepMarks=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).keepMarks,keepMarks=void 0===_ref82$keepMarks||_ref82$keepMarks;return function(_ref83){var tr=_ref83.tr,state=_ref83.state,dispatch=_ref83.dispatch,editor=_ref83.editor,selection=tr.selection,doc=tr.doc,$from=selection.$from,$to=selection.$to,newAttributes=getSplittedAttributes(editor.extensionManager.attributes,$from.node().type.name,$from.node().attrs);if(selection instanceof NodeSelection&&selection.node.isBlock)return!(!$from.parentOffset||!canSplit(doc,$from.pos))&&(dispatch&&(keepMarks&&ensureMarks(state,editor.extensionManager.splittableMarks),tr.split($from.pos).scrollIntoView()),!0);if(!$from.parent.isBlock)return!1;if(dispatch){var atEnd=$to.parentOffset===$to.parent.content.size;selection instanceof TextSelection&&tr.deleteSelection();var deflt=0===$from.depth?void 0:function defaultBlockAt(match){for(var _i400=0;_i400<match.edgeCount;_i400+=1){var type=match.edge(_i400).type;if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}($from.node(-1).contentMatchAt($from.indexAfter(-1))),types=atEnd&&deflt?[{type:deflt,attrs:newAttributes}]:void 0,can=canSplit(tr.doc,tr.mapping.map($from.pos),1,types);if(types||can||!canSplit(tr.doc,tr.mapping.map($from.pos),1,deflt?[{type:deflt}]:void 0)||(can=!0,types=deflt?[{type:deflt,attrs:newAttributes}]:void 0),can&&(tr.split(tr.mapping.map($from.pos),1,types),deflt&&!atEnd&&!$from.parentOffset&&$from.parent.type!==deflt)){var _first9=tr.mapping.map($from.before()),$first=tr.doc.resolve(_first9);$from.node(-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&tr.setNodeMarkup(tr.mapping.map($from.before()),deflt)}keepMarks&&ensureMarks(state,editor.extensionManager.splittableMarks),tr.scrollIntoView()}return!0}},splitListItem:function splitListItem(typeOrName){return function(_ref84){var _a,tr=_ref84.tr,state=_ref84.state,dispatch=_ref84.dispatch,editor=_ref84.editor,type=getNodeType(typeOrName,state.schema),_state$selection17=state.selection,$from=_state$selection17.$from,$to=_state$selection17.$to,node=state.selection.node;if(node&&node.isBlock||$from.depth<2||!$from.sameParent($to))return!1;var grandParent=$from.node(-1);if(grandParent.type!==type)return!1;var extensionAttributes=editor.extensionManager.attributes;if(0===$from.parent.content.size&&$from.node(-1).childCount===$from.indexAfter(-1)){if(2===$from.depth||$from.node(-3).type!==type||$from.index(-2)!==$from.node(-2).childCount-1)return!1;if(dispatch){for(var wrap=Fragment.empty,depthBefore=$from.index(-1)?1:$from.index(-2)?2:3,d=$from.depth-depthBefore;d>=$from.depth-3;d-=1)wrap=Fragment.from($from.node(d).copy(wrap));var depthAfter=$from.indexAfter(-1)<$from.node(-2).childCount?1:$from.indexAfter(-2)<$from.node(-3).childCount?2:3,_newNextTypeAttributes=getSplittedAttributes(extensionAttributes,$from.node().type.name,$from.node().attrs),_nextType=(null===(_a=type.contentMatch.defaultType)||void 0===_a?void 0:_a.createAndFill(_newNextTypeAttributes))||void 0;wrap=wrap.append(Fragment.from(type.createAndFill(null,_nextType)||void 0));var start=$from.before($from.depth-(depthBefore-1));tr.replace(start,$from.after(-depthAfter),new Slice(wrap,4-depthBefore,0));var sel=-1;tr.doc.nodesBetween(start,tr.doc.content.size,(function(n,pos){if(sel>-1)return!1;n.isTextblock&&0===n.content.size&&(sel=pos+1)})),sel>-1&&tr.setSelection(TextSelection.near(tr.doc.resolve(sel))),tr.scrollIntoView()}return!0}var nextType=$to.pos===$from.end()?grandParent.contentMatchAt(0).defaultType:null,newTypeAttributes=getSplittedAttributes(extensionAttributes,grandParent.type.name,grandParent.attrs),newNextTypeAttributes=getSplittedAttributes(extensionAttributes,$from.node().type.name,$from.node().attrs);tr.delete($from.pos,$to.pos);var types=nextType?[{type,attrs:newTypeAttributes},{type:nextType,attrs:newNextTypeAttributes}]:[{type,attrs:newTypeAttributes}];if(!canSplit(tr.doc,$from.pos,2))return!1;if(dispatch){var selection=state.selection,storedMarks=state.storedMarks,splittableMarks=editor.extensionManager.splittableMarks,marks=storedMarks||selection.$to.parentOffset&&selection.$from.marks();if(tr.split($from.pos,2,types).scrollIntoView(),!marks||!dispatch)return!0;var filteredMarks=marks.filter((function(mark){return splittableMarks.includes(mark.type.name)}));tr.ensureMarks(filteredMarks)}return!0}},toggleList:function toggleList(listTypeOrName,itemTypeOrName,keepMarks){var attributes=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(_ref85){var editor=_ref85.editor,tr=_ref85.tr,state=_ref85.state,dispatch=_ref85.dispatch,chain=_ref85.chain,commands=_ref85.commands,can=_ref85.can,_editor$extensionMana=editor.extensionManager,extensions=_editor$extensionMana.extensions,splittableMarks=_editor$extensionMana.splittableMarks,listType=getNodeType(listTypeOrName,state.schema),itemType=getNodeType(itemTypeOrName,state.schema),selection=state.selection,storedMarks=state.storedMarks,$from=selection.$from,$to=selection.$to,range=$from.blockRange($to),marks=storedMarks||selection.$to.parentOffset&&selection.$from.marks();if(!range)return!1;var parentList=findParentNode((function(node){return isList(node.type.name,extensions)}))(selection);if(range.depth>=1&&parentList&&range.depth-parentList.depth<=1){if(parentList.node.type===listType)return commands.liftListItem(itemType);if(isList(parentList.node.type.name,extensions)&&listType.validContent(parentList.node.content)&&dispatch)return chain().command((function(){return tr.setNodeMarkup(parentList.pos,listType),!0})).command((function(){return joinListBackwards(tr,listType)})).command((function(){return joinListForwards(tr,listType)})).run()}return keepMarks&&marks&&dispatch?chain().command((function(){var canWrapInList=can().wrapInList(listType,attributes),filteredMarks=marks.filter((function(mark){return splittableMarks.includes(mark.type.name)}));return tr.ensureMarks(filteredMarks),!!canWrapInList||commands.clearNodes()})).wrapInList(listType,attributes).command((function(){return joinListBackwards(tr,listType)})).command((function(){return joinListForwards(tr,listType)})).run():chain().command((function(){return!!can().wrapInList(listType,attributes)||commands.clearNodes()})).wrapInList(listType,attributes).command((function(){return joinListBackwards(tr,listType)})).command((function(){return joinListForwards(tr,listType)})).run()}},toggleMark:function toggleMark(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(_ref86){var state=_ref86.state,commands=_ref86.commands,_options$extendEmptyM=options.extendEmptyMarkRange,extendEmptyMarkRange=void 0!==_options$extendEmptyM&&_options$extendEmptyM,type=getMarkType(typeOrName,state.schema);return isMarkActive(state,type,attributes)?commands.unsetMark(type,{extendEmptyMarkRange}):commands.setMark(type,attributes)}},toggleNode:function toggleNode(typeOrName,toggleTypeOrName){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(_ref87){var state=_ref87.state,commands=_ref87.commands,type=getNodeType(typeOrName,state.schema),toggleType=getNodeType(toggleTypeOrName,state.schema);return isNodeActive(state,type,attributes)?commands.setNode(toggleType):commands.setNode(type,attributes)}},toggleWrap:function toggleWrap(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref88){var state=_ref88.state,commands=_ref88.commands,type=getNodeType(typeOrName,state.schema);return isNodeActive(state,type,attributes)?commands.lift(type):commands.wrapIn(type,attributes)}},undoInputRule:function undoInputRule(){return function(_ref89){for(var state=_ref89.state,dispatch=_ref89.dispatch,plugins=state.plugins,_i404=0;_i404<plugins.length;_i404+=1){var plugin=plugins[_i404],undoable=void 0;if(plugin.spec.isInputRules&&(undoable=plugin.getState(state))){if(dispatch){for(var _tr14=state.tr,toUndo=undoable.transform,j=toUndo.steps.length-1;j>=0;j-=1)_tr14.step(toUndo.steps[j].invert(toUndo.docs[j]));if(undoable.text){var marks=_tr14.doc.resolve(undoable.from).marks();_tr14.replaceWith(undoable.from,undoable.to,state.schema.text(undoable.text,marks))}else _tr14.delete(undoable.from,undoable.to)}return!0}}return!1}},unsetAllMarks:function unsetAllMarks(){return function(_ref90){var tr=_ref90.tr,dispatch=_ref90.dispatch,selection=tr.selection,empty=selection.empty,ranges=selection.ranges;return empty||dispatch&&ranges.forEach((function(range){tr.removeMark(range.$from.pos,range.$to.pos)})),!0}},unsetMark:function unsetMark(typeOrName){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref91){var _a,tr=_ref91.tr,state=_ref91.state,dispatch=_ref91.dispatch,_options$extendEmptyM2=options.extendEmptyMarkRange,extendEmptyMarkRange=void 0!==_options$extendEmptyM2&&_options$extendEmptyM2,selection=tr.selection,type=getMarkType(typeOrName,state.schema),$from=selection.$from,empty=selection.empty,ranges=selection.ranges;if(!dispatch)return!0;if(empty&&extendEmptyMarkRange){var from=selection.from,to=selection.to,_attrs2=null===(_a=$from.marks().find((function(mark){return mark.type===type})))||void 0===_a?void 0:_a.attrs,_range6=getMarkRange($from,type,_attrs2);_range6&&(from=_range6.from,to=_range6.to),tr.removeMark(from,to,type)}else ranges.forEach((function(range){tr.removeMark(range.$from.pos,range.$to.pos,type)}));return tr.removeStoredMark(type),!0}},updateAttributes:function updateAttributes(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref92){var tr=_ref92.tr,state=_ref92.state,dispatch=_ref92.dispatch,nodeType=null,markType=null,schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return!!schemaType&&("node"===schemaType&&(nodeType=getNodeType(typeOrName,state.schema)),"mark"===schemaType&&(markType=getMarkType(typeOrName,state.schema)),dispatch&&tr.selection.ranges.forEach((function(range){var from=range.$from.pos,to=range.$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){nodeType&&nodeType===node.type&&tr.setNodeMarkup(pos,void 0,Object.assign({},node.attrs,attributes)),markType&&node.marks.length&&node.marks.forEach((function(mark){if(markType===mark.type){var trimmedFrom=Math.max(pos,from),trimmedTo=Math.min(pos+node.nodeSize,to);tr.addMark(trimmedFrom,trimmedTo,markType.create(Object.assign({},mark.attrs,attributes)))}}))}))})),!0)}},wrapIn:function wrapIn(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref93){var state=_ref93.state,dispatch=_ref93.dispatch;return function wrapIn$1(nodeType){var attrs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(state,dispatch){var _state$selection9=state.selection,$from=_state$selection9.$from,$to=_state$selection9.$to,range=$from.blockRange($to),wrapping=range&&findWrapping(range,nodeType,attrs);return!!wrapping&&(dispatch&&dispatch(state.tr.wrap(range,wrapping).scrollIntoView()),!0)}}(getNodeType(typeOrName,state.schema),attributes)(state,dispatch)}},wrapInList:function wrapInList(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref94){var state=_ref94.state,dispatch=_ref94.dispatch;return wrapInList$1(getNodeType(typeOrName,state.schema),attributes)(state,dispatch)}}}),Commands=Extension.create({name:"commands",addCommands:function addCommands(){return Object.assign({},commands)}}),Editable=Extension.create({name:"editable",addProseMirrorPlugins:function addProseMirrorPlugins(){var _this51=this;return[new Plugin({key:new PluginKey("editable"),props:{editable:function editable(){return _this51.editor.options.editable}}})]}}),FocusEvents=Extension.create({name:"focusEvents",addProseMirrorPlugins:function addProseMirrorPlugins(){var editor=this.editor;return[new Plugin({key:new PluginKey("focusEvents"),props:{handleDOMEvents:{focus:function focus(view,event){editor.isFocused=!0;var transaction=editor.state.tr.setMeta("focus",{event}).setMeta("addToHistory",!1);return view.dispatch(transaction),!1},blur:function blur(view,event){editor.isFocused=!1;var transaction=editor.state.tr.setMeta("blur",{event}).setMeta("addToHistory",!1);return view.dispatch(transaction),!1}}}})]}}),Keymap=Extension.create({name:"keymap",addKeyboardShortcuts:function addKeyboardShortcuts(){var _this52=this,handleBackspace=function handleBackspace(){return _this52.editor.commands.first((function(_ref95){var commands=_ref95.commands;return[function(){return commands.undoInputRule()},function(){return commands.command((function(_ref96){var tr=_ref96.tr,selection=tr.selection,doc=tr.doc,empty=selection.empty,$anchor=selection.$anchor,pos=$anchor.pos,parent=$anchor.parent,$parentPos=$anchor.parent.isTextblock?tr.doc.resolve(pos-1):$anchor,parentIsIsolating=$parentPos.parent.type.spec.isolating,parentPos=$anchor.pos-$anchor.parentOffset,isAtStart=parentIsIsolating&&1===$parentPos.parent.childCount?parentPos===$anchor.pos:Selection.atStart(doc).from===pos;return!(!(empty&&isAtStart&&parent.type.isTextblock)||parent.textContent.length)&&commands.clearNodes()}))},function(){return commands.deleteSelection()},function(){return commands.joinBackward()},function(){return commands.selectNodeBackward()}]}))},handleDelete=function handleDelete(){return _this52.editor.commands.first((function(_ref97){var commands=_ref97.commands;return[function(){return commands.deleteSelection()},function(){return commands.deleteCurrentNode()},function(){return commands.joinForward()},function(){return commands.selectNodeForward()}]}))},baseKeymap={Enter:function handleEnter(){return _this52.editor.commands.first((function(_ref98){var commands=_ref98.commands;return[function(){return commands.newlineInCode()},function(){return commands.createParagraphNear()},function(){return commands.liftEmptyBlock()},function(){return commands.splitBlock()}]}))},"Mod-Enter":function ModEnter(){return _this52.editor.commands.exitCode()},Backspace:handleBackspace,"Mod-Backspace":handleBackspace,"Shift-Backspace":handleBackspace,Delete:handleDelete,"Mod-Delete":handleDelete,"Mod-a":function ModA(){return _this52.editor.commands.selectAll()}},pcKeymap=Object.assign({},baseKeymap),macKeymap=Object.assign({},baseKeymap,{"Ctrl-h":handleBackspace,"Alt-Backspace":handleBackspace,"Ctrl-d":handleDelete,"Ctrl-Alt-Backspace":handleDelete,"Alt-Delete":handleDelete,"Alt-d":handleDelete,"Ctrl-a":function CtrlA(){return _this52.editor.commands.selectTextblockStart()},"Ctrl-e":function CtrlE(){return _this52.editor.commands.selectTextblockEnd()}});return isiOS()||isMacOS()?macKeymap:pcKeymap},addProseMirrorPlugins:function addProseMirrorPlugins(){var _this53=this;return[new Plugin({key:new PluginKey("clearDocument"),appendTransaction:function appendTransaction(transactions,oldState,newState){if(transactions.some((function(transaction){return transaction.docChanged}))&&!oldState.doc.eq(newState.doc)){var _oldState$selection=oldState.selection,empty=_oldState$selection.empty,from=_oldState$selection.from,to=_oldState$selection.to,allFrom=Selection.atStart(oldState.doc).from,allEnd=Selection.atEnd(oldState.doc).to;if(!empty&&(from===allFrom&&to===allEnd))if(0===newState.doc.textBetween(0,newState.doc.content.size," "," ").length){var tr=newState.tr,state=createChainableState({state:newState,transaction:tr});if(new CommandManager({editor:_this53.editor,state}).commands.clearNodes(),tr.steps.length)return tr}}}})]}}),Tabindex=Extension.create({name:"tabindex",addProseMirrorPlugins:function addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}}),extensions=Object.freeze({__proto__:null,ClipboardTextSerializer,Commands,Editable,FocusEvents,Keymap,Tabindex});var Editor=function(_EventEmitter){_inherits(Editor,_EventEmitter);var _super23=_createSuper(Editor);function Editor(){var _this54,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Editor),(_this54=_super23.call(this)).isFocused=!1,_this54.extensionStorage={},_this54.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:function onBeforeCreate(){return null},onCreate:function onCreate(){return null},onUpdate:function onUpdate(){return null},onSelectionUpdate:function onSelectionUpdate(){return null},onTransaction:function onTransaction(){return null},onFocus:function onFocus(){return null},onBlur:function onBlur(){return null},onDestroy:function onDestroy(){return null}},_this54.isCapturingTransaction=!1,_this54.capturedTransaction=null,_this54.setOptions(options),_this54.createExtensionManager(),_this54.createCommandManager(),_this54.createSchema(),_this54.on("beforeCreate",_this54.options.onBeforeCreate),_this54.emit("beforeCreate",{editor:_assertThisInitialized(_this54)}),_this54.createView(),_this54.injectCSS(),_this54.on("create",_this54.options.onCreate),_this54.on("update",_this54.options.onUpdate),_this54.on("selectionUpdate",_this54.options.onSelectionUpdate),_this54.on("transaction",_this54.options.onTransaction),_this54.on("focus",_this54.options.onFocus),_this54.on("blur",_this54.options.onBlur),_this54.on("destroy",_this54.options.onDestroy),window.setTimeout((function(){_this54.isDestroyed||(_this54.commands.focus(_this54.options.autofocus),_this54.emit("create",{editor:_assertThisInitialized(_this54)}))}),0),_this54}return _createClass(Editor,[{key:"storage",get:function get(){return this.extensionStorage}},{key:"commands",get:function get(){return this.commandManager.commands}},{key:"chain",value:function chain(){return this.commandManager.chain()}},{key:"can",value:function can(){return this.commandManager.can()}},{key:"injectCSS",value:function injectCSS(){this.options.injectCSS&&document&&(this.css=function createStyleTag(style,nonce,suffix){var tiptapStyleTag=document.querySelector("style[data-tiptap-style"+(suffix?"-"+suffix:"")+"]");if(null!==tiptapStyleTag)return tiptapStyleTag;var styleNode=document.createElement("style");return nonce&&styleNode.setAttribute("nonce",nonce),styleNode.setAttribute("data-tiptap-style"+(suffix?"-"+suffix:""),""),styleNode.innerHTML=style,document.getElementsByTagName("head")[0].appendChild(styleNode),styleNode}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}},{key:"setOptions",value:function setOptions(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=Object.assign({},this.options,options),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}},{key:"setEditable",value:function setEditable(editable){var emitUpdate=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable}),emitUpdate&&this.emit("update",{editor:this,transaction:this.state.tr})}},{key:"isEditable",get:function get(){return this.options.editable&&this.view&&this.view.editable}},{key:"state",get:function get(){return this.view.state}},{key:"registerPlugin",value:function registerPlugin(plugin,handlePlugins){var plugins=isFunction$1(handlePlugins)?handlePlugins(plugin,_toConsumableArray(this.state.plugins)):[].concat(_toConsumableArray(this.state.plugins),[plugin]),state=this.state.reconfigure({plugins});this.view.updateState(state)}},{key:"unregisterPlugin",value:function unregisterPlugin(nameOrPluginKey){if(!this.isDestroyed){var name="string"==typeof nameOrPluginKey?nameOrPluginKey+"$":nameOrPluginKey.key,state=this.state.reconfigure({plugins:this.state.plugins.filter((function(plugin){return!plugin.key.startsWith(name)}))});this.view.updateState(state)}}},{key:"createExtensionManager",value:function createExtensionManager(){var coreExtensions=this.options.enableCoreExtensions?Object.values(extensions):[],allExtensions=[].concat(_toConsumableArray(coreExtensions),_toConsumableArray(this.options.extensions)).filter((function(extension){return["extension","node","mark"].includes(null==extension?void 0:extension.type)}));this.extensionManager=new ExtensionManager(allExtensions,this)}},{key:"createCommandManager",value:function createCommandManager(){this.commandManager=new CommandManager({editor:this})}},{key:"createSchema",value:function createSchema(){this.schema=this.extensionManager.schema}},{key:"createView",value:function createView(){var doc=createDocument(this.options.content,this.schema,this.options.parseOptions),selection=resolveFocusPosition(doc,this.options.autofocus);this.view=new EditorView(this.options.element,Object.assign({},this.options.editorProps,{dispatchTransaction:this.dispatchTransaction.bind(this),state:EditorState.create({doc,selection:selection||void 0})}));var newState=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(newState),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}},{key:"createNodeViews",value:function createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}},{key:"prependClass",value:function prependClass(){this.view.dom.className="tiptap "+this.view.dom.className}},{key:"captureTransaction",value:function captureTransaction(fn){this.isCapturingTransaction=!0,fn(),this.isCapturingTransaction=!1;var tr=this.capturedTransaction;return this.capturedTransaction=null,tr}},{key:"dispatchTransaction",value:function dispatchTransaction(transaction){var _this55=this;if(!this.view.isDestroyed){if(this.isCapturingTransaction)return this.capturedTransaction?void transaction.steps.forEach((function(step){var _a;return null===(_a=_this55.capturedTransaction)||void 0===_a?void 0:_a.step(step)})):void(this.capturedTransaction=transaction);var state=this.state.apply(transaction),selectionHasChanged=!this.state.selection.eq(state.selection);this.view.updateState(state),this.emit("transaction",{editor:this,transaction}),selectionHasChanged&&this.emit("selectionUpdate",{editor:this,transaction});var focus=transaction.getMeta("focus"),blur=transaction.getMeta("blur");focus&&this.emit("focus",{editor:this,event:focus.event,transaction}),blur&&this.emit("blur",{editor:this,event:blur.event,transaction}),transaction.docChanged&&!transaction.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction})}}},{key:"getAttributes",value:function getAttributes(nameOrType){return _getAttributes(this.state,nameOrType)}},{key:"isActive",value:function isActive(nameOrAttributes,attributesOrUndefined){var name="string"==typeof nameOrAttributes?nameOrAttributes:null,attributes="string"==typeof nameOrAttributes?attributesOrUndefined:nameOrAttributes;return function _isActive(state,name){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!name)return isNodeActive(state,null,attributes)||isMarkActive(state,null,attributes);var schemaType=getSchemaTypeNameByName(name,state.schema);return"node"===schemaType?isNodeActive(state,name,attributes):"mark"===schemaType&&isMarkActive(state,name,attributes)}(this.state,name,attributes)}},{key:"getJSON",value:function getJSON(){return this.state.doc.toJSON()}},{key:"getHTML",value:function getHTML(){return function getHTMLFromFragment(fragment,schema){var documentFragment=DOMSerializer.fromSchema(schema).serializeFragment(fragment),container=document.implementation.createHTMLDocument().createElement("div");return container.appendChild(documentFragment),container.innerHTML}(this.state.doc.content,this.schema)}},{key:"getText",value:function getText(options){var _ref99=options||{},_ref99$blockSeparator=_ref99.blockSeparator,blockSeparator=void 0===_ref99$blockSeparator?"\n\n":_ref99$blockSeparator,_ref99$textSerializer=_ref99.textSerializers,textSerializers=void 0===_ref99$textSerializer?{}:_ref99$textSerializer;return function _getText(node,options){return getTextBetween(node,{from:0,to:node.content.size},options)}(this.state.doc,{blockSeparator,textSerializers:Object.assign({},getTextSerializersFromSchema(this.schema),textSerializers)})}},{key:"isEmpty",get:function get(){return function isNodeEmpty(node){var _a,defaultContent=null===(_a=node.type.createAndFill())||void 0===_a?void 0:_a.toJSON(),content=node.toJSON();return JSON.stringify(defaultContent)===JSON.stringify(content)}(this.state.doc)}},{key:"getCharacterCount",value:function getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}},{key:"destroy",value:function destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}},{key:"isDestroyed",get:function get(){var _a;return!(null===(_a=this.view)||void 0===_a?void 0:_a.docView)}}]),Editor}(EventEmitter);function markInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref100){var state=_ref100.state,range=_ref100.range,match=_ref100.match,attributes=callOrReturn(config.getAttributes,void 0,match);if(!1===attributes||null===attributes)return null;var tr=state.tr,captureGroup=match[match.length-1],fullMatch=match[0];if(captureGroup){var startSpaces=fullMatch.search(/\S/),textStart=range.from+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;if(getMarksBetween(range.from,range.to,state.doc).filter((function(item){return item.mark.type.excluded.find((function(type){return type===config.type&&type!==item.mark.type}))})).filter((function(item){return item.to>textStart})).length)return null;textEnd<range.to&&tr.delete(textEnd,range.to),textStart>range.from&&tr.delete(range.from+startSpaces,textStart);var markEnd=range.from+startSpaces+captureGroup.length;tr.addMark(range.from+startSpaces,markEnd,config.type.create(attributes||{})),tr.removeStoredMark(config.type)}}})}function nodeInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref101){var state=_ref101.state,range=_ref101.range,match=_ref101.match,attributes=callOrReturn(config.getAttributes,void 0,match)||{},tr=state.tr,start=range.from,end=range.to,newNode=config.type.create(attributes);if(match[1]){var matchStart=start+match[0].lastIndexOf(match[1]);matchStart>end?matchStart=end:end=matchStart+match[1].length;var lastChar=match[0][match[0].length-1];tr.insertText(lastChar,start+match[0].length-1),tr.replaceWith(matchStart,end,newNode)}else match[0]&&tr.insert(start-1,config.type.create(attributes)).delete(tr.mapping.map(start),tr.mapping.map(end));tr.scrollIntoView()}})}function textblockTypeInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref102){var state=_ref102.state,range=_ref102.range,match=_ref102.match,$start=state.doc.resolve(range.from),attributes=callOrReturn(config.getAttributes,void 0,match)||{};if(!$start.node(-1).canReplaceWith($start.index(-1),$start.indexAfter(-1),config.type))return null;state.tr.delete(range.from,range.to).setBlockType(range.from,range.from,config.type,attributes)}})}function wrappingInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref103){var state=_ref103.state,range=_ref103.range,match=_ref103.match,chain=_ref103.chain,attributes=callOrReturn(config.getAttributes,void 0,match)||{},tr=state.tr.delete(range.from,range.to),blockRange=tr.doc.resolve(range.from).blockRange(),wrapping=blockRange&&findWrapping(blockRange,config.type,attributes);if(!wrapping)return null;if(tr.wrap(blockRange,wrapping),config.keepMarks&&config.editor){var selection=state.selection,storedMarks=state.storedMarks,splittableMarks=config.editor.extensionManager.splittableMarks,marks=storedMarks||selection.$to.parentOffset&&selection.$from.marks();if(marks){var filteredMarks=marks.filter((function(mark){return splittableMarks.includes(mark.type.name)}));tr.ensureMarks(filteredMarks)}}if(config.keepAttributes){var nodeType="bulletList"===config.type.name||"orderedList"===config.type.name?"listItem":"taskList";chain().updateAttributes(nodeType,attributes).run()}var before=tr.doc.resolve(range.from-1).nodeBefore;before&&before.type===config.type&&canJoin(tr.doc,range.from-1)&&(!config.joinPredicate||config.joinPredicate(match,before))&&tr.join(range.from-1)}})}var Mark=function(){function Mark(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Mark),this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Object.assign({},this.config,config),this.name=this.config.name,config.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+this.name+'".'),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}return _createClass(Mark,[{key:"configure",value:function configure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}},{key:"extend",value:function extend(){var extendedConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=new Mark(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+extension.name+'".'),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}],[{key:"create",value:function create(){return new Mark(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"handleExit",value:function handleExit(_ref104){var editor=_ref104.editor,mark=_ref104.mark,tr=editor.state.tr,currentPos=editor.state.selection.$from;if(currentPos.pos===currentPos.end()){var currentMarks=currentPos.marks();if(!!!currentMarks.find((function(m){return(null==m?void 0:m.type.name)===mark.name})))return!1;var removeMark=currentMarks.find((function(m){return(null==m?void 0:m.type.name)===mark.name}));return removeMark&&tr.removeStoredMark(removeMark),tr.insertText(" ",currentPos.pos),editor.view.dispatch(tr),!0}return!1}}]),Mark}(),Node=function(){function Node(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Node),this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Object.assign({},this.config,config),this.name=this.config.name,config.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+this.name+'".'),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}return _createClass(Node,[{key:"configure",value:function configure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}},{key:"extend",value:function extend(){var extendedConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=new Node(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+extension.name+'".'),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}],[{key:"create",value:function create(){return new Node(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}}]),Node}();function markPasteRule(config){return new PasteRule({find:config.find,handler:function handler(_ref105){var state=_ref105.state,range=_ref105.range,match=_ref105.match,pasteEvent=_ref105.pasteEvent,attributes=callOrReturn(config.getAttributes,void 0,match,pasteEvent);if(!1===attributes||null===attributes)return null;var tr=state.tr,captureGroup=match[match.length-1],fullMatch=match[0],markEnd=range.to;if(captureGroup){var startSpaces=fullMatch.search(/\S/),textStart=range.from+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;if(getMarksBetween(range.from,range.to,state.doc).filter((function(item){return item.mark.type.excluded.find((function(type){return type===config.type&&type!==item.mark.type}))})).filter((function(item){return item.to>textStart})).length)return null;textEnd<range.to&&tr.delete(textEnd,range.to),textStart>range.from&&tr.delete(range.from+startSpaces,textStart),markEnd=range.from+startSpaces+captureGroup.length,tr.addMark(range.from+startSpaces,markEnd,config.type.create(attributes||{})),tr.removeStoredMark(config.type)}}})}var encodedTlds="aaa1rp3barth4b0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0faromeo7ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re2s2c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y0eats7k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking0channel11l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t0isalat7u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0at2delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d0network8tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntdoor4ier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5gtv3iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0eles2s3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1nder2le4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster5ia3d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4de2k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0cys3drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7serati6ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic3tual5v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rthwesternmutual14on4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3ssagens7y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cher3ks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w0time7i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ffany5ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0channel7ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lkswagen7vo3te1ing3o2yage5u0elos6wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",encodedUtlds="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5تصالات6رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",assign$2=function assign$2(target,properties){for(var _key6 in properties)target[_key6]=properties[_key6];return target},numeric="numeric",ascii="ascii",alpha$1="alpha",asciinumeric="asciinumeric",alphanumeric="alphanumeric",domain="domain",emoji="emoji",scheme="scheme",slashscheme="slashscheme",whitespace="whitespace";function registerGroup(name,groups){return name in groups||(groups[name]=[]),groups[name]}function addToGroups(t,flags,groups){for(var k in flags[numeric]&&(flags[asciinumeric]=!0,flags[alphanumeric]=!0),flags[ascii]&&(flags[asciinumeric]=!0,flags[alpha$1]=!0),flags[asciinumeric]&&(flags[alphanumeric]=!0),flags[alpha$1]&&(flags[alphanumeric]=!0),flags[alphanumeric]&&(flags[domain]=!0),flags[emoji]&&(flags[domain]=!0),flags){var group=registerGroup(k,groups);group.indexOf(t)<0&&group.push(t)}}function State(token){void 0===token&&(token=null),this.j={},this.jr=[],this.jd=null,this.t=token}State.groups={},State.prototype={accepts:function accepts(){return!!this.t},go:function go(input){var nextState=this.j[input];if(nextState)return nextState;for(var _i406=0;_i406<this.jr.length;_i406++){var _regex=this.jr[_i406][0],_nextState=this.jr[_i406][1];if(_nextState&&_regex.test(input))return _nextState}return this.jd},has:function has(input,exactOnly){return void 0===exactOnly&&(exactOnly=!1),exactOnly?input in this.j:!!this.go(input)},ta:function ta(inputs,next,flags,groups){for(var _i408=0;_i408<inputs.length;_i408++)this.tt(inputs[_i408],next,flags,groups)},tr:function tr(regexp,next,flags,groups){var nextState;return groups=groups||State.groups,next&&next.j?nextState=next:(nextState=new State(next),flags&&groups&&addToGroups(next,flags,groups)),this.jr.push([regexp,nextState]),nextState},ts:function ts(input,next,flags,groups){var state=this,len=input.length;if(!len)return state;for(var _i410=0;_i410<len-1;_i410++)state=state.tt(input[_i410]);return state.tt(input[len-1],next,flags,groups)},tt:function tt(input,next,flags,groups){groups=groups||State.groups;if(next&&next.j)return this.j[input]=next,next;var nextState,t=next,templateState=this.go(input);if(templateState?(nextState=new State,assign$2(nextState.j,templateState.j),nextState.jr.push.apply(nextState.jr,templateState.jr),nextState.jd=templateState.jd,nextState.t=templateState.t):nextState=new State,t){if(groups)if(nextState.t&&"string"==typeof nextState.t){var allFlags=assign$2(function flagsForToken(t,groups){var result={};for(var c in groups)groups[c].indexOf(t)>=0&&(result[c]=!0);return result}(nextState.t,groups),flags);addToGroups(t,allFlags,groups)}else flags&&addToGroups(t,flags,groups);nextState.t=t}return this.j[input]=nextState,nextState}};var ta=function ta(state,input,next,flags,groups){return state.ta(input,next,flags,groups)},tr=function tr(state,regexp,next,flags,groups){return state.tr(regexp,next,flags,groups)},ts=function ts(state,input,next,flags,groups){return state.ts(input,next,flags,groups)},tt=function tt(state,input,next,flags,groups){return state.tt(input,next,flags,groups)},WORD="WORD",UWORD="UWORD",LOCALHOST="LOCALHOST",TLD="TLD",UTLD="UTLD",SCHEME="SCHEME",SLASH_SCHEME="SLASH_SCHEME",NUM="NUM",WS="WS",NL$1="NL",OPENBRACE="OPENBRACE",OPENBRACKET="OPENBRACKET",OPENANGLEBRACKET="OPENANGLEBRACKET",OPENPAREN="OPENPAREN",CLOSEBRACE="CLOSEBRACE",CLOSEBRACKET="CLOSEBRACKET",CLOSEANGLEBRACKET="CLOSEANGLEBRACKET",CLOSEPAREN="CLOSEPAREN",AMPERSAND="AMPERSAND",APOSTROPHE$1="APOSTROPHE",ASTERISK="ASTERISK",AT="AT",BACKSLASH="BACKSLASH",BACKTICK="BACKTICK",CARET="CARET",COLON="COLON",COMMA="COMMA",DOLLAR="DOLLAR",DOT="DOT",EQUALS="EQUALS",EXCLAMATION="EXCLAMATION",HYPHEN="HYPHEN",PERCENT="PERCENT",PIPE="PIPE",PLUS="PLUS",POUND="POUND",QUERY="QUERY",QUOTE="QUOTE",SEMI="SEMI",SLASH="SLASH",TILDE="TILDE",UNDERSCORE="UNDERSCORE",EMOJI$1="EMOJI",SYM="SYM",tk=Object.freeze({__proto__:null,WORD,UWORD,LOCALHOST,TLD,UTLD,SCHEME,SLASH_SCHEME,NUM,WS,NL:NL$1,OPENBRACE,OPENBRACKET,OPENANGLEBRACKET,OPENPAREN,CLOSEBRACE,CLOSEBRACKET,CLOSEANGLEBRACKET,CLOSEPAREN,AMPERSAND,APOSTROPHE:APOSTROPHE$1,ASTERISK,AT,BACKSLASH,BACKTICK,CARET,COLON,COMMA,DOLLAR,DOT,EQUALS,EXCLAMATION,HYPHEN,PERCENT,PIPE,PLUS,POUND,QUERY,QUOTE,SEMI,SLASH,TILDE,UNDERSCORE,EMOJI:EMOJI$1,SYM}),ASCII_LETTER=/[a-z]/,LETTER=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/,EMOJI=/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8])/,DIGIT=/\d/,SPACE=/\s/,NL="\n",EMOJI_VARIATION="️",EMOJI_JOINER="‍",tlds=null,utlds=null;function fastts(state,input,t,defaultt,jr){for(var next,len=input.length,_i418=0;_i418<len-1;_i418++){var _char2=input[_i418];state.j[_char2]?next=state.j[_char2]:((next=new State(defaultt)).jr=jr.slice(),state.j[_char2]=next),state=next}return(next=new State(t)).jr=jr.slice(),state.j[input[len-1]]=next,next}function decodeTlds(encoded){for(var words=[],stack=[],i=0;i<encoded.length;){for(var popDigitCount=0;"0123456789".indexOf(encoded[i+popDigitCount])>=0;)popDigitCount++;if(popDigitCount>0){words.push(stack.join(""));for(var popCount=parseInt(encoded.substring(i,i+popDigitCount),10);popCount>0;popCount--)stack.pop();i+=popDigitCount}else stack.push(encoded[i]),i++}return words}var defaults={defaultProtocol:"http",events:null,format:noop,formatHref:noop,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Options(opts,defaultRender){void 0===defaultRender&&(defaultRender=null);var o=assign$2({},defaults);opts&&(o=assign$2(o,opts instanceof Options?opts.o:opts));for(var ignoredTags=o.ignoreTags,uppercaseIgnoredTags=[],_i420=0;_i420<ignoredTags.length;_i420++)uppercaseIgnoredTags.push(ignoredTags[_i420].toUpperCase());this.o=o,defaultRender&&(this.defaultRender=defaultRender),this.ignoreTags=uppercaseIgnoredTags}function noop(val){return val}function MultiToken(value,tokens){this.t="token",this.v=value,this.tk=tokens}function createTokenClass(type,props){var Token=function(_MultiToken){_inherits(Token,_MultiToken);var _super24=_createSuper(Token);function Token(value,tokens){var _this56;return _classCallCheck(this,Token),(_this56=_super24.call(this,value,tokens)).t=type,_this56}return _createClass(Token)}(MultiToken);for(var p in props)Token.prototype[p]=props[p];return Token.t=type,Token}Options.prototype={o:defaults,ignoreTags:[],defaultRender:function defaultRender(ir){return ir},check:function check(token){return this.get("validate",token.toString(),token)},get:function get(key,operator,token){var isCallable=null!=operator,option=this.o[key];return option?("object"==typeof option?"function"==typeof(option=token.t in option?option[token.t]:defaults[key])&&isCallable&&(option=option(operator,token)):"function"==typeof option&&isCallable&&(option=option(operator,token.t,token)),option):option},getObj:function getObj(key,operator,token){var obj=this.o[key];return"function"==typeof obj&&null!=operator&&(obj=obj(operator,token.t,token)),obj},render:function render(token){var ir=token.render(this);return(this.get("render",null,token)||this.defaultRender)(ir,token.t,token)}},MultiToken.prototype={isLink:!1,toString:function toString(){return this.v},toHref:function toHref(scheme){return this.toString()},toFormattedString:function toFormattedString(options){var val=this.toString(),truncate=options.get("truncate",val,this),formatted=options.get("format",val,this);return truncate&&formatted.length>truncate?formatted.substring(0,truncate)+"…":formatted},toFormattedHref:function toFormattedHref(options){return options.get("formatHref",this.toHref(options.get("defaultProtocol")),this)},startIndex:function startIndex(){return this.tk[0].s},endIndex:function endIndex(){return this.tk[this.tk.length-1].e},toObject:function toObject(protocol){return void 0===protocol&&(protocol=defaults.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(protocol),start:this.startIndex(),end:this.endIndex()}},toFormattedObject:function toFormattedObject(options){return{type:this.t,value:this.toFormattedString(options),isLink:this.isLink,href:this.toFormattedHref(options),start:this.startIndex(),end:this.endIndex()}},validate:function validate(options){return options.get("validate",this.toString(),this)},render:function render(options){var href=this.toHref(options.get("defaultProtocol")),formattedHref=options.get("formatHref",href,this),tagName=options.get("tagName",href,this),content=this.toFormattedString(options),attributes={},className=options.get("className",href,this),target=options.get("target",href,this),rel=options.get("rel",href,this),attrs=options.getObj("attributes",href,this),eventListeners=options.getObj("events",href,this);return attributes.href=formattedHref,className&&(attributes.class=className),target&&(attributes.target=target),rel&&(attributes.rel=rel),attrs&&assign$2(attributes,attrs),{tagName,attributes,content,eventListeners}}};var Email=createTokenClass("email",{isLink:!0,toHref:function toHref(){return"mailto:"+this.toString()}}),Text$2=createTokenClass("text"),Nl=createTokenClass("nl"),Url$1=createTokenClass("url",{isLink:!0,toHref:function toHref(scheme){return void 0===scheme&&(scheme=defaults.defaultProtocol),this.hasProtocol()?this.v:scheme+"://"+this.v},hasProtocol:function hasProtocol(){var tokens=this.tk;return tokens.length>=2&&tokens[0].t!==LOCALHOST&&tokens[1].t===COLON}}),makeState=function makeState(arg){return new State(arg)};function initMultiToken(Multi,input,tokens){var startIdx=tokens[0].s,endIdx=tokens[tokens.length-1].e;return new Multi(input.slice(startIdx,endIdx),tokens)}var warn="undefined"!=typeof console&&console&&console.warn||function(){},INIT={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function registerCustomProtocol(scheme,optionalSlashSlash){if(void 0===optionalSlashSlash&&(optionalSlashSlash=!1),INIT.initialized&&warn('linkifyjs: already initialized - will not register custom scheme "'+scheme+'" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.'),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(scheme))throw new Error('linkifyjs: incorrect scheme format.\n 1. Must only contain digits, lowercase ASCII letters or "-"\n 2. Cannot start or end with "-"\n 3. "-" cannot repeat');INIT.customSchemes.push([scheme,optionalSlashSlash])}function init(){INIT.scanner=function init$2(customSchemes){var _tr15,_tr16,_tr17,_tr18,_tt,_tr19;void 0===customSchemes&&(customSchemes=[]);var groups={};State.groups=groups;var Start=new State;null==tlds&&(tlds=decodeTlds(encodedTlds)),null==utlds&&(utlds=decodeTlds(encodedUtlds)),tt(Start,"'",APOSTROPHE$1),tt(Start,"{",OPENBRACE),tt(Start,"[",OPENBRACKET),tt(Start,"<",OPENANGLEBRACKET),tt(Start,"(",OPENPAREN),tt(Start,"}",CLOSEBRACE),tt(Start,"]",CLOSEBRACKET),tt(Start,">",CLOSEANGLEBRACKET),tt(Start,")",CLOSEPAREN),tt(Start,"&",AMPERSAND),tt(Start,"*",ASTERISK),tt(Start,"@",AT),tt(Start,"`",BACKTICK),tt(Start,"^",CARET),tt(Start,":",COLON),tt(Start,",",COMMA),tt(Start,"$",DOLLAR),tt(Start,".",DOT),tt(Start,"=",EQUALS),tt(Start,"!",EXCLAMATION),tt(Start,"-",HYPHEN),tt(Start,"%",PERCENT),tt(Start,"|",PIPE),tt(Start,"+",PLUS),tt(Start,"#",POUND),tt(Start,"?",QUERY),tt(Start,'"',QUOTE),tt(Start,"/",SLASH),tt(Start,";",SEMI),tt(Start,"~",TILDE),tt(Start,"_",UNDERSCORE),tt(Start,"\\",BACKSLASH);var Num=tr(Start,DIGIT,NUM,((_tr15={})[numeric]=!0,_tr15));tr(Num,DIGIT,Num);var Word=tr(Start,ASCII_LETTER,WORD,((_tr16={})[ascii]=!0,_tr16));tr(Word,ASCII_LETTER,Word);var UWord=tr(Start,LETTER,UWORD,((_tr17={})[alpha$1]=!0,_tr17));tr(UWord,ASCII_LETTER),tr(UWord,LETTER,UWord);var Ws=tr(Start,SPACE,WS,((_tr18={})[whitespace]=!0,_tr18));tt(Start,NL,NL$1,((_tt={})[whitespace]=!0,_tt)),tt(Ws,NL),tr(Ws,SPACE,Ws);var Emoji=tr(Start,EMOJI,EMOJI$1,((_tr19={})[emoji]=!0,_tr19));tr(Emoji,EMOJI,Emoji),tt(Emoji,EMOJI_VARIATION,Emoji);var EmojiJoiner=tt(Emoji,EMOJI_JOINER);tr(EmojiJoiner,EMOJI,Emoji);for(var wordjr=[[ASCII_LETTER,Word]],uwordjr=[[ASCII_LETTER,null],[LETTER,UWord]],_i412=0;_i412<tlds.length;_i412++)fastts(Start,tlds[_i412],TLD,WORD,wordjr);for(var _i414=0;_i414<utlds.length;_i414++)fastts(Start,utlds[_i414],UTLD,UWORD,uwordjr);addToGroups(TLD,{tld:!0,ascii:!0},groups),addToGroups(UTLD,{utld:!0,alpha:!0},groups),fastts(Start,"file",SCHEME,WORD,wordjr),fastts(Start,"mailto",SCHEME,WORD,wordjr),fastts(Start,"http",SLASH_SCHEME,WORD,wordjr),fastts(Start,"https",SLASH_SCHEME,WORD,wordjr),fastts(Start,"ftp",SLASH_SCHEME,WORD,wordjr),fastts(Start,"ftps",SLASH_SCHEME,WORD,wordjr),addToGroups(SCHEME,{scheme:!0,ascii:!0},groups),addToGroups(SLASH_SCHEME,{slashscheme:!0,ascii:!0},groups),customSchemes=customSchemes.sort((function(a,b){return a[0]>b[0]?1:-1}));for(var _i416=0;_i416<customSchemes.length;_i416++){var _ref106,_ref107,sch=customSchemes[_i416][0],flags=customSchemes[_i416][1]?((_ref106={})[scheme]=!0,_ref106):((_ref107={})[slashscheme]=!0,_ref107);sch.indexOf("-")>=0?flags[domain]=!0:ASCII_LETTER.test(sch)?DIGIT.test(sch)?flags[asciinumeric]=!0:flags[ascii]=!0:flags[numeric]=!0,ts(Start,sch,sch,flags)}return ts(Start,"localhost",LOCALHOST,{ascii:!0}),Start.jd=new State(SYM),{start:Start,tokens:assign$2({groups},tk)}}(INIT.customSchemes);for(var _i422=0;_i422<INIT.tokenQueue.length;_i422++)INIT.tokenQueue[_i422][1]({scanner:INIT.scanner});INIT.parser=function init$1(_ref){var groups=_ref.groups,qsAccepting=groups.domain.concat([AMPERSAND,ASTERISK,AT,BACKSLASH,BACKTICK,CARET,DOLLAR,EQUALS,HYPHEN,NUM,PERCENT,PIPE,PLUS,POUND,SLASH,SYM,TILDE,UNDERSCORE]),qsNonAccepting=[APOSTROPHE$1,CLOSEANGLEBRACKET,CLOSEBRACE,CLOSEBRACKET,CLOSEPAREN,COLON,COMMA,DOT,EXCLAMATION,OPENANGLEBRACKET,OPENBRACE,OPENBRACKET,OPENPAREN,QUERY,QUOTE,SEMI],localpartAccepting=[AMPERSAND,APOSTROPHE$1,ASTERISK,BACKSLASH,BACKTICK,CARET,CLOSEBRACE,DOLLAR,EQUALS,HYPHEN,OPENBRACE,PERCENT,PIPE,PLUS,POUND,QUERY,SLASH,SYM,TILDE,UNDERSCORE],Start=makeState(),Localpart=tt(Start,TILDE);ta(Localpart,localpartAccepting,Localpart),ta(Localpart,groups.domain,Localpart);var Domain=makeState(),Scheme=makeState(),SlashScheme=makeState();ta(Start,groups.domain,Domain),ta(Start,groups.scheme,Scheme),ta(Start,groups.slashscheme,SlashScheme),ta(Domain,localpartAccepting,Localpart),ta(Domain,groups.domain,Domain);var LocalpartAt=tt(Domain,AT);tt(Localpart,AT,LocalpartAt),tt(Scheme,AT,LocalpartAt),tt(SlashScheme,AT,LocalpartAt);var LocalpartDot=tt(Localpart,DOT);ta(LocalpartDot,localpartAccepting,Localpart),ta(LocalpartDot,groups.domain,Localpart);var EmailDomain=makeState();ta(LocalpartAt,groups.domain,EmailDomain),ta(EmailDomain,groups.domain,EmailDomain);var EmailDomainDot=tt(EmailDomain,DOT);ta(EmailDomainDot,groups.domain,EmailDomain);var Email$1=makeState(Email);ta(EmailDomainDot,groups.tld,Email$1),ta(EmailDomainDot,groups.utld,Email$1),tt(LocalpartAt,LOCALHOST,Email$1);var EmailDomainHyphen=tt(EmailDomain,HYPHEN);ta(EmailDomainHyphen,groups.domain,EmailDomain),ta(Email$1,groups.domain,EmailDomain),tt(Email$1,DOT,EmailDomainDot),tt(Email$1,HYPHEN,EmailDomainHyphen);var EmailColon=tt(Email$1,COLON);ta(EmailColon,groups.numeric,Email);var DomainHyphen=tt(Domain,HYPHEN),DomainDot=tt(Domain,DOT);ta(DomainHyphen,groups.domain,Domain),ta(DomainDot,localpartAccepting,Localpart),ta(DomainDot,groups.domain,Domain);var DomainDotTld=makeState(Url$1);ta(DomainDot,groups.tld,DomainDotTld),ta(DomainDot,groups.utld,DomainDotTld),ta(DomainDotTld,groups.domain,Domain),ta(DomainDotTld,localpartAccepting,Localpart),tt(DomainDotTld,DOT,DomainDot),tt(DomainDotTld,HYPHEN,DomainHyphen),tt(DomainDotTld,AT,LocalpartAt);var DomainDotTldColon=tt(DomainDotTld,COLON),DomainDotTldColonPort=makeState(Url$1);ta(DomainDotTldColon,groups.numeric,DomainDotTldColonPort);var Url$1$1=makeState(Url$1),UrlNonaccept=makeState();ta(Url$1$1,qsAccepting,Url$1$1),ta(Url$1$1,qsNonAccepting,UrlNonaccept),ta(UrlNonaccept,qsAccepting,Url$1$1),ta(UrlNonaccept,qsNonAccepting,UrlNonaccept),tt(DomainDotTld,SLASH,Url$1$1),tt(DomainDotTldColonPort,SLASH,Url$1$1);var SchemeColon=tt(Scheme,COLON),SlashSchemeColon=tt(SlashScheme,COLON),SlashSchemeColonSlash=tt(SlashSchemeColon,SLASH),UriPrefix=tt(SlashSchemeColonSlash,SLASH);ta(Scheme,groups.domain,Domain),tt(Scheme,DOT,DomainDot),tt(Scheme,HYPHEN,DomainHyphen),ta(SlashScheme,groups.domain,Domain),tt(SlashScheme,DOT,DomainDot),tt(SlashScheme,HYPHEN,DomainHyphen),ta(SchemeColon,groups.domain,Url$1$1),tt(SchemeColon,SLASH,Url$1$1),ta(UriPrefix,groups.domain,Url$1$1),ta(UriPrefix,qsAccepting,Url$1$1),tt(UriPrefix,SLASH,Url$1$1);var UrlOpenbrace=tt(Url$1$1,OPENBRACE),UrlOpenbracket=tt(Url$1$1,OPENBRACKET),UrlOpenanglebracket=tt(Url$1$1,OPENANGLEBRACKET),UrlOpenparen=tt(Url$1$1,OPENPAREN);tt(UrlNonaccept,OPENBRACE,UrlOpenbrace),tt(UrlNonaccept,OPENBRACKET,UrlOpenbracket),tt(UrlNonaccept,OPENANGLEBRACKET,UrlOpenanglebracket),tt(UrlNonaccept,OPENPAREN,UrlOpenparen),tt(UrlOpenbrace,CLOSEBRACE,Url$1$1),tt(UrlOpenbracket,CLOSEBRACKET,Url$1$1),tt(UrlOpenanglebracket,CLOSEANGLEBRACKET,Url$1$1),tt(UrlOpenparen,CLOSEPAREN,Url$1$1),tt(UrlOpenbrace,CLOSEBRACE,Url$1$1);var UrlOpenbraceQ=makeState(Url$1),UrlOpenbracketQ=makeState(Url$1),UrlOpenanglebracketQ=makeState(Url$1),UrlOpenparenQ=makeState(Url$1);ta(UrlOpenbrace,qsAccepting,UrlOpenbraceQ),ta(UrlOpenbracket,qsAccepting,UrlOpenbracketQ),ta(UrlOpenanglebracket,qsAccepting,UrlOpenanglebracketQ),ta(UrlOpenparen,qsAccepting,UrlOpenparenQ);var UrlOpenbraceSyms=makeState(),UrlOpenbracketSyms=makeState(),UrlOpenanglebracketSyms=makeState(),UrlOpenparenSyms=makeState();return ta(UrlOpenbrace,qsNonAccepting),ta(UrlOpenbracket,qsNonAccepting),ta(UrlOpenanglebracket,qsNonAccepting),ta(UrlOpenparen,qsNonAccepting),ta(UrlOpenbraceQ,qsAccepting,UrlOpenbraceQ),ta(UrlOpenbracketQ,qsAccepting,UrlOpenbracketQ),ta(UrlOpenanglebracketQ,qsAccepting,UrlOpenanglebracketQ),ta(UrlOpenparenQ,qsAccepting,UrlOpenparenQ),ta(UrlOpenbraceQ,qsNonAccepting,UrlOpenbraceQ),ta(UrlOpenbracketQ,qsNonAccepting,UrlOpenbracketQ),ta(UrlOpenanglebracketQ,qsNonAccepting,UrlOpenanglebracketQ),ta(UrlOpenparenQ,qsNonAccepting,UrlOpenparenQ),ta(UrlOpenbraceSyms,qsAccepting,UrlOpenbraceSyms),ta(UrlOpenbracketSyms,qsAccepting,UrlOpenbracketQ),ta(UrlOpenanglebracketSyms,qsAccepting,UrlOpenanglebracketQ),ta(UrlOpenparenSyms,qsAccepting,UrlOpenparenQ),ta(UrlOpenbraceSyms,qsNonAccepting,UrlOpenbraceSyms),ta(UrlOpenbracketSyms,qsNonAccepting,UrlOpenbracketSyms),ta(UrlOpenanglebracketSyms,qsNonAccepting,UrlOpenanglebracketSyms),ta(UrlOpenparenSyms,qsNonAccepting,UrlOpenparenSyms),tt(UrlOpenbracketQ,CLOSEBRACKET,Url$1$1),tt(UrlOpenanglebracketQ,CLOSEANGLEBRACKET,Url$1$1),tt(UrlOpenparenQ,CLOSEPAREN,Url$1$1),tt(UrlOpenbraceQ,CLOSEBRACE,Url$1$1),tt(UrlOpenbracketSyms,CLOSEBRACKET,Url$1$1),tt(UrlOpenanglebracketSyms,CLOSEANGLEBRACKET,Url$1$1),tt(UrlOpenparenSyms,CLOSEPAREN,Url$1$1),tt(UrlOpenbraceSyms,CLOSEPAREN,Url$1$1),tt(Start,LOCALHOST,DomainDotTld),tt(Start,NL$1,Nl),{start:Start,tokens:tk}}(INIT.scanner.tokens);for(var _i424=0;_i424<INIT.pluginQueue.length;_i424++)INIT.pluginQueue[_i424][1]({scanner:INIT.scanner,parser:INIT.parser});INIT.initialized=!0}function tokenize$2(str){return INIT.initialized||init(),function run(start,input,tokens){for(var len=tokens.length,cursor=0,multis=[],textTokens=[];cursor<len;){for(var state=start,secondState=null,nextState=null,multiLength=0,latestAccepting=null,sinceAccepts=-1;cursor<len&&!(secondState=state.go(tokens[cursor].t));)textTokens.push(tokens[cursor++]);for(;cursor<len&&(nextState=secondState||state.go(tokens[cursor].t));)secondState=null,(state=nextState).accepts()?(sinceAccepts=0,latestAccepting=state):sinceAccepts>=0&&sinceAccepts++,cursor++,multiLength++;if(sinceAccepts<0)(cursor-=multiLength)<len&&(textTokens.push(tokens[cursor]),cursor++);else{textTokens.length>0&&(multis.push(initMultiToken(Text$2,input,textTokens)),textTokens=[]),cursor-=sinceAccepts,multiLength-=sinceAccepts;var Multi=latestAccepting.t,subtokens=tokens.slice(cursor-multiLength,cursor);multis.push(initMultiToken(Multi,input,subtokens))}}return textTokens.length>0&&multis.push(initMultiToken(Text$2,input,textTokens)),multis}(INIT.parser.start,str,function run$1(start,str){for(var iterable=function stringToArray(str){for(var result=[],len=str.length,index=0;index<len;){var _first10=str.charCodeAt(index),second=void 0,_char=_first10<55296||_first10>56319||index+1===len||(second=str.charCodeAt(index+1))<56320||second>57343?str[index]:str.slice(index,index+2);result.push(_char),index+=_char.length}return result}(str.replace(/[A-Z]/g,(function(c){return c.toLowerCase()}))),charCount=iterable.length,tokens=[],cursor=0,charCursor=0;charCursor<charCount;){for(var state=start,nextState=null,tokenLength=0,latestAccepting=null,sinceAccepts=-1,charsSinceAccepts=-1;charCursor<charCount&&(nextState=state.go(iterable[charCursor]));)(state=nextState).accepts()?(sinceAccepts=0,charsSinceAccepts=0,latestAccepting=state):sinceAccepts>=0&&(sinceAccepts+=iterable[charCursor].length,charsSinceAccepts++),tokenLength+=iterable[charCursor].length,cursor+=iterable[charCursor].length,charCursor++;cursor-=sinceAccepts,charCursor-=charsSinceAccepts,tokenLength-=sinceAccepts,tokens.push({t:latestAccepting.t,v:str.slice(cursor-tokenLength,cursor),s:cursor-tokenLength,e:cursor})}return tokens}(INIT.scanner.start,str))}function _find(str,type,opts){if(void 0===type&&(type=null),void 0===opts&&(opts=null),type&&"object"==typeof type){if(opts)throw Error("linkifyjs: Invalid link type "+type+"; must be a string");opts=type,type=null}for(var options=new Options(opts),tokens=tokenize$2(str),filtered=[],_i426=0;_i426<tokens.length;_i426++){var _token=tokens[_i426];!_token.isLink||type&&_token.t!==type||filtered.push(_token.toFormattedObject(options))}return filtered}function autolink$1(options){return new Plugin({key:new PluginKey("autolink"),appendTransaction:function appendTransaction(transactions,oldState,newState){var docChanges=transactions.some((function(transaction){return transaction.docChanged}))&&!oldState.doc.eq(newState.doc),preventAutolink=transactions.some((function(transaction){return transaction.getMeta("preventAutolink")}));if(docChanges&&!preventAutolink){var tr=newState.tr,transform=function combineTransactionSteps(oldDoc,transactions){var transform=new Transform(oldDoc);return transactions.forEach((function(transaction){transaction.steps.forEach((function(step){transform.step(step)}))})),transform}(oldState.doc,_toConsumableArray(transactions)),changes=function getChangedRanges(transform){var mapping=transform.mapping,steps=transform.steps,changes=[];return mapping.maps.forEach((function(stepMap,index){var ranges=[];if(stepMap.ranges.length)stepMap.forEach((function(from,to){ranges.push({from,to})}));else{var _steps$index=steps[index],from=_steps$index.from,to=_steps$index.to;if(void 0===from||void 0===to)return;ranges.push({from,to})}ranges.forEach((function(_ref68){var from=_ref68.from,to=_ref68.to,newStart=mapping.slice(index).map(from,-1),newEnd=mapping.slice(index).map(to),oldStart=mapping.invert().map(newStart,-1),oldEnd=mapping.invert().map(newEnd);changes.push({oldRange:{from:oldStart,to:oldEnd},newRange:{from:newStart,to:newEnd}})}))})),simplifyChangedRanges(changes)}(transform);if(changes.forEach((function(_ref108){var textBlock,textBeforeWhitespace,newRange=_ref108.newRange,nodesInChangedRanges=function findChildrenInRange(node,range,predicate){var nodesWithPos=[];return node.nodesBetween(range.from,range.to,(function(child,pos){predicate(child)&&nodesWithPos.push({node:child,pos})})),nodesWithPos}(newState.doc,newRange,(function(node){return node.isTextblock}));if(nodesInChangedRanges.length>1?(textBlock=nodesInChangedRanges[0],textBeforeWhitespace=newState.doc.textBetween(textBlock.pos,textBlock.pos+textBlock.node.nodeSize,void 0," ")):nodesInChangedRanges.length&&newState.doc.textBetween(newRange.from,newRange.to," "," ").endsWith(" ")&&(textBlock=nodesInChangedRanges[0],textBeforeWhitespace=newState.doc.textBetween(textBlock.pos,newRange.to,void 0," ")),textBlock&&textBeforeWhitespace){var wordsBeforeWhitespace=textBeforeWhitespace.split(" ").filter((function(s){return""!==s}));if(wordsBeforeWhitespace.length<=0)return!1;var lastWordBeforeSpace=wordsBeforeWhitespace[wordsBeforeWhitespace.length-1],lastWordAndBlockOffset=textBlock.pos+textBeforeWhitespace.lastIndexOf(lastWordBeforeSpace);if(!lastWordBeforeSpace)return!1;_find(lastWordBeforeSpace).filter((function(link){return link.isLink})).map((function(link){return Object.assign({},link,{from:lastWordAndBlockOffset+link.start+1,to:lastWordAndBlockOffset+link.end+1})})).filter((function(link){return!newState.schema.marks.code||!newState.doc.rangeHasMark(link.from,link.to,newState.schema.marks.code)})).filter((function(link){return!options.validate||options.validate(link.value)})).forEach((function(link){getMarksBetween(link.from,link.to,newState.doc).some((function(item){return item.mark.type===options.type}))||tr.addMark(link.from,link.to,options.type.create({href:link.href}))}))}})),tr.steps.length)return tr}}})}var Link=Mark.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate:function onCreate(){this.options.protocols.forEach((function(protocol){"string"!=typeof protocol?registerCustomProtocol(protocol.scheme,protocol.optionalSlashes):registerCustomProtocol(protocol)}))},onDestroy:function onDestroy(){!function reset(){State.groups={},INIT.scanner=null,INIT.parser=null,INIT.tokenQueue=[],INIT.pluginQueue=[],INIT.customSchemes=[],INIT.initialized=!1}()},inclusive:function inclusive(){return this.options.autolink},addOptions:function addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes:function addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML:function parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML:function renderHTML(_ref109){var HTMLAttributes=_ref109.HTMLAttributes;return["a",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this57=this;return{setLink:function setLink(attributes){return function(_ref110){return(0,_ref110.chain)().setMark(_this57.name,attributes).setMeta("preventAutolink",!0).run()}},toggleLink:function toggleLink(attributes){return function(_ref111){return(0,_ref111.chain)().toggleMark(_this57.name,attributes,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},unsetLink:function unsetLink(){return function(_ref112){return(0,_ref112.chain)().unsetMark(_this57.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}}},addPasteRules:function addPasteRules(){var _this58=this;return[markPasteRule({find:function find(text){return _find(text).filter((function(link){return!_this58.options.validate||_this58.options.validate(link.value)})).filter((function(link){return link.isLink})).map((function(link){return{text:link.value,index:link.start,data:link}}))},type:this.type,getAttributes:function getAttributes(match,pasteEvent){var _a,_b,html=null===(_a=pasteEvent.clipboardData)||void 0===_a?void 0:_a.getData("text/html"),existingLink=null==html?void 0:html.match(/href="([^"]*)"/);return existingLink?{href:existingLink[1]}:{href:null===(_b=match.data)||void 0===_b?void 0:_b.href}}})]},addProseMirrorPlugins:function addProseMirrorPlugins(){var plugins=[];return this.options.autolink&&plugins.push(autolink$1({type:this.type,validate:this.options.validate})),this.options.openOnClick&&plugins.push(function clickHandler(options){return new Plugin({key:new PluginKey("handleClickLink"),props:{handleClick:function handleClick(view,pos,event){var _a,_b;if(0!==event.button)return!1;if("A"!==event.target.nodeName)return!1;var attrs=_getAttributes(view.state,options.type.name),link=event.target,href=null!==(_a=null==link?void 0:link.href)&&void 0!==_a?_a:attrs.href,target=null!==(_b=null==link?void 0:link.target)&&void 0!==_b?_b:attrs.target;return!(!link||!href||(view.editable&&window.open(href,target),0))}}})}({type:this.type})),plugins}}),inputRegex$5=/^\s*>\s$/,Blockquote=Node.create({name:"blockquote",addOptions:function addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML:function parseHTML(){return[{tag:"blockquote"}]},renderHTML:function renderHTML(_ref113){var HTMLAttributes=_ref113.HTMLAttributes;return["blockquote",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this59=this;return{setBlockquote:function setBlockquote(){return function(_ref114){return _ref114.commands.wrapIn(_this59.name)}},toggleBlockquote:function toggleBlockquote(){return function(_ref115){return _ref115.commands.toggleWrap(_this59.name)}},unsetBlockquote:function unsetBlockquote(){return function(_ref116){return _ref116.commands.lift(_this59.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this60=this;return{"Mod-Shift-b":function ModShiftB(){return _this60.editor.commands.toggleBlockquote()}}},addInputRules:function addInputRules(){return[wrappingInputRule({find:inputRegex$5,type:this.type})]}}),starInputRegex$1=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,starPasteRegex$1=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,underscoreInputRegex$1=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,underscorePasteRegex$1=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Bold=Mark.create({name:"bold",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:function getAttrs(node){return"normal"!==node.style.fontWeight&&null}},{style:"font-weight",getAttrs:function getAttrs(value){return/^(bold(er)?|[5-9]\d{2,})$/.test(value)&&null}}]},renderHTML:function renderHTML(_ref117){var HTMLAttributes=_ref117.HTMLAttributes;return["strong",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this61=this;return{setBold:function setBold(){return function(_ref118){return _ref118.commands.setMark(_this61.name)}},toggleBold:function toggleBold(){return function(_ref119){return _ref119.commands.toggleMark(_this61.name)}},unsetBold:function unsetBold(){return function(_ref120){return _ref120.commands.unsetMark(_this61.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this62=this;return{"Mod-b":function ModB(){return _this62.editor.commands.toggleBold()},"Mod-B":function ModB(){return _this62.editor.commands.toggleBold()}}},addInputRules:function addInputRules(){return[markInputRule({find:starInputRegex$1,type:this.type}),markInputRule({find:underscoreInputRegex$1,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:starPasteRegex$1,type:this.type}),markPasteRule({find:underscorePasteRegex$1,type:this.type})]}}),ListItem$2=Node.create({name:"listItem",addOptions:function addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML:function parseHTML(){return[{tag:"li"}]},renderHTML:function renderHTML(_ref121){var HTMLAttributes=_ref121.HTMLAttributes;return["li",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this63=this;return{Enter:function Enter(){return _this63.editor.commands.splitListItem(_this63.name)},Tab:function Tab(){return _this63.editor.commands.sinkListItem(_this63.name)},"Shift-Tab":function ShiftTab(){return _this63.editor.commands.liftListItem(_this63.name)}}}}),TextStyle$1=Mark.create({name:"textStyle",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"span",getAttrs:function getAttrs(element){return!!element.hasAttribute("style")&&{}}}]},renderHTML:function renderHTML(_ref122){var HTMLAttributes=_ref122.HTMLAttributes;return["span",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this64=this;return{removeEmptyTextStyle:function removeEmptyTextStyle(){return function(_ref123){var state=_ref123.state,commands=_ref123.commands,attributes=getMarkAttributes(state,_this64.type);return!!Object.entries(attributes).some((function(_ref124){return!!_slicedToArray(_ref124,2)[1]}))||commands.unsetMark(_this64.name)}}}}}),inputRegex$4=/^\s*([-+*])\s$/,BulletList$1=Node.create({name:"bulletList",addOptions:function addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content:function content(){return this.options.itemTypeName+"+"},parseHTML:function parseHTML(){return[{tag:"ul"}]},renderHTML:function renderHTML(_ref126){var HTMLAttributes=_ref126.HTMLAttributes;return["ul",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this65=this;return{toggleBulletList:function toggleBulletList(){return function(_ref127){var commands=_ref127.commands,chain=_ref127.chain;return _this65.options.keepAttributes?chain().toggleList(_this65.name,_this65.options.itemTypeName,_this65.options.keepMarks).updateAttributes(ListItem$2.name,_this65.editor.getAttributes(TextStyle$1.name)).run():commands.toggleList(_this65.name,_this65.options.itemTypeName,_this65.options.keepMarks)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this66=this;return{"Mod-Shift-8":function ModShift8(){return _this66.editor.commands.toggleBulletList()}}},addInputRules:function addInputRules(){var _this67=this,inputRule=wrappingInputRule({find:inputRegex$4,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(inputRule=wrappingInputRule({find:inputRegex$4,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:function getAttributes(){return _this67.editor.getAttributes(TextStyle$1.name)},editor:this.editor})),[inputRule]}}),inputRegex$3=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,pasteRegex$1=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Code=Mark.create({name:"code",addOptions:function addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML:function parseHTML(){return[{tag:"code"}]},renderHTML:function renderHTML(_ref128){var HTMLAttributes=_ref128.HTMLAttributes;return["code",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this68=this;return{setCode:function setCode(){return function(_ref129){return _ref129.commands.setMark(_this68.name)}},toggleCode:function toggleCode(){return function(_ref130){return _ref130.commands.toggleMark(_this68.name)}},unsetCode:function unsetCode(){return function(_ref131){return _ref131.commands.unsetMark(_this68.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this69=this;return{"Mod-e":function ModE(){return _this69.editor.commands.toggleCode()}}},addInputRules:function addInputRules(){return[markInputRule({find:inputRegex$3,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:pasteRegex$1,type:this.type})]}}),backtickInputRegex=/^```([a-z]+)?[\s\n]$/,tildeInputRegex=/^~~~([a-z]+)?[\s\n]$/,CodeBlock=Node.create({name:"codeBlock",addOptions:function addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes:function addAttributes(){var _this70=this;return{language:{default:null,parseHTML:function parseHTML(element){var _a,languageClassPrefix=_this70.options.languageClassPrefix,language=_toConsumableArray((null===(_a=element.firstElementChild)||void 0===_a?void 0:_a.classList)||[]).filter((function(className){return className.startsWith(languageClassPrefix)})).map((function(className){return className.replace(languageClassPrefix,"")}))[0];return language||null},rendered:!1}}},parseHTML:function parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML:function renderHTML(_ref132){var node=_ref132.node,HTMLAttributes=_ref132.HTMLAttributes;return["pre",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),["code",{class:node.attrs.language?this.options.languageClassPrefix+node.attrs.language:null},0]]},addCommands:function addCommands(){var _this71=this;return{setCodeBlock:function setCodeBlock(attributes){return function(_ref133){return _ref133.commands.setNode(_this71.name,attributes)}},toggleCodeBlock:function toggleCodeBlock(attributes){return function(_ref134){return _ref134.commands.toggleNode(_this71.name,"paragraph",attributes)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this72=this;return{"Mod-Alt-c":function ModAltC(){return _this72.editor.commands.toggleCodeBlock()},Backspace:function Backspace(){var _this72$editor$state$=_this72.editor.state.selection,empty=_this72$editor$state$.empty,$anchor=_this72$editor$state$.$anchor,isAtStart=1===$anchor.pos;return!(!empty||$anchor.parent.type.name!==_this72.name)&&(!(!isAtStart&&$anchor.parent.textContent.length)&&_this72.editor.commands.clearNodes())},Enter:function Enter(_ref135){var editor=_ref135.editor;if(!_this72.options.exitOnTripleEnter)return!1;var selection=editor.state.selection,$from=selection.$from;if(!selection.empty||$from.parent.type!==_this72.type)return!1;var isAtEnd=$from.parentOffset===$from.parent.nodeSize-2,endsWithDoubleNewline=$from.parent.textContent.endsWith("\n\n");return!(!isAtEnd||!endsWithDoubleNewline)&&editor.chain().command((function(_ref136){return _ref136.tr.delete($from.pos-2,$from.pos),!0})).exitCode().run()},ArrowDown:function ArrowDown(_ref137){var editor=_ref137.editor;if(!_this72.options.exitOnArrowDown)return!1;var state=editor.state,selection=state.selection,doc=state.doc,$from=selection.$from;if(!selection.empty||$from.parent.type!==_this72.type)return!1;if(!($from.parentOffset===$from.parent.nodeSize-2))return!1;var after=$from.after();return void 0!==after&&(!doc.nodeAt(after)&&editor.commands.exitCode())}}},addInputRules:function addInputRules(){return[textblockTypeInputRule({find:backtickInputRegex,type:this.type,getAttributes:function getAttributes(match){return{language:match[1]}}}),textblockTypeInputRule({find:tildeInputRegex,type:this.type,getAttributes:function getAttributes(match){return{language:match[1]}}})]},addProseMirrorPlugins:function addProseMirrorPlugins(){var _this73=this;return[new Plugin({key:new PluginKey("codeBlockVSCodeHandler"),props:{handlePaste:function handlePaste(view,event){if(!event.clipboardData)return!1;if(_this73.editor.isActive(_this73.type.name))return!1;var text=event.clipboardData.getData("text/plain"),vscode=event.clipboardData.getData("vscode-editor-data"),vscodeData=vscode?JSON.parse(vscode):void 0,language=null==vscodeData?void 0:vscodeData.mode;if(!text||!language)return!1;var tr=view.state.tr;return tr.replaceSelectionWith(_this73.type.create({language})),tr.setSelection(TextSelection.near(tr.doc.resolve(Math.max(0,tr.selection.from-2)))),tr.insertText(text.replace(/\r\n?/g,"\n")),tr.setMeta("paste",!0),view.dispatch(tr),!0}}})]}}),Document=Node.create({name:"doc",topNode:!0,content:"block+"});function dropCursor(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Plugin({view:function view(editorView){return new DropCursorView(editorView,options)}})}var DropCursorView=function(){function DropCursorView(editorView,options){var _a,_this74=this;_classCallCheck(this,DropCursorView),this.editorView=editorView,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(_a=options.width)&&void 0!==_a?_a:1,this.color=!1===options.color?void 0:options.color||"black",this.class=options.class,this.handlers=["dragover","dragend","drop","dragleave"].map((function(name){var handler=function handler(e){_this74[name](e)};return editorView.dom.addEventListener(name,handler),{name,handler}}))}return _createClass(DropCursorView,[{key:"destroy",value:function destroy(){var _this75=this;this.handlers.forEach((function(_ref138){var name=_ref138.name,handler=_ref138.handler;return _this75.editorView.dom.removeEventListener(name,handler)}))}},{key:"update",value:function update(editorView,prevState){null!=this.cursorPos&&prevState.doc!=editorView.state.doc&&(this.cursorPos>editorView.state.doc.content.size?this.setCursor(null):this.updateOverlay())}},{key:"setCursor",value:function setCursor(pos){pos!=this.cursorPos&&(this.cursorPos=pos,null==pos?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}},{key:"updateOverlay",value:function updateOverlay(){var rect,$pos=this.editorView.state.doc.resolve(this.cursorPos),isBlock=!$pos.parent.inlineContent;if(isBlock){var before=$pos.nodeBefore,after=$pos.nodeAfter;if(before||after){var node=this.editorView.nodeDOM(this.cursorPos-(before?before.nodeSize:0));if(node){var nodeRect=node.getBoundingClientRect(),_top4=before?nodeRect.bottom:nodeRect.top;before&&after&&(_top4=(_top4+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),rect={left:nodeRect.left,right:nodeRect.right,top:_top4-this.width/2,bottom:_top4+this.width/2}}}}if(!rect){var coords=this.editorView.coordsAtPos(this.cursorPos);rect={left:coords.left-this.width/2,right:coords.left+this.width/2,top:coords.top,bottom:coords.bottom}}var parentLeft,parentTop,parent=this.editorView.dom.offsetParent;if(this.element||(this.element=parent.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",isBlock),this.element.classList.toggle("prosemirror-dropcursor-inline",!isBlock),!parent||parent==document.body&&"static"==getComputedStyle(parent).position)parentLeft=-pageXOffset,parentTop=-pageYOffset;else{var _rect7=parent.getBoundingClientRect();parentLeft=_rect7.left-parent.scrollLeft,parentTop=_rect7.top-parent.scrollTop}this.element.style.left=rect.left-parentLeft+"px",this.element.style.top=rect.top-parentTop+"px",this.element.style.width=rect.right-rect.left+"px",this.element.style.height=rect.bottom-rect.top+"px"}},{key:"scheduleRemoval",value:function scheduleRemoval(timeout){var _this76=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return _this76.setCursor(null)}),timeout)}},{key:"dragover",value:function dragover(event){if(this.editorView.editable){var pos=this.editorView.posAtCoords({left:event.clientX,top:event.clientY}),node=pos&&pos.inside>=0&&this.editorView.state.doc.nodeAt(pos.inside),disableDropCursor=node&&node.type.spec.disableDropCursor,disabled="function"==typeof disableDropCursor?disableDropCursor(this.editorView,pos,event):disableDropCursor;if(pos&&!disabled){var _target5=pos.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){var point=dropPoint(this.editorView.state.doc,_target5,this.editorView.dragging.slice);null!=point&&(_target5=point)}this.setCursor(_target5),this.scheduleRemoval(5e3)}}}},{key:"dragend",value:function dragend(){this.scheduleRemoval(20)}},{key:"drop",value:function drop(){this.scheduleRemoval(20)}},{key:"dragleave",value:function dragleave(event){event.target!=this.editorView.dom&&this.editorView.dom.contains(event.relatedTarget)||this.setCursor(null)}}]),DropCursorView}(),Dropcursor=Extension.create({name:"dropCursor",addOptions:function addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins:function addProseMirrorPlugins(){return[dropCursor(this.options)]}}),GapCursor=function(_Selection4){_inherits(GapCursor,_Selection4);var _super25=_createSuper(GapCursor);function GapCursor($pos){return _classCallCheck(this,GapCursor),_super25.call(this,$pos,$pos)}return _createClass(GapCursor,[{key:"map",value:function map(doc,mapping){var $pos=doc.resolve(mapping.map(this.head));return GapCursor.valid($pos)?new GapCursor($pos):Selection.near($pos)}},{key:"content",value:function content(){return Slice.empty}},{key:"eq",value:function eq(other){return other instanceof GapCursor&&other.head==this.head}},{key:"toJSON",value:function toJSON(){return{type:"gapcursor",pos:this.head}}},{key:"getBookmark",value:function getBookmark(){return new GapBookmark(this.anchor)}}],[{key:"fromJSON",value:function fromJSON(doc,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new GapCursor(doc.resolve(json.pos))}},{key:"valid",value:function valid($pos){var parent=$pos.parent;if(parent.isTextblock||!function closedBefore($pos){for(var d=$pos.depth;d>=0;d--){var index=$pos.index(d),parent=$pos.node(d);if(0!=index)for(var before=parent.child(index-1);;before=before.lastChild){if(0==before.childCount&&!before.inlineContent||before.isAtom||before.type.spec.isolating)return!0;if(before.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos)||!function closedAfter($pos){for(var d=$pos.depth;d>=0;d--){var index=$pos.indexAfter(d),parent=$pos.node(d);if(index!=parent.childCount)for(var after=parent.child(index);;after=after.firstChild){if(0==after.childCount&&!after.inlineContent||after.isAtom||after.type.spec.isolating)return!0;if(after.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos))return!1;var override=parent.type.spec.allowGapCursor;if(null!=override)return override;var deflt=parent.contentMatchAt($pos.index()).defaultType;return deflt&&deflt.isTextblock}},{key:"findGapCursorFrom",value:function findGapCursorFrom($pos,dir){var mustMove=arguments.length>2&&void 0!==arguments[2]&&arguments[2];search:for(;;){if(!mustMove&&GapCursor.valid($pos))return $pos;for(var pos=$pos.pos,next=null,d=$pos.depth;;d--){var parent=$pos.node(d);if(dir>0?$pos.indexAfter(d)<parent.childCount:$pos.index(d)>0){next=parent.child(dir>0?$pos.indexAfter(d):$pos.index(d)-1);break}if(0==d)return null;pos+=dir;var $cur=$pos.doc.resolve(pos);if(GapCursor.valid($cur))return $cur}for(;;){var inside=dir>0?next.firstChild:next.lastChild;if(!inside){if(next.isAtom&&!next.isText&&!NodeSelection.isSelectable(next)){$pos=$pos.doc.resolve(pos+next.nodeSize*dir),mustMove=!1;continue search}break}next=inside,pos+=dir;var _$cur=$pos.doc.resolve(pos);if(GapCursor.valid(_$cur))return _$cur}return null}}}]),GapCursor}(Selection);GapCursor.prototype.visible=!1,GapCursor.findFrom=GapCursor.findGapCursorFrom,Selection.jsonID("gapcursor",GapCursor);var GapBookmark=function(){function GapBookmark(pos){_classCallCheck(this,GapBookmark),this.pos=pos}return _createClass(GapBookmark,[{key:"map",value:function map(mapping){return new GapBookmark(mapping.map(this.pos))}},{key:"resolve",value:function resolve(doc){var $pos=doc.resolve(this.pos);return GapCursor.valid($pos)?new GapCursor($pos):Selection.near($pos)}}]),GapBookmark}();var handleKeyDown=keydownHandler({ArrowLeft:arrow("horiz",-1),ArrowRight:arrow("horiz",1),ArrowUp:arrow("vert",-1),ArrowDown:arrow("vert",1)});function arrow(axis,dir){var dirStr="vert"==axis?dir>0?"down":"up":dir>0?"right":"left";return function(state,dispatch,view){var sel=state.selection,$start=dir>0?sel.$to:sel.$from,mustMove=sel.empty;if(sel instanceof TextSelection){if(!view.endOfTextblock(dirStr)||0==$start.depth)return!1;mustMove=!1,$start=state.doc.resolve(dir>0?$start.after():$start.before())}var $found=GapCursor.findGapCursorFrom($start,dir,mustMove);return!!$found&&(dispatch&&dispatch(state.tr.setSelection(new GapCursor($found))),!0)}}function handleClick(view,pos,event){if(!view||!view.editable)return!1;var $pos=view.state.doc.resolve(pos);if(!GapCursor.valid($pos))return!1;var clickPos=view.posAtCoords({left:event.clientX,top:event.clientY});return!(clickPos&&clickPos.inside>-1&&NodeSelection.isSelectable(view.state.doc.nodeAt(clickPos.inside)))&&(view.dispatch(view.state.tr.setSelection(new GapCursor($pos))),!0)}function beforeinput(view,event){if("insertCompositionText"!=event.inputType||!(view.state.selection instanceof GapCursor))return!1;var $from=view.state.selection.$from,insert=$from.parent.contentMatchAt($from.index()).findWrapping(view.state.schema.nodes.text);if(!insert)return!1;for(var frag=Fragment.empty,_i428=insert.length-1;_i428>=0;_i428--)frag=Fragment.from(insert[_i428].createAndFill(null,frag));var tr=view.state.tr.replace($from.pos,$from.pos,new Slice(frag,0,0));return tr.setSelection(TextSelection.near(tr.doc.resolve($from.pos+1))),view.dispatch(tr),!1}function drawGapCursor(state){if(!(state.selection instanceof GapCursor))return null;var node=document.createElement("div");return node.className="ProseMirror-gapcursor",DecorationSet.create(state.doc,[Decoration.widget(state.selection.head,node,{key:"gapcursor"})])}var Gapcursor=Extension.create({name:"gapCursor",addProseMirrorPlugins:function addProseMirrorPlugins(){return[new Plugin({props:{decorations:drawGapCursor,createSelectionBetween:function createSelectionBetween(_view,$anchor,$head){return $anchor.pos==$head.pos&&GapCursor.valid($head)?new GapCursor($head):null},handleClick,handleKeyDown,handleDOMEvents:{beforeinput}}})]},extendNodeSchema:function extendNodeSchema(extension){var _a;return{allowGapCursor:null!==(_a=callOrReturn(getExtensionField(extension,"allowGapCursor",{name:extension.name,options:extension.options,storage:extension.storage})))&&void 0!==_a?_a:null}}}),HardBreak=Node.create({name:"hardBreak",addOptions:function addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML:function parseHTML(){return[{tag:"br"}]},renderHTML:function renderHTML(_ref139){var HTMLAttributes=_ref139.HTMLAttributes;return["br",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes)]},renderText:function renderText(){return"\n"},addCommands:function addCommands(){var _this77=this;return{setHardBreak:function setHardBreak(){return function(_ref140){var commands=_ref140.commands,chain=_ref140.chain,state=_ref140.state,editor=_ref140.editor;return commands.first([function(){return commands.exitCode()},function(){return commands.command((function(){var selection=state.selection,storedMarks=state.storedMarks;if(selection.$from.parent.type.spec.isolating)return!1;var keepMarks=_this77.options.keepMarks,splittableMarks=editor.extensionManager.splittableMarks,marks=storedMarks||selection.$to.parentOffset&&selection.$from.marks();return chain().insertContent({type:_this77.name}).command((function(_ref141){var tr=_ref141.tr;if(_ref141.dispatch&&marks&&keepMarks){var filteredMarks=marks.filter((function(mark){return splittableMarks.includes(mark.type.name)}));tr.ensureMarks(filteredMarks)}return!0})).run()}))}])}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this78=this;return{"Mod-Enter":function ModEnter(){return _this78.editor.commands.setHardBreak()},"Shift-Enter":function ShiftEnter(){return _this78.editor.commands.setHardBreak()}}}}),Heading=Node.create({name:"heading",addOptions:function addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes:function addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML:function parseHTML(){return this.options.levels.map((function(level){return{tag:"h"+level,attrs:{level}}}))},renderHTML:function renderHTML(_ref142){var node=_ref142.node,HTMLAttributes=_ref142.HTMLAttributes;return["h"+(this.options.levels.includes(node.attrs.level)?node.attrs.level:this.options.levels[0]),mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this79=this;return{setHeading:function setHeading(attributes){return function(_ref143){var commands=_ref143.commands;return!!_this79.options.levels.includes(attributes.level)&&commands.setNode(_this79.name,attributes)}},toggleHeading:function toggleHeading(attributes){return function(_ref144){var commands=_ref144.commands;return!!_this79.options.levels.includes(attributes.level)&&commands.toggleNode(_this79.name,"paragraph",attributes)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this80=this;return this.options.levels.reduce((function(items,level){var _Object$assign4;return Object.assign({},items,((_Object$assign4={})["Mod-Alt-"+level]=function ModAlt(){return _this80.editor.commands.toggleHeading({level})},_Object$assign4))}),{})},addInputRules:function addInputRules(){var _this81=this;return this.options.levels.map((function(level){return textblockTypeInputRule({find:new RegExp("^(#{1,"+level+"})\\s$"),type:_this81.type,getAttributes:{level}})}))}}),RopeSequence=function RopeSequence(){};RopeSequence.prototype.append=function append(other){return other.length?(other=RopeSequence.from(other),!this.length&&other||other.length<200&&this.leafAppend(other)||this.length<200&&other.leafPrepend(this)||this.appendInner(other)):this},RopeSequence.prototype.prepend=function prepend(other){return other.length?RopeSequence.from(other).append(this):this},RopeSequence.prototype.appendInner=function appendInner(other){return new Append(this,other)},RopeSequence.prototype.slice=function slice(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.length),from>=to?RopeSequence.empty:this.sliceInner(Math.max(0,from),Math.min(this.length,to))},RopeSequence.prototype.get=function get(i){if(!(i<0||i>=this.length))return this.getInner(i)},RopeSequence.prototype.forEach=function forEach(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length),from<=to?this.forEachInner(f,from,to,0):this.forEachInvertedInner(f,from,to,0)},RopeSequence.prototype.map=function map(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length);var result=[];return this.forEach((function(elt,i){return result.push(f(elt,i))}),from,to),result},RopeSequence.from=function from(values){return values instanceof RopeSequence?values:values&&values.length?new Leaf(values):RopeSequence.empty};var Leaf=function(RopeSequence){function Leaf(values){RopeSequence.call(this),this.values=values}RopeSequence&&(Leaf.__proto__=RopeSequence),Leaf.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Leaf.prototype.constructor=Leaf;var prototypeAccessors={length:{configurable:!0},depth:{configurable:!0}};return Leaf.prototype.flatten=function flatten(){return this.values},Leaf.prototype.sliceInner=function sliceInner(from,to){return 0==from&&to==this.length?this:new Leaf(this.values.slice(from,to))},Leaf.prototype.getInner=function getInner(i){return this.values[i]},Leaf.prototype.forEachInner=function forEachInner(f,from,to,start){for(var i=from;i<to;i++)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){for(var i=from-1;i>=to;i--)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.leafAppend=function leafAppend(other){if(this.length+other.length<=200)return new Leaf(this.values.concat(other.flatten()))},Leaf.prototype.leafPrepend=function leafPrepend(other){if(this.length+other.length<=200)return new Leaf(other.flatten().concat(this.values))},prototypeAccessors.length.get=function(){return this.values.length},prototypeAccessors.depth.get=function(){return 0},Object.defineProperties(Leaf.prototype,prototypeAccessors),Leaf}(RopeSequence);RopeSequence.empty=new Leaf([]);var Append=function(RopeSequence){function Append(left,right){RopeSequence.call(this),this.left=left,this.right=right,this.length=left.length+right.length,this.depth=Math.max(left.depth,right.depth)+1}return RopeSequence&&(Append.__proto__=RopeSequence),Append.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Append.prototype.constructor=Append,Append.prototype.flatten=function flatten(){return this.left.flatten().concat(this.right.flatten())},Append.prototype.getInner=function getInner(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},Append.prototype.forEachInner=function forEachInner(f,from,to,start){var leftLen=this.left.length;return!(from<leftLen&&!1===this.left.forEachInner(f,from,Math.min(to,leftLen),start))&&(!(to>leftLen&&!1===this.right.forEachInner(f,Math.max(from-leftLen,0),Math.min(this.length,to)-leftLen,start+leftLen))&&void 0)},Append.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){var leftLen=this.left.length;return!(from>leftLen&&!1===this.right.forEachInvertedInner(f,from-leftLen,Math.max(to,leftLen)-leftLen,start+leftLen))&&(!(to<leftLen&&!1===this.left.forEachInvertedInner(f,Math.min(from,leftLen),to,start))&&void 0)},Append.prototype.sliceInner=function sliceInner(from,to){if(0==from&&to==this.length)return this;var leftLen=this.left.length;return to<=leftLen?this.left.slice(from,to):from>=leftLen?this.right.slice(from-leftLen,to-leftLen):this.left.slice(from,leftLen).append(this.right.slice(0,to-leftLen))},Append.prototype.leafAppend=function leafAppend(other){var inner=this.right.leafAppend(other);if(inner)return new Append(this.left,inner)},Append.prototype.leafPrepend=function leafPrepend(other){var inner=this.left.leafPrepend(other);if(inner)return new Append(inner,this.right)},Append.prototype.appendInner=function appendInner(other){return this.left.depth>=Math.max(this.right.depth,other.depth)+1?new Append(this.left,new Append(this.right,other)):new Append(this,other)},Append}(RopeSequence),Branch=function(){function Branch(items,eventCount){_classCallCheck(this,Branch),this.items=items,this.eventCount=eventCount}return _createClass(Branch,[{key:"popEvent",value:function popEvent(state,preserveItems){var _this82=this;if(0==this.eventCount)return null;for(var remap,mapFrom,end=this.items.length;;end--){if(this.items.get(end-1).selection){--end;break}}preserveItems&&(remap=this.remapping(end,this.items.length),mapFrom=remap.maps.length);var selection,remaining,transform=state.tr,addAfter=[],addBefore=[];return this.items.forEach((function(item,i){if(!item.step)return remap||(remap=_this82.remapping(end,i+1),mapFrom=remap.maps.length),mapFrom--,void addBefore.push(item);if(remap){addBefore.push(new Item(item.map));var _map3,step=item.step.map(remap.slice(mapFrom));step&&transform.maybeStep(step).doc&&(_map3=transform.mapping.maps[transform.mapping.maps.length-1],addAfter.push(new Item(_map3,void 0,void 0,addAfter.length+addBefore.length))),mapFrom--,_map3&&remap.appendMap(_map3,mapFrom)}else transform.maybeStep(item.step);return item.selection?(selection=remap?item.selection.map(remap.slice(mapFrom)):item.selection,remaining=new Branch(_this82.items.slice(0,end).append(addBefore.reverse().concat(addAfter)),_this82.eventCount-1),!1):void 0}),this.items.length,0),{remaining,transform,selection}}},{key:"addTransform",value:function addTransform(transform,selection,histOptions,preserveItems){for(var newItems=[],eventCount=this.eventCount,oldItems=this.items,lastItem=!preserveItems&&oldItems.length?oldItems.get(oldItems.length-1):null,_i430=0;_i430<transform.steps.length;_i430++){var merged,step=transform.steps[_i430].invert(transform.docs[_i430]),item=new Item(transform.mapping.maps[_i430],step,selection);(merged=lastItem&&lastItem.merge(item))&&(item=merged,_i430?newItems.pop():oldItems=oldItems.slice(0,oldItems.length-1)),newItems.push(item),selection&&(eventCount++,selection=void 0),preserveItems||(lastItem=item)}var overflow=eventCount-histOptions.depth;return overflow>DEPTH_OVERFLOW&&(oldItems=function cutOffEvents(items,n){var cutPoint;return items.forEach((function(item,i){if(item.selection&&0==n--)return cutPoint=i,!1})),items.slice(cutPoint)}(oldItems,overflow),eventCount-=overflow),new Branch(oldItems.append(newItems),eventCount)}},{key:"remapping",value:function remapping(from,to){var maps=new Mapping;return this.items.forEach((function(item,i){var mirrorPos=null!=item.mirrorOffset&&i-item.mirrorOffset>=from?maps.maps.length-item.mirrorOffset:void 0;maps.appendMap(item.map,mirrorPos)}),from,to),maps}},{key:"addMaps",value:function addMaps(array){return 0==this.eventCount?this:new Branch(this.items.append(array.map((function(map){return new Item(map)}))),this.eventCount)}},{key:"rebased",value:function rebased(rebasedTransform,rebasedCount){if(!this.eventCount)return this;var rebasedItems=[],start=Math.max(0,this.items.length-rebasedCount),mapping=rebasedTransform.mapping,newUntil=rebasedTransform.steps.length,eventCount=this.eventCount;this.items.forEach((function(item){item.selection&&eventCount--}),start);var iRebased=rebasedCount;this.items.forEach((function(item){var pos=mapping.getMirror(--iRebased);if(null!=pos){newUntil=Math.min(newUntil,pos);var map=mapping.maps[pos];if(item.step){var step=rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]),selection=item.selection&&item.selection.map(mapping.slice(iRebased+1,pos));selection&&eventCount++,rebasedItems.push(new Item(map,step,selection))}else rebasedItems.push(new Item(map))}}),start);for(var newMaps=[],_i432=rebasedCount;_i432<newUntil;_i432++)newMaps.push(new Item(mapping.maps[_i432]));var branch=new Branch(this.items.slice(0,start).append(newMaps).append(rebasedItems),eventCount);return branch.emptyItemCount()>500&&(branch=branch.compress(this.items.length-rebasedItems.length)),branch}},{key:"emptyItemCount",value:function emptyItemCount(){var count=0;return this.items.forEach((function(item){item.step||count++})),count}},{key:"compress",value:function compress(){var upto=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,remap=this.remapping(0,upto),mapFrom=remap.maps.length,items=[],events=0;return this.items.forEach((function(item,i){if(i>=upto)items.push(item),item.selection&&events++;else if(item.step){var step=item.step.map(remap.slice(mapFrom)),_map4=step&&step.getMap();if(mapFrom--,_map4&&remap.appendMap(_map4,mapFrom),step){var selection=item.selection&&item.selection.map(remap.slice(mapFrom));selection&&events++;var merged,newItem=new Item(_map4.invert(),step,selection),last=items.length-1;(merged=items.length&&items[last].merge(newItem))?items[last]=merged:items.push(newItem)}}else item.map&&mapFrom--}),this.items.length,0),new Branch(RopeSequence.from(items.reverse()),events)}}]),Branch}();Branch.empty=new Branch(RopeSequence.empty,0);var Item=function(){function Item(map,step,selection,mirrorOffset){_classCallCheck(this,Item),this.map=map,this.step=step,this.selection=selection,this.mirrorOffset=mirrorOffset}return _createClass(Item,[{key:"merge",value:function merge(other){if(this.step&&other.step&&!other.selection){var step=other.step.merge(this.step);if(step)return new Item(step.getMap().invert(),step,this.selection)}}}]),Item}(),HistoryState=_createClass((function HistoryState(done,undone,prevRanges,prevTime,prevComposition){_classCallCheck(this,HistoryState),this.done=done,this.undone=undone,this.prevRanges=prevRanges,this.prevTime=prevTime,this.prevComposition=prevComposition})),DEPTH_OVERFLOW=20;function rangesFor(map){var result=[];return map.forEach((function(_from,_to,from,to){return result.push(from,to)})),result}function mapRanges(ranges,mapping){if(!ranges)return null;for(var result=[],_i436=0;_i436<ranges.length;_i436+=2){var from=mapping.map(ranges[_i436],1),to=mapping.map(ranges[_i436+1],-1);from<=to&&result.push(from,to)}return result}function histTransaction(history,state,dispatch,redo){var preserveItems=mustPreserveItems(state),histOptions=historyKey.get(state).spec.config,pop=(redo?history.undone:history.done).popEvent(state,preserveItems);if(pop){var selection=pop.selection.resolve(pop.transform.doc),added=(redo?history.done:history.undone).addTransform(pop.transform,state.selection.getBookmark(),histOptions,preserveItems),newHist=new HistoryState(redo?added:pop.remaining,redo?pop.remaining:added,null,0,-1);dispatch(pop.transform.setSelection(selection).setMeta(historyKey,{redo,historyState:newHist}).scrollIntoView())}}var cachedPreserveItems=!1,cachedPreserveItemsPlugins=null;function mustPreserveItems(state){var plugins=state.plugins;if(cachedPreserveItemsPlugins!=plugins){cachedPreserveItems=!1,cachedPreserveItemsPlugins=plugins;for(var _i438=0;_i438<plugins.length;_i438++)if(plugins[_i438].spec.historyPreserveItems){cachedPreserveItems=!0;break}}return cachedPreserveItems}var historyKey=new PluginKey("history"),closeHistoryKey=new PluginKey("closeHistory");function history(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return config={depth:config.depth||100,newGroupDelay:config.newGroupDelay||500},new Plugin({key:historyKey,state:{init:function init(){return new HistoryState(Branch.empty,Branch.empty,null,0,-1)},apply:function apply(tr,hist,state){return function applyTransaction(history,state,tr,options){var rebased,historyTr=tr.getMeta(historyKey);if(historyTr)return historyTr.historyState;tr.getMeta(closeHistoryKey)&&(history=new HistoryState(history.done,history.undone,null,0,-1));var appended=tr.getMeta("appendedTransaction");if(0==tr.steps.length)return history;if(appended&&appended.getMeta(historyKey))return appended.getMeta(historyKey).redo?new HistoryState(history.done.addTransform(tr,void 0,options,mustPreserveItems(state)),history.undone,rangesFor(tr.mapping.maps[tr.steps.length-1]),history.prevTime,history.prevComposition):new HistoryState(history.done,history.undone.addTransform(tr,void 0,options,mustPreserveItems(state)),null,history.prevTime,history.prevComposition);if(!1===tr.getMeta("addToHistory")||appended&&!1===appended.getMeta("addToHistory"))return(rebased=tr.getMeta("rebased"))?new HistoryState(history.done.rebased(tr,rebased),history.undone.rebased(tr,rebased),mapRanges(history.prevRanges,tr.mapping),history.prevTime,history.prevComposition):new HistoryState(history.done.addMaps(tr.mapping.maps),history.undone.addMaps(tr.mapping.maps),mapRanges(history.prevRanges,tr.mapping),history.prevTime,history.prevComposition);var composition=tr.getMeta("composition"),newGroup=0==history.prevTime||!appended&&history.prevComposition!=composition&&(history.prevTime<(tr.time||0)-options.newGroupDelay||!function isAdjacentTo(transform,prevRanges){if(!prevRanges)return!1;if(!transform.docChanged)return!0;var adjacent=!1;return transform.mapping.maps[0].forEach((function(start,end){for(var _i434=0;_i434<prevRanges.length;_i434+=2)start<=prevRanges[_i434+1]&&end>=prevRanges[_i434]&&(adjacent=!0)})),adjacent}(tr,history.prevRanges)),prevRanges=appended?mapRanges(history.prevRanges,tr.mapping):rangesFor(tr.mapping.maps[tr.steps.length-1]);return new HistoryState(history.done.addTransform(tr,newGroup?state.selection.getBookmark():void 0,options,mustPreserveItems(state)),Branch.empty,prevRanges,tr.time,null==composition?history.prevComposition:composition)}(hist,state,tr,config)}},config,props:{handleDOMEvents:{beforeinput:function beforeinput(view,e){var inputType=e.inputType,command="historyUndo"==inputType?_undo:"historyRedo"==inputType?_redo:null;return!!command&&(e.preventDefault(),command(view.state,view.dispatch))}}}})}var ViewMode,Actions,_undo=function undo(state,dispatch){var hist=historyKey.getState(state);return!(!hist||0==hist.done.eventCount)&&(dispatch&&histTransaction(hist,state,dispatch,!1),!0)},_redo=function redo(state,dispatch){var hist=historyKey.getState(state);return!(!hist||0==hist.undone.eventCount)&&(dispatch&&histTransaction(hist,state,dispatch,!0),!0)},History=Extension.create({name:"history",addOptions:function addOptions(){return{depth:100,newGroupDelay:500}},addCommands:function addCommands(){return{undo:function undo(){return function(_ref145){var state=_ref145.state,dispatch=_ref145.dispatch;return _undo(state,dispatch)}},redo:function redo(){return function(_ref146){var state=_ref146.state,dispatch=_ref146.dispatch;return _redo(state,dispatch)}}}},addProseMirrorPlugins:function addProseMirrorPlugins(){return[history(this.options)]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this83=this;return{"Mod-z":function ModZ(){return _this83.editor.commands.undo()},"Mod-Z":function ModZ(){return _this83.editor.commands.undo()},"Mod-y":function ModY(){return _this83.editor.commands.redo()},"Mod-Y":function ModY(){return _this83.editor.commands.redo()},"Shift-Mod-z":function ShiftModZ(){return _this83.editor.commands.redo()},"Shift-Mod-Z":function ShiftModZ(){return _this83.editor.commands.redo()},"Mod-я":function ModЯ(){return _this83.editor.commands.undo()},"Shift-Mod-я":function ShiftModЯ(){return _this83.editor.commands.redo()}}}}),HorizontalRule=Node.create({name:"horizontalRule",addOptions:function addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML:function parseHTML(){return[{tag:"hr"}]},renderHTML:function renderHTML(_ref147){var HTMLAttributes=_ref147.HTMLAttributes;return["hr",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes)]},addCommands:function addCommands(){var _this84=this;return{setHorizontalRule:function setHorizontalRule(){return function(_ref148){var chain=_ref148.chain,$originTo=_ref148.state.selection.$to,currentChain=chain();return 0===$originTo.parentOffset?currentChain.insertContentAt(Math.max($originTo.pos-2,0),{type:_this84.name}):currentChain.insertContent({type:_this84.name}),currentChain.command((function(_ref149){var _a,tr=_ref149.tr;if(_ref149.dispatch){var $to=tr.selection.$to,posAfter=$to.end();if($to.nodeAfter)$to.nodeAfter.isTextblock?tr.setSelection(TextSelection.create(tr.doc,$to.pos+1)):$to.nodeAfter.isBlock?tr.setSelection(NodeSelection.create(tr.doc,$to.pos)):tr.setSelection(TextSelection.create(tr.doc,$to.pos));else{var node=null===(_a=$to.parent.type.contentMatch.defaultType)||void 0===_a?void 0:_a.create();node&&(tr.insert(posAfter,node),tr.setSelection(TextSelection.create(tr.doc,posAfter+1)))}tr.scrollIntoView()}return!0})).run()}}}},addInputRules:function addInputRules(){return[nodeInputRule({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),starInputRegex=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,starPasteRegex=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,underscoreInputRegex=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,underscorePasteRegex=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Italic=Mark.create({name:"italic",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:function getAttrs(node){return"normal"!==node.style.fontStyle&&null}},{style:"font-style=italic"}]},renderHTML:function renderHTML(_ref150){var HTMLAttributes=_ref150.HTMLAttributes;return["em",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this85=this;return{setItalic:function setItalic(){return function(_ref151){return _ref151.commands.setMark(_this85.name)}},toggleItalic:function toggleItalic(){return function(_ref152){return _ref152.commands.toggleMark(_this85.name)}},unsetItalic:function unsetItalic(){return function(_ref153){return _ref153.commands.unsetMark(_this85.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this86=this;return{"Mod-i":function ModI(){return _this86.editor.commands.toggleItalic()},"Mod-I":function ModI(){return _this86.editor.commands.toggleItalic()}}},addInputRules:function addInputRules(){return[markInputRule({find:starInputRegex,type:this.type}),markInputRule({find:underscoreInputRegex,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:starPasteRegex,type:this.type}),markPasteRule({find:underscorePasteRegex,type:this.type})]}}),ListItem$1=Node.create({name:"listItem",addOptions:function addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML:function parseHTML(){return[{tag:"li"}]},renderHTML:function renderHTML(_ref154){var HTMLAttributes=_ref154.HTMLAttributes;return["li",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this87=this;return{Enter:function Enter(){return _this87.editor.commands.splitListItem(_this87.name)},Tab:function Tab(){return _this87.editor.commands.sinkListItem(_this87.name)},"Shift-Tab":function ShiftTab(){return _this87.editor.commands.liftListItem(_this87.name)}}}}),ListItem=Node.create({name:"listItem",addOptions:function addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML:function parseHTML(){return[{tag:"li"}]},renderHTML:function renderHTML(_ref155){var HTMLAttributes=_ref155.HTMLAttributes;return["li",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this88=this;return{Enter:function Enter(){return _this88.editor.commands.splitListItem(_this88.name)},Tab:function Tab(){return _this88.editor.commands.sinkListItem(_this88.name)},"Shift-Tab":function ShiftTab(){return _this88.editor.commands.liftListItem(_this88.name)}}}}),TextStyle=Mark.create({name:"textStyle",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"span",getAttrs:function getAttrs(element){return!!element.hasAttribute("style")&&{}}}]},renderHTML:function renderHTML(_ref156){var HTMLAttributes=_ref156.HTMLAttributes;return["span",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this89=this;return{removeEmptyTextStyle:function removeEmptyTextStyle(){return function(_ref157){var state=_ref157.state,commands=_ref157.commands,attributes=getMarkAttributes(state,_this89.type);return!!Object.entries(attributes).some((function(_ref158){return!!_slicedToArray(_ref158,2)[1]}))||commands.unsetMark(_this89.name)}}}}}),inputRegex$2=/^(\d+)\.\s$/,OrderedList=Node.create({name:"orderedList",addOptions:function addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content:function content(){return this.options.itemTypeName+"+"},addAttributes:function addAttributes(){return{start:{default:1,parseHTML:function parseHTML(element){return element.hasAttribute("start")?parseInt(element.getAttribute("start")||"",10):1}}}},parseHTML:function parseHTML(){return[{tag:"ol"}]},renderHTML:function renderHTML(_ref160){var HTMLAttributes=_ref160.HTMLAttributes,start=HTMLAttributes.start,attributesWithoutStart=_objectWithoutProperties(HTMLAttributes,_excluded);return 1===start?["ol",mergeAttributes(this.options.HTMLAttributes,attributesWithoutStart),0]:["ol",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this90=this;return{toggleOrderedList:function toggleOrderedList(){return function(_ref161){var commands=_ref161.commands,chain=_ref161.chain;return _this90.options.keepAttributes?chain().toggleList(_this90.name,_this90.options.itemTypeName,_this90.options.keepMarks).updateAttributes(ListItem.name,_this90.editor.getAttributes(TextStyle.name)).run():commands.toggleList(_this90.name,_this90.options.itemTypeName,_this90.options.keepMarks)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this91=this;return{"Mod-Shift-7":function ModShift7(){return _this91.editor.commands.toggleOrderedList()}}},addInputRules:function addInputRules(){var _this92=this,inputRule=wrappingInputRule({find:inputRegex$2,type:this.type,getAttributes:function getAttributes(match){return{start:+match[1]}},joinPredicate:function joinPredicate(match,node){return node.childCount+node.attrs.start===+match[1]}});return(this.options.keepMarks||this.options.keepAttributes)&&(inputRule=wrappingInputRule({find:inputRegex$2,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:function getAttributes(match){return Object.assign({start:+match[1]},_this92.editor.getAttributes(TextStyle.name))},joinPredicate:function joinPredicate(match,node){return node.childCount+node.attrs.start===+match[1]},editor:this.editor})),[inputRule]}}),Paragraph=Node.create({name:"paragraph",priority:1e3,addOptions:function addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML:function parseHTML(){return[{tag:"p"}]},renderHTML:function renderHTML(_ref162){var HTMLAttributes=_ref162.HTMLAttributes;return["p",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this93=this;return{setParagraph:function setParagraph(){return function(_ref163){return _ref163.commands.setNode(_this93.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this94=this;return{"Mod-Alt-0":function ModAlt0(){return _this94.editor.commands.setParagraph()}}}}),inputRegex$1=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,pasteRegex=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Strike=Mark.create({name:"strike",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:function getAttrs(style){return!!style.includes("line-through")&&{}}}]},renderHTML:function renderHTML(_ref164){var HTMLAttributes=_ref164.HTMLAttributes;return["s",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this95=this;return{setStrike:function setStrike(){return function(_ref165){return _ref165.commands.setMark(_this95.name)}},toggleStrike:function toggleStrike(){return function(_ref166){return _ref166.commands.toggleMark(_this95.name)}},unsetStrike:function unsetStrike(){return function(_ref167){return _ref167.commands.unsetMark(_this95.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this96=this,shortcuts={};return isMacOS()?shortcuts["Mod-Shift-s"]=function(){return _this96.editor.commands.toggleStrike()}:shortcuts["Ctrl-Shift-s"]=function(){return _this96.editor.commands.toggleStrike()},shortcuts},addInputRules:function addInputRules(){return[markInputRule({find:inputRegex$1,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:pasteRegex,type:this.type})]}}),Text$1=Node.create({name:"text",group:"inline"}),StarterKit=Extension.create({name:"starterKit",addExtensions:function addExtensions(){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,extensions=[];return!1!==this.options.blockquote&&extensions.push(Blockquote.configure(null===(_a=this.options)||void 0===_a?void 0:_a.blockquote)),!1!==this.options.bold&&extensions.push(Bold.configure(null===(_b=this.options)||void 0===_b?void 0:_b.bold)),!1!==this.options.bulletList&&extensions.push(BulletList$1.configure(null===(_c=this.options)||void 0===_c?void 0:_c.bulletList)),!1!==this.options.code&&extensions.push(Code.configure(null===(_d=this.options)||void 0===_d?void 0:_d.code)),!1!==this.options.codeBlock&&extensions.push(CodeBlock.configure(null===(_e=this.options)||void 0===_e?void 0:_e.codeBlock)),!1!==this.options.document&&extensions.push(Document.configure(null===(_f=this.options)||void 0===_f?void 0:_f.document)),!1!==this.options.dropcursor&&extensions.push(Dropcursor.configure(null===(_g=this.options)||void 0===_g?void 0:_g.dropcursor)),!1!==this.options.gapcursor&&extensions.push(Gapcursor.configure(null===(_h=this.options)||void 0===_h?void 0:_h.gapcursor)),!1!==this.options.hardBreak&&extensions.push(HardBreak.configure(null===(_j=this.options)||void 0===_j?void 0:_j.hardBreak)),!1!==this.options.heading&&extensions.push(Heading.configure(null===(_k=this.options)||void 0===_k?void 0:_k.heading)),!1!==this.options.history&&extensions.push(History.configure(null===(_l=this.options)||void 0===_l?void 0:_l.history)),!1!==this.options.horizontalRule&&extensions.push(HorizontalRule.configure(null===(_m=this.options)||void 0===_m?void 0:_m.horizontalRule)),!1!==this.options.italic&&extensions.push(Italic.configure(null===(_o=this.options)||void 0===_o?void 0:_o.italic)),!1!==this.options.listItem&&extensions.push(ListItem$1.configure(null===(_p=this.options)||void 0===_p?void 0:_p.listItem)),!1!==this.options.orderedList&&extensions.push(OrderedList.configure(null===(_q=this.options)||void 0===_q?void 0:_q.orderedList)),!1!==this.options.paragraph&&extensions.push(Paragraph.configure(null===(_r=this.options)||void 0===_r?void 0:_r.paragraph)),!1!==this.options.strike&&extensions.push(Strike.configure(null===(_s=this.options)||void 0===_s?void 0:_s.strike)),!1!==this.options.text&&extensions.push(Text$1.configure(null===(_t=this.options)||void 0===_t?void 0:_t.text)),extensions}});!function(ViewMode){ViewMode.MARKDOWN="markdown",ViewMode.PREVIEW="preview",ViewMode.READONLY="readonly"}(ViewMode||(ViewMode={})),function(Actions){Actions[Actions.ITALIC=0]="ITALIC",Actions[Actions.BOLD=1]="BOLD",Actions[Actions.H1=2]="H1",Actions[Actions.H2=3]="H2",Actions[Actions.STRIKE=4]="STRIKE",Actions[Actions.OL=5]="OL",Actions[Actions.UL=6]="UL",Actions[Actions.LINK=7]="LINK",Actions[Actions.UNLINK=8]="UNLINK",Actions[Actions.CODE_BLOCK=9]="CODE_BLOCK",Actions[Actions.BLOCKQUOTE=10]="BLOCKQUOTE",Actions[Actions.TASK_LIST=11]="TASK_LIST"}(Actions||(Actions={}));var focusChain=function focusChain(editor){return editor.chain().focus()};var customInputRegex$1=/^\s*([-+*]\s[^\[])$/,BulletList=BulletList$1.extend({addInputRules:function addInputRules(){return[wrappingInputRule({find:customInputRegex$1,type:this.type})]}}),inputRegex=/^\s*(\[([( |x])?\])\s$/,TaskItem$1=Node.create({name:"taskItem",addOptions:function addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content:function content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:function addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:function parseHTML(element){return"true"===element.getAttribute("data-checked")},renderHTML:function renderHTML(attributes){return{"data-checked":attributes.checked}}}}},parseHTML:function parseHTML(){return[{tag:'li[data-type="'+this.name+'"]',priority:51}]},renderHTML:function renderHTML(_ref168){var node=_ref168.node,HTMLAttributes=_ref168.HTMLAttributes;return["li",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:node.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this97=this,shortcuts={Enter:function Enter(){return _this97.editor.commands.splitListItem(_this97.name)},"Shift-Tab":function ShiftTab(){return _this97.editor.commands.liftListItem(_this97.name)}};return this.options.nested?Object.assign({},shortcuts,{Tab:function Tab(){return _this97.editor.commands.sinkListItem(_this97.name)}}):shortcuts},addNodeView:function addNodeView(){var _this98=this;return function(_ref169){var node=_ref169.node,HTMLAttributes=_ref169.HTMLAttributes,getPos=_ref169.getPos,editor=_ref169.editor,listItem=document.createElement("li"),checkboxWrapper=document.createElement("label"),checkboxStyler=document.createElement("span"),checkbox=document.createElement("input"),content=document.createElement("div");return checkboxWrapper.contentEditable="false",checkbox.type="checkbox",checkbox.addEventListener("change",(function(event){if(editor.isEditable||_this98.options.onReadOnlyChecked){var checked=event.target.checked;editor.isEditable&&"function"==typeof getPos&&editor.chain().focus(void 0,{scrollIntoView:!1}).command((function(_ref170){var tr=_ref170.tr,position=getPos(),currentNode=tr.doc.nodeAt(position);return tr.setNodeMarkup(position,void 0,Object.assign({},null==currentNode?void 0:currentNode.attrs,{checked})),!0})).run(),!editor.isEditable&&_this98.options.onReadOnlyChecked&&(_this98.options.onReadOnlyChecked(node,checked)||(checkbox.checked=!checkbox.checked))}else checkbox.checked=!checkbox.checked})),Object.entries(_this98.options.HTMLAttributes).forEach((function(_ref171){var _ref172=_slicedToArray(_ref171,2),key=_ref172[0],value=_ref172[1];listItem.setAttribute(key,value)})),listItem.dataset.checked=node.attrs.checked,node.attrs.checked&&checkbox.setAttribute("checked","checked"),checkboxWrapper.append(checkbox,checkboxStyler),listItem.append(checkboxWrapper,content),Object.entries(HTMLAttributes).forEach((function(_ref173){var _ref174=_slicedToArray(_ref173,2),key=_ref174[0],value=_ref174[1];listItem.setAttribute(key,value)})),{dom:listItem,contentDOM:content,update:function update(updatedNode){return updatedNode.type===_this98.type&&(listItem.dataset.checked=updatedNode.attrs.checked,updatedNode.attrs.checked?checkbox.setAttribute("checked","checked"):checkbox.removeAttribute("checked"),!0)}}}},addInputRules:function addInputRules(){return[wrappingInputRule({find:inputRegex,type:this.type,getAttributes:function getAttributes(match){return{checked:"x"===match[match.length-1]}}})]}}),customInputRegex=/^\s*([-+*]\s\[([( |x])?])\s$/,TaskItem=TaskItem$1.extend({addOptions:function addOptions(){var _a;return Object.assign(Object.assign({},null===(_a=this.parent)||void 0===_a?void 0:_a.call(this)),{nested:!0})},addAttributes:function addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:function parseHTML(element){var checkbox=element.querySelector("input[type=checkbox].task-list-item-checkbox");return null==checkbox?void 0:checkbox.checked},renderHTML:function renderHTML(attributes){return{"data-checked":attributes.checked}}}}},addNodeView:function addNodeView(){var _this99=this;return function(_ref175){var node=_ref175.node,HTMLAttributes=_ref175.HTMLAttributes,getPos=_ref175.getPos,editor=_ref175.editor,listItem=document.createElement("li"),checkboxWrapper=document.createElement("label"),checkboxStyler=document.createElement("span"),checkbox=document.createElement("input"),content=document.createElement("div");return checkboxWrapper.contentEditable="false",checkbox.type="checkbox",checkbox.addEventListener("change",(function(event){if(editor.isEditable||_this99.options.onReadOnlyChecked){var checked=event.target.checked;editor.isEditable&&"function"==typeof getPos&&editor.chain().focus(void 0,{scrollIntoView:!1}).command((function(_ref176){var tr=_ref176.tr,position=getPos(),currentNode=tr.doc.nodeAt(position);return tr.setNodeMarkup(position,void 0,Object.assign(Object.assign({},null==currentNode?void 0:currentNode.attrs),{checked})),!0})).run(),!editor.isEditable&&_this99.options.onReadOnlyChecked&&(_this99.options.onReadOnlyChecked(node,checked)||(checkbox.checked=!checkbox.checked))}else checkbox.checked=!checkbox.checked})),Object.entries(_this99.options.HTMLAttributes).forEach((function(_ref177){var _ref178=_slicedToArray(_ref177,2),key=_ref178[0],value=_ref178[1];listItem.setAttribute(key,value)})),listItem.dataset.checked=node.attrs.checked,node.attrs.checked&&checkbox.setAttribute("checked","checked"),checkboxWrapper.append(checkbox,checkboxStyler),listItem.append(checkboxWrapper,content),Object.entries(HTMLAttributes).forEach((function(_ref179){var _ref180=_slicedToArray(_ref179,2),key=_ref180[0],value=_ref180[1];listItem.setAttribute(key,value)})),{dom:listItem,contentDOM:content,update:function update(updatedNode){return updatedNode.type===_this99.type&&(listItem.dataset.checked=updatedNode.attrs.checked,updatedNode.attrs.checked?checkbox.setAttribute("checked","checked"):checkbox.removeAttribute("checked"),!0)},ignoreMutation:function ignoreMutation(mr){return"data-checked"!==mr.attributeName}}}},parseHTML:function parseHTML(){var _a;return[].concat(_toConsumableArray(null===(_a=this.parent)||void 0===_a?void 0:_a.call(this)),[{tag:"li.task-list-item",priority:100}])},addInputRules:function addInputRules(){var _a;return[].concat(_toConsumableArray(null===(_a=this.parent)||void 0===_a?void 0:_a.call(this)),[wrappingInputRule({find:customInputRegex,type:this.type,getAttributes:function getAttributes(match){return{checked:"x"===match[match.length-1]}}})])}}),TaskList$1=Node.create({name:"taskList",addOptions:function addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content:function content(){return this.options.itemTypeName+"+"},parseHTML:function parseHTML(){return[{tag:'ul[data-type="'+this.name+'"]',priority:51}]},renderHTML:function renderHTML(_ref181){var HTMLAttributes=_ref181.HTMLAttributes;return["ul",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes,{"data-type":this.name}),0]},addCommands:function addCommands(){var _this100=this;return{toggleTaskList:function toggleTaskList(){return function(_ref182){return _ref182.commands.toggleList(_this100.name,_this100.options.itemTypeName)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this101=this;return{"Mod-Shift-9":function ModShift9(){return _this101.editor.commands.toggleTaskList()}}}}),TaskList=TaskList$1.extend({addAttributes:function addAttributes(){return{numeric:{default:!1,parseHTML:function parseHTML(element){return"ol"===element.tagName.toLowerCase()}}}},parseHTML:function parseHTML(){return[{tag:".contains-task-list",priority:100}]},renderHTML:function renderHTML(_a){var _b=_a.HTMLAttributes;return[_b.numeric?"ol":"ul",mergeAttributes((0,_tslib_es6_973a6cc3_js__WEBPACK_IMPORTED_MODULE_79__._)(_b,["numeric"]),{"data-type":"taskList"}),0]}}),entities={Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",amp:"&",AMP:"&",andand:"⩕",And:"⩓",and:"∧",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angmsd:"∡",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",apacir:"⩯",ap:"≈",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxHd:"╤",boxhD:"╥",boxHD:"╦",boxhu:"┴",boxHu:"╧",boxhU:"╨",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsolb:"⧅",bsol:"\\",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",capand:"⩄",capbrcup:"⩉",capcap:"⩋",cap:"∩",Cap:"⋒",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cir:"○",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cup:"∪",Cup:"⋓",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",Darr:"↡",dArr:"⇓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",ddagger:"‡",ddarr:"⇊",DD:"ⅅ",dd:"ⅆ",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrowBar:"⤓",downarrow:"↓",DownArrow:"↓",Downarrow:"⇓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVectorBar:"⥖",DownLeftVector:"↽",DownRightTeeVector:"⥟",DownRightVectorBar:"⥗",DownRightVector:"⇁",DownTeeArrow:"↧",DownTee:"⊤",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",Ecirc:"Ê",ecirc:"ê",ecir:"≖",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",edot:"ė",eDot:"≑",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp13:" ",emsp14:" ",emsp:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",ge:"≥",gE:"≧",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",gescc:"⪩",ges:"⩾",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gla:"⪥",gl:"≷",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",gtcc:"⪧",gtcir:"⩺",gt:">",GT:">",Gt:"≫",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",harrcir:"⥈",harr:"↔",hArr:"⇔",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",Im:"ℑ",imof:"⊷",imped:"Ƶ",Implies:"⇒",incare:"℅",in:"∈",infin:"∞",infintie:"⧝",inodot:"ı",intcal:"⊺",int:"∫",Int:"∬",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larrb:"⇤",larrbfs:"⤟",larr:"←",Larr:"↞",lArr:"⇐",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",latail:"⤙",lAtail:"⤛",lat:"⪫",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",LeftArrowBar:"⇤",leftarrow:"←",LeftArrow:"←",Leftarrow:"⇐",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVectorBar:"⥙",LeftDownVector:"⇃",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTeeArrow:"↤",LeftTee:"⊣",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangleBar:"⧏",LeftTriangle:"⊲",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVectorBar:"⥘",LeftUpVector:"↿",LeftVectorBar:"⥒",LeftVector:"↼",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",lescc:"⪨",les:"⩽",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",llarr:"⇇",ll:"≪",Ll:"⋘",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoustache:"⎰",lmoust:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftrightarrow:"⟷",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longmapsto:"⟼",longrightarrow:"⟶",LongRightArrow:"⟶",Longrightarrow:"⟹",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",ltcc:"⪦",ltcir:"⩹",lt:"<",LT:"<",Lt:"≪",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",midast:"*",midcir:"⫰",mid:"∣",middot:"·",minusb:"⊟",minus:"−",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natural:"♮",naturals:"ℕ",natur:"♮",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",ne:"≠",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nlE:"≦̸",nle:"≰",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangleBar:"⧏̸",NotLeftTriangle:"⋪",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangleBar:"⧐̸",NotRightTriangle:"⋫",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",nparallel:"∦",npar:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",nprec:"⊀",npreceq:"⪯̸",npre:"⪯̸",nrarrc:"⤳̸",nrarr:"↛",nrArr:"⇏",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",Ocirc:"Ô",ocirc:"ô",ocir:"⊚",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",orarr:"↻",Or:"⩔",or:"∨",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",otimesas:"⨶",Otimes:"⨷",otimes:"⊗",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",para:"¶",parallel:"∥",par:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plus:"+",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",prap:"⪷",Pr:"⪻",pr:"≺",prcue:"≼",precapprox:"⪷",prec:"≺",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",pre:"⪯",prE:"⪳",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportional:"∝",Proportion:"∷",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarr:"→",Rarr:"↠",rArr:"⇒",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",Re:"ℜ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrowBar:"⇥",rightarrow:"→",RightArrow:"→",Rightarrow:"⇒",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVectorBar:"⥕",RightDownVector:"⇂",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTeeArrow:"↦",RightTee:"⊢",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangleBar:"⧐",RightTriangle:"⊳",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVectorBar:"⥔",RightUpVector:"↾",RightVectorBar:"⥓",RightVector:"⇀",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoustache:"⎱",rmoust:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",scap:"⪸",Scaron:"Š",scaron:"š",Sc:"⪼",sc:"≻",sccue:"≽",sce:"⪰",scE:"⪴",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdotb:"⊡",sdot:"⋅",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",solbar:"⌿",solb:"⧄",sol:"/",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squ:"□",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succapprox:"⪸",succ:"≻",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup1:"¹",sup2:"²",sup3:"³",sup:"⊃",Sup:"⋑",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",therefore:"∴",Therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",ThinSpace:" ",thinsp:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",timesbar:"⨱",timesb:"⊠",times:"×",timesd:"⨰",tint:"∭",toea:"⤨",topbot:"⌶",topcir:"⫱",top:"⊤",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",uarr:"↑",Uarr:"↟",uArr:"⇑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrowBar:"⤒",uparrow:"↑",UpArrow:"↑",Uparrow:"⇑",UpArrowDownArrow:"⇅",updownarrow:"↕",UpDownArrow:"↕",Updownarrow:"⇕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTeeArrow:"↥",UpTee:"⊥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",Vcy:"В",vcy:"в",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",veebar:"⊻",vee:"∨",Vee:"⋁",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xharr:"⟷",xhArr:"⟺",Xi:"Ξ",xi:"ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",yuml:"ÿ",Yuml:"Ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",zfr:"𝔷",Zfr:"ℨ",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"},regex$4=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,encodeCache={};function encode$2(string,exclude,keepEscaped){var i,l,code,nextCode,cache,result="";for("string"!=typeof exclude&&(keepEscaped=exclude,exclude=encode$2.defaultChars),void 0===keepEscaped&&(keepEscaped=!0),cache=function getEncodeCache(exclude){var i,ch,cache=encodeCache[exclude];if(cache)return cache;for(cache=encodeCache[exclude]=[],i=0;i<128;i++)ch=String.fromCharCode(i),/^[0-9a-z]$/i.test(ch)?cache.push(ch):cache.push("%"+("0"+i.toString(16).toUpperCase()).slice(-2));for(i=0;i<exclude.length;i++)cache[exclude.charCodeAt(i)]=exclude[i];return cache}(exclude),i=0,l=string.length;i<l;i++)if(code=string.charCodeAt(i),keepEscaped&&37===code&&i+2<l&&/^[0-9a-f]{2}$/i.test(string.slice(i+1,i+3)))result+=string.slice(i,i+3),i+=2;else if(code<128)result+=cache[code];else if(code>=55296&&code<=57343){if(code>=55296&&code<=56319&&i+1<l&&(nextCode=string.charCodeAt(i+1))>=56320&&nextCode<=57343){result+=encodeURIComponent(string[i]+string[i+1]),i++;continue}result+="%EF%BF%BD"}else result+=encodeURIComponent(string[i]);return result}encode$2.defaultChars=";/?:@&=+$,-_.!~*'()#",encode$2.componentChars="-_.!~*'()";var encode_1=encode$2,decodeCache={};function decode$2(string,exclude){var cache;return"string"!=typeof exclude&&(exclude=decode$2.defaultChars),cache=function getDecodeCache(exclude){var i,ch,cache=decodeCache[exclude];if(cache)return cache;for(cache=decodeCache[exclude]=[],i=0;i<128;i++)ch=String.fromCharCode(i),cache.push(ch);for(i=0;i<exclude.length;i++)cache[ch=exclude.charCodeAt(i)]="%"+("0"+ch.toString(16).toUpperCase()).slice(-2);return cache}(exclude),string.replace(/(%[a-f0-9]{2})+/gi,(function(seq){var i,l,b1,b2,b3,b4,chr,result="";for(i=0,l=seq.length;i<l;i+=3)(b1=parseInt(seq.slice(i+1,i+3),16))<128?result+=cache[b1]:192==(224&b1)&&i+3<l&&128==(192&(b2=parseInt(seq.slice(i+4,i+6),16)))?(result+=(chr=b1<<6&1984|63&b2)<128?"��":String.fromCharCode(chr),i+=3):224==(240&b1)&&i+6<l&&(b2=parseInt(seq.slice(i+4,i+6),16),b3=parseInt(seq.slice(i+7,i+9),16),128==(192&b2)&&128==(192&b3))?(result+=(chr=b1<<12&61440|b2<<6&4032|63&b3)<2048||chr>=55296&&chr<=57343?"���":String.fromCharCode(chr),i+=6):240==(248&b1)&&i+9<l&&(b2=parseInt(seq.slice(i+4,i+6),16),b3=parseInt(seq.slice(i+7,i+9),16),b4=parseInt(seq.slice(i+10,i+12),16),128==(192&b2)&&128==(192&b3)&&128==(192&b4))?((chr=b1<<18&1835008|b2<<12&258048|b3<<6&4032|63&b4)<65536||chr>1114111?result+="����":(chr-=65536,result+=String.fromCharCode(55296+(chr>>10),56320+(1023&chr))),i+=9):result+="�";return result}))}decode$2.defaultChars=";/?:@&=+$,#",decode$2.componentChars="";var decode_1=decode$2;function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};Url.prototype.parse=function(url,slashesDenoteHost){var i,l,lowerProto,hec,slashes,rest=url;if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.pathname=simplePath[1],simplePath[2]&&(this.search=simplePath[2]),this}var proto=protocolPattern.exec(rest);if(proto&&(lowerProto=(proto=proto[0]).toLowerCase(),this.protocol=proto,rest=rest.substr(proto.length)),(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(slashes="//"===rest.substr(0,2))||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)),!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var auth,atSign,hostEnd=-1;for(i=0;i<hostEndingChars.length;i++)-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec);for(-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=auth),hostEnd=-1,i=0;i<nonHostChars.length;i++)-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec);-1===hostEnd&&(hostEnd=rest.length),":"===rest[hostEnd-1]&&hostEnd--;var host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd),this.parseHost(host),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest=notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");return-1!==qm&&(this.search=rest.substr(qm),rest=rest.slice(0,qm)),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname=""),this},Url.prototype.parseHost=function(host){var port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)};var mdurl={encode:encode_1,decode:decode_1,format:function format(url){var result="";return result+=url.protocol||"",result+=url.slashes?"//":"",result+=url.auth?url.auth+"@":"",url.hostname&&-1!==url.hostname.indexOf(":")?result+="["+url.hostname+"]":result+=url.hostname||"",result+=url.port?":"+url.port:"",result+=url.pathname||"",result+=url.search||"",result+=url.hash||""},parse:function urlParse(url,slashesDenoteHost){if(url&&url instanceof Url)return url;var u=new Url;return u.parse(url,slashesDenoteHost),u}},regex$3=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,regex$2=/[\0-\x1F\x7F-\x9F]/,regex=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,uc_micro={Any:regex$3,Cc:regex$2,Cf:/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,P:regex$4,Z:regex},utils=(0,_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_80__.c)((function(module,exports){var _hasOwnProperty=Object.prototype.hasOwnProperty;function has(object,key){return _hasOwnProperty.call(object,key)}function isValidEntityCode(c){return!(c>=55296&&c<=57343)&&(!(c>=64976&&c<=65007)&&(65535!=(65535&c)&&65534!=(65535&c)&&(!(c>=0&&c<=8)&&(11!==c&&(!(c>=14&&c<=31)&&(!(c>=127&&c<=159)&&!(c>1114111)))))))}function fromCodePoint(c){if(c>65535){var surrogate1=55296+((c-=65536)>>10),surrogate2=56320+(1023&c);return String.fromCharCode(surrogate1,surrogate2)}return String.fromCharCode(c)}var UNESCAPE_MD_RE=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,UNESCAPE_ALL_RE=new RegExp(UNESCAPE_MD_RE.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),DIGITAL_ENTITY_TEST_RE=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;var HTML_ESCAPE_TEST_RE=/[&<>"]/,HTML_ESCAPE_REPLACE_RE=/[&<>"]/g,HTML_REPLACEMENTS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function replaceUnsafeChar(ch){return HTML_REPLACEMENTS[ch]}var REGEXP_ESCAPE_RE=/[.?*+^$[\]\\(){}|-]/g;exports.lib={},exports.lib.mdurl=mdurl,exports.lib.ucmicro=uc_micro,exports.assign=function assign(obj){return Array.prototype.slice.call(arguments,1).forEach((function(source){if(source){if("object"!=typeof source)throw new TypeError(source+"must be object");Object.keys(source).forEach((function(key){obj[key]=source[key]}))}})),obj},exports.isString=function isString(obj){return"[object String]"===function _class(obj){return Object.prototype.toString.call(obj)}(obj)},exports.has=has,exports.unescapeMd=function unescapeMd(str){return str.indexOf("\\")<0?str:str.replace(UNESCAPE_MD_RE,"$1")},exports.unescapeAll=function unescapeAll(str){return str.indexOf("\\")<0&&str.indexOf("&")<0?str:str.replace(UNESCAPE_ALL_RE,(function(match,escaped,entity){return escaped||function replaceEntityPattern(match,name){var code;return has(entities,name)?entities[name]:35===name.charCodeAt(0)&&DIGITAL_ENTITY_TEST_RE.test(name)&&isValidEntityCode(code="x"===name[1].toLowerCase()?parseInt(name.slice(2),16):parseInt(name.slice(1),10))?fromCodePoint(code):match}(match,entity)}))},exports.isValidEntityCode=isValidEntityCode,exports.fromCodePoint=fromCodePoint,exports.escapeHtml=function escapeHtml(str){return HTML_ESCAPE_TEST_RE.test(str)?str.replace(HTML_ESCAPE_REPLACE_RE,replaceUnsafeChar):str},exports.arrayReplaceAt=function arrayReplaceAt(src,pos,newElements){return[].concat(src.slice(0,pos),newElements,src.slice(pos+1))},exports.isSpace=function isSpace(code){switch(code){case 9:case 32:return!0}return!1},exports.isWhiteSpace=function isWhiteSpace(code){if(code>=8192&&code<=8202)return!0;switch(code){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},exports.isMdAsciiPunct=function isMdAsciiPunct(ch){switch(ch){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},exports.isPunctChar=function isPunctChar(ch){return regex$4.test(ch)},exports.escapeRE=function escapeRE(str){return str.replace(REGEXP_ESCAPE_RE,"\\$&")},exports.normalizeReference=function normalizeReference(str){return str=str.trim().replace(/\s+/g," "),"Ṿ"==="ẞ".toLowerCase()&&(str=str.replace(/ẞ/g,"ß")),str.toLowerCase().toUpperCase()}})),unescapeAll$2=utils.unescapeAll,unescapeAll$1=utils.unescapeAll,parseLinkLabel=function parseLinkLabel(state,start,disableNested){var level,found,marker,prevPos,labelEnd=-1,max=state.posMax,oldPos=state.pos;for(state.pos=start+1,level=1;state.pos<max;){if(93===(marker=state.src.charCodeAt(state.pos))&&0===--level){found=!0;break}if(prevPos=state.pos,state.md.inline.skipToken(state),91===marker)if(prevPos===state.pos-1)level++;else if(disableNested)return state.pos=oldPos,-1}return found&&(labelEnd=state.pos),state.pos=oldPos,labelEnd},parseLinkDestination=function parseLinkDestination(str,start,max){var code,level,pos=start,result={ok:!1,pos:0,lines:0,str:""};if(60===str.charCodeAt(pos)){for(pos++;pos<max;){if(10===(code=str.charCodeAt(pos)))return result;if(60===code)return result;if(62===code)return result.pos=pos+1,result.str=unescapeAll$2(str.slice(start+1,pos)),result.ok=!0,result;92===code&&pos+1<max?pos+=2:pos++}return result}for(level=0;pos<max&&32!==(code=str.charCodeAt(pos))&&!(code<32||127===code);)if(92===code&&pos+1<max){if(32===str.charCodeAt(pos+1))break;pos+=2}else{if(40===code&&++level>32)return result;if(41===code){if(0===level)break;level--}pos++}return start===pos||0!==level||(result.str=unescapeAll$2(str.slice(start,pos)),result.pos=pos,result.ok=!0),result},parseLinkTitle=function parseLinkTitle(str,start,max){var code,marker,lines=0,pos=start,result={ok:!1,pos:0,lines:0,str:""};if(pos>=max)return result;if(34!==(marker=str.charCodeAt(pos))&&39!==marker&&40!==marker)return result;for(pos++,40===marker&&(marker=41);pos<max;){if((code=str.charCodeAt(pos))===marker)return result.pos=pos+1,result.lines=lines,result.str=unescapeAll$1(str.slice(start+1,pos)),result.ok=!0,result;if(40===code&&41===marker)return result;10===code?lines++:92===code&&pos+1<max&&(pos++,10===str.charCodeAt(pos)&&lines++),pos++}return result},helpers={parseLinkLabel,parseLinkDestination,parseLinkTitle},assign$1=utils.assign,unescapeAll=utils.unescapeAll,escapeHtml=utils.escapeHtml,default_rules={};function Renderer(){this.rules=assign$1({},default_rules)}default_rules.code_inline=function(tokens,idx,options,env,slf){var token=tokens[idx];return"<code"+slf.renderAttrs(token)+">"+escapeHtml(token.content)+"</code>"},default_rules.code_block=function(tokens,idx,options,env,slf){var token=tokens[idx];return"<pre"+slf.renderAttrs(token)+"><code>"+escapeHtml(tokens[idx].content)+"</code></pre>\n"},default_rules.fence=function(tokens,idx,options,env,slf){var highlighted,i,arr,tmpAttrs,tmpToken,token=tokens[idx],info=token.info?unescapeAll(token.info).trim():"",langName="",langAttrs="";return info&&(langName=(arr=info.split(/(\s+)/g))[0],langAttrs=arr.slice(2).join("")),0===(highlighted=options.highlight&&options.highlight(token.content,langName,langAttrs)||escapeHtml(token.content)).indexOf("<pre")?highlighted+"\n":info?(i=token.attrIndex("class"),tmpAttrs=token.attrs?token.attrs.slice():[],i<0?tmpAttrs.push(["class",options.langPrefix+langName]):(tmpAttrs[i]=tmpAttrs[i].slice(),tmpAttrs[i][1]+=" "+options.langPrefix+langName),tmpToken={attrs:tmpAttrs},"<pre><code"+slf.renderAttrs(tmpToken)+">"+highlighted+"</code></pre>\n"):"<pre><code"+slf.renderAttrs(token)+">"+highlighted+"</code></pre>\n"},default_rules.image=function(tokens,idx,options,env,slf){var token=tokens[idx];return token.attrs[token.attrIndex("alt")][1]=slf.renderInlineAsText(token.children,options,env),slf.renderToken(tokens,idx,options)},default_rules.hardbreak=function(tokens,idx,options){return options.xhtmlOut?"<br />\n":"<br>\n"},default_rules.softbreak=function(tokens,idx,options){return options.breaks?options.xhtmlOut?"<br />\n":"<br>\n":"\n"},default_rules.text=function(tokens,idx){return escapeHtml(tokens[idx].content)},default_rules.html_block=function(tokens,idx){return tokens[idx].content},default_rules.html_inline=function(tokens,idx){return tokens[idx].content},Renderer.prototype.renderAttrs=function renderAttrs(token){var i,l,result;if(!token.attrs)return"";for(result="",i=0,l=token.attrs.length;i<l;i++)result+=" "+escapeHtml(token.attrs[i][0])+'="'+escapeHtml(token.attrs[i][1])+'"';return result},Renderer.prototype.renderToken=function renderToken(tokens,idx,options){var nextToken,result="",needLf=!1,token=tokens[idx];return token.hidden?"":(token.block&&-1!==token.nesting&&idx&&tokens[idx-1].hidden&&(result+="\n"),result+=(-1===token.nesting?"</":"<")+token.tag,result+=this.renderAttrs(token),0===token.nesting&&options.xhtmlOut&&(result+=" /"),token.block&&(needLf=!0,1===token.nesting&&idx+1<tokens.length&&("inline"===(nextToken=tokens[idx+1]).type||nextToken.hidden||-1===nextToken.nesting&&nextToken.tag===token.tag)&&(needLf=!1)),result+=needLf?">\n":">")},Renderer.prototype.renderInline=function(tokens,options,env){for(var type,result="",rules=this.rules,i=0,len=tokens.length;i<len;i++)void 0!==rules[type=tokens[i].type]?result+=rules[type](tokens,i,options,env,this):result+=this.renderToken(tokens,i,options);return result},Renderer.prototype.renderInlineAsText=function(tokens,options,env){for(var result="",i=0,len=tokens.length;i<len;i++)"text"===tokens[i].type?result+=tokens[i].content:"image"===tokens[i].type?result+=this.renderInlineAsText(tokens[i].children,options,env):"softbreak"===tokens[i].type&&(result+="\n");return result},Renderer.prototype.render=function(tokens,options,env){var i,len,type,result="",rules=this.rules;for(i=0,len=tokens.length;i<len;i++)"inline"===(type=tokens[i].type)?result+=this.renderInline(tokens[i].children,options,env):void 0!==rules[type]?result+=rules[type](tokens,i,options,env,this):result+=this.renderToken(tokens,i,options,env);return result};var renderer=Renderer;function Ruler(){this.__rules__=[],this.__cache__=null}Ruler.prototype.__find__=function(name){for(var i=0;i<this.__rules__.length;i++)if(this.__rules__[i].name===name)return i;return-1},Ruler.prototype.__compile__=function(){var self=this,chains=[""];self.__rules__.forEach((function(rule){rule.enabled&&rule.alt.forEach((function(altName){chains.indexOf(altName)<0&&chains.push(altName)}))})),self.__cache__={},chains.forEach((function(chain){self.__cache__[chain]=[],self.__rules__.forEach((function(rule){rule.enabled&&(chain&&rule.alt.indexOf(chain)<0||self.__cache__[chain].push(rule.fn))}))}))},Ruler.prototype.at=function(name,fn,options){var index=this.__find__(name),opt=options||{};if(-1===index)throw new Error("Parser rule not found: "+name);this.__rules__[index].fn=fn,this.__rules__[index].alt=opt.alt||[],this.__cache__=null},Ruler.prototype.before=function(beforeName,ruleName,fn,options){var index=this.__find__(beforeName),opt=options||{};if(-1===index)throw new Error("Parser rule not found: "+beforeName);this.__rules__.splice(index,0,{name:ruleName,enabled:!0,fn,alt:opt.alt||[]}),this.__cache__=null},Ruler.prototype.after=function(afterName,ruleName,fn,options){var index=this.__find__(afterName),opt=options||{};if(-1===index)throw new Error("Parser rule not found: "+afterName);this.__rules__.splice(index+1,0,{name:ruleName,enabled:!0,fn,alt:opt.alt||[]}),this.__cache__=null},Ruler.prototype.push=function(ruleName,fn,options){var opt=options||{};this.__rules__.push({name:ruleName,enabled:!0,fn,alt:opt.alt||[]}),this.__cache__=null},Ruler.prototype.enable=function(list,ignoreInvalid){Array.isArray(list)||(list=[list]);var result=[];return list.forEach((function(name){var idx=this.__find__(name);if(idx<0){if(ignoreInvalid)return;throw new Error("Rules manager: invalid rule name "+name)}this.__rules__[idx].enabled=!0,result.push(name)}),this),this.__cache__=null,result},Ruler.prototype.enableOnly=function(list,ignoreInvalid){Array.isArray(list)||(list=[list]),this.__rules__.forEach((function(rule){rule.enabled=!1})),this.enable(list,ignoreInvalid)},Ruler.prototype.disable=function(list,ignoreInvalid){Array.isArray(list)||(list=[list]);var result=[];return list.forEach((function(name){var idx=this.__find__(name);if(idx<0){if(ignoreInvalid)return;throw new Error("Rules manager: invalid rule name "+name)}this.__rules__[idx].enabled=!1,result.push(name)}),this),this.__cache__=null,result},Ruler.prototype.getRules=function(chainName){return null===this.__cache__&&this.__compile__(),this.__cache__[chainName]||[]};var ruler=Ruler,NEWLINES_RE=/\r\n?|\n/g,NULL_RE=/\0/g,arrayReplaceAt=utils.arrayReplaceAt;function isLinkClose$1(str){return/^<\/a\s*>/i.test(str)}var RARE_RE=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,SCOPED_ABBR_TEST_RE=/\((c|tm|r)\)/i,SCOPED_ABBR_RE=/\((c|tm|r)\)/gi,SCOPED_ABBR={c:"©",r:"®",tm:"™"};function replaceFn(match,name){return SCOPED_ABBR[name.toLowerCase()]}function replace_scoped(inlineTokens){var i,token,inside_autolink=0;for(i=inlineTokens.length-1;i>=0;i--)"text"!==(token=inlineTokens[i]).type||inside_autolink||(token.content=token.content.replace(SCOPED_ABBR_RE,replaceFn)),"link_open"===token.type&&"auto"===token.info&&inside_autolink--,"link_close"===token.type&&"auto"===token.info&&inside_autolink++}function replace_rare(inlineTokens){var i,token,inside_autolink=0;for(i=inlineTokens.length-1;i>=0;i--)"text"!==(token=inlineTokens[i]).type||inside_autolink||RARE_RE.test(token.content)&&(token.content=token.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1—").replace(/(^|\s)--(?=\s|$)/gm,"$1–").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1–")),"link_open"===token.type&&"auto"===token.info&&inside_autolink--,"link_close"===token.type&&"auto"===token.info&&inside_autolink++}var isWhiteSpace$1=utils.isWhiteSpace,isPunctChar$1=utils.isPunctChar,isMdAsciiPunct$1=utils.isMdAsciiPunct,QUOTE_TEST_RE=/['"]/,QUOTE_RE=/['"]/g;function replaceAt(str,index,ch){return str.slice(0,index)+ch+str.slice(index+1)}function process_inlines(tokens,state){var i,token,text,t,pos,max,thisLevel,item,lastChar,nextChar,isLastPunctChar,isNextPunctChar,isLastWhiteSpace,isNextWhiteSpace,canOpen,canClose,j,isSingle,stack,openQuote,closeQuote;for(stack=[],i=0;i<tokens.length;i++){for(token=tokens[i],thisLevel=tokens[i].level,j=stack.length-1;j>=0&&!(stack[j].level<=thisLevel);j--);if(stack.length=j+1,"text"===token.type){pos=0,max=(text=token.content).length;OUTER:for(;pos<max&&(QUOTE_RE.lastIndex=pos,t=QUOTE_RE.exec(text));){if(canOpen=canClose=!0,pos=t.index+1,isSingle="'"===t[0],lastChar=32,t.index-1>=0)lastChar=text.charCodeAt(t.index-1);else for(j=i-1;j>=0&&("softbreak"!==tokens[j].type&&"hardbreak"!==tokens[j].type);j--)if(tokens[j].content){lastChar=tokens[j].content.charCodeAt(tokens[j].content.length-1);break}if(nextChar=32,pos<max)nextChar=text.charCodeAt(pos);else for(j=i+1;j<tokens.length&&("softbreak"!==tokens[j].type&&"hardbreak"!==tokens[j].type);j++)if(tokens[j].content){nextChar=tokens[j].content.charCodeAt(0);break}if(isLastPunctChar=isMdAsciiPunct$1(lastChar)||isPunctChar$1(String.fromCharCode(lastChar)),isNextPunctChar=isMdAsciiPunct$1(nextChar)||isPunctChar$1(String.fromCharCode(nextChar)),isLastWhiteSpace=isWhiteSpace$1(lastChar),(isNextWhiteSpace=isWhiteSpace$1(nextChar))?canOpen=!1:isNextPunctChar&&(isLastWhiteSpace||isLastPunctChar||(canOpen=!1)),isLastWhiteSpace?canClose=!1:isLastPunctChar&&(isNextWhiteSpace||isNextPunctChar||(canClose=!1)),34===nextChar&&'"'===t[0]&&lastChar>=48&&lastChar<=57&&(canClose=canOpen=!1),canOpen&&canClose&&(canOpen=isLastPunctChar,canClose=isNextPunctChar),canOpen||canClose){if(canClose)for(j=stack.length-1;j>=0&&(item=stack[j],!(stack[j].level<thisLevel));j--)if(item.single===isSingle&&stack[j].level===thisLevel){item=stack[j],isSingle?(openQuote=state.md.options.quotes[2],closeQuote=state.md.options.quotes[3]):(openQuote=state.md.options.quotes[0],closeQuote=state.md.options.quotes[1]),token.content=replaceAt(token.content,t.index,closeQuote),tokens[item.token].content=replaceAt(tokens[item.token].content,item.pos,openQuote),pos+=closeQuote.length-1,item.token===i&&(pos+=openQuote.length-1),max=(text=token.content).length,stack.length=j;continue OUTER}canOpen?stack.push({token:i,pos:t.index,single:isSingle,level:thisLevel}):canClose&&isSingle&&(token.content=replaceAt(token.content,t.index,"’"))}else isSingle&&(token.content=replaceAt(token.content,t.index,"’"))}}}}function Token(type,tag,nesting){this.type=type,this.tag=tag,this.attrs=null,this.map=null,this.nesting=nesting,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Token.prototype.attrIndex=function attrIndex(name){var attrs,i,len;if(!this.attrs)return-1;for(i=0,len=(attrs=this.attrs).length;i<len;i++)if(attrs[i][0]===name)return i;return-1},Token.prototype.attrPush=function attrPush(attrData){this.attrs?this.attrs.push(attrData):this.attrs=[attrData]},Token.prototype.attrSet=function attrSet(name,value){var idx=this.attrIndex(name),attrData=[name,value];idx<0?this.attrPush(attrData):this.attrs[idx]=attrData},Token.prototype.attrGet=function attrGet(name){var idx=this.attrIndex(name),value=null;return idx>=0&&(value=this.attrs[idx][1]),value},Token.prototype.attrJoin=function attrJoin(name,value){var idx=this.attrIndex(name);idx<0?this.attrPush([name,value]):this.attrs[idx][1]=this.attrs[idx][1]+" "+value};var token=Token;function StateCore(src,md,env){this.src=src,this.env=env,this.tokens=[],this.inlineMode=!1,this.md=md}StateCore.prototype.Token=token;var state_core=StateCore,_rules$2=[["normalize",function normalize(state){var str;str=(str=state.src.replace(NEWLINES_RE,"\n")).replace(NULL_RE,"�"),state.src=str}],["block",function block(state){var token;state.inlineMode?((token=new state.Token("inline","",0)).content=state.src,token.map=[0,1],token.children=[],state.tokens.push(token)):state.md.block.parse(state.src,state.md,state.env,state.tokens)}],["inline",function inline(state){var tok,i,l,tokens=state.tokens;for(i=0,l=tokens.length;i<l;i++)"inline"===(tok=tokens[i]).type&&state.md.inline.parse(tok.content,state.md,state.env,tok.children)}],["linkify",function linkify(state){var i,j,l,tokens,token,currentToken,nodes,ln,text,pos,lastPos,level,htmlLinkLevel,url,fullUrl,urlText,links,str,blockTokens=state.tokens;if(state.md.options.linkify)for(j=0,l=blockTokens.length;j<l;j++)if("inline"===blockTokens[j].type&&state.md.linkify.pretest(blockTokens[j].content))for(htmlLinkLevel=0,i=(tokens=blockTokens[j].children).length-1;i>=0;i--)if("link_close"!==(currentToken=tokens[i]).type){if("html_inline"===currentToken.type&&(str=currentToken.content,/^<a[>\s]/i.test(str)&&htmlLinkLevel>0&&htmlLinkLevel--,isLinkClose$1(currentToken.content)&&htmlLinkLevel++),!(htmlLinkLevel>0)&&"text"===currentToken.type&&state.md.linkify.test(currentToken.content)){for(text=currentToken.content,links=state.md.linkify.match(text),nodes=[],level=currentToken.level,lastPos=0,links.length>0&&0===links[0].index&&i>0&&"text_special"===tokens[i-1].type&&(links=links.slice(1)),ln=0;ln<links.length;ln++)url=links[ln].url,fullUrl=state.md.normalizeLink(url),state.md.validateLink(fullUrl)&&(urlText=links[ln].text,urlText=links[ln].schema?"mailto:"!==links[ln].schema||/^mailto:/i.test(urlText)?state.md.normalizeLinkText(urlText):state.md.normalizeLinkText("mailto:"+urlText).replace(/^mailto:/,""):state.md.normalizeLinkText("http://"+urlText).replace(/^http:\/\//,""),(pos=links[ln].index)>lastPos&&((token=new state.Token("text","",0)).content=text.slice(lastPos,pos),token.level=level,nodes.push(token)),(token=new state.Token("link_open","a",1)).attrs=[["href",fullUrl]],token.level=level++,token.markup="linkify",token.info="auto",nodes.push(token),(token=new state.Token("text","",0)).content=urlText,token.level=level,nodes.push(token),(token=new state.Token("link_close","a",-1)).level=--level,token.markup="linkify",token.info="auto",nodes.push(token),lastPos=links[ln].lastIndex);lastPos<text.length&&((token=new state.Token("text","",0)).content=text.slice(lastPos),token.level=level,nodes.push(token)),blockTokens[j].children=tokens=arrayReplaceAt(tokens,i,nodes)}}else for(i--;tokens[i].level!==currentToken.level&&"link_open"!==tokens[i].type;)i--}],["replacements",function replace(state){var blkIdx;if(state.md.options.typographer)for(blkIdx=state.tokens.length-1;blkIdx>=0;blkIdx--)"inline"===state.tokens[blkIdx].type&&(SCOPED_ABBR_TEST_RE.test(state.tokens[blkIdx].content)&&replace_scoped(state.tokens[blkIdx].children),RARE_RE.test(state.tokens[blkIdx].content)&&replace_rare(state.tokens[blkIdx].children))}],["smartquotes",function smartquotes(state){var blkIdx;if(state.md.options.typographer)for(blkIdx=state.tokens.length-1;blkIdx>=0;blkIdx--)"inline"===state.tokens[blkIdx].type&&QUOTE_TEST_RE.test(state.tokens[blkIdx].content)&&process_inlines(state.tokens[blkIdx].children,state)}],["text_join",function text_join(state){var j,l,tokens,curr,max,last,blockTokens=state.tokens;for(j=0,l=blockTokens.length;j<l;j++)if("inline"===blockTokens[j].type){for(max=(tokens=blockTokens[j].children).length,curr=0;curr<max;curr++)"text_special"===tokens[curr].type&&(tokens[curr].type="text");for(curr=last=0;curr<max;curr++)"text"===tokens[curr].type&&curr+1<max&&"text"===tokens[curr+1].type?tokens[curr+1].content=tokens[curr].content+tokens[curr+1].content:(curr!==last&&(tokens[last]=tokens[curr]),last++);curr!==last&&(tokens.length=last)}}]];function Core(){this.ruler=new ruler;for(var i=0;i<_rules$2.length;i++)this.ruler.push(_rules$2[i][0],_rules$2[i][1])}Core.prototype.process=function(state){var i,l,rules;for(i=0,l=(rules=this.ruler.getRules("")).length;i<l;i++)rules[i](state)},Core.prototype.State=state_core;var parser_core=Core,isSpace$a=utils.isSpace;function getLine(state,line){var pos=state.bMarks[line]+state.tShift[line],max=state.eMarks[line];return state.src.slice(pos,max)}function escapedSplit(str){var ch,result=[],pos=0,max=str.length,isEscaped=!1,lastPos=0,current="";for(ch=str.charCodeAt(pos);pos<max;)124===ch&&(isEscaped?(current+=str.substring(lastPos,pos-1),lastPos=pos):(result.push(current+str.substring(lastPos,pos)),current="",lastPos=pos+1)),isEscaped=92===ch,pos++,ch=str.charCodeAt(pos);return result.push(current+str.substring(lastPos)),result}var isSpace$9=utils.isSpace,isSpace$8=utils.isSpace,isSpace$7=utils.isSpace;function skipBulletListMarker(state,startLine){var marker,pos,max,ch;return pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine],42!==(marker=state.src.charCodeAt(pos++))&&45!==marker&&43!==marker||pos<max&&(ch=state.src.charCodeAt(pos),!isSpace$7(ch))?-1:pos}function skipOrderedListMarker(state,startLine){var ch,start=state.bMarks[startLine]+state.tShift[startLine],pos=start,max=state.eMarks[startLine];if(pos+1>=max)return-1;if((ch=state.src.charCodeAt(pos++))<48||ch>57)return-1;for(;;){if(pos>=max)return-1;if(!((ch=state.src.charCodeAt(pos++))>=48&&ch<=57)){if(41===ch||46===ch)break;return-1}if(pos-start>=10)return-1}return pos<max&&(ch=state.src.charCodeAt(pos),!isSpace$7(ch))?-1:pos}var normalizeReference$2=utils.normalizeReference,isSpace$6=utils.isSpace,open_tag="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",close_tag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",html_re={HTML_TAG_RE:new RegExp("^(?:"+open_tag+"|"+close_tag+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),HTML_OPEN_CLOSE_TAG_RE:new RegExp("^(?:"+open_tag+"|"+close_tag+")")},HTML_OPEN_CLOSE_TAG_RE=html_re.HTML_OPEN_CLOSE_TAG_RE,HTML_SEQUENCES=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"].join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(HTML_OPEN_CLOSE_TAG_RE.source+"\\s*$"),/^$/,!1]],isSpace$5=utils.isSpace,isSpace$4=utils.isSpace;function StateBlock(src,md,env,tokens){var ch,s,start,pos,len,indent,offset,indent_found;for(this.src=src,this.md=md,this.env=env,this.tokens=tokens,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",indent_found=!1,start=pos=indent=offset=0,len=(s=this.src).length;pos<len;pos++){if(ch=s.charCodeAt(pos),!indent_found){if(isSpace$4(ch)){indent++,9===ch?offset+=4-offset%4:offset++;continue}indent_found=!0}10!==ch&&pos!==len-1||(10!==ch&&pos++,this.bMarks.push(start),this.eMarks.push(pos),this.tShift.push(indent),this.sCount.push(offset),this.bsCount.push(0),indent_found=!1,indent=0,offset=0,start=pos+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}StateBlock.prototype.push=function(type,tag,nesting){var token$1=new token(type,tag,nesting);return token$1.block=!0,nesting<0&&this.level--,token$1.level=this.level,nesting>0&&this.level++,this.tokens.push(token$1),token$1},StateBlock.prototype.isEmpty=function isEmpty(line){return this.bMarks[line]+this.tShift[line]>=this.eMarks[line]},StateBlock.prototype.skipEmptyLines=function skipEmptyLines(from){for(var max=this.lineMax;from<max&&!(this.bMarks[from]+this.tShift[from]<this.eMarks[from]);from++);return from},StateBlock.prototype.skipSpaces=function skipSpaces(pos){for(var ch,max=this.src.length;pos<max&&(ch=this.src.charCodeAt(pos),isSpace$4(ch));pos++);return pos},StateBlock.prototype.skipSpacesBack=function skipSpacesBack(pos,min){if(pos<=min)return pos;for(;pos>min;)if(!isSpace$4(this.src.charCodeAt(--pos)))return pos+1;return pos},StateBlock.prototype.skipChars=function skipChars(pos,code){for(var max=this.src.length;pos<max&&this.src.charCodeAt(pos)===code;pos++);return pos},StateBlock.prototype.skipCharsBack=function skipCharsBack(pos,code,min){if(pos<=min)return pos;for(;pos>min;)if(code!==this.src.charCodeAt(--pos))return pos+1;return pos},StateBlock.prototype.getLines=function getLines(begin,end,indent,keepLastLF){var i,lineIndent,ch,first,last,queue,lineStart,line=begin;if(begin>=end)return"";for(queue=new Array(end-begin),i=0;line<end;line++,i++){for(lineIndent=0,lineStart=first=this.bMarks[line],last=line+1<end||keepLastLF?this.eMarks[line]+1:this.eMarks[line];first<last&&lineIndent<indent;){if(ch=this.src.charCodeAt(first),isSpace$4(ch))9===ch?lineIndent+=4-(lineIndent+this.bsCount[line])%4:lineIndent++;else{if(!(first-lineStart<this.tShift[line]))break;lineIndent++}first++}queue[i]=lineIndent>indent?new Array(lineIndent-indent+1).join(" ")+this.src.slice(first,last):this.src.slice(first,last)}return queue.join("")},StateBlock.prototype.Token=token;var state_block=StateBlock,_rules$1=[["table",function table(state,startLine,endLine,silent){var ch,lineText,pos,i,l,nextLine,columns,columnCount,token,aligns,t,tableLines,tbodyLines,oldParentType,terminate,terminatorRules,firstCh,secondCh;if(startLine+2>endLine)return!1;if(nextLine=startLine+1,state.sCount[nextLine]<state.blkIndent)return!1;if(state.sCount[nextLine]-state.blkIndent>=4)return!1;if((pos=state.bMarks[nextLine]+state.tShift[nextLine])>=state.eMarks[nextLine])return!1;if(124!==(firstCh=state.src.charCodeAt(pos++))&&45!==firstCh&&58!==firstCh)return!1;if(pos>=state.eMarks[nextLine])return!1;if(124!==(secondCh=state.src.charCodeAt(pos++))&&45!==secondCh&&58!==secondCh&&!isSpace$a(secondCh))return!1;if(45===firstCh&&isSpace$a(secondCh))return!1;for(;pos<state.eMarks[nextLine];){if(124!==(ch=state.src.charCodeAt(pos))&&45!==ch&&58!==ch&&!isSpace$a(ch))return!1;pos++}for(columns=(lineText=getLine(state,startLine+1)).split("|"),aligns=[],i=0;i<columns.length;i++){if(!(t=columns[i].trim())){if(0===i||i===columns.length-1)continue;return!1}if(!/^:?-+:?$/.test(t))return!1;58===t.charCodeAt(t.length-1)?aligns.push(58===t.charCodeAt(0)?"center":"right"):58===t.charCodeAt(0)?aligns.push("left"):aligns.push("")}if(-1===(lineText=getLine(state,startLine).trim()).indexOf("|"))return!1;if(state.sCount[startLine]-state.blkIndent>=4)return!1;if((columns=escapedSplit(lineText)).length&&""===columns[0]&&columns.shift(),columns.length&&""===columns[columns.length-1]&&columns.pop(),0===(columnCount=columns.length)||columnCount!==aligns.length)return!1;if(silent)return!0;for(oldParentType=state.parentType,state.parentType="table",terminatorRules=state.md.block.ruler.getRules("blockquote"),(token=state.push("table_open","table",1)).map=tableLines=[startLine,0],(token=state.push("thead_open","thead",1)).map=[startLine,startLine+1],(token=state.push("tr_open","tr",1)).map=[startLine,startLine+1],i=0;i<columns.length;i++)token=state.push("th_open","th",1),aligns[i]&&(token.attrs=[["style","text-align:"+aligns[i]]]),(token=state.push("inline","",0)).content=columns[i].trim(),token.children=[],token=state.push("th_close","th",-1);for(token=state.push("tr_close","tr",-1),token=state.push("thead_close","thead",-1),nextLine=startLine+2;nextLine<endLine&&!(state.sCount[nextLine]<state.blkIndent);nextLine++){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break;if(!(lineText=getLine(state,nextLine).trim()))break;if(state.sCount[nextLine]-state.blkIndent>=4)break;for((columns=escapedSplit(lineText)).length&&""===columns[0]&&columns.shift(),columns.length&&""===columns[columns.length-1]&&columns.pop(),nextLine===startLine+2&&((token=state.push("tbody_open","tbody",1)).map=tbodyLines=[startLine+2,0]),(token=state.push("tr_open","tr",1)).map=[nextLine,nextLine+1],i=0;i<columnCount;i++)token=state.push("td_open","td",1),aligns[i]&&(token.attrs=[["style","text-align:"+aligns[i]]]),(token=state.push("inline","",0)).content=columns[i]?columns[i].trim():"",token.children=[],token=state.push("td_close","td",-1);token=state.push("tr_close","tr",-1)}return tbodyLines&&(token=state.push("tbody_close","tbody",-1),tbodyLines[1]=nextLine),token=state.push("table_close","table",-1),tableLines[1]=nextLine,state.parentType=oldParentType,state.line=nextLine,!0},["paragraph","reference"]],["code",function code(state,startLine,endLine){var nextLine,last,token;if(state.sCount[startLine]-state.blkIndent<4)return!1;for(last=nextLine=startLine+1;nextLine<endLine;)if(state.isEmpty(nextLine))nextLine++;else{if(!(state.sCount[nextLine]-state.blkIndent>=4))break;last=++nextLine}return state.line=last,(token=state.push("code_block","code",0)).content=state.getLines(startLine,last,4+state.blkIndent,!1)+"\n",token.map=[startLine,state.line],!0}],["fence",function fence(state,startLine,endLine,silent){var marker,len,params,nextLine,mem,token,markup,haveEndMarker=!1,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(pos+3>max)return!1;if(126!==(marker=state.src.charCodeAt(pos))&&96!==marker)return!1;if(mem=pos,(len=(pos=state.skipChars(pos,marker))-mem)<3)return!1;if(markup=state.src.slice(mem,pos),params=state.src.slice(pos,max),96===marker&&params.indexOf(String.fromCharCode(marker))>=0)return!1;if(silent)return!0;for(nextLine=startLine;!(++nextLine>=endLine)&&!((pos=mem=state.bMarks[nextLine]+state.tShift[nextLine])<(max=state.eMarks[nextLine])&&state.sCount[nextLine]<state.blkIndent);)if(state.src.charCodeAt(pos)===marker&&!(state.sCount[nextLine]-state.blkIndent>=4||(pos=state.skipChars(pos,marker))-mem<len||(pos=state.skipSpaces(pos))<max)){haveEndMarker=!0;break}return len=state.sCount[startLine],state.line=nextLine+(haveEndMarker?1:0),(token=state.push("fence","code",0)).info=params,token.content=state.getLines(startLine+1,nextLine,len,!0),token.markup=markup,token.map=[startLine,state.line],!0},["paragraph","reference","blockquote","list"]],["blockquote",function blockquote(state,startLine,endLine,silent){var adjustTab,ch,i,initial,l,lastLineEmpty,lines,nextLine,offset,oldBMarks,oldBSCount,oldIndent,oldParentType,oldSCount,oldTShift,spaceAfterMarker,terminate,terminatorRules,token,isOutdented,oldLineMax=state.lineMax,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(62!==state.src.charCodeAt(pos))return!1;if(silent)return!0;for(oldBMarks=[],oldBSCount=[],oldSCount=[],oldTShift=[],terminatorRules=state.md.block.ruler.getRules("blockquote"),oldParentType=state.parentType,state.parentType="blockquote",nextLine=startLine;nextLine<endLine&&(isOutdented=state.sCount[nextLine]<state.blkIndent,!((pos=state.bMarks[nextLine]+state.tShift[nextLine])>=(max=state.eMarks[nextLine])));nextLine++)if(62!==state.src.charCodeAt(pos++)||isOutdented){if(lastLineEmpty)break;for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate){state.lineMax=nextLine,0!==state.blkIndent&&(oldBMarks.push(state.bMarks[nextLine]),oldBSCount.push(state.bsCount[nextLine]),oldTShift.push(state.tShift[nextLine]),oldSCount.push(state.sCount[nextLine]),state.sCount[nextLine]-=state.blkIndent);break}oldBMarks.push(state.bMarks[nextLine]),oldBSCount.push(state.bsCount[nextLine]),oldTShift.push(state.tShift[nextLine]),oldSCount.push(state.sCount[nextLine]),state.sCount[nextLine]=-1}else{for(initial=state.sCount[nextLine]+1,32===state.src.charCodeAt(pos)?(pos++,initial++,adjustTab=!1,spaceAfterMarker=!0):9===state.src.charCodeAt(pos)?(spaceAfterMarker=!0,(state.bsCount[nextLine]+initial)%4==3?(pos++,initial++,adjustTab=!1):adjustTab=!0):spaceAfterMarker=!1,offset=initial,oldBMarks.push(state.bMarks[nextLine]),state.bMarks[nextLine]=pos;pos<max&&(ch=state.src.charCodeAt(pos),isSpace$9(ch));)9===ch?offset+=4-(offset+state.bsCount[nextLine]+(adjustTab?1:0))%4:offset++,pos++;lastLineEmpty=pos>=max,oldBSCount.push(state.bsCount[nextLine]),state.bsCount[nextLine]=state.sCount[nextLine]+1+(spaceAfterMarker?1:0),oldSCount.push(state.sCount[nextLine]),state.sCount[nextLine]=offset-initial,oldTShift.push(state.tShift[nextLine]),state.tShift[nextLine]=pos-state.bMarks[nextLine]}for(oldIndent=state.blkIndent,state.blkIndent=0,(token=state.push("blockquote_open","blockquote",1)).markup=">",token.map=lines=[startLine,0],state.md.block.tokenize(state,startLine,nextLine),(token=state.push("blockquote_close","blockquote",-1)).markup=">",state.lineMax=oldLineMax,state.parentType=oldParentType,lines[1]=state.line,i=0;i<oldTShift.length;i++)state.bMarks[i+startLine]=oldBMarks[i],state.tShift[i+startLine]=oldTShift[i],state.sCount[i+startLine]=oldSCount[i],state.bsCount[i+startLine]=oldBSCount[i];return state.blkIndent=oldIndent,!0},["paragraph","reference","blockquote","list"]],["hr",function hr(state,startLine,endLine,silent){var marker,cnt,ch,token,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(42!==(marker=state.src.charCodeAt(pos++))&&45!==marker&&95!==marker)return!1;for(cnt=1;pos<max;){if((ch=state.src.charCodeAt(pos++))!==marker&&!isSpace$8(ch))return!1;ch===marker&&cnt++}return!(cnt<3)&&(silent||(state.line=startLine+1,(token=state.push("hr","hr",0)).map=[startLine,state.line],token.markup=Array(cnt+1).join(String.fromCharCode(marker))),!0)},["paragraph","reference","blockquote","list"]],["list",function list(state,startLine,endLine,silent){var ch,contentStart,i,indent,indentAfterMarker,initial,isOrdered,itemLines,l,listLines,listTokIdx,markerCharCode,markerValue,max,offset,oldListIndent,oldParentType,oldSCount,oldTShift,oldTight,pos,posAfterMarker,prevEmptyEnd,start,terminate,terminatorRules,token,nextLine=startLine,isTerminatingParagraph=!1,tight=!0;if(state.sCount[nextLine]-state.blkIndent>=4)return!1;if(state.listIndent>=0&&state.sCount[nextLine]-state.listIndent>=4&&state.sCount[nextLine]<state.blkIndent)return!1;if(silent&&"paragraph"===state.parentType&&state.sCount[nextLine]>=state.blkIndent&&(isTerminatingParagraph=!0),(posAfterMarker=skipOrderedListMarker(state,nextLine))>=0){if(isOrdered=!0,start=state.bMarks[nextLine]+state.tShift[nextLine],markerValue=Number(state.src.slice(start,posAfterMarker-1)),isTerminatingParagraph&&1!==markerValue)return!1}else{if(!((posAfterMarker=skipBulletListMarker(state,nextLine))>=0))return!1;isOrdered=!1}if(isTerminatingParagraph&&state.skipSpaces(posAfterMarker)>=state.eMarks[nextLine])return!1;if(silent)return!0;for(markerCharCode=state.src.charCodeAt(posAfterMarker-1),listTokIdx=state.tokens.length,isOrdered?(token=state.push("ordered_list_open","ol",1),1!==markerValue&&(token.attrs=[["start",markerValue]])):token=state.push("bullet_list_open","ul",1),token.map=listLines=[nextLine,0],token.markup=String.fromCharCode(markerCharCode),prevEmptyEnd=!1,terminatorRules=state.md.block.ruler.getRules("list"),oldParentType=state.parentType,state.parentType="list";nextLine<endLine;){for(pos=posAfterMarker,max=state.eMarks[nextLine],initial=offset=state.sCount[nextLine]+posAfterMarker-(state.bMarks[nextLine]+state.tShift[nextLine]);pos<max;){if(9===(ch=state.src.charCodeAt(pos)))offset+=4-(offset+state.bsCount[nextLine])%4;else{if(32!==ch)break;offset++}pos++}if((indentAfterMarker=(contentStart=pos)>=max?1:offset-initial)>4&&(indentAfterMarker=1),indent=initial+indentAfterMarker,(token=state.push("list_item_open","li",1)).markup=String.fromCharCode(markerCharCode),token.map=itemLines=[nextLine,0],isOrdered&&(token.info=state.src.slice(start,posAfterMarker-1)),oldTight=state.tight,oldTShift=state.tShift[nextLine],oldSCount=state.sCount[nextLine],oldListIndent=state.listIndent,state.listIndent=state.blkIndent,state.blkIndent=indent,state.tight=!0,state.tShift[nextLine]=contentStart-state.bMarks[nextLine],state.sCount[nextLine]=offset,contentStart>=max&&state.isEmpty(nextLine+1)?state.line=Math.min(state.line+2,endLine):state.md.block.tokenize(state,nextLine,endLine,!0),state.tight&&!prevEmptyEnd||(tight=!1),prevEmptyEnd=state.line-nextLine>1&&state.isEmpty(state.line-1),state.blkIndent=state.listIndent,state.listIndent=oldListIndent,state.tShift[nextLine]=oldTShift,state.sCount[nextLine]=oldSCount,state.tight=oldTight,(token=state.push("list_item_close","li",-1)).markup=String.fromCharCode(markerCharCode),nextLine=state.line,itemLines[1]=nextLine,nextLine>=endLine)break;if(state.sCount[nextLine]<state.blkIndent)break;if(state.sCount[nextLine]-state.blkIndent>=4)break;for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break;if(isOrdered){if((posAfterMarker=skipOrderedListMarker(state,nextLine))<0)break;start=state.bMarks[nextLine]+state.tShift[nextLine]}else if((posAfterMarker=skipBulletListMarker(state,nextLine))<0)break;if(markerCharCode!==state.src.charCodeAt(posAfterMarker-1))break}return(token=isOrdered?state.push("ordered_list_close","ol",-1):state.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(markerCharCode),listLines[1]=nextLine,state.line=nextLine,state.parentType=oldParentType,tight&&function markTightParagraphs(state,idx){var i,l,level=state.level+2;for(i=idx+2,l=state.tokens.length-2;i<l;i++)state.tokens[i].level===level&&"paragraph_open"===state.tokens[i].type&&(state.tokens[i+2].hidden=!0,state.tokens[i].hidden=!0,i+=2)}(state,listTokIdx),!0},["paragraph","reference","blockquote"]],["reference",function reference(state,startLine,_endLine,silent){var ch,destEndPos,destEndLineNo,endLine,href,i,l,label,labelEnd,oldParentType,res,start,str,terminate,terminatorRules,title,lines=0,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine],nextLine=startLine+1;if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(91!==state.src.charCodeAt(pos))return!1;for(;++pos<max;)if(93===state.src.charCodeAt(pos)&&92!==state.src.charCodeAt(pos-1)){if(pos+1===max)return!1;if(58!==state.src.charCodeAt(pos+1))return!1;break}for(endLine=state.lineMax,terminatorRules=state.md.block.ruler.getRules("reference"),oldParentType=state.parentType,state.parentType="reference";nextLine<endLine&&!state.isEmpty(nextLine);nextLine++)if(!(state.sCount[nextLine]-state.blkIndent>3||state.sCount[nextLine]<0)){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break}for(max=(str=state.getLines(startLine,nextLine,state.blkIndent,!1).trim()).length,pos=1;pos<max;pos++){if(91===(ch=str.charCodeAt(pos)))return!1;if(93===ch){labelEnd=pos;break}(10===ch||92===ch&&++pos<max&&10===str.charCodeAt(pos))&&lines++}if(labelEnd<0||58!==str.charCodeAt(labelEnd+1))return!1;for(pos=labelEnd+2;pos<max;pos++)if(10===(ch=str.charCodeAt(pos)))lines++;else if(!isSpace$6(ch))break;if(!(res=state.md.helpers.parseLinkDestination(str,pos,max)).ok)return!1;if(href=state.md.normalizeLink(res.str),!state.md.validateLink(href))return!1;for(destEndPos=pos=res.pos,destEndLineNo=lines+=res.lines,start=pos;pos<max;pos++)if(10===(ch=str.charCodeAt(pos)))lines++;else if(!isSpace$6(ch))break;for(res=state.md.helpers.parseLinkTitle(str,pos,max),pos<max&&start!==pos&&res.ok?(title=res.str,pos=res.pos,lines+=res.lines):(title="",pos=destEndPos,lines=destEndLineNo);pos<max&&(ch=str.charCodeAt(pos),isSpace$6(ch));)pos++;if(pos<max&&10!==str.charCodeAt(pos)&&title)for(title="",pos=destEndPos,lines=destEndLineNo;pos<max&&(ch=str.charCodeAt(pos),isSpace$6(ch));)pos++;return!(pos<max&&10!==str.charCodeAt(pos))&&(!!(label=normalizeReference$2(str.slice(1,labelEnd)))&&(silent||(void 0===state.env.references&&(state.env.references={}),void 0===state.env.references[label]&&(state.env.references[label]={title,href}),state.parentType=oldParentType,state.line=startLine+lines+1),!0))}],["html_block",function html_block(state,startLine,endLine,silent){var i,nextLine,token,lineText,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(!state.md.options.html)return!1;if(60!==state.src.charCodeAt(pos))return!1;for(lineText=state.src.slice(pos,max),i=0;i<HTML_SEQUENCES.length&&!HTML_SEQUENCES[i][0].test(lineText);i++);if(i===HTML_SEQUENCES.length)return!1;if(silent)return HTML_SEQUENCES[i][2];if(nextLine=startLine+1,!HTML_SEQUENCES[i][1].test(lineText))for(;nextLine<endLine&&!(state.sCount[nextLine]<state.blkIndent);nextLine++)if(pos=state.bMarks[nextLine]+state.tShift[nextLine],max=state.eMarks[nextLine],lineText=state.src.slice(pos,max),HTML_SEQUENCES[i][1].test(lineText)){0!==lineText.length&&nextLine++;break}return state.line=nextLine,(token=state.push("html_block","",0)).map=[startLine,nextLine],token.content=state.getLines(startLine,nextLine,state.blkIndent,!0),!0},["paragraph","reference","blockquote"]],["heading",function heading(state,startLine,endLine,silent){var ch,level,tmp,token,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(35!==(ch=state.src.charCodeAt(pos))||pos>=max)return!1;for(level=1,ch=state.src.charCodeAt(++pos);35===ch&&pos<max&&level<=6;)level++,ch=state.src.charCodeAt(++pos);return!(level>6||pos<max&&!isSpace$5(ch))&&(silent||(max=state.skipSpacesBack(max,pos),(tmp=state.skipCharsBack(max,35,pos))>pos&&isSpace$5(state.src.charCodeAt(tmp-1))&&(max=tmp),state.line=startLine+1,(token=state.push("heading_open","h"+String(level),1)).markup="########".slice(0,level),token.map=[startLine,state.line],(token=state.push("inline","",0)).content=state.src.slice(pos,max).trim(),token.map=[startLine,state.line],token.children=[],(token=state.push("heading_close","h"+String(level),-1)).markup="########".slice(0,level)),!0)},["paragraph","reference","blockquote"]],["lheading",function lheading(state,startLine,endLine){var content,terminate,i,l,token,pos,max,level,marker,oldParentType,nextLine=startLine+1,terminatorRules=state.md.block.ruler.getRules("paragraph");if(state.sCount[startLine]-state.blkIndent>=4)return!1;for(oldParentType=state.parentType,state.parentType="paragraph";nextLine<endLine&&!state.isEmpty(nextLine);nextLine++)if(!(state.sCount[nextLine]-state.blkIndent>3)){if(state.sCount[nextLine]>=state.blkIndent&&(pos=state.bMarks[nextLine]+state.tShift[nextLine])<(max=state.eMarks[nextLine])&&(45===(marker=state.src.charCodeAt(pos))||61===marker)&&(pos=state.skipChars(pos,marker),(pos=state.skipSpaces(pos))>=max)){level=61===marker?1:2;break}if(!(state.sCount[nextLine]<0)){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break}}return!!level&&(content=state.getLines(startLine,nextLine,state.blkIndent,!1).trim(),state.line=nextLine+1,(token=state.push("heading_open","h"+String(level),1)).markup=String.fromCharCode(marker),token.map=[startLine,state.line],(token=state.push("inline","",0)).content=content,token.map=[startLine,state.line-1],token.children=[],(token=state.push("heading_close","h"+String(level),-1)).markup=String.fromCharCode(marker),state.parentType=oldParentType,!0)}],["paragraph",function paragraph(state,startLine,endLine){var content,terminate,i,l,token,oldParentType,nextLine=startLine+1,terminatorRules=state.md.block.ruler.getRules("paragraph");for(oldParentType=state.parentType,state.parentType="paragraph";nextLine<endLine&&!state.isEmpty(nextLine);nextLine++)if(!(state.sCount[nextLine]-state.blkIndent>3||state.sCount[nextLine]<0)){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break}return content=state.getLines(startLine,nextLine,state.blkIndent,!1).trim(),state.line=nextLine,(token=state.push("paragraph_open","p",1)).map=[startLine,state.line],(token=state.push("inline","",0)).content=content,token.map=[startLine,state.line],token.children=[],token=state.push("paragraph_close","p",-1),state.parentType=oldParentType,!0}]];function ParserBlock(){this.ruler=new ruler;for(var i=0;i<_rules$1.length;i++)this.ruler.push(_rules$1[i][0],_rules$1[i][1],{alt:(_rules$1[i][2]||[]).slice()})}ParserBlock.prototype.tokenize=function(state,startLine,endLine){for(var ok,i,prevLine,rules=this.ruler.getRules(""),len=rules.length,line=startLine,hasEmptyLines=!1,maxNesting=state.md.options.maxNesting;line<endLine&&(state.line=line=state.skipEmptyLines(line),!(line>=endLine))&&!(state.sCount[line]<state.blkIndent);){if(state.level>=maxNesting){state.line=endLine;break}for(prevLine=state.line,i=0;i<len;i++)if(ok=rules[i](state,line,endLine,!1)){if(prevLine>=state.line)throw new Error("block rule didn't increment state.line");break}if(!ok)throw new Error("none of the block rules matched");state.tight=!hasEmptyLines,state.isEmpty(state.line-1)&&(hasEmptyLines=!0),(line=state.line)<endLine&&state.isEmpty(line)&&(hasEmptyLines=!0,line++,state.line=line)}},ParserBlock.prototype.parse=function(src,md,env,outTokens){var state;src&&(state=new this.State(src,md,env,outTokens),this.tokenize(state,state.line,state.lineMax))},ParserBlock.prototype.State=state_block;var parser_block=ParserBlock;function isTerminatorChar(ch){switch(ch){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}for(var SCHEME_RE=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i,isSpace$3=utils.isSpace,isSpace$2=utils.isSpace,ESCAPED=[],i=0;i<256;i++)ESCAPED.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(ch){ESCAPED[ch.charCodeAt(0)]=1}));function postProcess$1(state,delimiters){var i,j,startDelim,endDelim,token,loneMarkers=[],max=delimiters.length;for(i=0;i<max;i++)126===(startDelim=delimiters[i]).marker&&-1!==startDelim.end&&(endDelim=delimiters[startDelim.end],(token=state.tokens[startDelim.token]).type="s_open",token.tag="s",token.nesting=1,token.markup="~~",token.content="",(token=state.tokens[endDelim.token]).type="s_close",token.tag="s",token.nesting=-1,token.markup="~~",token.content="","text"===state.tokens[endDelim.token-1].type&&"~"===state.tokens[endDelim.token-1].content&&loneMarkers.push(endDelim.token-1));for(;loneMarkers.length;){for(j=(i=loneMarkers.pop())+1;j<state.tokens.length&&"s_close"===state.tokens[j].type;)j++;i!==--j&&(token=state.tokens[j],state.tokens[j]=state.tokens[i],state.tokens[i]=token)}}var strikethrough={tokenize:function strikethrough(state,silent){var i,scanned,len,ch,start=state.pos,marker=state.src.charCodeAt(start);if(silent)return!1;if(126!==marker)return!1;if(len=(scanned=state.scanDelims(state.pos,!0)).length,ch=String.fromCharCode(marker),len<2)return!1;for(len%2&&(state.push("text","",0).content=ch,len--),i=0;i<len;i+=2)state.push("text","",0).content=ch+ch,state.delimiters.push({marker,length:0,token:state.tokens.length-1,end:-1,open:scanned.can_open,close:scanned.can_close});return state.pos+=scanned.length,!0},postProcess:function strikethrough(state){var curr,tokens_meta=state.tokens_meta,max=state.tokens_meta.length;for(postProcess$1(state,state.delimiters),curr=0;curr<max;curr++)tokens_meta[curr]&&tokens_meta[curr].delimiters&&postProcess$1(state,tokens_meta[curr].delimiters)}};function postProcess(state,delimiters){var i,startDelim,endDelim,token,ch,isStrong;for(i=delimiters.length-1;i>=0;i--)95!==(startDelim=delimiters[i]).marker&&42!==startDelim.marker||-1!==startDelim.end&&(endDelim=delimiters[startDelim.end],isStrong=i>0&&delimiters[i-1].end===startDelim.end+1&&delimiters[i-1].marker===startDelim.marker&&delimiters[i-1].token===startDelim.token-1&&delimiters[startDelim.end+1].token===endDelim.token+1,ch=String.fromCharCode(startDelim.marker),(token=state.tokens[startDelim.token]).type=isStrong?"strong_open":"em_open",token.tag=isStrong?"strong":"em",token.nesting=1,token.markup=isStrong?ch+ch:ch,token.content="",(token=state.tokens[endDelim.token]).type=isStrong?"strong_close":"em_close",token.tag=isStrong?"strong":"em",token.nesting=-1,token.markup=isStrong?ch+ch:ch,token.content="",isStrong&&(state.tokens[delimiters[i-1].token].content="",state.tokens[delimiters[startDelim.end+1].token].content="",i--))}var emphasis={tokenize:function emphasis(state,silent){var i,scanned,start=state.pos,marker=state.src.charCodeAt(start);if(silent)return!1;if(95!==marker&&42!==marker)return!1;for(scanned=state.scanDelims(state.pos,42===marker),i=0;i<scanned.length;i++)state.push("text","",0).content=String.fromCharCode(marker),state.delimiters.push({marker,length:scanned.length,token:state.tokens.length-1,end:-1,open:scanned.can_open,close:scanned.can_close});return state.pos+=scanned.length,!0},postProcess:function emphasis(state){var curr,tokens_meta=state.tokens_meta,max=state.tokens_meta.length;for(postProcess(state,state.delimiters),curr=0;curr<max;curr++)tokens_meta[curr]&&tokens_meta[curr].delimiters&&postProcess(state,tokens_meta[curr].delimiters)}},normalizeReference$1=utils.normalizeReference,isSpace$1=utils.isSpace,normalizeReference=utils.normalizeReference,isSpace=utils.isSpace,EMAIL_RE=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,AUTOLINK_RE=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/,HTML_TAG_RE=html_re.HTML_TAG_RE;var has=utils.has,isValidEntityCode=utils.isValidEntityCode,fromCodePoint=utils.fromCodePoint,DIGITAL_RE=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,NAMED_RE=/^&([a-z][a-z0-9]{1,31});/i;function processDelimiters(delimiters){var closerIdx,openerIdx,closer,opener,minOpenerIdx,newMinOpenerIdx,isOddMatch,lastJump,openersBottom={},max=delimiters.length;if(max){var headerIdx=0,lastTokenIdx=-2,jumps=[];for(closerIdx=0;closerIdx<max;closerIdx++)if(closer=delimiters[closerIdx],jumps.push(0),delimiters[headerIdx].marker===closer.marker&&lastTokenIdx===closer.token-1||(headerIdx=closerIdx),lastTokenIdx=closer.token,closer.length=closer.length||0,closer.close){for(openersBottom.hasOwnProperty(closer.marker)||(openersBottom[closer.marker]=[-1,-1,-1,-1,-1,-1]),minOpenerIdx=openersBottom[closer.marker][(closer.open?3:0)+closer.length%3],newMinOpenerIdx=openerIdx=headerIdx-jumps[headerIdx]-1;openerIdx>minOpenerIdx;openerIdx-=jumps[openerIdx]+1)if((opener=delimiters[openerIdx]).marker===closer.marker&&opener.open&&opener.end<0&&(isOddMatch=!1,(opener.close||closer.open)&&(opener.length+closer.length)%3==0&&(opener.length%3==0&&closer.length%3==0||(isOddMatch=!0)),!isOddMatch)){lastJump=openerIdx>0&&!delimiters[openerIdx-1].open?jumps[openerIdx-1]+1:0,jumps[closerIdx]=closerIdx-openerIdx+lastJump,jumps[openerIdx]=lastJump,closer.open=!1,opener.end=closerIdx,opener.close=!1,newMinOpenerIdx=-1,lastTokenIdx=-2;break}-1!==newMinOpenerIdx&&(openersBottom[closer.marker][(closer.open?3:0)+(closer.length||0)%3]=newMinOpenerIdx)}}}var isWhiteSpace=utils.isWhiteSpace,isPunctChar=utils.isPunctChar,isMdAsciiPunct=utils.isMdAsciiPunct;function StateInline(src,md,env,outTokens){this.src=src,this.env=env,this.md=md,this.tokens=outTokens,this.tokens_meta=Array(outTokens.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}StateInline.prototype.pushPending=function(){var token$1=new token("text","",0);return token$1.content=this.pending,token$1.level=this.pendingLevel,this.tokens.push(token$1),this.pending="",token$1},StateInline.prototype.push=function(type,tag,nesting){this.pending&&this.pushPending();var token$1=new token(type,tag,nesting),token_meta=null;return nesting<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),token$1.level=this.level,nesting>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],token_meta={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(token$1),this.tokens_meta.push(token_meta),token$1},StateInline.prototype.scanDelims=function(start,canSplitWord){var lastChar,nextChar,count,can_open,can_close,isLastWhiteSpace,isLastPunctChar,isNextWhiteSpace,isNextPunctChar,pos=start,left_flanking=!0,right_flanking=!0,max=this.posMax,marker=this.src.charCodeAt(start);for(lastChar=start>0?this.src.charCodeAt(start-1):32;pos<max&&this.src.charCodeAt(pos)===marker;)pos++;return count=pos-start,nextChar=pos<max?this.src.charCodeAt(pos):32,isLastPunctChar=isMdAsciiPunct(lastChar)||isPunctChar(String.fromCharCode(lastChar)),isNextPunctChar=isMdAsciiPunct(nextChar)||isPunctChar(String.fromCharCode(nextChar)),isLastWhiteSpace=isWhiteSpace(lastChar),(isNextWhiteSpace=isWhiteSpace(nextChar))?left_flanking=!1:isNextPunctChar&&(isLastWhiteSpace||isLastPunctChar||(left_flanking=!1)),isLastWhiteSpace?right_flanking=!1:isLastPunctChar&&(isNextWhiteSpace||isNextPunctChar||(right_flanking=!1)),canSplitWord?(can_open=left_flanking,can_close=right_flanking):(can_open=left_flanking&&(!right_flanking||isLastPunctChar),can_close=right_flanking&&(!left_flanking||isNextPunctChar)),{can_open,can_close,length:count}},StateInline.prototype.Token=token;var state_inline=StateInline,_rules=[["text",function text(state,silent){for(var pos=state.pos;pos<state.posMax&&!isTerminatorChar(state.src.charCodeAt(pos));)pos++;return pos!==state.pos&&(silent||(state.pending+=state.src.slice(state.pos,pos)),state.pos=pos,!0)}],["linkify",function linkify(state,silent){var pos,match,proto,link,url,fullUrl,token;return!!state.md.options.linkify&&(!(state.linkLevel>0)&&(!((pos=state.pos)+3>state.posMax)&&(58===state.src.charCodeAt(pos)&&(47===state.src.charCodeAt(pos+1)&&(47===state.src.charCodeAt(pos+2)&&(!!(match=state.pending.match(SCHEME_RE))&&(proto=match[1],!!(link=state.md.linkify.matchAtStart(state.src.slice(pos-proto.length)))&&(!((url=link.url).length<=proto.length)&&(url=url.replace(/\*+$/,""),fullUrl=state.md.normalizeLink(url),!!state.md.validateLink(fullUrl)&&(silent||(state.pending=state.pending.slice(0,-proto.length),(token=state.push("link_open","a",1)).attrs=[["href",fullUrl]],token.markup="linkify",token.info="auto",(token=state.push("text","",0)).content=state.md.normalizeLinkText(url),(token=state.push("link_close","a",-1)).markup="linkify",token.info="auto"),state.pos+=url.length-proto.length,!0))))))))))}],["newline",function newline(state,silent){var pmax,max,ws,pos=state.pos;if(10!==state.src.charCodeAt(pos))return!1;if(pmax=state.pending.length-1,max=state.posMax,!silent)if(pmax>=0&&32===state.pending.charCodeAt(pmax))if(pmax>=1&&32===state.pending.charCodeAt(pmax-1)){for(ws=pmax-1;ws>=1&&32===state.pending.charCodeAt(ws-1);)ws--;state.pending=state.pending.slice(0,ws),state.push("hardbreak","br",0)}else state.pending=state.pending.slice(0,-1),state.push("softbreak","br",0);else state.push("softbreak","br",0);for(pos++;pos<max&&isSpace$3(state.src.charCodeAt(pos));)pos++;return state.pos=pos,!0}],["escape",function escape(state,silent){var ch1,ch2,origStr,escapedStr,token,pos=state.pos,max=state.posMax;if(92!==state.src.charCodeAt(pos))return!1;if(++pos>=max)return!1;if(10===(ch1=state.src.charCodeAt(pos))){for(silent||state.push("hardbreak","br",0),pos++;pos<max&&(ch1=state.src.charCodeAt(pos),isSpace$2(ch1));)pos++;return state.pos=pos,!0}return escapedStr=state.src[pos],ch1>=55296&&ch1<=56319&&pos+1<max&&(ch2=state.src.charCodeAt(pos+1))>=56320&&ch2<=57343&&(escapedStr+=state.src[pos+1],pos++),origStr="\\"+escapedStr,silent||(token=state.push("text_special","",0),ch1<256&&0!==ESCAPED[ch1]?token.content=escapedStr:token.content=origStr,token.markup=origStr,token.info="escape"),state.pos=pos+1,!0}],["backticks",function backtick(state,silent){var start,max,marker,token,matchStart,matchEnd,openerLength,closerLength,pos=state.pos;if(96!==state.src.charCodeAt(pos))return!1;for(start=pos,pos++,max=state.posMax;pos<max&&96===state.src.charCodeAt(pos);)pos++;if(openerLength=(marker=state.src.slice(start,pos)).length,state.backticksScanned&&(state.backticks[openerLength]||0)<=start)return silent||(state.pending+=marker),state.pos+=openerLength,!0;for(matchEnd=pos;-1!==(matchStart=state.src.indexOf("`",matchEnd));){for(matchEnd=matchStart+1;matchEnd<max&&96===state.src.charCodeAt(matchEnd);)matchEnd++;if((closerLength=matchEnd-matchStart)===openerLength)return silent||((token=state.push("code_inline","code",0)).markup=marker,token.content=state.src.slice(pos,matchStart).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),state.pos=matchEnd,!0;state.backticks[closerLength]=matchStart}return state.backticksScanned=!0,silent||(state.pending+=marker),state.pos+=openerLength,!0}],["strikethrough",strikethrough.tokenize],["emphasis",emphasis.tokenize],["link",function link(state,silent){var attrs,code,label,labelEnd,labelStart,pos,res,ref,href="",title="",oldPos=state.pos,max=state.posMax,start=state.pos,parseReference=!0;if(91!==state.src.charCodeAt(state.pos))return!1;if(labelStart=state.pos+1,(labelEnd=state.md.helpers.parseLinkLabel(state,state.pos,!0))<0)return!1;if((pos=labelEnd+1)<max&&40===state.src.charCodeAt(pos)){for(parseReference=!1,pos++;pos<max&&(code=state.src.charCodeAt(pos),isSpace$1(code)||10===code);pos++);if(pos>=max)return!1;if(start=pos,(res=state.md.helpers.parseLinkDestination(state.src,pos,state.posMax)).ok){for(href=state.md.normalizeLink(res.str),state.md.validateLink(href)?pos=res.pos:href="",start=pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace$1(code)||10===code);pos++);if(res=state.md.helpers.parseLinkTitle(state.src,pos,state.posMax),pos<max&&start!==pos&&res.ok)for(title=res.str,pos=res.pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace$1(code)||10===code);pos++);}(pos>=max||41!==state.src.charCodeAt(pos))&&(parseReference=!0),pos++}if(parseReference){if(void 0===state.env.references)return!1;if(pos<max&&91===state.src.charCodeAt(pos)?(start=pos+1,(pos=state.md.helpers.parseLinkLabel(state,pos))>=0?label=state.src.slice(start,pos++):pos=labelEnd+1):pos=labelEnd+1,label||(label=state.src.slice(labelStart,labelEnd)),!(ref=state.env.references[normalizeReference$1(label)]))return state.pos=oldPos,!1;href=ref.href,title=ref.title}return silent||(state.pos=labelStart,state.posMax=labelEnd,state.push("link_open","a",1).attrs=attrs=[["href",href]],title&&attrs.push(["title",title]),state.linkLevel++,state.md.inline.tokenize(state),state.linkLevel--,state.push("link_close","a",-1)),state.pos=pos,state.posMax=max,!0}],["image",function image(state,silent){var attrs,code,content,label,labelEnd,labelStart,pos,ref,res,title,token,tokens,start,href="",oldPos=state.pos,max=state.posMax;if(33!==state.src.charCodeAt(state.pos))return!1;if(91!==state.src.charCodeAt(state.pos+1))return!1;if(labelStart=state.pos+2,(labelEnd=state.md.helpers.parseLinkLabel(state,state.pos+1,!1))<0)return!1;if((pos=labelEnd+1)<max&&40===state.src.charCodeAt(pos)){for(pos++;pos<max&&(code=state.src.charCodeAt(pos),isSpace(code)||10===code);pos++);if(pos>=max)return!1;for(start=pos,(res=state.md.helpers.parseLinkDestination(state.src,pos,state.posMax)).ok&&(href=state.md.normalizeLink(res.str),state.md.validateLink(href)?pos=res.pos:href=""),start=pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace(code)||10===code);pos++);if(res=state.md.helpers.parseLinkTitle(state.src,pos,state.posMax),pos<max&&start!==pos&&res.ok)for(title=res.str,pos=res.pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace(code)||10===code);pos++);else title="";if(pos>=max||41!==state.src.charCodeAt(pos))return state.pos=oldPos,!1;pos++}else{if(void 0===state.env.references)return!1;if(pos<max&&91===state.src.charCodeAt(pos)?(start=pos+1,(pos=state.md.helpers.parseLinkLabel(state,pos))>=0?label=state.src.slice(start,pos++):pos=labelEnd+1):pos=labelEnd+1,label||(label=state.src.slice(labelStart,labelEnd)),!(ref=state.env.references[normalizeReference(label)]))return state.pos=oldPos,!1;href=ref.href,title=ref.title}return silent||(content=state.src.slice(labelStart,labelEnd),state.md.inline.parse(content,state.md,state.env,tokens=[]),(token=state.push("image","img",0)).attrs=attrs=[["src",href],["alt",""]],token.children=tokens,token.content=content,title&&attrs.push(["title",title])),state.pos=pos,state.posMax=max,!0}],["autolink",function autolink(state,silent){var url,fullUrl,token,ch,start,max,pos=state.pos;if(60!==state.src.charCodeAt(pos))return!1;for(start=state.pos,max=state.posMax;;){if(++pos>=max)return!1;if(60===(ch=state.src.charCodeAt(pos)))return!1;if(62===ch)break}return url=state.src.slice(start+1,pos),AUTOLINK_RE.test(url)?(fullUrl=state.md.normalizeLink(url),!!state.md.validateLink(fullUrl)&&(silent||((token=state.push("link_open","a",1)).attrs=[["href",fullUrl]],token.markup="autolink",token.info="auto",(token=state.push("text","",0)).content=state.md.normalizeLinkText(url),(token=state.push("link_close","a",-1)).markup="autolink",token.info="auto"),state.pos+=url.length+2,!0)):!!EMAIL_RE.test(url)&&(fullUrl=state.md.normalizeLink("mailto:"+url),!!state.md.validateLink(fullUrl)&&(silent||((token=state.push("link_open","a",1)).attrs=[["href",fullUrl]],token.markup="autolink",token.info="auto",(token=state.push("text","",0)).content=state.md.normalizeLinkText(url),(token=state.push("link_close","a",-1)).markup="autolink",token.info="auto"),state.pos+=url.length+2,!0))}],["html_inline",function html_inline(state,silent){var ch,match,max,token,pos=state.pos;return!!state.md.options.html&&(max=state.posMax,!(60!==state.src.charCodeAt(pos)||pos+2>=max)&&(!(33!==(ch=state.src.charCodeAt(pos+1))&&63!==ch&&47!==ch&&!function isLetter(ch){var lc=32|ch;return lc>=97&&lc<=122}(ch))&&(!!(match=state.src.slice(pos).match(HTML_TAG_RE))&&(silent||((token=state.push("html_inline","",0)).content=match[0],function isLinkOpen(str){return/^<a[>\s]/i.test(str)}(token.content)&&state.linkLevel++,function isLinkClose(str){return/^<\/a\s*>/i.test(str)}(token.content)&&state.linkLevel--),state.pos+=match[0].length,!0))))}],["entity",function entity(state,silent){var code,match,token,pos=state.pos,max=state.posMax;if(38!==state.src.charCodeAt(pos))return!1;if(pos+1>=max)return!1;if(35===state.src.charCodeAt(pos+1)){if(match=state.src.slice(pos).match(DIGITAL_RE))return silent||(code="x"===match[1][0].toLowerCase()?parseInt(match[1].slice(1),16):parseInt(match[1],10),(token=state.push("text_special","",0)).content=isValidEntityCode(code)?fromCodePoint(code):fromCodePoint(65533),token.markup=match[0],token.info="entity"),state.pos+=match[0].length,!0}else if((match=state.src.slice(pos).match(NAMED_RE))&&has(entities,match[1]))return silent||((token=state.push("text_special","",0)).content=entities[match[1]],token.markup=match[0],token.info="entity"),state.pos+=match[0].length,!0;return!1}]],_rules2=[["balance_pairs",function link_pairs(state){var curr,tokens_meta=state.tokens_meta,max=state.tokens_meta.length;for(processDelimiters(state.delimiters),curr=0;curr<max;curr++)tokens_meta[curr]&&tokens_meta[curr].delimiters&&processDelimiters(tokens_meta[curr].delimiters)}],["strikethrough",strikethrough.postProcess],["emphasis",emphasis.postProcess],["fragments_join",function fragments_join(state){var curr,last,level=0,tokens=state.tokens,max=state.tokens.length;for(curr=last=0;curr<max;curr++)tokens[curr].nesting<0&&level--,tokens[curr].level=level,tokens[curr].nesting>0&&level++,"text"===tokens[curr].type&&curr+1<max&&"text"===tokens[curr+1].type?tokens[curr+1].content=tokens[curr].content+tokens[curr+1].content:(curr!==last&&(tokens[last]=tokens[curr]),last++);curr!==last&&(tokens.length=last)}]];function ParserInline(){var i;for(this.ruler=new ruler,i=0;i<_rules.length;i++)this.ruler.push(_rules[i][0],_rules[i][1]);for(this.ruler2=new ruler,i=0;i<_rules2.length;i++)this.ruler2.push(_rules2[i][0],_rules2[i][1])}ParserInline.prototype.skipToken=function(state){var ok,i,pos=state.pos,rules=this.ruler.getRules(""),len=rules.length,maxNesting=state.md.options.maxNesting,cache=state.cache;if(void 0===cache[pos]){if(state.level<maxNesting){for(i=0;i<len;i++)if(state.level++,ok=rules[i](state,!0),state.level--,ok){if(pos>=state.pos)throw new Error("inline rule didn't increment state.pos");break}}else state.pos=state.posMax;ok||state.pos++,cache[pos]=state.pos}else state.pos=cache[pos]},ParserInline.prototype.tokenize=function(state){for(var ok,i,prevPos,rules=this.ruler.getRules(""),len=rules.length,end=state.posMax,maxNesting=state.md.options.maxNesting;state.pos<end;){if(prevPos=state.pos,state.level<maxNesting)for(i=0;i<len;i++)if(ok=rules[i](state,!1)){if(prevPos>=state.pos)throw new Error("inline rule didn't increment state.pos");break}if(ok){if(state.pos>=end)break}else state.pending+=state.src[state.pos++]}state.pending&&state.pushPending()},ParserInline.prototype.parse=function(str,md,env,outTokens){var i,rules,len,state=new this.State(str,md,env,outTokens);for(this.tokenize(state),len=(rules=this.ruler2.getRules("")).length,i=0;i<len;i++)rules[i](state)},ParserInline.prototype.State=state_inline;var parser_inline=ParserInline,re=function re(opts){var re={};opts=opts||{},re.src_Any=regex$3.source,re.src_Cc=regex$2.source,re.src_Z=regex.source,re.src_P=regex$4.source,re.src_ZPCc=[re.src_Z,re.src_P,re.src_Cc].join("|"),re.src_ZCc=[re.src_Z,re.src_Cc].join("|");return re.src_pseudo_letter="(?:(?![><｜]|"+re.src_ZPCc+")"+re.src_Any+")",re.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",re.src_auth="(?:(?:(?!"+re.src_ZCc+"|[@/\\[\\]()]).)+@)?",re.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",re.src_host_terminator="(?=$|[><｜]|"+re.src_ZPCc+")(?!"+(opts["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+re.src_ZPCc+"))",re.src_path="(?:[/?#](?:(?!"+re.src_ZCc+"|[><｜]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+re.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+re.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+re.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+re.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+re.src_ZCc+"|[']).)+\\'|\\'(?="+re.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+re.src_ZCc+"|[.]|$)|"+(opts["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+re.src_ZCc+"|$)|;(?!"+re.src_ZCc+"|$)|\\!+(?!"+re.src_ZCc+"|[!]|$)|\\?(?!"+re.src_ZCc+"|[?]|$))+|\\/)?",re.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',re.src_xn="xn--[a-z0-9\\-]{1,59}",re.src_domain_root="(?:"+re.src_xn+"|"+re.src_pseudo_letter+"{1,63})",re.src_domain="(?:"+re.src_xn+"|(?:"+re.src_pseudo_letter+")|(?:"+re.src_pseudo_letter+"(?:-|"+re.src_pseudo_letter+"){0,61}"+re.src_pseudo_letter+"))",re.src_host="(?:(?:(?:(?:"+re.src_domain+")\\.)*"+re.src_domain+"))",re.tpl_host_fuzzy="(?:"+re.src_ip4+"|(?:(?:(?:"+re.src_domain+")\\.)+(?:%TLDS%)))",re.tpl_host_no_ip_fuzzy="(?:(?:(?:"+re.src_domain+")\\.)+(?:%TLDS%))",re.src_host_strict=re.src_host+re.src_host_terminator,re.tpl_host_fuzzy_strict=re.tpl_host_fuzzy+re.src_host_terminator,re.src_host_port_strict=re.src_host+re.src_port+re.src_host_terminator,re.tpl_host_port_fuzzy_strict=re.tpl_host_fuzzy+re.src_port+re.src_host_terminator,re.tpl_host_port_no_ip_fuzzy_strict=re.tpl_host_no_ip_fuzzy+re.src_port+re.src_host_terminator,re.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+re.src_ZPCc+"|>|$))",re.tpl_email_fuzzy='(^|[><｜]|"|\\(|'+re.src_ZCc+")("+re.src_email_name+"@"+re.tpl_host_fuzzy_strict+")",re.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+re.src_ZPCc+"))((?![$+<=>^`|｜])"+re.tpl_host_port_fuzzy_strict+re.src_path+")",re.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+re.src_ZPCc+"))((?![$+<=>^`|｜])"+re.tpl_host_port_no_ip_fuzzy_strict+re.src_path+")",re};function assign(obj){return Array.prototype.slice.call(arguments,1).forEach((function(source){source&&Object.keys(source).forEach((function(key){obj[key]=source[key]}))})),obj}function _class(obj){return Object.prototype.toString.call(obj)}function isFunction(obj){return"[object Function]"===_class(obj)}function escapeRE(str){return str.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var defaultOptions={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var defaultSchemas={"http:":{validate:function validate(text,pos,self){var tail=text.slice(pos);return self.re.http||(self.re.http=new RegExp("^\\/\\/"+self.re.src_auth+self.re.src_host_port_strict+self.re.src_path,"i")),self.re.http.test(tail)?tail.match(self.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function validate(text,pos,self){var tail=text.slice(pos);return self.re.no_http||(self.re.no_http=new RegExp("^"+self.re.src_auth+"(?:localhost|(?:(?:"+self.re.src_domain+")\\.)+"+self.re.src_domain_root+")"+self.re.src_port+self.re.src_host_terminator+self.re.src_path,"i")),self.re.no_http.test(tail)?pos>=3&&":"===text[pos-3]||pos>=3&&"/"===text[pos-3]?0:tail.match(self.re.no_http)[0].length:0}},"mailto:":{validate:function validate(text,pos,self){var tail=text.slice(pos);return self.re.mailto||(self.re.mailto=new RegExp("^"+self.re.src_email_name+"@"+self.re.src_host_strict,"i")),self.re.mailto.test(tail)?tail.match(self.re.mailto)[0].length:0}}},tlds_2ch_src_re="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",tlds_default="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function compile(self){var re$1=self.re=re(self.__opts__),tlds=self.__tlds__.slice();function untpl(tpl){return tpl.replace("%TLDS%",re$1.src_tlds)}self.onCompile(),self.__tlds_replaced__||tlds.push(tlds_2ch_src_re),tlds.push(re$1.src_xn),re$1.src_tlds=tlds.join("|"),re$1.email_fuzzy=RegExp(untpl(re$1.tpl_email_fuzzy),"i"),re$1.link_fuzzy=RegExp(untpl(re$1.tpl_link_fuzzy),"i"),re$1.link_no_ip_fuzzy=RegExp(untpl(re$1.tpl_link_no_ip_fuzzy),"i"),re$1.host_fuzzy_test=RegExp(untpl(re$1.tpl_host_fuzzy_test),"i");var aliases=[];function schemaError(name,val){throw new Error('(LinkifyIt) Invalid schema "'+name+'": '+val)}self.__compiled__={},Object.keys(self.__schemas__).forEach((function(name){var val=self.__schemas__[name];if(null!==val){var compiled={validate:null,link:null};if(self.__compiled__[name]=compiled,function isObject(obj){return"[object Object]"===_class(obj)}(val))return!function isRegExp(obj){return"[object RegExp]"===_class(obj)}(val.validate)?isFunction(val.validate)?compiled.validate=val.validate:schemaError(name,val):compiled.validate=function createValidator(re){return function(text,pos){var tail=text.slice(pos);return re.test(tail)?tail.match(re)[0].length:0}}(val.validate),void(isFunction(val.normalize)?compiled.normalize=val.normalize:val.normalize?schemaError(name,val):compiled.normalize=function(match,self){self.normalize(match)});!function isString(obj){return"[object String]"===_class(obj)}(val)?schemaError(name,val):aliases.push(name)}})),aliases.forEach((function(alias){self.__compiled__[self.__schemas__[alias]]&&(self.__compiled__[alias].validate=self.__compiled__[self.__schemas__[alias]].validate,self.__compiled__[alias].normalize=self.__compiled__[self.__schemas__[alias]].normalize)})),self.__compiled__[""]={validate:null,normalize:function(match,self){self.normalize(match)}};var slist=Object.keys(self.__compiled__).filter((function(name){return name.length>0&&self.__compiled__[name]})).map(escapeRE).join("|");self.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+re$1.src_ZPCc+"))("+slist+")","i"),self.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+re$1.src_ZPCc+"))("+slist+")","ig"),self.re.schema_at_start=RegExp("^"+self.re.schema_search.source,"i"),self.re.pretest=RegExp("("+self.re.schema_test.source+")|("+self.re.host_fuzzy_test.source+")|@","i"),function resetScanCache(self){self.__index__=-1,self.__text_cache__=""}(self)}function Match(self,shift){var start=self.__index__,end=self.__last_index__,text=self.__text_cache__.slice(start,end);this.schema=self.__schema__.toLowerCase(),this.index=start+shift,this.lastIndex=end+shift,this.raw=text,this.text=text,this.url=text}function createMatch(self,shift){var match=new Match(self,shift);return self.__compiled__[match.schema].normalize(match,self),match}function LinkifyIt(schemas,options){if(!(this instanceof LinkifyIt))return new LinkifyIt(schemas,options);options||function isOptionsObj(obj){return Object.keys(obj||{}).reduce((function(acc,k){return acc||defaultOptions.hasOwnProperty(k)}),!1)}(schemas)&&(options=schemas,schemas={}),this.__opts__=assign({},defaultOptions,options),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=assign({},defaultSchemas,schemas),this.__compiled__={},this.__tlds__=tlds_default,this.__tlds_replaced__=!1,this.re={},compile(this)}LinkifyIt.prototype.add=function add(schema,definition){return this.__schemas__[schema]=definition,compile(this),this},LinkifyIt.prototype.set=function set(options){return this.__opts__=assign(this.__opts__,options),this},LinkifyIt.prototype.test=function test(text){if(this.__text_cache__=text,this.__index__=-1,!text.length)return!1;var m,ml,me,len,shift,next,re,tld_pos;if(this.re.schema_test.test(text))for((re=this.re.schema_search).lastIndex=0;null!==(m=re.exec(text));)if(len=this.testSchemaAt(text,m[2],re.lastIndex)){this.__schema__=m[2],this.__index__=m.index+m[1].length,this.__last_index__=m.index+m[0].length+len;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(tld_pos=text.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||tld_pos<this.__index__)&&null!==(ml=text.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(shift=ml.index+ml[1].length,(this.__index__<0||shift<this.__index__)&&(this.__schema__="",this.__index__=shift,this.__last_index__=ml.index+ml[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&text.indexOf("@")>=0&&null!==(me=text.match(this.re.email_fuzzy))&&(shift=me.index+me[1].length,next=me.index+me[0].length,(this.__index__<0||shift<this.__index__||shift===this.__index__&&next>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=shift,this.__last_index__=next)),this.__index__>=0},LinkifyIt.prototype.pretest=function pretest(text){return this.re.pretest.test(text)},LinkifyIt.prototype.testSchemaAt=function testSchemaAt(text,schema,pos){return this.__compiled__[schema.toLowerCase()]?this.__compiled__[schema.toLowerCase()].validate(text,pos,this):0},LinkifyIt.prototype.match=function match(text){var shift=0,result=[];this.__index__>=0&&this.__text_cache__===text&&(result.push(createMatch(this,shift)),shift=this.__last_index__);for(var tail=shift?text.slice(shift):text;this.test(tail);)result.push(createMatch(this,shift)),tail=tail.slice(this.__last_index__),shift+=this.__last_index__;return result.length?result:null},LinkifyIt.prototype.matchAtStart=function matchAtStart(text){if(this.__text_cache__=text,this.__index__=-1,!text.length)return null;var m=this.re.schema_at_start.exec(text);if(!m)return null;var len=this.testSchemaAt(text,m[2],m[0].length);return len?(this.__schema__=m[2],this.__index__=m.index+m[1].length,this.__last_index__=m.index+m[0].length+len,createMatch(this,0)):null},LinkifyIt.prototype.tlds=function tlds(list,keepOld){return list=Array.isArray(list)?list:[list],keepOld?(this.__tlds__=this.__tlds__.concat(list).sort().filter((function(el,idx,arr){return el!==arr[idx-1]})).reverse(),compile(this),this):(this.__tlds__=list.slice(),this.__tlds_replaced__=!0,compile(this),this)},LinkifyIt.prototype.normalize=function normalize(match){match.schema||(match.url="http://"+match.url),"mailto:"!==match.schema||/^mailto:/i.test(match.url)||(match.url="mailto:"+match.url)},LinkifyIt.prototype.onCompile=function onCompile(){};var linkifyIt=LinkifyIt,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\0-\x7F]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function mapDomain(domain,callback){var parts=domain.split("@"),result="";parts.length>1&&(result=parts[0]+"@",domain=parts[1]);var encoded=function map(array,callback){for(var result=[],length=array.length;length--;)result[length]=callback(array[length]);return result}((domain=domain.replace(regexSeparators,".")).split("."),callback).join(".");return result+encoded}function ucs2decode(string){for(var output=[],counter=0,length=string.length;counter<length;){var value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){var extra=string.charCodeAt(counter++);56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)}else output.push(value)}return output}var basicToDigit=function basicToDigit(codePoint){return codePoint>=48&&codePoint<58?codePoint-48+26:codePoint>=65&&codePoint<91?codePoint-65:codePoint>=97&&codePoint<123?codePoint-97:36},digitToBasic=function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)},adapt=function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))},decode=function decode(input){var output=[],inputLength=input.length,i=0,n=128,bias=72,basic=input.lastIndexOf("-");basic<0&&(basic=0);for(var j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(var index=basic>0?basic+1:0;index<inputLength;){for(var oldi=i,w=1,k=36;;k+=36){index>=inputLength&&error("invalid-input");var digit=basicToDigit(input.charCodeAt(index++));digit>=36&&error("invalid-input"),digit>floor((maxInt-i)/w)&&error("overflow"),i+=digit*w;var t=k<=bias?1:k>=bias+26?26:k-bias;if(digit<t)break;var baseMinusT=36-t;w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT}var out=output.length+1;bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return String.fromCodePoint.apply(String,output)},encode=function encode(input){var _step4,output=[],inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,_iterator3=_createForOfIteratorHelper(input);try{for(_iterator3.s();!(_step4=_iterator3.n()).done;){var _currentValue2=_step4.value;_currentValue2<128&&output.push(stringFromCharCode(_currentValue2))}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var basicLength=output.length,handledCPCount=basicLength;for(basicLength&&output.push("-");handledCPCount<inputLength;){var _step5,m=maxInt,_iterator4=_createForOfIteratorHelper(input);try{for(_iterator4.s();!(_step5=_iterator4.n()).done;){var currentValue=_step5.value;currentValue>=n&&currentValue<m&&(m=currentValue)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var handledCPCountPlusOne=handledCPCount+1;m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m;var _step6,_iterator5=_createForOfIteratorHelper(input);try{for(_iterator5.s();!(_step6=_iterator5.n()).done;){var _currentValue=_step6.value;if(_currentValue<n&&++delta>maxInt&&error("overflow"),_currentValue===n){for(var q=delta,k=36;;k+=36){var t=k<=bias?1:k>=bias+26?26:k-bias;if(q<t)break;var qMinusT=q-t,baseMinusT=36-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount===basicLength),delta=0,++handledCPCount}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}++delta,++n}return output.join("")},punycode_1={version:"2.1.0",ucs2:{decode:ucs2decode,encode:function ucs2encode(codePoints){return String.fromCodePoint.apply(String,_toConsumableArray(codePoints))}},decode,encode,toASCII:function toASCII(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function toUnicode(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},config={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},zero:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}}},BAD_PROTO_RE=/^(vbscript|javascript|file|data):/,GOOD_DATA_RE=/^data:image\/(gif|png|jpeg|webp);/;function validateLink(url){var str=url.trim().toLowerCase();return!BAD_PROTO_RE.test(str)||!!GOOD_DATA_RE.test(str)}var RECODE_HOSTNAME_FOR=["http:","https:","mailto:"];function normalizeLink(url){var parsed=mdurl.parse(url,!0);if(parsed.hostname&&(!parsed.protocol||RECODE_HOSTNAME_FOR.indexOf(parsed.protocol)>=0))try{parsed.hostname=punycode_1.toASCII(parsed.hostname)}catch(er){}return mdurl.encode(mdurl.format(parsed))}function normalizeLinkText(url){var parsed=mdurl.parse(url,!0);if(parsed.hostname&&(!parsed.protocol||RECODE_HOSTNAME_FOR.indexOf(parsed.protocol)>=0))try{parsed.hostname=punycode_1.toUnicode(parsed.hostname)}catch(er){}return mdurl.decode(mdurl.format(parsed),mdurl.decode.defaultChars+"%")}function MarkdownIt(presetName,options){if(!(this instanceof MarkdownIt))return new MarkdownIt(presetName,options);options||utils.isString(presetName)||(options=presetName||{},presetName="default"),this.inline=new parser_inline,this.block=new parser_block,this.core=new parser_core,this.renderer=new renderer,this.linkify=new linkifyIt,this.validateLink=validateLink,this.normalizeLink=normalizeLink,this.normalizeLinkText=normalizeLinkText,this.utils=utils,this.helpers=utils.assign({},helpers),this.options={},this.configure(presetName),options&&this.set(options)}MarkdownIt.prototype.set=function(options){return utils.assign(this.options,options),this},MarkdownIt.prototype.configure=function(presets){var presetName,self=this;if(utils.isString(presets)&&!(presets=config[presetName=presets]))throw new Error('Wrong `markdown-it` preset "'+presetName+'", check name');if(!presets)throw new Error("Wrong `markdown-it` preset, can't be empty");return presets.options&&self.set(presets.options),presets.components&&Object.keys(presets.components).forEach((function(name){presets.components[name].rules&&self[name].ruler.enableOnly(presets.components[name].rules),presets.components[name].rules2&&self[name].ruler2.enableOnly(presets.components[name].rules2)})),this},MarkdownIt.prototype.enable=function(list,ignoreInvalid){var result=[];Array.isArray(list)||(list=[list]),["core","block","inline"].forEach((function(chain){result=result.concat(this[chain].ruler.enable(list,!0))}),this),result=result.concat(this.inline.ruler2.enable(list,!0));var missed=list.filter((function(name){return result.indexOf(name)<0}));if(missed.length&&!ignoreInvalid)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+missed);return this},MarkdownIt.prototype.disable=function(list,ignoreInvalid){var result=[];Array.isArray(list)||(list=[list]),["core","block","inline"].forEach((function(chain){result=result.concat(this[chain].ruler.disable(list,!0))}),this),result=result.concat(this.inline.ruler2.disable(list,!0));var missed=list.filter((function(name){return result.indexOf(name)<0}));if(missed.length&&!ignoreInvalid)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+missed);return this},MarkdownIt.prototype.use=function(plugin){var args=[this].concat(Array.prototype.slice.call(arguments,1));return plugin.apply(plugin,args),this},MarkdownIt.prototype.parse=function(src,env){if("string"!=typeof src)throw new Error("Input data should be a String");var state=new this.core.State(src,this,env);return this.core.process(state),state.tokens},MarkdownIt.prototype.render=function(src,env){return env=env||{},this.renderer.render(this.parse(src,env),this.options,env)},MarkdownIt.prototype.parseInline=function(src,env){var state=new this.core.State(src,this,env);return state.inlineMode=!0,this.core.process(state),state.tokens},MarkdownIt.prototype.renderInline=function(src,env){return env=env||{},this.renderer.render(this.parseInline(src,env),this.options,env)};var markdownIt=MarkdownIt,schema=new Schema({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:function toDOM(){return["p",0]}},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM:function toDOM(){return["blockquote",0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:function toDOM(){return["div",["hr"]]}},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:function toDOM(node){return["h"+node.attrs.level,0]}},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:function getAttrs(node){return{params:node.getAttribute("data-params")||""}}}],toDOM:function toDOM(node){return["pre",node.attrs.params?{"data-params":node.attrs.params}:{},["code",0]]}},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs:function getAttrs(dom){return{order:dom.hasAttribute("start")?+dom.getAttribute("start"):1,tight:dom.hasAttribute("data-tight")}}}],toDOM:function toDOM(node){return["ol",{start:1==node.attrs.order?null:node.attrs.order,"data-tight":node.attrs.tight?"true":null},0]}},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:function getAttrs(dom){return{tight:dom.hasAttribute("data-tight")}}}],toDOM:function toDOM(node){return["ul",{"data-tight":node.attrs.tight?"true":null},0]}},list_item:{content:"block+",defining:!0,parseDOM:[{tag:"li"}],toDOM:function toDOM(){return["li",0]}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:function getAttrs(dom){return{src:dom.getAttribute("src"),title:dom.getAttribute("title"),alt:dom.getAttribute("alt")}}}],toDOM:function toDOM(node){return["img",node.attrs]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function toDOM(){return["br"]}}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:function clearMark(m){return"em"==m.type.name}}],toDOM:function toDOM(){return["em"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function getAttrs(node){return"normal"!=node.style.fontWeight&&null}},{style:"font-weight=400",clearMark:function clearMark(m){return"strong"==m.type.name}},{style:"font-weight",getAttrs:function getAttrs(value){return/^(bold(er)?|[5-9]\d{2,})$/.test(value)&&null}}],toDOM:function toDOM(){return["strong"]}},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function getAttrs(dom){return{href:dom.getAttribute("href"),title:dom.getAttribute("title")}}}],toDOM:function toDOM(node){return["a",node.attrs]}},code:{parseDOM:[{tag:"code"}],toDOM:function toDOM(){return["code"]}}}});var MarkdownParseState=function(){function MarkdownParseState(schema,tokenHandlers){_classCallCheck(this,MarkdownParseState),this.schema=schema,this.tokenHandlers=tokenHandlers,this.stack=[{type:schema.topNodeType,attrs:null,content:[],marks:Mark$1.none}]}return _createClass(MarkdownParseState,[{key:"top",value:function top(){return this.stack[this.stack.length-1]}},{key:"push",value:function push(elt){this.stack.length&&this.top().content.push(elt)}},{key:"addText",value:function addText(text){if(text){var merged,top=this.top(),nodes=top.content,last=nodes[nodes.length-1],node=this.schema.text(text,top.marks);last&&(merged=function maybeMerge(a,b){if(a.isText&&b.isText&&Mark$1.sameSet(a.marks,b.marks))return a.withText(a.text+b.text)}(last,node))?nodes[nodes.length-1]=merged:nodes.push(node)}}},{key:"openMark",value:function openMark(mark){var top=this.top();top.marks=mark.addToSet(top.marks)}},{key:"closeMark",value:function closeMark(mark){var top=this.top();top.marks=mark.removeFromSet(top.marks)}},{key:"parseTokens",value:function parseTokens(toks){for(var _i440=0;_i440<toks.length;_i440++){var tok=toks[_i440],handler=this.tokenHandlers[tok.type];if(!handler)throw new Error("Token type `"+tok.type+"` not supported by Markdown parser");handler(this,tok,toks,_i440)}}},{key:"addNode",value:function addNode(type,attrs,content){var top=this.top(),node=type.createAndFill(attrs,content,top?top.marks:[]);return node?(this.push(node),node):null}},{key:"openNode",value:function openNode(type,attrs){this.stack.push({type,attrs,content:[],marks:Mark$1.none})}},{key:"closeNode",value:function closeNode(){var info=this.stack.pop();return this.addNode(info.type,info.attrs,info.content)}}]),MarkdownParseState}();function attrs(spec,token,tokens,i){return spec.getAttrs?spec.getAttrs(token,tokens,i):spec.attrs instanceof Function?spec.attrs(token):spec.attrs}function noCloseToken(spec,type){return spec.noCloseToken||"code_inline"==type||"code_block"==type||"fence"==type}function withoutTrailingNewline(str){return"\n"==str[str.length-1]?str.slice(0,str.length-1):str}function noOp(){}var MarkdownParser=function(){function MarkdownParser(schema,tokenizer,tokens){_classCallCheck(this,MarkdownParser),this.schema=schema,this.tokenizer=tokenizer,this.tokens=tokens,this.tokenHandlers=function tokenHandlers(schema,tokens){var handlers=Object.create(null),_loop11=function _loop11(){var spec=tokens[type];if(spec.block){var nodeType=schema.nodeType(spec.block);noCloseToken(spec,type)?handlers[type]=function(state,tok,tokens,i){state.openNode(nodeType,attrs(spec,tok,tokens,i)),state.addText(withoutTrailingNewline(tok.content)),state.closeNode()}:(handlers[type+"_open"]=function(state,tok,tokens,i){return state.openNode(nodeType,attrs(spec,tok,tokens,i))},handlers[type+"_close"]=function(state){return state.closeNode()})}else if(spec.node){var _nodeType=schema.nodeType(spec.node);handlers[type]=function(state,tok,tokens,i){return state.addNode(_nodeType,attrs(spec,tok,tokens,i))}}else if(spec.mark){var markType=schema.marks[spec.mark];noCloseToken(spec,type)?handlers[type]=function(state,tok,tokens,i){state.openMark(markType.create(attrs(spec,tok,tokens,i))),state.addText(withoutTrailingNewline(tok.content)),state.closeMark(markType)}:(handlers[type+"_open"]=function(state,tok,tokens,i){return state.openMark(markType.create(attrs(spec,tok,tokens,i)))},handlers[type+"_close"]=function(state){return state.closeMark(markType)})}else{if(!spec.ignore)throw new RangeError("Unrecognized parsing spec "+JSON.stringify(spec));noCloseToken(spec,type)?handlers[type]=noOp:(handlers[type+"_open"]=noOp,handlers[type+"_close"]=noOp)}};for(var type in tokens)_loop11();return handlers.text=function(state,tok){return state.addText(tok.content)},handlers.inline=function(state,tok){return state.parseTokens(tok.children)},handlers.softbreak=handlers.softbreak||function(state){return state.addText(" ")},handlers}(schema,tokens)}return _createClass(MarkdownParser,[{key:"parse",value:function parse(text){var doc,markdownEnv=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},state=new MarkdownParseState(this.schema,this.tokenHandlers);state.parseTokens(this.tokenizer.parse(text,markdownEnv));do{doc=state.closeNode()}while(state.stack.length);return doc||this.schema.topNodeType.createAndFill()}}]),MarkdownParser}();function listIsTight(tokens,i){for(;++i<tokens.length;)if("list_item_open"!=tokens[i].type)return tokens[i].hidden;return!1}var defaultMarkdownParser=new MarkdownParser(schema,markdownIt("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:function getAttrs(_,tokens,i){return{tight:listIsTight(tokens,i)}}},ordered_list:{block:"ordered_list",getAttrs:function getAttrs(tok,tokens,i){return{order:+tok.attrGet("start")||1,tight:listIsTight(tokens,i)}}},heading:{block:"heading",getAttrs:function getAttrs(tok){return{level:+tok.tag.slice(1)}}},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:function getAttrs(tok){return{params:tok.info||""}},noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:function getAttrs(tok){return{src:tok.attrGet("src"),title:tok.attrGet("title")||null,alt:tok.children[0]&&tok.children[0].content||null}}},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:function getAttrs(tok){return{href:tok.attrGet("href"),title:tok.attrGet("title")||null}}},code_inline:{mark:"code",noCloseToken:!0}}),MarkdownSerializer=function(){function MarkdownSerializer(nodes,marks){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,MarkdownSerializer),this.nodes=nodes,this.marks=marks,this.options=options}return _createClass(MarkdownSerializer,[{key:"serialize",value:function serialize(content){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};options=Object.assign({},this.options,options);var state=new MarkdownSerializerState(this.nodes,this.marks,options);return state.renderContent(content),state.out}}]),MarkdownSerializer}(),defaultMarkdownSerializer=new MarkdownSerializer({blockquote:function blockquote(state,node){state.wrapBlock("> ",null,node,(function(){return state.renderContent(node)}))},code_block:function code_block(state,node){var backticks=node.textContent.match(/`{3,}/gm),fence=backticks?backticks.sort().slice(-1)[0]+"`":"```";state.write(fence+(node.attrs.params||"")+"\n"),state.text(node.textContent,!1),state.write("\n"),state.write(fence),state.closeBlock(node)},heading:function heading(state,node){state.write(state.repeat("#",node.attrs.level)+" "),state.renderInline(node),state.closeBlock(node)},horizontal_rule:function horizontal_rule(state,node){state.write(node.attrs.markup||"---"),state.closeBlock(node)},bullet_list:function bullet_list(state,node){state.renderList(node,"  ",(function(){return(node.attrs.bullet||"*")+" "}))},ordered_list:function ordered_list(state,node){var start=node.attrs.order||1,maxW=String(start+node.childCount-1).length,space=state.repeat(" ",maxW+2);state.renderList(node,space,(function(i){var nStr=String(start+i);return state.repeat(" ",maxW-nStr.length)+nStr+". "}))},list_item:function list_item(state,node){state.renderContent(node)},paragraph:function paragraph(state,node){state.renderInline(node),state.closeBlock(node)},image:function image(state,node){state.write("!["+state.esc(node.attrs.alt||"")+"]("+node.attrs.src.replace(/[\(\)]/g,"\\$&")+(node.attrs.title?' "'+node.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break:function hard_break(state,node,parent,index){for(var _i442=index+1;_i442<parent.childCount;_i442++)if(parent.child(_i442).type!=node.type)return void state.write("\\\n")},text:function text(state,node){state.text(node.text,!state.inAutolink)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open:function open(state,mark,parent,index){return state.inAutolink=function isPlainURL(link,parent,index){if(link.attrs.title||!/^\w+:/.test(link.attrs.href))return!1;var content=parent.child(index);return!(!content.isText||content.text!=link.attrs.href||content.marks[content.marks.length-1]!=link)&&(index==parent.childCount-1||!link.isInSet(parent.child(index+1).marks))}(mark,parent,index),state.inAutolink?"<":"["},close:function close(state,mark,parent,index){var inAutolink=state.inAutolink;return state.inAutolink=void 0,inAutolink?">":"]("+mark.attrs.href.replace(/[\(\)"]/g,"\\$&")+(mark.attrs.title?' "'+mark.attrs.title.replace(/"/g,'\\"')+'"':"")+")"},mixable:!0},code:{open:function open(_state,_mark,parent,index){return backticksFor(parent.child(index),-1)},close:function close(_state,_mark,parent,index){return backticksFor(parent.child(index-1),1)},escape:!1}});function backticksFor(node,side){var m,ticks=/`+/g,len=0;if(node.isText)for(;m=ticks.exec(node.text);)len=Math.max(len,m[0].length);for(var result=len>0&&side>0?" `":"`",_i444=0;_i444<len;_i444++)result+="`";return len>0&&side<0&&(result+=" "),result}var MarkdownSerializerState=function(){function MarkdownSerializerState(nodes,marks,options){_classCallCheck(this,MarkdownSerializerState),this.nodes=nodes,this.marks=marks,this.options=options,this.delim="",this.out="",this.closed=null,this.inAutolink=void 0,this.atBlockStart=!1,this.inTightList=!1,void 0===this.options.tightLists&&(this.options.tightLists=!1),void 0===this.options.hardBreakNodeName&&(this.options.hardBreakNodeName="hard_break")}return _createClass(MarkdownSerializerState,[{key:"flushClose",value:function flushClose(){var size=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;if(this.closed){if(this.atBlank()||(this.out+="\n"),size>1){var delimMin=this.delim,trim=/\s+$/.exec(delimMin);trim&&(delimMin=delimMin.slice(0,delimMin.length-trim[0].length));for(var _i446=1;_i446<size;_i446++)this.out+=delimMin+"\n"}this.closed=null}}},{key:"wrapBlock",value:function wrapBlock(delim,firstDelim,node,f){var old=this.delim;this.write(null!=firstDelim?firstDelim:delim),this.delim+=delim,f(),this.delim=old,this.closeBlock(node)}},{key:"atBlank",value:function atBlank(){return/(^|\n)$/.test(this.out)}},{key:"ensureNewLine",value:function ensureNewLine(){this.atBlank()||(this.out+="\n")}},{key:"write",value:function write(content){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),content&&(this.out+=content)}},{key:"closeBlock",value:function closeBlock(node){this.closed=node}},{key:"text",value:function text(_text6){for(var escape=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],lines=_text6.split("\n"),_i448=0;_i448<lines.length;_i448++)this.write(),!escape&&"["==lines[_i448][0]&&/(^|[^\\])\!$/.test(this.out)&&(this.out=this.out.slice(0,this.out.length-1)+"\\!"),this.out+=escape?this.esc(lines[_i448],this.atBlockStart):lines[_i448],_i448!=lines.length-1&&(this.out+="\n")}},{key:"render",value:function render(node,parent,index){if("number"==typeof parent)throw new Error("!");if(!this.nodes[node.type.name])throw new Error("Token type `"+node.type.name+"` not supported by Markdown renderer");this.nodes[node.type.name](this,node,parent,index)}},{key:"renderContent",value:function renderContent(parent){var _this102=this;parent.forEach((function(node,_,i){return _this102.render(node,parent,i)}))}},{key:"renderInline",value:function renderInline(parent){var _this103=this;this.atBlockStart=!0;var active=[],trailing="",progress=function progress(node,offset,index){var marks=node?node.marks:[];node&&node.type.name===_this103.options.hardBreakNodeName&&(marks=marks.filter((function(m){if(index+1==parent.childCount)return!1;var next=parent.child(index+1);return m.isInSet(next.marks)&&(!next.isText||/\S/.test(next.text))})));var leading=trailing;if(trailing="",node&&node.isText&&marks.some((function(mark){var info=_this103.marks[mark.type.name];return info&&info.expelEnclosingWhitespace&&!mark.isInSet(active)}))){var _exec2=_slicedToArray(/^(\s*)(.*)$/m.exec(node.text),3),lead=(_exec2[0],_exec2[1]),rest=_exec2[2];lead&&(leading+=lead,(node=rest?node.withText(rest):null)||(marks=active))}if(node&&node.isText&&marks.some((function(mark){var info=_this103.marks[mark.type.name];return info&&info.expelEnclosingWhitespace&&(index==parent.childCount-1||!mark.isInSet(parent.child(index+1).marks))}))){var _exec4=_slicedToArray(/^(.*?)(\s*)$/m.exec(node.text),3),_rest=(_exec4[0],_exec4[1]),trail=_exec4[2];trail&&(trailing=trail,(node=_rest?node.withText(_rest):null)||(marks=active))}var inner=marks.length?marks[marks.length-1]:null,noEsc=inner&&!1===_this103.marks[inner.type.name].escape,len=marks.length-(noEsc?1:0);outer:for(var _i450=0;_i450<len;_i450++){var mark=marks[_i450];if(!_this103.marks[mark.type.name].mixable)break;for(var j=0;j<active.length;j++){var other=active[j];if(!_this103.marks[other.type.name].mixable)break;if(mark.eq(other)){_i450>j?marks=marks.slice(0,j).concat(mark).concat(marks.slice(j,_i450)).concat(marks.slice(_i450+1,len)):j>_i450&&(marks=marks.slice(0,_i450).concat(marks.slice(_i450+1,j)).concat(mark).concat(marks.slice(j,len)));continue outer}}}for(var keep=0;keep<Math.min(active.length,len)&&marks[keep].eq(active[keep]);)++keep;for(;keep<active.length;)_this103.text(_this103.markString(active.pop(),!1,parent,index),!1);if(leading&&_this103.text(leading),node){for(;active.length<len;){var add=marks[active.length];active.push(add),_this103.text(_this103.markString(add,!0,parent,index),!1),_this103.atBlockStart=!1}noEsc&&node.isText?_this103.text(_this103.markString(inner,!0,parent,index)+node.text+_this103.markString(inner,!1,parent,index+1),!1):_this103.render(node,parent,index),_this103.atBlockStart=!1}(null==node?void 0:node.isText)&&node.nodeSize>0&&(_this103.atBlockStart=!1)};parent.forEach(progress),progress(null,0,parent.childCount),this.atBlockStart=!1}},{key:"renderList",value:function renderList(node,delim,firstDelim){var _this104=this;this.closed&&this.closed.type==node.type?this.flushClose(3):this.inTightList&&this.flushClose(1);var isTight=void 0!==node.attrs.tight?node.attrs.tight:this.options.tightLists,prevTight=this.inTightList;this.inTightList=isTight,node.forEach((function(child,_,i){i&&isTight&&_this104.flushClose(1),_this104.wrapBlock(delim,firstDelim(i),node,(function(){return _this104.render(child,node,i)}))})),this.inTightList=prevTight}},{key:"esc",value:function esc(str){var startOfLine=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return str=str.replace(/[`*\\~\[\]_]/g,(function(m,i){return"_"==m&&i>0&&i+1<str.length&&str[i-1].match(/\w/)&&str[i+1].match(/\w/)?m:"\\"+m})),startOfLine&&(str=str.replace(/^[\-*+>]/,"\\$&").replace(/^(\s*)(#{1,6})(\s|$)/,"$1\\$2$3").replace(/^(\s*\d+)\.\s/,"$1\\. ")),this.options.escapeExtraCharacters&&(str=str.replace(this.options.escapeExtraCharacters,"\\$&")),str}},{key:"quote",value:function quote(str){var wrap=-1==str.indexOf('"')?'""':-1==str.indexOf("'")?"''":"()";return wrap[0]+str+wrap[1]}},{key:"repeat",value:function repeat(str,n){for(var out="",_i452=0;_i452<n;_i452++)out+=str;return out}},{key:"markString",value:function markString(mark,open,parent,index){var info=this.marks[mark.type.name],value=open?info.open:info.close;return"string"==typeof value?value:value(this,mark,parent,index)}},{key:"getEnclosingWhitespace",value:function getEnclosingWhitespace(text){return{leading:(text.match(/^(\s+)/)||[void 0])[0],trailing:(text.match(/(\s+)$/)||[void 0])[0]}}}]),MarkdownSerializerState}(),dist=(0,_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_80__.c)((function(module,exports){var __importDefault=_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_80__.a&&_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_80__.a.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var token_1=__importDefault(token),checkboxRegex=/^ *\[([\sx])] /i;function findParentToken(tokens,index){for(var targetLevel=tokens[index].level-1,currentTokenIndex=index-1;currentTokenIndex>=0;currentTokenIndex--)if(tokens[currentTokenIndex].level===targetLevel)return tokens[currentTokenIndex]}function isTodoItem(tokens,index){return function isInline(token){return"inline"===token.type}(tokens[index])&&function isParagraph(token){return"paragraph_open"===token.type}(tokens[index-1])&&function isListItem(token){return"list_item_open"===token.type}(tokens[index-2])&&function startsWithTodoMarkdown(token){return checkboxRegex.test(token.content)}(tokens[index])}function todoify(token,options){if(null!=token.children){var id=function generateIdForToken(token){return token.map?"task-item-".concat(token.map[0]):"task-item-".concat(Math.ceil(1e7*Math.random()-1e3))}(token);token.children.splice(0,0,function createCheckboxToken(token,enabled,id){var checkbox=new token_1.default("taskListItemCheckbox","",0);enabled||checkbox.attrSet("disabled","true");token.map&&checkbox.attrSet("line",token.map[0].toString());checkbox.attrSet("id",id);var checkboxRegexResult=checkboxRegex.exec(token.content);"x"===(null==checkboxRegexResult?void 0:checkboxRegexResult[1].toLowerCase())&&checkbox.attrSet("checked","true");return checkbox}(token,options.enabled,id)),token.children[1].content=token.children[1].content.replace(checkboxRegex,""),options.label&&(token.children.splice(1,0,function createLabelBeginToken(id){var labelBeginToken=new token_1.default("taskListItemLabel_open","",1);return labelBeginToken.attrSet("id",id),labelBeginToken}(id)),token.children.push(function createLabelEndToken(){return new token_1.default("taskListItemLabel_close","",-1)}()))}}exports.default=function markdownItTaskLists(md,options){void 0===options&&(options={enabled:!1,label:!1,lineNumber:!1}),md.core.ruler.after("inline","task-lists",(function(state){return function processToken(state,options){for(var allTokens=state.tokens,i=2;i<allTokens.length;i++)if(isTodoItem(allTokens,i)){todoify(allTokens[i],options),allTokens[i-2].attrJoin("class","task-list-item ".concat(options.enabled?" enabled":""));var parentToken=findParentToken(allTokens,i-2);parentToken&&parentToken.attrJoin("class","contains-task-list")}return!1}(state,options)})),md.renderer.rules.taskListItemCheckbox=function(tokens){var token=tokens[0],checkedAttribute=token.attrGet("checked")?'checked="" ':"",disabledAttribute=token.attrGet("disabled")?'disabled="" ':"",line=token.attrGet("line"),idAttribute='id="'.concat(token.attrGet("id"),'" '),dataLineAttribute=line&&options.lineNumber?'data-line="'.concat(line,'" '):"";return'<input class="task-list-item-checkbox" type="checkbox" '.concat(checkedAttribute).concat(disabledAttribute).concat(dataLineAttribute).concat(idAttribute,"/>")},md.renderer.rules.taskListItemLabel_close=function(){return"</label>"},md.renderer.rules.taskListItemLabel_open=function(tokens){var id=tokens[0].attrGet("id");return'<label for="'.concat(id,'">')}}})),taskLists=(0,_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_80__.g)(dist),defaultSerializerConfig={marks:(_marks3={em:defaultMarkdownSerializer.marks.em},_marks3[Bold.name]=defaultMarkdownSerializer.marks.strong,_marks3[Code.name]=defaultMarkdownSerializer.marks.code,_marks3[Italic.name]={open:"_",close:"_",mixable:!0,expelEnclosingWhitespace:!0},_marks3[Link.name]=defaultMarkdownSerializer.marks.link,_marks3[Strike.name]={open:"~~",close:"~~",mixable:!0,expelEnclosingWhitespace:!0},_marks3),nodes:Object.assign(Object.assign({},defaultMarkdownSerializer.nodes),(_Object$assign5={},_Object$assign5[Blockquote.name]=function(state,node){node.attrs.multiline?(state.write(">>>"),state.ensureNewLine(),state.renderContent(node),state.ensureNewLine(),state.write(">>>"),state.closeBlock(node)):state.wrapBlock("> ",null,node,(function(){return state.renderContent(node)}))},_Object$assign5[CodeBlock.name]=defaultMarkdownSerializer.nodes.code_block,_Object$assign5[Heading.name]=defaultMarkdownSerializer.nodes.heading,_Object$assign5[HardBreak.name]=defaultMarkdownSerializer.nodes.hard_break,_Object$assign5[HorizontalRule.name]=defaultMarkdownSerializer.nodes.horizontal_rule,_Object$assign5[BulletList.name]=defaultMarkdownSerializer.nodes.bullet_list,_Object$assign5[OrderedList.name]=defaultMarkdownSerializer.nodes.ordered_list,_Object$assign5[ListItem$1.name]=defaultMarkdownSerializer.nodes.list_item,_Object$assign5[Paragraph.name]=defaultMarkdownSerializer.nodes.paragraph,_Object$assign5[Text.name]=defaultMarkdownSerializer.nodes.text,_Object$assign5[TaskItem.name]=function(state,node){state.write("["+(node.attrs.checked?"x":" ")+"] "),state.renderContent(node)},_Object$assign5[TaskList.name]=function(state,node,parent,index){node.attrs.numeric?defaultMarkdownSerializer.nodes.ordered_list(state,node,parent,index):defaultMarkdownSerializer.nodes.bullet_list(state,node,parent,index)},_Object$assign5))},markdownSerializer=new MarkdownSerializer(defaultSerializerConfig.nodes,defaultSerializerConfig.marks),markdownRenderer=null,markdownSerializer$1_serialize=function serialize(content){return markdownSerializer.serialize(content,{tightLists:!0})},markdownSerializer$1_parse=function parse(markdownText){return markdownRenderer||(markdownRenderer=defaultMarkdownParser.tokenizer.enable("strikethrough").use(taskLists,{enabled:!0,label:!0,labelAfter:!0})),markdownRenderer.render(markdownText)},MarkdownEditor=function(){function MarkdownEditor(hostRef){var _this105=this;_classCallCheck(this,MarkdownEditor),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.r)(this,hostRef),this.viewModeChange=(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.c)(this,"viewModeChange",7),this.valueChange=(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.c)(this,"valueChange",7),this.inoBlur=(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.c)(this,"inoBlur",3),this.handlePreviewBlur=function(){var markdownText=_this105.htmlToMarkdown();_this105.errorMessage||_this105.valueChange.emit(markdownText),_this105.inoBlur.emit()},this.onEditorTransaction=function(){_this105.toolbarActionsState=new Set(Object.values(Actions).filter((function(action){return"number"==typeof action&&function isToolbarBtnActive(editor,action){if(!editor)return!1;switch(action){case Actions.ITALIC:return editor.isActive("italic");case Actions.BOLD:return editor.isActive("bold");case Actions.H1:return editor.isActive("heading",{level:1});case Actions.H2:return editor.isActive("heading",{level:2});case Actions.STRIKE:return editor.isActive("strike");case Actions.OL:return editor.isActive("orderedList");case Actions.UL:return editor.isActive("bulletList");case Actions.LINK:return editor.isActive("link");case Actions.UNLINK:return!1;case Actions.CODE_BLOCK:return editor.isActive("code");case Actions.BLOCKQUOTE:return editor.isActive("blockquote");case Actions.TASK_LIST:return editor.isActive("taskList");default:console.warn("case missing:",action)}}(_this105.editor,action)})))},this.onTextareaChange=function(e){e.stopPropagation(),_this105.textareaRef.value=e.detail},this.handleMarkdownBlur=function(e){e.stopPropagation(),_this105.editor.commands.clearContent(),_this105.editor.commands.setContent(_this105.markdownToHtml(_this105.textareaRef.value)),_this105.errorMessage||_this105.valueChange.emit(_this105.textareaRef.value),_this105.inoBlur.emit()},this.initialValue=void 0,this.viewMode="preview",this.toolbarActionsState=new Set,this.errorMessage="",this.showLinkDialog=!1,this.currentURL="",this.isCreationDialog=!0,this.hasValueChanged=!1}return _createClass(MarkdownEditor,[{key:"handleInitialValueChange",value:function handleInitialValueChange(newInitialValue){this.initializeEditor(newInitialValue)}},{key:"handleViewModeChange",value:function handleViewModeChange(newViewMode){var _a;newViewMode===ViewMode.MARKDOWN&&this.textareaRef?(this.textareaRef.value=this.htmlToMarkdown(),this.textareaRef.rows=this.textareaRef.value.split("\n").length):null===(_a=this.editor)||void 0===_a||_a.setEditable(newViewMode!==ViewMode.READONLY)}},{key:"componentDidLoad",value:function componentDidLoad(){this.createEditor(),this.initialValue&&this.initializeEditor(this.initialValue),this.textareaRef.addEventListener("valueChange",this.onTextareaChange),this.textareaRef.addEventListener("inoBlur",this.handleMarkdownBlur)}},{key:"disconnectedCallback",value:function disconnectedCallback(){var _a;null===(_a=this.editor)||void 0===_a||_a.destroy(),this.textareaRef.removeEventListener("valueChange",this.onTextareaChange),this.textareaRef.removeEventListener("inoBlur",this.handleMarkdownBlur)}},{key:"initializeEditor",value:function initializeEditor(initialValue){this.editor&&(this.editor.commands.setContent(this.markdownToHtml(initialValue),!0),this.textareaRef.value=this.htmlToMarkdown(),this.textareaRef.rows=this.textareaRef.value.split("\n").length)}},{key:"createEditor",value:function createEditor(){this.editor=new Editor({element:this.editorRef,extensions:[StarterKit.configure({bulletList:!1}),BulletList,Link.extend({inclusive:!1}),TaskItem,TaskList],onBlur:this.handlePreviewBlur,onTransaction:this.onEditorTransaction,editable:this.viewMode!==ViewMode.READONLY})}},{key:"htmlToMarkdown",value:function htmlToMarkdown(){var _this106=this;return this.tryParse((function(){var doc=_this106.editor.schema.nodeFromJSON(_this106.editor.getJSON());return markdownSerializer$1_serialize(doc)}),this.textareaRef.value)}},{key:"markdownToHtml",value:function markdownToHtml(){var md=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.initialValue;return this.tryParse((function(){return markdownSerializer$1_parse(md)}),this.editor.getHTML())}},{key:"tryParse",value:function tryParse(parseCallback,fallbackValue){try{return this.errorMessage="",parseCallback()}catch(err){return this.errorMessage=err.message,console.error(err),fallbackValue}}},{key:"handleViewModeBtnClick",value:function handleViewModeBtnClick(viewMode){this.errorMessage||this.viewModeChange.emit(viewMode)}},{key:"handleToolbarActionClick",value:function handleToolbarActionClick(action,url){!function handleToolbarBtnClick(editor,action,url){switch(action){case Actions.ITALIC:focusChain(editor).toggleItalic().run();break;case Actions.BOLD:focusChain(editor).toggleBold().run();break;case Actions.H1:focusChain(editor).toggleHeading({level:1}).run();break;case Actions.H2:focusChain(editor).toggleHeading({level:2}).run();break;case Actions.STRIKE:focusChain(editor).toggleStrike().run();break;case Actions.OL:focusChain(editor).toggleOrderedList().run();break;case Actions.UL:focusChain(editor).toggleBulletList().run();break;case Actions.LINK:url&&focusChain(editor).setLink({href:url}).run();break;case Actions.UNLINK:focusChain(editor).unsetLink().run();break;case Actions.CODE_BLOCK:focusChain(editor).toggleCodeBlock().run();break;case Actions.BLOCKQUOTE:focusChain(editor).toggleBlockquote().run();break;case Actions.TASK_LIST:focusChain(editor).toggleTaskList().run();break;default:console.warn("case missing:",action)}}(this.editor,action,url)}},{key:"handleDeleteLink",value:function handleDeleteLink(){this.handleToolbarActionClick(Actions.UNLINK),this.showLinkDialog=!1}},{key:"handleTextInputChange",value:function handleTextInputChange(e){this.currentURL=e.detail,this.hasValueChanged=!0}},{key:"handleLinkButtonClick",value:function handleLinkButtonClick(){var url=function getActiveLink(editor){return editor&&editor.isActive("link")&&editor.getAttributes("link").href||null}(this.editor);url?(this.currentURL=url,this.isCreationDialog=!1):(this.currentURL="",this.isCreationDialog=!0),this.hasValueChanged=!1,this.showLinkDialog=!0}},{key:"submitLink",value:function submitLink(e){e.preventDefault(),this.handleToolbarActionClick(Actions.LINK,this.currentURL),this.showLinkDialog=!1}},{key:"isDisabled",value:function isDisabled(){return!(0,_helpers_8b0cd51e_js__WEBPACK_IMPORTED_MODULE_78__.h)(this.currentURL)||!this.hasValueChanged}},{key:"render",value:function render(){var _this107=this,isReadonlyMode=this.viewMode===ViewMode.READONLY,isPreviewMode=isReadonlyMode||this.viewMode===ViewMode.PREVIEW,isMarkdownMode=this.viewMode===ViewMode.MARKDOWN,editorClasses=(0,_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__.c)({"markdown-editor":!0,"markdown-editor--readonly":isReadonlyMode}),previewModeEditorClasses=(0,_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__.c)({"markdown-editor__content__container":!0,"show-editor":isPreviewMode,"hide-editor":isMarkdownMode}),markdownModeEditorClasses=(0,_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__.c)({"show-editor":isMarkdownMode,"hide-editor":isPreviewMode}),getViewModeBtnClasses=function getViewModeBtnClasses(viewMode){return(0,_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__.c)({"toolbar__action-button":!0,"toolbar__view-mode":!0,"toolbar__action-button--active":_this107.viewMode===viewMode})},textFormatToolbarClasses=(0,_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__.c)({"toolbar__text-format":!0,"toolbar__text-format--show":isPreviewMode,"toolbar__text-format--hide":isMarkdownMode}),getToolbarActionBtnClass=function getToolbarActionBtnClass(action){return(0,_index_796d4780_js__WEBPACK_IMPORTED_MODULE_77__.c)({"toolbar__action-button":!0,"toolbar__action-button--active":_this107.toolbarActionsState.has(action)})},editLinkDialog=(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-dialog",{id:"link-dialog",open:this.showLinkDialog,"attach-to":".markdown-editor__content",dismissible:!0,headerText:"Insert Link",onClose:function onClose(){return _this107.showLinkDialog=!1}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("section",{class:"ino-dialog-section",slot:"body"},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("form",{class:"ino-dialog-form",onSubmit:function onSubmit(e){return _this107.submitLink(e)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-input",{label:"URL",type:"text",required:!0,helper:"Enter a valid URL",value:this.currentURL,onValueChange:function onValueChange(e){return _this107.handleTextInputChange(e)},placeholder:"https://example.org"}),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{type:"submit",style:{display:"none"}}))),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("section",{class:"ino-dialog-section",slot:"footer"},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon-button",{class:"ino-dialog-delete",icon:"remove",disabled:this.isCreationDialog,onClick:function onClick(){_this107.isCreationDialog||_this107.handleDeleteLink()},type:"reset"}),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon-button",{icon:"snackbar-checkmark",filled:!0,disabled:this.isDisabled(),onClick:function onClick(e){_this107.isDisabled()||_this107.submitLink(e)},type:"submit"})));return(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("div",{class:editorClasses},this.showLinkDialog&&editLinkDialog,(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("div",{class:"markdown-editor__toolbar"},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("div",null,(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getViewModeBtnClasses(ViewMode.PREVIEW),onClick:function onClick(){return _this107.handleViewModeBtnClick(ViewMode.PREVIEW)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"edit_text"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getViewModeBtnClasses(ViewMode.MARKDOWN),onClick:function onClick(){return _this107.handleViewModeBtnClick(ViewMode.MARKDOWN)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"code"}))),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("div",{class:textFormatToolbarClasses},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.H1),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.H1)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"headline_one"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.H2),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.H2)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"headline_two"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.BOLD),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.BOLD)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"bold"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.ITALIC),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.ITALIC)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"italic"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.STRIKE),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.STRIKE)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"strikethrough"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.LINK),onClick:function onClick(){return _this107.handleLinkButtonClick()}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"link"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.UL),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.UL)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"bullet_list"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.OL),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.OL)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"numeric_list"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.TASK_LIST),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.TASK_LIST)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"checkmark"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.BLOCKQUOTE),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.BLOCKQUOTE)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"quote"})),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("button",{class:getToolbarActionBtnClass(Actions.CODE_BLOCK),onClick:function onClick(){return _this107.handleToolbarActionClick(Actions.CODE_BLOCK)}},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-icon",{icon:"code_block"}))),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-popover",{placement:"top-start",controlled:!0,colorScheme:"light",visible:Boolean(this.errorMessage)},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("span",{class:"markdown-editor__error-text"},this.errorMessage))),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("div",{class:"markdown-editor__content"},(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("div",{class:previewModeEditorClasses,ref:function ref(el){return _this107.editorRef=el}}),(0,_index_2ff82bb8_js__WEBPACK_IMPORTED_MODULE_76__.h)("ino-textarea",{ref:function ref(el){return _this107.textareaRef=el},class:markdownModeEditorClasses,cols:100,autogrow:!0,outline:!0})))}}],[{key:"watchers",get:function get(){return{initialValue:["handleInitialValueChange"],viewMode:["handleViewModeChange"]}}}]),MarkdownEditor}();MarkdownEditor.style=".ino-dialog-section{display:flex;justify-content:space-between;margin-top:20px}.ino-dialog-delete ino-icon{--ino-icon-button-icon-color:#ff2e54}.ino-dialog-form{width:100%}ino-markdown-editor .markdown-editor{border-radius:10px}ino-markdown-editor .markdown-editor--readonly .markdown-editor__toolbar{display:none}ino-markdown-editor .markdown-editor--readonly .ProseMirror{padding:0;border:0}ino-markdown-editor .markdown-editor--readonly .ProseMirror-focused{outline:none}ino-markdown-editor .markdown-editor__error-text{display:block;padding:10px;color:#ff2e54}ino-markdown-editor .markdown-editor__toolbar{display:grid;grid-template-columns:auto auto;justify-content:space-between;border-radius:10px;background-color:#f4f4f7;padding:10px 20px;margin-bottom:10px}ino-markdown-editor .toolbar__action-button{--ino-icon-color-primary:#5d5b69;border:0;margin:0;padding:1px 2px;border-radius:10px;background-color:transparent;font-size:22px}ino-markdown-editor .toolbar__action-button:hover,ino-markdown-editor .toolbar__action-button--active{--ino-icon-color-primary:#2d02ff;background-color:#e2ecff;color:#2d02ff;cursor:pointer}ino-markdown-editor .toolbar__action-button--active{box-shadow:inset 0 3px 6px rgba(24, 1, 225, 0.16)}ino-markdown-editor .toolbar__action-button ino-icon{vertical-align:middle;padding:5px}ino-markdown-editor .toolbar__view-mode{border-radius:0;margin:0}ino-markdown-editor .toolbar__view-mode:first-of-type{border-radius:10px 0 0 10px}ino-markdown-editor .toolbar__view-mode:last-of-type{border-radius:0 10px 10px 0}ino-markdown-editor .toolbar__text-format--show{display:block}ino-markdown-editor .toolbar__text-format--hide{display:none}ino-markdown-editor .markdown-editor__content__container{height:100%;width:100%}ino-markdown-editor .markdown-editor__content{overflow:auto;max-height:var(--ino-markdown-editor-max-height, none)}ino-markdown-editor .markdown-editor__content ino-textarea{width:100%;height:100%}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined{display:flex}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:#dfdee6}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b6b4c4}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{min-height:var(--ino-markdown-editor-min-height, 100px);line-height:normal;letter-spacing:0}ino-markdown-editor .show-editor{display:block}ino-markdown-editor .hide-editor{display:none}ino-markdown-editor .ProseMirror{min-height:var(--ino-markdown-editor-min-height, 100px);padding:15px;border-radius:4px;border:1px solid #dfdee6;color:rgba(0, 0, 0, 0.87)}ino-markdown-editor .ProseMirror:hover:not(ino-markdown-editor .ProseMirror-focused){border-color:#b6b4c4}ino-markdown-editor .ProseMirror-focused{outline:#4655ff auto 1px}ino-markdown-editor .ProseMirror *:first-child{margin-top:0;padding-top:0}ino-markdown-editor .ProseMirror *:last-child{margin-bottom:0;padding-bottom:0}ino-markdown-editor .ProseMirror blockquote{padding-left:10px;border-left:3px solid #cac8d5}ino-markdown-editor .ProseMirror p{margin-top:0;margin-bottom:1.2em}ino-markdown-editor .ProseMirror pre code{display:block;background-color:rgba(202, 200, 213, 0.15);white-space:pre;-webkit-overflow-scrolling:touch;overflow-x:auto;max-width:100%;min-width:100px;padding:6px 8px}ino-markdown-editor .ProseMirror ul[data-type=taskList]{list-style:none}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList]{padding-left:12px}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] p{margin:0}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li{display:flex}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li>label{flex:0 0 auto;margin-right:0.5rem;user-select:none}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li>div{flex:1 1 auto;display:inline-block}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li input[type=checkbox]{accent-color:#4655ff}"},"../elements/dist/esm/tslib.es6-973a6cc3.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>__rest,a:()=>__extends,b:()=>_assign,c:()=>__spreadArray,d:()=>__read,e:()=>__values});__webpack_require__("../../node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.create.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../../node_modules/core-js/modules/es.function.name.js");var _extendStatics=function extendStatics(d,b){return _extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])},_extendStatics(d,b)};function __extends(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var _assign=function __assign(){return _assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},_assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function __values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function next(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function __spreadArray(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))}"function"==typeof SuppressedError&&SuppressedError},"../../node_modules/core-js/internals/array-last-index-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{var apply=__webpack_require__("../../node_modules/core-js/internals/function-apply.js"),toIndexedObject=__webpack_require__("../../node_modules/core-js/internals/to-indexed-object.js"),toIntegerOrInfinity=__webpack_require__("../../node_modules/core-js/internals/to-integer-or-infinity.js"),lengthOfArrayLike=__webpack_require__("../../node_modules/core-js/internals/length-of-array-like.js"),arrayMethodIsStrict=__webpack_require__("../../node_modules/core-js/internals/array-method-is-strict.js"),min=Math.min,$lastIndexOf=[].lastIndexOf,NEGATIVE_ZERO=!!$lastIndexOf&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD=arrayMethodIsStrict("lastIndexOf"),FORCED=NEGATIVE_ZERO||!STRICT_METHOD;module.exports=FORCED?function lastIndexOf(searchElement){if(NEGATIVE_ZERO)return apply($lastIndexOf,this,arguments)||0;var O=toIndexedObject(this),length=lengthOfArrayLike(O),index=length-1;for(arguments.length>1&&(index=min(index,toIntegerOrInfinity(arguments[1]))),index<0&&(index=length+index);index>=0;index--)if(index in O&&O[index]===searchElement)return index||0;return-1}:$lastIndexOf},"../../node_modules/core-js/internals/flatten-into-array.js":(module,__unused_webpack_exports,__webpack_require__)=>{var isArray=__webpack_require__("../../node_modules/core-js/internals/is-array.js"),lengthOfArrayLike=__webpack_require__("../../node_modules/core-js/internals/length-of-array-like.js"),doesNotExceedSafeInteger=__webpack_require__("../../node_modules/core-js/internals/does-not-exceed-safe-integer.js"),bind=__webpack_require__("../../node_modules/core-js/internals/function-bind-context.js"),flattenIntoArray=function(target,original,source,sourceLen,start,depth,mapper,thisArg){for(var element,elementLen,targetIndex=start,sourceIndex=0,mapFn=!!mapper&&bind(mapper,thisArg);sourceIndex<sourceLen;)sourceIndex in source&&(element=mapFn?mapFn(source[sourceIndex],sourceIndex,original):source[sourceIndex],depth>0&&isArray(element)?(elementLen=lengthOfArrayLike(element),targetIndex=flattenIntoArray(target,original,element,elementLen,targetIndex,depth-1)-1):(doesNotExceedSafeInteger(targetIndex+1),target[targetIndex]=element),targetIndex++),sourceIndex++;return targetIndex};module.exports=flattenIntoArray},"../../node_modules/core-js/internals/number-parse-int.js":(module,__unused_webpack_exports,__webpack_require__)=>{var global=__webpack_require__("../../node_modules/core-js/internals/global.js"),fails=__webpack_require__("../../node_modules/core-js/internals/fails.js"),uncurryThis=__webpack_require__("../../node_modules/core-js/internals/function-uncurry-this.js"),toString=__webpack_require__("../../node_modules/core-js/internals/to-string.js"),trim=__webpack_require__("../../node_modules/core-js/internals/string-trim.js").trim,whitespaces=__webpack_require__("../../node_modules/core-js/internals/whitespaces.js"),$parseInt=global.parseInt,Symbol=global.Symbol,ITERATOR=Symbol&&Symbol.iterator,hex=/^[+-]?0x/i,exec=uncurryThis(hex.exec),FORCED=8!==$parseInt(whitespaces+"08")||22!==$parseInt(whitespaces+"0x16")||ITERATOR&&!fails((function(){$parseInt(Object(ITERATOR))}));module.exports=FORCED?function parseInt(string,radix){var S=trim(toString(string));return $parseInt(S,radix>>>0||(exec(hex,S)?16:10))}:$parseInt},"../../node_modules/core-js/modules/es.array.flat.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),flattenIntoArray=__webpack_require__("../../node_modules/core-js/internals/flatten-into-array.js"),toObject=__webpack_require__("../../node_modules/core-js/internals/to-object.js"),lengthOfArrayLike=__webpack_require__("../../node_modules/core-js/internals/length-of-array-like.js"),toIntegerOrInfinity=__webpack_require__("../../node_modules/core-js/internals/to-integer-or-infinity.js"),arraySpeciesCreate=__webpack_require__("../../node_modules/core-js/internals/array-species-create.js");$({target:"Array",proto:!0},{flat:function flat(){var depthArg=arguments.length?arguments[0]:void 0,O=toObject(this),sourceLen=lengthOfArrayLike(O),A=arraySpeciesCreate(O,0);return A.length=flattenIntoArray(A,O,O,sourceLen,0,void 0===depthArg?1:toIntegerOrInfinity(depthArg)),A}})},"../../node_modules/core-js/modules/es.array.last-index-of.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),lastIndexOf=__webpack_require__("../../node_modules/core-js/internals/array-last-index-of.js");$({target:"Array",proto:!0,forced:lastIndexOf!==[].lastIndexOf},{lastIndexOf})},"../../node_modules/core-js/modules/es.date.now.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),uncurryThis=__webpack_require__("../../node_modules/core-js/internals/function-uncurry-this.js"),$Date=Date,thisTimeValue=uncurryThis($Date.prototype.getTime);$({target:"Date",stat:!0},{now:function now(){return thisTimeValue(new $Date)}})},"../../node_modules/core-js/modules/es.date.to-json.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),fails=__webpack_require__("../../node_modules/core-js/internals/fails.js"),toObject=__webpack_require__("../../node_modules/core-js/internals/to-object.js"),toPrimitive=__webpack_require__("../../node_modules/core-js/internals/to-primitive.js");$({target:"Date",proto:!0,arity:1,forced:fails((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function toJSON(key){var O=toObject(this),pv=toPrimitive(O,"number");return"number"!=typeof pv||isFinite(pv)?O.toISOString():null}})},"../../node_modules/core-js/modules/es.parse-int.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),$parseInt=__webpack_require__("../../node_modules/core-js/internals/number-parse-int.js");$({global:!0,forced:parseInt!==$parseInt},{parseInt:$parseInt})},"../../node_modules/core-js/modules/es.string.from-code-point.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),uncurryThis=__webpack_require__("../../node_modules/core-js/internals/function-uncurry-this.js"),toAbsoluteIndex=__webpack_require__("../../node_modules/core-js/internals/to-absolute-index.js"),$RangeError=RangeError,fromCharCode=String.fromCharCode,$fromCodePoint=String.fromCodePoint,join=uncurryThis([].join);$({target:"String",stat:!0,arity:1,forced:!!$fromCodePoint&&1!==$fromCodePoint.length},{fromCodePoint:function fromCodePoint(x){for(var code,elements=[],length=arguments.length,i=0;length>i;){if(code=+arguments[i++],toAbsoluteIndex(code,1114111)!==code)throw new $RangeError(code+" is not a valid code point");elements[i]=code<65536?fromCharCode(code):fromCharCode(55296+((code-=65536)>>10),code%1024+56320)}return join(elements,"")}})},"../../node_modules/core-js/modules/es.string.italics.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("../../node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("../../node_modules/core-js/internals/string-html-forced.js")("italics")},{italics:function italics(){return createHTML(this,"i","","")}})},"../../node_modules/core-js/modules/es.string.link.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("../../node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("../../node_modules/core-js/internals/string-html-forced.js")("link")},{link:function link(url){return createHTML(this,"a","href",url)}})},"../../node_modules/core-js/modules/es.string.match-all.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),call=__webpack_require__("../../node_modules/core-js/internals/function-call.js"),uncurryThis=__webpack_require__("../../node_modules/core-js/internals/function-uncurry-this-clause.js"),createIteratorConstructor=__webpack_require__("../../node_modules/core-js/internals/iterator-create-constructor.js"),createIterResultObject=__webpack_require__("../../node_modules/core-js/internals/create-iter-result-object.js"),requireObjectCoercible=__webpack_require__("../../node_modules/core-js/internals/require-object-coercible.js"),toLength=__webpack_require__("../../node_modules/core-js/internals/to-length.js"),toString=__webpack_require__("../../node_modules/core-js/internals/to-string.js"),anObject=__webpack_require__("../../node_modules/core-js/internals/an-object.js"),isNullOrUndefined=__webpack_require__("../../node_modules/core-js/internals/is-null-or-undefined.js"),classof=__webpack_require__("../../node_modules/core-js/internals/classof-raw.js"),isRegExp=__webpack_require__("../../node_modules/core-js/internals/is-regexp.js"),getRegExpFlags=__webpack_require__("../../node_modules/core-js/internals/regexp-get-flags.js"),getMethod=__webpack_require__("../../node_modules/core-js/internals/get-method.js"),defineBuiltIn=__webpack_require__("../../node_modules/core-js/internals/define-built-in.js"),fails=__webpack_require__("../../node_modules/core-js/internals/fails.js"),wellKnownSymbol=__webpack_require__("../../node_modules/core-js/internals/well-known-symbol.js"),speciesConstructor=__webpack_require__("../../node_modules/core-js/internals/species-constructor.js"),advanceStringIndex=__webpack_require__("../../node_modules/core-js/internals/advance-string-index.js"),regExpExec=__webpack_require__("../../node_modules/core-js/internals/regexp-exec-abstract.js"),InternalStateModule=__webpack_require__("../../node_modules/core-js/internals/internal-state.js"),IS_PURE=__webpack_require__("../../node_modules/core-js/internals/is-pure.js"),MATCH_ALL=wellKnownSymbol("matchAll"),setInternalState=InternalStateModule.set,getInternalState=InternalStateModule.getterFor("RegExp String Iterator"),RegExpPrototype=RegExp.prototype,$TypeError=TypeError,stringIndexOf=uncurryThis("".indexOf),nativeMatchAll=uncurryThis("".matchAll),WORKS_WITH_NON_GLOBAL_REGEX=!!nativeMatchAll&&!fails((function(){nativeMatchAll("a",/./)})),$RegExpStringIterator=createIteratorConstructor((function RegExpStringIterator(regexp,string,$global,fullUnicode){setInternalState(this,{type:"RegExp String Iterator",regexp,string,global:$global,unicode:fullUnicode,done:!1})}),"RegExp String",(function next(){var state=getInternalState(this);if(state.done)return createIterResultObject(void 0,!0);var R=state.regexp,S=state.string,match=regExpExec(R,S);return null===match?(state.done=!0,createIterResultObject(void 0,!0)):state.global?(""===toString(match[0])&&(R.lastIndex=advanceStringIndex(S,toLength(R.lastIndex),state.unicode)),createIterResultObject(match,!1)):(state.done=!0,createIterResultObject(match,!1))})),$matchAll=function(string){var matcher,$global,fullUnicode,R=anObject(this),S=toString(string),C=speciesConstructor(R,RegExp),flags=toString(getRegExpFlags(R));return matcher=new C(C===RegExp?R.source:R,flags),$global=!!~stringIndexOf(flags,"g"),fullUnicode=!!~stringIndexOf(flags,"u"),matcher.lastIndex=toLength(R.lastIndex),new $RegExpStringIterator(matcher,S,$global,fullUnicode)};$({target:"String",proto:!0,forced:WORKS_WITH_NON_GLOBAL_REGEX},{matchAll:function matchAll(regexp){var flags,S,matcher,rx,O=requireObjectCoercible(this);if(isNullOrUndefined(regexp)){if(WORKS_WITH_NON_GLOBAL_REGEX)return nativeMatchAll(O,regexp)}else{if(isRegExp(regexp)&&(flags=toString(requireObjectCoercible(getRegExpFlags(regexp))),!~stringIndexOf(flags,"g")))throw new $TypeError("`.matchAll` does not allow non-global regexes");if(WORKS_WITH_NON_GLOBAL_REGEX)return nativeMatchAll(O,regexp);if(void 0===(matcher=getMethod(regexp,MATCH_ALL))&&IS_PURE&&"RegExp"===classof(regexp)&&(matcher=$matchAll),matcher)return call(matcher,regexp,O)}return S=toString(O),rx=new RegExp(regexp,"g"),IS_PURE?call($matchAll,rx,S):rx[MATCH_ALL](S)}}),IS_PURE||MATCH_ALL in RegExpPrototype||defineBuiltIn(RegExpPrototype,MATCH_ALL,$matchAll)},"../../node_modules/core-js/modules/es.string.strike.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("../../node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("../../node_modules/core-js/internals/string-html-forced.js")("strike")},{strike:function strike(){return createHTML(this,"strike","","")}})},"../../node_modules/core-js/modules/web.url.to-json.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),call=__webpack_require__("../../node_modules/core-js/internals/function-call.js");$({target:"URL",proto:!0,enumerable:!0},{toJSON:function toJSON(){return call(URL.prototype.toString,this)}})}}]);