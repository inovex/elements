/*! For license information please see 622.90e5aec9.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_inovex_de_elements_storybook=self.webpackChunk_inovex_de_elements_storybook||[]).push([[622],{"../elements/dist/esm/_commonjsHelpers-212d567a.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>commonjsGlobal,c:()=>createCommonjsModule,g:()=>getDefaultExportFromCjs});__webpack_require__("../../node_modules/core-js/modules/es.global-this.js");var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function createCommonjsModule(fn,basedir,module){return fn(module={path:basedir,exports:{},require:function require(path,base){return function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},module.exports),module.exports}},"../elements/dist/esm/index-b7e5b0c5.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>classnames});__webpack_require__("../../node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.join.js");var classnames=(0,__webpack_require__("../elements/dist/esm/_commonjsHelpers-212d567a.js").c)((function(module){!function(){var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}else if("object"===argType)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):window.classNames=classNames}()}))},"../elements/dist/esm/ino-markdown-editor.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ino_markdown_editor:()=>MarkdownEditor});__webpack_require__("../../node_modules/core-js/modules/es.array.find.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.slice.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.splice.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.concat.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.for-each.js"),__webpack_require__("../../node_modules/core-js/modules/web.dom-collections.for-each.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.find-index.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.to-string.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.join.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.to-json.js"),__webpack_require__("../../node_modules/core-js/modules/web.url.to-json.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.map.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.is-array.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.define-properties.js"),__webpack_require__("../../node_modules/core-js/modules/es.function.name.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.sort.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.create.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.replace.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.exec.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.index-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.match.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.reverse.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.split.js"),__webpack_require__("../../node_modules/core-js/modules/es.number.constructor.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.reduce.js"),__webpack_require__("../../node_modules/core-js/modules/es.function.bind.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.some.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.last-index-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.trim.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.anchor.js"),__webpack_require__("../../node_modules/core-js/modules/es.date.now.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.filter.js"),__webpack_require__("../../node_modules/core-js/modules/es.map.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/web.dom-collections.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/web.timers.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.get-prototype-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.assign.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.keys.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.from-entries.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.entries.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.freeze.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.every.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.includes.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.includes.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.starts-with.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.match-all.js"),__webpack_require__("../../node_modules/core-js/modules/es.set.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.flat.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.values.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.search.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.ends-with.js"),__webpack_require__("../../node_modules/core-js/modules/es.regexp.constructor.js"),__webpack_require__("../../node_modules/core-js/modules/es.parse-int.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.bold.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.italics.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.strike.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.from-code-point.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.repeat.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.define-property.js"),__webpack_require__("../../node_modules/core-js/modules/es.string.link.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.description.js"),__webpack_require__("../../node_modules/core-js/modules/es.symbol.iterator.js"),__webpack_require__("../../node_modules/core-js/modules/es.array.from.js"),__webpack_require__("../../node_modules/core-js/modules/es.object.set-prototype-of.js"),__webpack_require__("../../node_modules/core-js/modules/es.reflect.construct.js");var _marks2,_Object$assign5,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__=__webpack_require__("../elements/dist/esm/index-dbb9ab19.js"),_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__=__webpack_require__("../elements/dist/esm/index-b7e5b0c5.js"),_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_72__=__webpack_require__("../elements/dist/esm/_commonjsHelpers-212d567a.js");function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function OrderedMap(content){this.content=content}OrderedMap.prototype={constructor:OrderedMap,find:function find(key){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===key)return i;return-1},get:function get(key){var found=this.find(key);return-1==found?void 0:this.content[found+1]},update:function update(key,value,newKey){var self=newKey&&newKey!=key?this.remove(newKey):this,found=self.find(key),content=self.content.slice();return-1==found?content.push(newKey||key,value):(content[found+1]=value,newKey&&(content[found]=newKey)),new OrderedMap(content)},remove:function remove(key){var found=this.find(key);if(-1==found)return this;var content=this.content.slice();return content.splice(found,2),new OrderedMap(content)},addToStart:function addToStart(key,value){return new OrderedMap([key,value].concat(this.remove(key).content))},addToEnd:function addToEnd(key,value){var content=this.remove(key).content.slice();return content.push(key,value),new OrderedMap(content)},addBefore:function addBefore(place,key,value){var without=this.remove(key),content=without.content.slice(),found=without.find(place);return content.splice(-1==found?content.length:found,0,key,value),new OrderedMap(content)},forEach:function forEach(f){for(var i=0;i<this.content.length;i+=2)f(this.content[i],this.content[i+1])},prepend:function prepend(map){return(map=OrderedMap.from(map)).size?new OrderedMap(map.content.concat(this.subtract(map).content)):this},append:function append(map){return(map=OrderedMap.from(map)).size?new OrderedMap(this.subtract(map).content.concat(map.content)):this},subtract:function subtract(map){var result=this;map=OrderedMap.from(map);for(var i=0;i<map.content.length;i+=2)result=result.remove(map.content[i]);return result},get size(){return this.content.length>>1}},OrderedMap.from=function(value){if(value instanceof OrderedMap)return value;var content=[];if(value)for(var prop in value)content.push(prop,value[prop]);return new OrderedMap(content)};var orderedmap=OrderedMap;function findDiffStart(a,b,pos){for(var i=0;;i++){if(i==a.childCount||i==b.childCount)return a.childCount==b.childCount?null:pos;var childA=a.child(i),childB=b.child(i);if(childA!=childB){if(!childA.sameMarkup(childB))return pos;if(childA.isText&&childA.text!=childB.text){for(var j=0;childA.text[j]==childB.text[j];j++)pos++;return pos}if(childA.content.size||childB.content.size){var inner=findDiffStart(childA.content,childB.content,pos+1);if(null!=inner)return inner}pos+=childA.nodeSize}else pos+=childA.nodeSize}}function findDiffEnd(a,b,posA,posB){for(var iA=a.childCount,iB=b.childCount;;){if(0==iA||0==iB)return iA==iB?null:{a:posA,b:posB};var childA=a.child(--iA),childB=b.child(--iB),size=childA.nodeSize;if(childA!=childB){if(!childA.sameMarkup(childB))return{a:posA,b:posB};if(childA.isText&&childA.text!=childB.text){for(var same=0,minSize=Math.min(childA.text.length,childB.text.length);same<minSize&&childA.text[childA.text.length-same-1]==childB.text[childB.text.length-same-1];)same++,posA--,posB--;return{a:posA,b:posB}}if(childA.content.size||childB.content.size){var inner=findDiffEnd(childA.content,childB.content,posA-1,posB-1);if(inner)return inner}posA-=size,posB-=size}else posA-=size,posB-=size}}var Fragment=function Fragment(content,size){if(this.content=content,this.size=size||0,null==size)for(var i=0;i<content.length;i++)this.size+=content[i].nodeSize},prototypeAccessors$5={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Fragment.prototype.nodesBetween=function nodesBetween(from,to,f,nodeStart,parent){void 0===nodeStart&&(nodeStart=0);for(var i=0,pos=0;pos<to;i++){var child=this.content[i],end=pos+child.nodeSize;if(end>from&&!1!==f(child,nodeStart+pos,parent,i)&&child.content.size){var start=pos+1;child.nodesBetween(Math.max(0,from-start),Math.min(child.content.size,to-start),f,nodeStart+start)}pos=end}},Fragment.prototype.descendants=function descendants(f){this.nodesBetween(0,this.size,f)},Fragment.prototype.textBetween=function textBetween(from,to,blockSeparator,leafText){var text="",separated=!0;return this.nodesBetween(from,to,(function(node,pos){node.isText?(text+=node.text.slice(Math.max(from,pos)-pos,to-pos),separated=!blockSeparator):node.isLeaf&&leafText?(text+="function"==typeof leafText?leafText(node):leafText,separated=!blockSeparator):!separated&&node.isBlock&&(text+=blockSeparator,separated=!0)}),0),text},Fragment.prototype.append=function append(other){if(!other.size)return this;if(!this.size)return other;var last=this.lastChild,first=other.firstChild,content=this.content.slice(),i=0;for(last.isText&&last.sameMarkup(first)&&(content[content.length-1]=last.withText(last.text+first.text),i=1);i<other.content.length;i++)content.push(other.content[i]);return new Fragment(content,this.size+other.size)},Fragment.prototype.cut=function cut(from,to){if(null==to&&(to=this.size),0==from&&to==this.size)return this;var result=[],size=0;if(to>from)for(var i=0,pos=0;pos<to;i++){var child=this.content[i],end=pos+child.nodeSize;end>from&&((pos<from||end>to)&&(child=child.isText?child.cut(Math.max(0,from-pos),Math.min(child.text.length,to-pos)):child.cut(Math.max(0,from-pos-1),Math.min(child.content.size,to-pos-1))),result.push(child),size+=child.nodeSize),pos=end}return new Fragment(result,size)},Fragment.prototype.cutByIndex=function cutByIndex(from,to){return from==to?Fragment.empty:0==from&&to==this.content.length?this:new Fragment(this.content.slice(from,to))},Fragment.prototype.replaceChild=function replaceChild(index,node){var current=this.content[index];if(current==node)return this;var copy=this.content.slice(),size=this.size+node.nodeSize-current.nodeSize;return copy[index]=node,new Fragment(copy,size)},Fragment.prototype.addToStart=function addToStart(node){return new Fragment([node].concat(this.content),this.size+node.nodeSize)},Fragment.prototype.addToEnd=function addToEnd(node){return new Fragment(this.content.concat(node),this.size+node.nodeSize)},Fragment.prototype.eq=function eq(other){if(this.content.length!=other.content.length)return!1;for(var i=0;i<this.content.length;i++)if(!this.content[i].eq(other.content[i]))return!1;return!0},prototypeAccessors$5.firstChild.get=function(){return this.content.length?this.content[0]:null},prototypeAccessors$5.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},prototypeAccessors$5.childCount.get=function(){return this.content.length},Fragment.prototype.child=function child(index){var found=this.content[index];if(!found)throw new RangeError("Index "+index+" out of range for "+this);return found},Fragment.prototype.maybeChild=function maybeChild(index){return this.content[index]},Fragment.prototype.forEach=function forEach(f){for(var i=0,p=0;i<this.content.length;i++){var child=this.content[i];f(child,p,i),p+=child.nodeSize}},Fragment.prototype.findDiffStart=function findDiffStart$1(other,pos){return void 0===pos&&(pos=0),findDiffStart(this,other,pos)},Fragment.prototype.findDiffEnd=function findDiffEnd$1(other,pos,otherPos){return void 0===pos&&(pos=this.size),void 0===otherPos&&(otherPos=other.size),findDiffEnd(this,other,pos,otherPos)},Fragment.prototype.findIndex=function findIndex(pos,round){if(void 0===round&&(round=-1),0==pos)return retIndex(0,pos);if(pos==this.size)return retIndex(this.content.length,pos);if(pos>this.size||pos<0)throw new RangeError("Position "+pos+" outside of fragment ("+this+")");for(var i=0,curPos=0;;i++){var end=curPos+this.child(i).nodeSize;if(end>=pos)return end==pos||round>0?retIndex(i+1,end):retIndex(i,curPos);curPos=end}},Fragment.prototype.toString=function toString(){return"<"+this.toStringInner()+">"},Fragment.prototype.toStringInner=function toStringInner(){return this.content.join(", ")},Fragment.prototype.toJSON=function toJSON(){return this.content.length?this.content.map((function(n){return n.toJSON()})):null},Fragment.fromJSON=function fromJSON(schema,value){if(!value)return Fragment.empty;if(!Array.isArray(value))throw new RangeError("Invalid input for Fragment.fromJSON");return new Fragment(value.map(schema.nodeFromJSON))},Fragment.fromArray=function fromArray(array){if(!array.length)return Fragment.empty;for(var joined,size=0,i=0;i<array.length;i++){var node=array[i];size+=node.nodeSize,i&&node.isText&&array[i-1].sameMarkup(node)?(joined||(joined=array.slice(0,i)),joined[joined.length-1]=node.withText(joined[joined.length-1].text+node.text)):joined&&joined.push(node)}return new Fragment(joined||array,size)},Fragment.from=function from(nodes){if(!nodes)return Fragment.empty;if(nodes instanceof Fragment)return nodes;if(Array.isArray(nodes))return this.fromArray(nodes);if(nodes.attrs)return new Fragment([nodes],nodes.nodeSize);throw new RangeError("Can not convert "+nodes+" to a Fragment"+(nodes.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Fragment.prototype,prototypeAccessors$5);var found={index:0,offset:0};function retIndex(index,offset){return found.index=index,found.offset=offset,found}function compareDeep(a,b){if(a===b)return!0;if(!a||"object"!=typeof a||!b||"object"!=typeof b)return!1;var array=Array.isArray(a);if(Array.isArray(b)!=array)return!1;if(array){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!compareDeep(a[i],b[i]))return!1}else{for(var p in a)if(!(p in b)||!compareDeep(a[p],b[p]))return!1;for(var p$1 in b)if(!(p$1 in a))return!1}return!0}Fragment.empty=new Fragment([],0);var Mark$1=function Mark(type,attrs){this.type=type,this.attrs=attrs};function ReplaceError(message){var err=Error.call(this,message);return err.__proto__=ReplaceError.prototype,err}Mark$1.prototype.addToSet=function addToSet(set){for(var copy,placed=!1,i=0;i<set.length;i++){var other=set[i];if(this.eq(other))return set;if(this.type.excludes(other.type))copy||(copy=set.slice(0,i));else{if(other.type.excludes(this.type))return set;!placed&&other.type.rank>this.type.rank&&(copy||(copy=set.slice(0,i)),copy.push(this),placed=!0),copy&&copy.push(other)}}return copy||(copy=set.slice()),placed||copy.push(this),copy},Mark$1.prototype.removeFromSet=function removeFromSet(set){for(var i=0;i<set.length;i++)if(this.eq(set[i]))return set.slice(0,i).concat(set.slice(i+1));return set},Mark$1.prototype.isInSet=function isInSet(set){for(var i=0;i<set.length;i++)if(this.eq(set[i]))return!0;return!1},Mark$1.prototype.eq=function eq(other){return this==other||this.type==other.type&&compareDeep(this.attrs,other.attrs)},Mark$1.prototype.toJSON=function toJSON(){var obj={type:this.type.name};for(var _ in this.attrs){obj.attrs=this.attrs;break}return obj},Mark$1.fromJSON=function fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Mark.fromJSON");var type=schema.marks[json.type];if(!type)throw new RangeError("There is no mark type "+json.type+" in this schema");return type.create(json.attrs)},Mark$1.sameSet=function sameSet(a,b){if(a==b)return!0;if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].eq(b[i]))return!1;return!0},Mark$1.setFrom=function setFrom(marks){if(!marks||0==marks.length)return Mark$1.none;if(marks instanceof Mark$1)return[marks];var copy=marks.slice();return copy.sort((function(a,b){return a.type.rank-b.type.rank})),copy},Mark$1.none=[],ReplaceError.prototype=Object.create(Error.prototype),ReplaceError.prototype.constructor=ReplaceError,ReplaceError.prototype.name="ReplaceError";var Slice=function Slice(content,openStart,openEnd){this.content=content,this.openStart=openStart,this.openEnd=openEnd},prototypeAccessors$1$3={size:{configurable:!0}};function removeRange(content,from,to){var ref=content.findIndex(from),index=ref.index,offset=ref.offset,child=content.maybeChild(index),ref$1=content.findIndex(to),indexTo=ref$1.index,offsetTo=ref$1.offset;if(offset==from||child.isText){if(offsetTo!=to&&!content.child(indexTo).isText)throw new RangeError("Removing non-flat range");return content.cut(0,from).append(content.cut(to))}if(index!=indexTo)throw new RangeError("Removing non-flat range");return content.replaceChild(index,child.copy(removeRange(child.content,from-offset-1,to-offset-1)))}function insertInto(content,dist,insert,parent){var ref=content.findIndex(dist),index=ref.index,offset=ref.offset,child=content.maybeChild(index);if(offset==dist||child.isText)return parent&&!parent.canReplace(index,index,insert)?null:content.cut(0,dist).append(insert).append(content.cut(dist));var inner=insertInto(child.content,dist-offset-1,insert);return inner&&content.replaceChild(index,child.copy(inner))}function replace($from,$to,slice){if(slice.openStart>$from.depth)throw new ReplaceError("Inserted content deeper than insertion position");if($from.depth-slice.openStart!=$to.depth-slice.openEnd)throw new ReplaceError("Inconsistent open depths");return replaceOuter($from,$to,slice,0)}function replaceOuter($from,$to,slice,depth){var index=$from.index(depth),node=$from.node(depth);if(index==$to.index(depth)&&depth<$from.depth-slice.openStart){var inner=replaceOuter($from,$to,slice,depth+1);return node.copy(node.content.replaceChild(index,inner))}if(slice.content.size){if(slice.openStart||slice.openEnd||$from.depth!=depth||$to.depth!=depth){var ref=function prepareSliceForReplace(slice,$along){for(var extra=$along.depth-slice.openStart,node=$along.node(extra).copy(slice.content),i=extra-1;i>=0;i--)node=$along.node(i).copy(Fragment.from(node));return{start:node.resolveNoCache(slice.openStart+extra),end:node.resolveNoCache(node.content.size-slice.openEnd-extra)}}(slice,$from);return close(node,replaceThreeWay($from,ref.start,ref.end,$to,depth))}var parent=$from.parent,content=parent.content;return close(parent,content.cut(0,$from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))}return close(node,replaceTwoWay($from,$to,depth))}function checkJoin(main,sub){if(!sub.type.compatibleContent(main.type))throw new ReplaceError("Cannot join "+sub.type.name+" onto "+main.type.name)}function joinable$1($before,$after,depth){var node=$before.node(depth);return checkJoin(node,$after.node(depth)),node}function addNode(child,target){var last=target.length-1;last>=0&&child.isText&&child.sameMarkup(target[last])?target[last]=child.withText(target[last].text+child.text):target.push(child)}function addRange($start,$end,depth,target){var node=($end||$start).node(depth),startIndex=0,endIndex=$end?$end.index(depth):node.childCount;$start&&(startIndex=$start.index(depth),$start.depth>depth?startIndex++:$start.textOffset&&(addNode($start.nodeAfter,target),startIndex++));for(var i=startIndex;i<endIndex;i++)addNode(node.child(i),target);$end&&$end.depth==depth&&$end.textOffset&&addNode($end.nodeBefore,target)}function close(node,content){if(!node.type.validContent(content))throw new ReplaceError("Invalid content for node "+node.type.name);return node.copy(content)}function replaceThreeWay($from,$start,$end,$to,depth){var openStart=$from.depth>depth&&joinable$1($from,$start,depth+1),openEnd=$to.depth>depth&&joinable$1($end,$to,depth+1),content=[];return addRange(null,$from,depth,content),openStart&&openEnd&&$start.index(depth)==$end.index(depth)?(checkJoin(openStart,openEnd),addNode(close(openStart,replaceThreeWay($from,$start,$end,$to,depth+1)),content)):(openStart&&addNode(close(openStart,replaceTwoWay($from,$start,depth+1)),content),addRange($start,$end,depth,content),openEnd&&addNode(close(openEnd,replaceTwoWay($end,$to,depth+1)),content)),addRange($to,null,depth,content),new Fragment(content)}function replaceTwoWay($from,$to,depth){var content=[];(addRange(null,$from,depth,content),$from.depth>depth)&&addNode(close(joinable$1($from,$to,depth+1),replaceTwoWay($from,$to,depth+1)),content);return addRange($to,null,depth,content),new Fragment(content)}prototypeAccessors$1$3.size.get=function(){return this.content.size-this.openStart-this.openEnd},Slice.prototype.insertAt=function insertAt(pos,fragment){var content=insertInto(this.content,pos+this.openStart,fragment,null);return content&&new Slice(content,this.openStart,this.openEnd)},Slice.prototype.removeBetween=function removeBetween(from,to){return new Slice(removeRange(this.content,from+this.openStart,to+this.openStart),this.openStart,this.openEnd)},Slice.prototype.eq=function eq(other){return this.content.eq(other.content)&&this.openStart==other.openStart&&this.openEnd==other.openEnd},Slice.prototype.toString=function toString(){return this.content+"("+this.openStart+","+this.openEnd+")"},Slice.prototype.toJSON=function toJSON(){if(!this.content.size)return null;var json={content:this.content.toJSON()};return this.openStart>0&&(json.openStart=this.openStart),this.openEnd>0&&(json.openEnd=this.openEnd),json},Slice.fromJSON=function fromJSON(schema,json){if(!json)return Slice.empty;var openStart=json.openStart||0,openEnd=json.openEnd||0;if("number"!=typeof openStart||"number"!=typeof openEnd)throw new RangeError("Invalid input for Slice.fromJSON");return new Slice(Fragment.fromJSON(schema,json.content),openStart,openEnd)},Slice.maxOpen=function maxOpen(fragment,openIsolating){void 0===openIsolating&&(openIsolating=!0);for(var openStart=0,openEnd=0,n=fragment.firstChild;n&&!n.isLeaf&&(openIsolating||!n.type.spec.isolating);n=n.firstChild)openStart++;for(var n$1=fragment.lastChild;n$1&&!n$1.isLeaf&&(openIsolating||!n$1.type.spec.isolating);n$1=n$1.lastChild)openEnd++;return new Slice(fragment,openStart,openEnd)},Object.defineProperties(Slice.prototype,prototypeAccessors$1$3),Slice.empty=new Slice(Fragment.empty,0,0);var ResolvedPos=function ResolvedPos(pos,path,parentOffset){this.pos=pos,this.path=path,this.depth=path.length/3-1,this.parentOffset=parentOffset},prototypeAccessors$2$1={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};ResolvedPos.prototype.resolveDepth=function resolveDepth(val){return null==val?this.depth:val<0?this.depth+val:val},prototypeAccessors$2$1.parent.get=function(){return this.node(this.depth)},prototypeAccessors$2$1.doc.get=function(){return this.node(0)},ResolvedPos.prototype.node=function node(depth){return this.path[3*this.resolveDepth(depth)]},ResolvedPos.prototype.index=function index(depth){return this.path[3*this.resolveDepth(depth)+1]},ResolvedPos.prototype.indexAfter=function indexAfter(depth){return depth=this.resolveDepth(depth),this.index(depth)+(depth!=this.depth||this.textOffset?1:0)},ResolvedPos.prototype.start=function start(depth){return 0==(depth=this.resolveDepth(depth))?0:this.path[3*depth-1]+1},ResolvedPos.prototype.end=function end(depth){return depth=this.resolveDepth(depth),this.start(depth)+this.node(depth).content.size},ResolvedPos.prototype.before=function before(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position before the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]},ResolvedPos.prototype.after=function after(depth){if(!(depth=this.resolveDepth(depth)))throw new RangeError("There is no position after the top-level node");return depth==this.depth+1?this.pos:this.path[3*depth-1]+this.path[3*depth].nodeSize},prototypeAccessors$2$1.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},prototypeAccessors$2$1.nodeAfter.get=function(){var parent=this.parent,index=this.index(this.depth);if(index==parent.childCount)return null;var dOff=this.pos-this.path[this.path.length-1],child=parent.child(index);return dOff?parent.child(index).cut(dOff):child},prototypeAccessors$2$1.nodeBefore.get=function(){var index=this.index(this.depth),dOff=this.pos-this.path[this.path.length-1];return dOff?this.parent.child(index).cut(0,dOff):0==index?null:this.parent.child(index-1)},ResolvedPos.prototype.posAtIndex=function posAtIndex(index,depth){depth=this.resolveDepth(depth);for(var node=this.path[3*depth],pos=0==depth?0:this.path[3*depth-1]+1,i=0;i<index;i++)pos+=node.child(i).nodeSize;return pos},ResolvedPos.prototype.marks=function marks(){var parent=this.parent,index=this.index();if(0==parent.content.size)return Mark$1.none;if(this.textOffset)return parent.child(index).marks;var main=parent.maybeChild(index-1),other=parent.maybeChild(index);if(!main){var tmp=main;main=other,other=tmp}for(var marks=main.marks,i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||other&&marks[i].isInSet(other.marks)||(marks=marks[i--].removeFromSet(marks));return marks},ResolvedPos.prototype.marksAcross=function marksAcross($end){var after=this.parent.maybeChild(this.index());if(!after||!after.isInline)return null;for(var marks=after.marks,next=$end.parent.maybeChild($end.index()),i=0;i<marks.length;i++)!1!==marks[i].type.spec.inclusive||next&&marks[i].isInSet(next.marks)||(marks=marks[i--].removeFromSet(marks));return marks},ResolvedPos.prototype.sharedDepth=function sharedDepth(pos){for(var depth=this.depth;depth>0;depth--)if(this.start(depth)<=pos&&this.end(depth)>=pos)return depth;return 0},ResolvedPos.prototype.blockRange=function blockRange(other,pred){if(void 0===other&&(other=this),other.pos<this.pos)return other.blockRange(this);for(var d=this.depth-(this.parent.inlineContent||this.pos==other.pos?1:0);d>=0;d--)if(other.pos<=this.end(d)&&(!pred||pred(this.node(d))))return new NodeRange(this,other,d)},ResolvedPos.prototype.sameParent=function sameParent(other){return this.pos-this.parentOffset==other.pos-other.parentOffset},ResolvedPos.prototype.max=function max(other){return other.pos>this.pos?other:this},ResolvedPos.prototype.min=function min(other){return other.pos<this.pos?other:this},ResolvedPos.prototype.toString=function toString(){for(var str="",i=1;i<=this.depth;i++)str+=(str?"/":"")+this.node(i).type.name+"_"+this.index(i-1);return str+":"+this.parentOffset},ResolvedPos.resolve=function resolve(doc,pos){if(!(pos>=0&&pos<=doc.content.size))throw new RangeError("Position "+pos+" out of range");for(var path=[],start=0,parentOffset=pos,node=doc;;){var ref=node.content.findIndex(parentOffset),index=ref.index,offset=ref.offset,rem=parentOffset-offset;if(path.push(node,index,start+offset),!rem)break;if((node=node.child(index)).isText)break;parentOffset=rem-1,start+=offset+1}return new ResolvedPos(pos,path,parentOffset)},ResolvedPos.resolveCached=function resolveCached(doc,pos){for(var i=0;i<resolveCache.length;i++){var cached=resolveCache[i];if(cached.pos==pos&&cached.doc==doc)return cached}var result=resolveCache[resolveCachePos]=ResolvedPos.resolve(doc,pos);return resolveCachePos=(resolveCachePos+1)%resolveCacheSize,result},Object.defineProperties(ResolvedPos.prototype,prototypeAccessors$2$1);var resolveCache=[],resolveCachePos=0,resolveCacheSize=12,NodeRange=function NodeRange($from,$to,depth){this.$from=$from,this.$to=$to,this.depth=depth},prototypeAccessors$1$1$1={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};prototypeAccessors$1$1$1.start.get=function(){return this.$from.before(this.depth+1)},prototypeAccessors$1$1$1.end.get=function(){return this.$to.after(this.depth+1)},prototypeAccessors$1$1$1.parent.get=function(){return this.$from.node(this.depth)},prototypeAccessors$1$1$1.startIndex.get=function(){return this.$from.index(this.depth)},prototypeAccessors$1$1$1.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(NodeRange.prototype,prototypeAccessors$1$1$1);var emptyAttrs=Object.create(null),Node$1=function Node(type,attrs,content,marks){this.type=type,this.attrs=attrs,this.content=content||Fragment.empty,this.marks=marks||Mark$1.none},prototypeAccessors$3$1={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};prototypeAccessors$3$1.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},prototypeAccessors$3$1.childCount.get=function(){return this.content.childCount},Node$1.prototype.child=function child(index){return this.content.child(index)},Node$1.prototype.maybeChild=function maybeChild(index){return this.content.maybeChild(index)},Node$1.prototype.forEach=function forEach(f){this.content.forEach(f)},Node$1.prototype.nodesBetween=function nodesBetween(from,to,f,startPos){void 0===startPos&&(startPos=0),this.content.nodesBetween(from,to,f,startPos,this)},Node$1.prototype.descendants=function descendants(f){this.nodesBetween(0,this.content.size,f)},prototypeAccessors$3$1.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Node$1.prototype.textBetween=function textBetween(from,to,blockSeparator,leafText){return this.content.textBetween(from,to,blockSeparator,leafText)},prototypeAccessors$3$1.firstChild.get=function(){return this.content.firstChild},prototypeAccessors$3$1.lastChild.get=function(){return this.content.lastChild},Node$1.prototype.eq=function eq(other){return this==other||this.sameMarkup(other)&&this.content.eq(other.content)},Node$1.prototype.sameMarkup=function sameMarkup(other){return this.hasMarkup(other.type,other.attrs,other.marks)},Node$1.prototype.hasMarkup=function hasMarkup(type,attrs,marks){return this.type==type&&compareDeep(this.attrs,attrs||type.defaultAttrs||emptyAttrs)&&Mark$1.sameSet(this.marks,marks||Mark$1.none)},Node$1.prototype.copy=function copy(content){return void 0===content&&(content=null),content==this.content?this:new this.constructor(this.type,this.attrs,content,this.marks)},Node$1.prototype.mark=function mark(marks){return marks==this.marks?this:new this.constructor(this.type,this.attrs,this.content,marks)},Node$1.prototype.cut=function cut(from,to){return 0==from&&to==this.content.size?this:this.copy(this.content.cut(from,to))},Node$1.prototype.slice=function slice(from,to,includeParents){if(void 0===to&&(to=this.content.size),void 0===includeParents&&(includeParents=!1),from==to)return Slice.empty;var $from=this.resolve(from),$to=this.resolve(to),depth=includeParents?0:$from.sharedDepth(to),start=$from.start(depth),content=$from.node(depth).content.cut($from.pos-start,$to.pos-start);return new Slice(content,$from.depth-depth,$to.depth-depth)},Node$1.prototype.replace=function replace$1(from,to,slice){return replace(this.resolve(from),this.resolve(to),slice)},Node$1.prototype.nodeAt=function nodeAt(pos){for(var node=this;;){var ref=node.content.findIndex(pos),index=ref.index,offset=ref.offset;if(!(node=node.maybeChild(index)))return null;if(offset==pos||node.isText)return node;pos-=offset+1}},Node$1.prototype.childAfter=function childAfter(pos){var ref=this.content.findIndex(pos),index=ref.index,offset=ref.offset;return{node:this.content.maybeChild(index),index,offset}},Node$1.prototype.childBefore=function childBefore(pos){if(0==pos)return{node:null,index:0,offset:0};var ref=this.content.findIndex(pos),index=ref.index,offset=ref.offset;if(offset<pos)return{node:this.content.child(index),index,offset};var node=this.content.child(index-1);return{node,index:index-1,offset:offset-node.nodeSize}},Node$1.prototype.resolve=function resolve(pos){return ResolvedPos.resolveCached(this,pos)},Node$1.prototype.resolveNoCache=function resolveNoCache(pos){return ResolvedPos.resolve(this,pos)},Node$1.prototype.rangeHasMark=function rangeHasMark(from,to,type){var found=!1;return to>from&&this.nodesBetween(from,to,(function(node){return type.isInSet(node.marks)&&(found=!0),!found})),found},prototypeAccessors$3$1.isBlock.get=function(){return this.type.isBlock},prototypeAccessors$3$1.isTextblock.get=function(){return this.type.isTextblock},prototypeAccessors$3$1.inlineContent.get=function(){return this.type.inlineContent},prototypeAccessors$3$1.isInline.get=function(){return this.type.isInline},prototypeAccessors$3$1.isText.get=function(){return this.type.isText},prototypeAccessors$3$1.isLeaf.get=function(){return this.type.isLeaf},prototypeAccessors$3$1.isAtom.get=function(){return this.type.isAtom},Node$1.prototype.toString=function toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var name=this.type.name;return this.content.size&&(name+="("+this.content.toStringInner()+")"),wrapMarks(this.marks,name)},Node$1.prototype.contentMatchAt=function contentMatchAt(index){var match=this.type.contentMatch.matchFragment(this.content,0,index);if(!match)throw new Error("Called contentMatchAt on a node with invalid content");return match},Node$1.prototype.canReplace=function canReplace(from,to,replacement,start,end){void 0===replacement&&(replacement=Fragment.empty),void 0===start&&(start=0),void 0===end&&(end=replacement.childCount);var one=this.contentMatchAt(from).matchFragment(replacement,start,end),two=one&&one.matchFragment(this.content,to);if(!two||!two.validEnd)return!1;for(var i=start;i<end;i++)if(!this.type.allowsMarks(replacement.child(i).marks))return!1;return!0},Node$1.prototype.canReplaceWith=function canReplaceWith(from,to,type,marks){if(marks&&!this.type.allowsMarks(marks))return!1;var start=this.contentMatchAt(from).matchType(type),end=start&&start.matchFragment(this.content,to);return!!end&&end.validEnd},Node$1.prototype.canAppend=function canAppend(other){return other.content.size?this.canReplace(this.childCount,this.childCount,other.content):this.type.compatibleContent(other.type)},Node$1.prototype.check=function check(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var copy=Mark$1.none,i=0;i<this.marks.length;i++)copy=this.marks[i].addToSet(copy);if(!Mark$1.sameSet(copy,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(m){return m.type.name})));this.content.forEach((function(node){return node.check()}))},Node$1.prototype.toJSON=function toJSON(){var obj={type:this.type.name};for(var _ in this.attrs){obj.attrs=this.attrs;break}return this.content.size&&(obj.content=this.content.toJSON()),this.marks.length&&(obj.marks=this.marks.map((function(n){return n.toJSON()}))),obj},Node$1.fromJSON=function fromJSON(schema,json){if(!json)throw new RangeError("Invalid input for Node.fromJSON");var marks=null;if(json.marks){if(!Array.isArray(json.marks))throw new RangeError("Invalid mark data for Node.fromJSON");marks=json.marks.map(schema.markFromJSON)}if("text"==json.type){if("string"!=typeof json.text)throw new RangeError("Invalid text node in JSON");return schema.text(json.text,marks)}var content=Fragment.fromJSON(schema,json.content);return schema.nodeType(json.type).create(json.attrs,content,marks)},Object.defineProperties(Node$1.prototype,prototypeAccessors$3$1);var TextNode=function(Node){function TextNode(type,attrs,content,marks){if(Node.call(this,type,attrs,null,marks),!content)throw new RangeError("Empty text nodes are not allowed");this.text=content}Node&&(TextNode.__proto__=Node),TextNode.prototype=Object.create(Node&&Node.prototype),TextNode.prototype.constructor=TextNode;var prototypeAccessors$1={textContent:{configurable:!0},nodeSize:{configurable:!0}};return TextNode.prototype.toString=function toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wrapMarks(this.marks,JSON.stringify(this.text))},prototypeAccessors$1.textContent.get=function(){return this.text},TextNode.prototype.textBetween=function textBetween(from,to){return this.text.slice(from,to)},prototypeAccessors$1.nodeSize.get=function(){return this.text.length},TextNode.prototype.mark=function mark(marks){return marks==this.marks?this:new TextNode(this.type,this.attrs,this.text,marks)},TextNode.prototype.withText=function withText(text){return text==this.text?this:new TextNode(this.type,this.attrs,text,this.marks)},TextNode.prototype.cut=function cut(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.text.length),0==from&&to==this.text.length?this:this.withText(this.text.slice(from,to))},TextNode.prototype.eq=function eq(other){return this.sameMarkup(other)&&this.text==other.text},TextNode.prototype.toJSON=function toJSON(){var base=Node.prototype.toJSON.call(this);return base.text=this.text,base},Object.defineProperties(TextNode.prototype,prototypeAccessors$1),TextNode}(Node$1);function wrapMarks(marks,str){for(var i=marks.length-1;i>=0;i--)str=marks[i].type.name+"("+str+")";return str}var ContentMatch=function ContentMatch(validEnd){this.validEnd=validEnd,this.next=[],this.wrapCache=[]},prototypeAccessors$4$1={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};ContentMatch.parse=function parse(string,nodeTypes){var stream=new TokenStream(string,nodeTypes);if(null==stream.next)return ContentMatch.empty;var expr=parseExpr(stream);stream.next&&stream.err("Unexpected trailing text");var match=function dfa(nfa){var labeled=Object.create(null);return explore(nullFrom(nfa,0));function explore(states){var out=[];states.forEach((function(node){nfa[node].forEach((function(ref){var term=ref.term,to=ref.to;if(term){var known=out.indexOf(term),set=known>-1&&out[known+1];nullFrom(nfa,to).forEach((function(node){set||out.push(term,set=[]),-1==set.indexOf(node)&&set.push(node)}))}}))}));for(var state=labeled[states.join(",")]=new ContentMatch(states.indexOf(nfa.length-1)>-1),i=0;i<out.length;i+=2){var states$1=out[i+1].sort(cmp);state.next.push(out[i],labeled[states$1.join(",")]||explore(states$1))}return state}}(function nfa(expr){var nfa=[[]];return connect(compile(expr,0),node()),nfa;function node(){return nfa.push([])-1}function edge(from,to,term){var edge={term,to};return nfa[from].push(edge),edge}function connect(edges,to){edges.forEach((function(edge){return edge.to=to}))}function compile(expr,from){if("choice"==expr.type)return expr.exprs.reduce((function(out,expr){return out.concat(compile(expr,from))}),[]);if("seq"==expr.type)for(var i=0;;i++){var next=compile(expr.exprs[i],from);if(i==expr.exprs.length-1)return next;connect(next,from=node())}else{if("star"==expr.type){var loop=node();return edge(from,loop),connect(compile(expr.expr,loop),loop),[edge(loop)]}if("plus"==expr.type){var loop$1=node();return connect(compile(expr.expr,from),loop$1),connect(compile(expr.expr,loop$1),loop$1),[edge(loop$1)]}if("opt"==expr.type)return[edge(from)].concat(compile(expr.expr,from));if("range"==expr.type){for(var cur=from,i$1=0;i$1<expr.min;i$1++){var next$1=node();connect(compile(expr.expr,cur),next$1),cur=next$1}if(-1==expr.max)connect(compile(expr.expr,cur),cur);else for(var i$2=expr.min;i$2<expr.max;i$2++){var next$2=node();edge(cur,next$2),connect(compile(expr.expr,cur),next$2),cur=next$2}return[edge(cur)]}if("name"==expr.type)return[edge(from,null,expr.value)]}}}(expr));return function checkForDeadEnds(match,stream){for(var i=0,work=[match];i<work.length;i++){for(var state=work[i],dead=!state.validEnd,nodes=[],j=0;j<state.next.length;j+=2){var node=state.next[j],next=state.next[j+1];nodes.push(node.name),!dead||node.isText||node.hasRequiredAttrs()||(dead=!1),-1==work.indexOf(next)&&work.push(next)}dead&&stream.err("Only non-generatable nodes ("+nodes.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(match,stream),match},ContentMatch.prototype.matchType=function matchType(type){for(var i=0;i<this.next.length;i+=2)if(this.next[i]==type)return this.next[i+1];return null},ContentMatch.prototype.matchFragment=function matchFragment(frag,start,end){void 0===start&&(start=0),void 0===end&&(end=frag.childCount);for(var cur=this,i=start;cur&&i<end;i++)cur=cur.matchType(frag.child(i).type);return cur},prototypeAccessors$4$1.inlineContent.get=function(){var first=this.next[0];return!!first&&first.isInline},prototypeAccessors$4$1.defaultType.get=function(){for(var i=0;i<this.next.length;i+=2){var type=this.next[i];if(!type.isText&&!type.hasRequiredAttrs())return type}},ContentMatch.prototype.compatible=function compatible(other){for(var i=0;i<this.next.length;i+=2)for(var j=0;j<other.next.length;j+=2)if(this.next[i]==other.next[j])return!0;return!1},ContentMatch.prototype.fillBefore=function fillBefore(after,toEnd,startIndex){void 0===toEnd&&(toEnd=!1),void 0===startIndex&&(startIndex=0);var seen=[this];return function search(match,types){var finished=match.matchFragment(after,startIndex);if(finished&&(!toEnd||finished.validEnd))return Fragment.from(types.map((function(tp){return tp.createAndFill()})));for(var i=0;i<match.next.length;i+=2){var type=match.next[i],next=match.next[i+1];if(!type.isText&&!type.hasRequiredAttrs()&&-1==seen.indexOf(next)){seen.push(next);var found=search(next,types.concat(type));if(found)return found}}}(this,[])},ContentMatch.prototype.findWrapping=function findWrapping(target){for(var i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==target)return this.wrapCache[i+1];var computed=this.computeWrapping(target);return this.wrapCache.push(target,computed),computed},ContentMatch.prototype.computeWrapping=function computeWrapping(target){for(var seen=Object.create(null),active=[{match:this,type:null,via:null}];active.length;){var current=active.shift(),match=current.match;if(match.matchType(target)){for(var result=[],obj=current;obj.type;obj=obj.via)result.push(obj.type);return result.reverse()}for(var i=0;i<match.next.length;i+=2){var type=match.next[i];type.isLeaf||type.hasRequiredAttrs()||type.name in seen||current.type&&!match.next[i+1].validEnd||(active.push({match:type.contentMatch,type,via:current}),seen[type.name]=!0)}}},prototypeAccessors$4$1.edgeCount.get=function(){return this.next.length>>1},ContentMatch.prototype.edge=function edge(n){var i=n<<1;if(i>=this.next.length)throw new RangeError("There's no "+n+"th edge in this content match");return{type:this.next[i],next:this.next[i+1]}},ContentMatch.prototype.toString=function toString(){var seen=[];return function scan(m){seen.push(m);for(var i=1;i<m.next.length;i+=2)-1==seen.indexOf(m.next[i])&&scan(m.next[i])}(this),seen.map((function(m,i){for(var out=i+(m.validEnd?"*":" ")+" ",i$1=0;i$1<m.next.length;i$1+=2)out+=(i$1?", ":"")+m.next[i$1].name+"->"+seen.indexOf(m.next[i$1+1]);return out})).join("\n")},Object.defineProperties(ContentMatch.prototype,prototypeAccessors$4$1),ContentMatch.empty=new ContentMatch(!0);var TokenStream=function TokenStream(string,nodeTypes){this.string=string,this.nodeTypes=nodeTypes,this.inline=null,this.pos=0,this.tokens=string.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},prototypeAccessors$1$2$1={next:{configurable:!0}};function parseExpr(stream){var exprs=[];do{exprs.push(parseExprSeq(stream))}while(stream.eat("|"));return 1==exprs.length?exprs[0]:{type:"choice",exprs}}function parseExprSeq(stream){var exprs=[];do{exprs.push(parseExprSubscript(stream))}while(stream.next&&")"!=stream.next&&"|"!=stream.next);return 1==exprs.length?exprs[0]:{type:"seq",exprs}}function parseExprSubscript(stream){for(var expr=function parseExprAtom(stream){if(stream.eat("(")){var expr=parseExpr(stream);return stream.eat(")")||stream.err("Missing closing paren"),expr}if(!/\W/.test(stream.next)){var exprs=function resolveName(stream,name){var types=stream.nodeTypes,type=types[name];if(type)return[type];var result=[];for(var typeName in types){var type$1=types[typeName];type$1.groups.indexOf(name)>-1&&result.push(type$1)}0==result.length&&stream.err("No node type or group '"+name+"' found");return result}(stream,stream.next).map((function(type){return null==stream.inline?stream.inline=type.isInline:stream.inline!=type.isInline&&stream.err("Mixing inline and block content"),{type:"name",value:type}}));return stream.pos++,1==exprs.length?exprs[0]:{type:"choice",exprs}}stream.err("Unexpected token '"+stream.next+"'")}(stream);;)if(stream.eat("+"))expr={type:"plus",expr};else if(stream.eat("*"))expr={type:"star",expr};else if(stream.eat("?"))expr={type:"opt",expr};else{if(!stream.eat("{"))break;expr=parseExprRange(stream,expr)}return expr}function parseNum(stream){/\D/.test(stream.next)&&stream.err("Expected number, got '"+stream.next+"'");var result=Number(stream.next);return stream.pos++,result}function parseExprRange(stream,expr){var min=parseNum(stream),max=min;return stream.eat(",")&&(max="}"!=stream.next?parseNum(stream):-1),stream.eat("}")||stream.err("Unclosed braced range"),{type:"range",min,max,expr}}function cmp(a,b){return b-a}function nullFrom(nfa,node){var result=[];return function scan(node){var edges=nfa[node];if(1==edges.length&&!edges[0].term)return scan(edges[0].to);result.push(node);for(var i=0;i<edges.length;i++){var ref=edges[i],term=ref.term,to=ref.to;term||-1!=result.indexOf(to)||scan(to)}}(node),result.sort(cmp)}function defaultAttrs(attrs){var defaults=Object.create(null);for(var attrName in attrs){var attr=attrs[attrName];if(!attr.hasDefault)return null;defaults[attrName]=attr.default}return defaults}function computeAttrs(attrs,value){var built=Object.create(null);for(var name in attrs){var given=value&&value[name];if(void 0===given){var attr=attrs[name];if(!attr.hasDefault)throw new RangeError("No value supplied for attribute "+name);given=attr.default}built[name]=given}return built}function initAttrs(attrs){var result=Object.create(null);if(attrs)for(var name in attrs)result[name]=new Attribute(attrs[name]);return result}prototypeAccessors$1$2$1.next.get=function(){return this.tokens[this.pos]},TokenStream.prototype.eat=function eat(tok){return this.next==tok&&(this.pos++||!0)},TokenStream.prototype.err=function err(str){throw new SyntaxError(str+" (in content expression '"+this.string+"')")},Object.defineProperties(TokenStream.prototype,prototypeAccessors$1$2$1);var NodeType$1=function NodeType(name,schema,spec){this.name=name,this.schema=schema,this.spec=spec,this.groups=spec.group?spec.group.split(" "):[],this.attrs=initAttrs(spec.attrs),this.defaultAttrs=defaultAttrs(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(spec.inline||"text"==name),this.isText="text"==name},prototypeAccessors$5$1={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0},whitespace:{configurable:!0}};prototypeAccessors$5$1.isInline.get=function(){return!this.isBlock},prototypeAccessors$5$1.isTextblock.get=function(){return this.isBlock&&this.inlineContent},prototypeAccessors$5$1.isLeaf.get=function(){return this.contentMatch==ContentMatch.empty},prototypeAccessors$5$1.isAtom.get=function(){return this.isLeaf||this.spec.atom},prototypeAccessors$5$1.whitespace.get=function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")},NodeType$1.prototype.hasRequiredAttrs=function hasRequiredAttrs(){for(var n in this.attrs)if(this.attrs[n].isRequired)return!0;return!1},NodeType$1.prototype.compatibleContent=function compatibleContent(other){return this==other||this.contentMatch.compatible(other.contentMatch)},NodeType$1.prototype.computeAttrs=function computeAttrs$1(attrs){return!attrs&&this.defaultAttrs?this.defaultAttrs:computeAttrs(this.attrs,attrs)},NodeType$1.prototype.create=function create(attrs,content,marks){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Node$1(this,this.computeAttrs(attrs),Fragment.from(content),Mark$1.setFrom(marks))},NodeType$1.prototype.createChecked=function createChecked(attrs,content,marks){if(content=Fragment.from(content),!this.validContent(content))throw new RangeError("Invalid content for node "+this.name);return new Node$1(this,this.computeAttrs(attrs),content,Mark$1.setFrom(marks))},NodeType$1.prototype.createAndFill=function createAndFill(attrs,content,marks){if(attrs=this.computeAttrs(attrs),(content=Fragment.from(content)).size){var before=this.contentMatch.fillBefore(content);if(!before)return null;content=before.append(content)}var after=this.contentMatch.matchFragment(content).fillBefore(Fragment.empty,!0);return after?new Node$1(this,attrs,content.append(after),Mark$1.setFrom(marks)):null},NodeType$1.prototype.validContent=function validContent(content){var result=this.contentMatch.matchFragment(content);if(!result||!result.validEnd)return!1;for(var i=0;i<content.childCount;i++)if(!this.allowsMarks(content.child(i).marks))return!1;return!0},NodeType$1.prototype.allowsMarkType=function allowsMarkType(markType){return null==this.markSet||this.markSet.indexOf(markType)>-1},NodeType$1.prototype.allowsMarks=function allowsMarks(marks){if(null==this.markSet)return!0;for(var i=0;i<marks.length;i++)if(!this.allowsMarkType(marks[i].type))return!1;return!0},NodeType$1.prototype.allowedMarks=function allowedMarks(marks){if(null==this.markSet)return marks;for(var copy,i=0;i<marks.length;i++)this.allowsMarkType(marks[i].type)?copy&&copy.push(marks[i]):copy||(copy=marks.slice(0,i));return copy?copy.length?copy:Mark$1.empty:marks},NodeType$1.compile=function compile(nodes,schema){var result=Object.create(null);nodes.forEach((function(name,spec){return result[name]=new NodeType$1(name,schema,spec)}));var topType=schema.spec.topNode||"doc";if(!result[topType])throw new RangeError("Schema is missing its top node type ('"+topType+"')");if(!result.text)throw new RangeError("Every schema needs a 'text' type");for(var _ in result.text.attrs)throw new RangeError("The text node type should not have attributes");return result},Object.defineProperties(NodeType$1.prototype,prototypeAccessors$5$1);var Attribute=function Attribute(options){this.hasDefault=Object.prototype.hasOwnProperty.call(options,"default"),this.default=options.default},prototypeAccessors$1$3$1={isRequired:{configurable:!0}};prototypeAccessors$1$3$1.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Attribute.prototype,prototypeAccessors$1$3$1);var MarkType=function MarkType(name,rank,schema,spec){this.name=name,this.schema=schema,this.spec=spec,this.attrs=initAttrs(spec.attrs),this.rank=rank,this.excluded=null;var defaults=defaultAttrs(this.attrs);this.instance=defaults&&new Mark$1(this,defaults)};MarkType.prototype.create=function create(attrs){return!attrs&&this.instance?this.instance:new Mark$1(this,computeAttrs(this.attrs,attrs))},MarkType.compile=function compile(marks,schema){var result=Object.create(null),rank=0;return marks.forEach((function(name,spec){return result[name]=new MarkType(name,rank++,schema,spec)})),result},MarkType.prototype.removeFromSet=function removeFromSet(set){for(var i=0;i<set.length;i++)set[i].type==this&&(set=set.slice(0,i).concat(set.slice(i+1)),i--);return set},MarkType.prototype.isInSet=function isInSet(set){for(var i=0;i<set.length;i++)if(set[i].type==this)return set[i]},MarkType.prototype.excludes=function excludes(other){return this.excluded.indexOf(other)>-1};var Schema=function Schema(spec){for(var prop in this.spec={},spec)this.spec[prop]=spec[prop];this.spec.nodes=orderedmap.from(spec.nodes),this.spec.marks=orderedmap.from(spec.marks),this.nodes=NodeType$1.compile(this.spec.nodes,this),this.marks=MarkType.compile(this.spec.marks,this);var contentExprCache=Object.create(null);for(var prop$1 in this.nodes){if(prop$1 in this.marks)throw new RangeError(prop$1+" can not be both a node and a mark");var type=this.nodes[prop$1],contentExpr=type.spec.content||"",markExpr=type.spec.marks;type.contentMatch=contentExprCache[contentExpr]||(contentExprCache[contentExpr]=ContentMatch.parse(contentExpr,this.nodes)),type.inlineContent=type.contentMatch.inlineContent,type.markSet="_"==markExpr?null:markExpr?gatherMarks(this,markExpr.split(" ")):""!=markExpr&&type.inlineContent?null:[]}for(var prop$2 in this.marks){var type$1=this.marks[prop$2],excl=type$1.spec.excludes;type$1.excluded=null==excl?[type$1]:""==excl?[]:gatherMarks(this,excl.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function gatherMarks(schema,marks){for(var found=[],i=0;i<marks.length;i++){var name=marks[i],mark=schema.marks[name],ok=mark;if(mark)found.push(mark);else for(var prop in schema.marks){var mark$1=schema.marks[prop];("_"==name||mark$1.spec.group&&mark$1.spec.group.split(" ").indexOf(name)>-1)&&found.push(ok=mark$1)}if(!ok)throw new SyntaxError("Unknown mark type: '"+marks[i]+"'")}return found}Schema.prototype.node=function node(type,attrs,content,marks){if("string"==typeof type)type=this.nodeType(type);else{if(!(type instanceof NodeType$1))throw new RangeError("Invalid node type: "+type);if(type.schema!=this)throw new RangeError("Node type from different schema used ("+type.name+")")}return type.createChecked(attrs,content,marks)},Schema.prototype.text=function text(text$1,marks){var type=this.nodes.text;return new TextNode(type,type.defaultAttrs,text$1,Mark$1.setFrom(marks))},Schema.prototype.mark=function mark(type,attrs){return"string"==typeof type&&(type=this.marks[type]),type.create(attrs)},Schema.prototype.nodeFromJSON=function nodeFromJSON(json){return Node$1.fromJSON(this,json)},Schema.prototype.markFromJSON=function markFromJSON(json){return Mark$1.fromJSON(this,json)},Schema.prototype.nodeType=function nodeType(name){var found=this.nodes[name];if(!found)throw new RangeError("Unknown node type: "+name);return found};var DOMParser=function DOMParser(schema,rules){var this$1=this;this.schema=schema,this.rules=rules,this.tags=[],this.styles=[],rules.forEach((function(rule){rule.tag?this$1.tags.push(rule):rule.style&&this$1.styles.push(rule)})),this.normalizeLists=!this.tags.some((function(r){if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;var node=schema.nodes[r.node];return node.contentMatch.matchType(node)}))};DOMParser.prototype.parse=function parse(dom,options){void 0===options&&(options={});var context=new ParseContext(this,options,!1);return context.addAll(dom,null,options.from,options.to),context.finish()},DOMParser.prototype.parseSlice=function parseSlice(dom,options){void 0===options&&(options={});var context=new ParseContext(this,options,!0);return context.addAll(dom,null,options.from,options.to),Slice.maxOpen(context.finish())},DOMParser.prototype.matchTag=function matchTag(dom,context,after){for(var i=after?this.tags.indexOf(after)+1:0;i<this.tags.length;i++){var rule=this.tags[i];if(matches(dom,rule.tag)&&(void 0===rule.namespace||dom.namespaceURI==rule.namespace)&&(!rule.context||context.matchesContext(rule.context))){if(rule.getAttrs){var result=rule.getAttrs(dom);if(!1===result)continue;rule.attrs=result}return rule}}},DOMParser.prototype.matchStyle=function matchStyle(prop,value,context,after){for(var i=after?this.styles.indexOf(after)+1:0;i<this.styles.length;i++){var rule=this.styles[i];if(!(0!=rule.style.indexOf(prop)||rule.context&&!context.matchesContext(rule.context)||rule.style.length>prop.length&&(61!=rule.style.charCodeAt(prop.length)||rule.style.slice(prop.length+1)!=value))){if(rule.getAttrs){var result=rule.getAttrs(value);if(!1===result)continue;rule.attrs=result}return rule}}},DOMParser.schemaRules=function schemaRules(schema){var result=[];function insert(rule){for(var priority=null==rule.priority?50:rule.priority,i=0;i<result.length;i++){var next=result[i];if((null==next.priority?50:next.priority)<priority)break}result.splice(i,0,rule)}var loop=function loop(name){var rules=schema.marks[name].spec.parseDOM;rules&&rules.forEach((function(rule){insert(rule=copy$1(rule)),rule.mark=name}))};for(var name in schema.marks)loop(name);var loop$1=function loop$1(name){var rules$1=schema.nodes[name$1].spec.parseDOM;rules$1&&rules$1.forEach((function(rule){insert(rule=copy$1(rule)),rule.node=name$1}))};for(var name$1 in schema.nodes)loop$1();return result},DOMParser.fromSchema=function fromSchema(schema){return schema.cached.domParser||(schema.cached.domParser=new DOMParser(schema,DOMParser.schemaRules(schema)))};var blockTags={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ignoreTags={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},listTags={ol:!0,ul:!0};function wsOptionsFor(type,preserveWhitespace,base){return null!=preserveWhitespace?(preserveWhitespace?1:0)|("full"===preserveWhitespace?2:0):type&&"pre"==type.whitespace?3:-5&base}var NodeContext=function NodeContext(type,attrs,marks,pendingMarks,solid,match,options){this.type=type,this.attrs=attrs,this.solid=solid,this.match=match||(4&options?null:type.contentMatch),this.options=options,this.content=[],this.marks=marks,this.activeMarks=Mark$1.none,this.pendingMarks=pendingMarks,this.stashMarks=[]};NodeContext.prototype.findWrapping=function findWrapping(node){if(!this.match){if(!this.type)return[];var fill=this.type.contentMatch.fillBefore(Fragment.from(node));if(!fill){var wrap,start=this.type.contentMatch;return(wrap=start.findWrapping(node.type))?(this.match=start,wrap):null}this.match=this.type.contentMatch.matchFragment(fill)}return this.match.findWrapping(node.type)},NodeContext.prototype.finish=function finish(openEnd){if(!(1&this.options)){var m,last=this.content[this.content.length-1];last&&last.isText&&(m=/[ \t\r\n\u000c]+$/.exec(last.text))&&(last.text.length==m[0].length?this.content.pop():this.content[this.content.length-1]=last.withText(last.text.slice(0,last.text.length-m[0].length)))}var content=Fragment.from(this.content);return!openEnd&&this.match&&(content=content.append(this.match.fillBefore(Fragment.empty,!0))),this.type?this.type.create(this.attrs,content,this.marks):content},NodeContext.prototype.popFromStashMark=function popFromStashMark(mark){for(var i=this.stashMarks.length-1;i>=0;i--)if(mark.eq(this.stashMarks[i]))return this.stashMarks.splice(i,1)[0]},NodeContext.prototype.applyPending=function applyPending(nextType){for(var i=0,pending=this.pendingMarks;i<pending.length;i++){var mark=pending[i];(this.type?this.type.allowsMarkType(mark.type):markMayApply(mark.type,nextType))&&!mark.isInSet(this.activeMarks)&&(this.activeMarks=mark.addToSet(this.activeMarks),this.pendingMarks=mark.removeFromSet(this.pendingMarks))}},NodeContext.prototype.inlineContext=function inlineContext(node){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:node.parentNode&&!blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())};var ParseContext=function ParseContext(parser,options,open){this.parser=parser,this.options=options,this.isOpen=open;var topContext,topNode=options.topNode,topOptions=wsOptionsFor(null,options.preserveWhitespace,0)|(open?4:0);topContext=topNode?new NodeContext(topNode.type,topNode.attrs,Mark$1.none,Mark$1.none,!0,options.topMatch||topNode.type.contentMatch,topOptions):new NodeContext(open?null:parser.schema.topNodeType,null,Mark$1.none,Mark$1.none,!0,null,topOptions),this.nodes=[topContext],this.open=0,this.find=options.findPositions,this.needsBlock=!1},prototypeAccessors$6={top:{configurable:!0},currentPos:{configurable:!0}};function matches(dom,selector){return(dom.matches||dom.msMatchesSelector||dom.webkitMatchesSelector||dom.mozMatchesSelector).call(dom,selector)}function copy$1(obj){var copy={};for(var prop in obj)copy[prop]=obj[prop];return copy}function markMayApply(markType,nodeType){var nodes=nodeType.schema.nodes,loop=function loop(name){var parent=nodes[name];if(parent.allowsMarkType(markType)){var seen=[];return function scan(match){seen.push(match);for(var i=0;i<match.edgeCount;i++){var ref=match.edge(i),type=ref.type,next=ref.next;if(type==nodeType)return!0;if(seen.indexOf(next)<0&&scan(next))return!0}}(parent.contentMatch)?{v:!0}:void 0}};for(var name in nodes){var returned=loop(name);if(returned)return returned.v}}prototypeAccessors$6.top.get=function(){return this.nodes[this.open]},ParseContext.prototype.addDOM=function addDOM(dom){if(3==dom.nodeType)this.addTextNode(dom);else if(1==dom.nodeType){var style=dom.getAttribute("style"),marks=style?this.readStyles(function parseStyles(style){var m,re=/\s*([\w-]+)\s*:\s*([^;]+)/g,result=[];for(;m=re.exec(style);)result.push(m[1],m[2].trim());return result}(style)):null,top=this.top;if(null!=marks)for(var i=0;i<marks.length;i++)this.addPendingMark(marks[i]);if(this.addElement(dom),null!=marks)for(var i$1=0;i$1<marks.length;i$1++)this.removePendingMark(marks[i$1],top)}},ParseContext.prototype.addTextNode=function addTextNode(dom){var value=dom.nodeValue,top=this.top;if(2&top.options||top.inlineContext(dom)||/[^ \t\r\n\u000c]/.test(value)){if(1&top.options)value=2&top.options?value.replace(/\r\n?/g,"\n"):value.replace(/\r?\n|\r/g," ");else if(value=value.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(value)&&this.open==this.nodes.length-1){var nodeBefore=top.content[top.content.length-1],domNodeBefore=dom.previousSibling;(!nodeBefore||domNodeBefore&&"BR"==domNodeBefore.nodeName||nodeBefore.isText&&/[ \t\r\n\u000c]$/.test(nodeBefore.text))&&(value=value.slice(1))}value&&this.insertNode(this.parser.schema.text(value)),this.findInText(dom)}else this.findInside(dom)},ParseContext.prototype.addElement=function addElement(dom,matchAfter){var ruleID,name=dom.nodeName.toLowerCase();listTags.hasOwnProperty(name)&&this.parser.normalizeLists&&function normalizeList(dom){for(var child=dom.firstChild,prevItem=null;child;child=child.nextSibling){var name=1==child.nodeType?child.nodeName.toLowerCase():null;name&&listTags.hasOwnProperty(name)&&prevItem?(prevItem.appendChild(child),child=prevItem):"li"==name?prevItem=child:name&&(prevItem=null)}}(dom);var rule=this.options.ruleFromNode&&this.options.ruleFromNode(dom)||(ruleID=this.parser.matchTag(dom,this,matchAfter));if(rule?rule.ignore:ignoreTags.hasOwnProperty(name))this.findInside(dom),this.ignoreFallback(dom);else if(!rule||rule.skip||rule.closeParent){rule&&rule.closeParent?this.open=Math.max(0,this.open-1):rule&&rule.skip.nodeType&&(dom=rule.skip);var sync,top=this.top,oldNeedsBlock=this.needsBlock;if(blockTags.hasOwnProperty(name))sync=!0,top.type||(this.needsBlock=!0);else if(!dom.firstChild)return void this.leafFallback(dom);this.addAll(dom),sync&&this.sync(top),this.needsBlock=oldNeedsBlock}else this.addElementByRule(dom,rule,!1===rule.consuming?ruleID:null)},ParseContext.prototype.leafFallback=function leafFallback(dom){"BR"==dom.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(dom.ownerDocument.createTextNode("\n"))},ParseContext.prototype.ignoreFallback=function ignoreFallback(dom){"BR"!=dom.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},ParseContext.prototype.readStyles=function readStyles(styles){var marks=Mark$1.none;style:for(var i=0;i<styles.length;i+=2)for(var after=null;;){var rule=this.parser.matchStyle(styles[i],styles[i+1],this,after);if(!rule)continue style;if(rule.ignore)return null;if(marks=this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks),!1!==rule.consuming)break;after=rule}return marks},ParseContext.prototype.addElementByRule=function addElementByRule(dom,rule,continueAfter){var sync,nodeType,mark,this$1=this;rule.node?(nodeType=this.parser.schema.nodes[rule.node]).isLeaf?this.insertNode(nodeType.create(rule.attrs))||this.leafFallback(dom):sync=this.enter(nodeType,rule.attrs,rule.preserveWhitespace):(mark=this.parser.schema.marks[rule.mark].create(rule.attrs),this.addPendingMark(mark));var startIn=this.top;if(nodeType&&nodeType.isLeaf)this.findInside(dom);else if(continueAfter)this.addElement(dom,continueAfter);else if(rule.getContent)this.findInside(dom),rule.getContent(dom,this.parser.schema).forEach((function(node){return this$1.insertNode(node)}));else{var contentDOM=rule.contentElement;"string"==typeof contentDOM?contentDOM=dom.querySelector(contentDOM):"function"==typeof contentDOM&&(contentDOM=contentDOM(dom)),contentDOM||(contentDOM=dom),this.findAround(dom,contentDOM,!0),this.addAll(contentDOM,sync)}sync&&(this.sync(startIn),this.open--),mark&&this.removePendingMark(mark,startIn)},ParseContext.prototype.addAll=function addAll(parent,sync,startIndex,endIndex){for(var index=startIndex||0,dom=startIndex?parent.childNodes[startIndex]:parent.firstChild,end=null==endIndex?null:parent.childNodes[endIndex];dom!=end;dom=dom.nextSibling,++index)this.findAtPoint(parent,index),this.addDOM(dom),sync&&blockTags.hasOwnProperty(dom.nodeName.toLowerCase())&&this.sync(sync);this.findAtPoint(parent,index)},ParseContext.prototype.findPlace=function findPlace(node){for(var route,sync,depth=this.open;depth>=0;depth--){var cx=this.nodes[depth],found=cx.findWrapping(node);if(found&&(!route||route.length>found.length)&&(route=found,sync=cx,!found.length))break;if(cx.solid)break}if(!route)return!1;this.sync(sync);for(var i=0;i<route.length;i++)this.enterInner(route[i],null,!1);return!0},ParseContext.prototype.insertNode=function insertNode(node){if(node.isInline&&this.needsBlock&&!this.top.type){var block=this.textblockFromContext();block&&this.enterInner(block)}if(this.findPlace(node)){this.closeExtra();var top=this.top;top.applyPending(node.type),top.match&&(top.match=top.match.matchType(node.type));for(var marks=top.activeMarks,i=0;i<node.marks.length;i++)top.type&&!top.type.allowsMarkType(node.marks[i].type)||(marks=node.marks[i].addToSet(marks));return top.content.push(node.mark(marks)),!0}return!1},ParseContext.prototype.enter=function enter(type,attrs,preserveWS){var ok=this.findPlace(type.create(attrs));return ok&&this.enterInner(type,attrs,!0,preserveWS),ok},ParseContext.prototype.enterInner=function enterInner(type,attrs,solid,preserveWS){this.closeExtra();var top=this.top;top.applyPending(type),top.match=top.match&&top.match.matchType(type,attrs);var options=wsOptionsFor(type,preserveWS,top.options);4&top.options&&0==top.content.length&&(options|=4),this.nodes.push(new NodeContext(type,attrs,top.activeMarks,top.pendingMarks,solid,null,options)),this.open++},ParseContext.prototype.closeExtra=function closeExtra(openEnd){var i=this.nodes.length-1;if(i>this.open){for(;i>this.open;i--)this.nodes[i-1].content.push(this.nodes[i].finish(openEnd));this.nodes.length=this.open+1}},ParseContext.prototype.finish=function finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ParseContext.prototype.sync=function sync(to){for(var i=this.open;i>=0;i--)if(this.nodes[i]==to)return void(this.open=i)},prototypeAccessors$6.currentPos.get=function(){this.closeExtra();for(var pos=0,i=this.open;i>=0;i--){for(var content=this.nodes[i].content,j=content.length-1;j>=0;j--)pos+=content[j].nodeSize;i&&pos++}return pos},ParseContext.prototype.findAtPoint=function findAtPoint(parent,offset){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==parent&&this.find[i].offset==offset&&(this.find[i].pos=this.currentPos)},ParseContext.prototype.findInside=function findInside(parent){if(this.find)for(var i=0;i<this.find.length;i++)null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node)&&(this.find[i].pos=this.currentPos)},ParseContext.prototype.findAround=function findAround(parent,content,before){if(parent!=content&&this.find)for(var i=0;i<this.find.length;i++){if(null==this.find[i].pos&&1==parent.nodeType&&parent.contains(this.find[i].node))content.compareDocumentPosition(this.find[i].node)&(before?2:4)&&(this.find[i].pos=this.currentPos)}},ParseContext.prototype.findInText=function findInText(textNode){if(this.find)for(var i=0;i<this.find.length;i++)this.find[i].node==textNode&&(this.find[i].pos=this.currentPos-(textNode.nodeValue.length-this.find[i].offset))},ParseContext.prototype.matchesContext=function matchesContext(context){var this$1=this;if(context.indexOf("|")>-1)return context.split(/\s*\|\s*/).some(this.matchesContext,this);var parts=context.split("/"),option=this.options.context,useRoot=!(this.isOpen||option&&option.parent.type!=this.nodes[0].type),minDepth=-(option?option.depth+1:0)+(useRoot?0:1);return function match(i,depth){for(;i>=0;i--){var part=parts[i];if(""==part){if(i==parts.length-1||0==i)continue;for(;depth>=minDepth;depth--)if(match(i-1,depth))return!0;return!1}var next=depth>0||0==depth&&useRoot?this$1.nodes[depth].type:option&&depth>=minDepth?option.node(depth-minDepth).type:null;if(!next||next.name!=part&&-1==next.groups.indexOf(part))return!1;depth--}return!0}(parts.length-1,this.open)},ParseContext.prototype.textblockFromContext=function textblockFromContext(){var $context=this.options.context;if($context)for(var d=$context.depth;d>=0;d--){var deflt=$context.node(d).contentMatchAt($context.indexAfter(d)).defaultType;if(deflt&&deflt.isTextblock&&deflt.defaultAttrs)return deflt}for(var name in this.parser.schema.nodes){var type=this.parser.schema.nodes[name];if(type.isTextblock&&type.defaultAttrs)return type}},ParseContext.prototype.addPendingMark=function addPendingMark(mark){var found=function findSameMarkInSet(mark,set){for(var i=0;i<set.length;i++)if(mark.eq(set[i]))return set[i]}(mark,this.top.pendingMarks);found&&this.top.stashMarks.push(found),this.top.pendingMarks=mark.addToSet(this.top.pendingMarks)},ParseContext.prototype.removePendingMark=function removePendingMark(mark,upto){for(var depth=this.open;depth>=0;depth--){var level=this.nodes[depth];if(level.pendingMarks.lastIndexOf(mark)>-1)level.pendingMarks=mark.removeFromSet(level.pendingMarks);else{level.activeMarks=mark.removeFromSet(level.activeMarks);var stashMark=level.popFromStashMark(mark);stashMark&&level.type&&level.type.allowsMarkType(stashMark.type)&&(level.activeMarks=stashMark.addToSet(level.activeMarks))}if(level==upto)break}},Object.defineProperties(ParseContext.prototype,prototypeAccessors$6);var DOMSerializer=function DOMSerializer(nodes,marks){this.nodes=nodes||{},this.marks=marks||{}};function gatherToDOM(obj){var result={};for(var name in obj){var toDOM=obj[name].spec.toDOM;toDOM&&(result[name]=toDOM)}return result}function doc(options){return options.document||window.document}DOMSerializer.prototype.serializeFragment=function serializeFragment(fragment,options,target){var this$1=this;void 0===options&&(options={}),target||(target=doc(options).createDocumentFragment());var top=target,active=null;return fragment.forEach((function(node){if(active||node.marks.length){active||(active=[]);for(var keep=0,rendered=0;keep<active.length&&rendered<node.marks.length;){var next=node.marks[rendered];if(this$1.marks[next.type.name]){if(!next.eq(active[keep])||!1===next.type.spec.spanning)break;keep+=2,rendered++}else rendered++}for(;keep<active.length;)top=active.pop(),active.pop();for(;rendered<node.marks.length;){var add=node.marks[rendered++],markDOM=this$1.serializeMark(add,node.isInline,options);markDOM&&(active.push(add,top),top.appendChild(markDOM.dom),top=markDOM.contentDOM||markDOM.dom)}}top.appendChild(this$1.serializeNodeInner(node,options))})),target},DOMSerializer.prototype.serializeNodeInner=function serializeNodeInner(node,options){void 0===options&&(options={});var ref=DOMSerializer.renderSpec(doc(options),this.nodes[node.type.name](node)),dom=ref.dom,contentDOM=ref.contentDOM;if(contentDOM){if(node.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");options.onContent?options.onContent(node,contentDOM,options):this.serializeFragment(node.content,options,contentDOM)}return dom},DOMSerializer.prototype.serializeNode=function serializeNode(node,options){void 0===options&&(options={});for(var dom=this.serializeNodeInner(node,options),i=node.marks.length-1;i>=0;i--){var wrap=this.serializeMark(node.marks[i],node.isInline,options);wrap&&((wrap.contentDOM||wrap.dom).appendChild(dom),dom=wrap.dom)}return dom},DOMSerializer.prototype.serializeMark=function serializeMark(mark,inline,options){void 0===options&&(options={});var toDOM=this.marks[mark.type.name];return toDOM&&DOMSerializer.renderSpec(doc(options),toDOM(mark,inline))},DOMSerializer.renderSpec=function renderSpec(doc,structure,xmlNS){if(void 0===xmlNS&&(xmlNS=null),"string"==typeof structure)return{dom:doc.createTextNode(structure)};if(null!=structure.nodeType)return{dom:structure};if(structure.dom&&null!=structure.dom.nodeType)return structure;var tagName=structure[0],space=tagName.indexOf(" ");space>0&&(xmlNS=tagName.slice(0,space),tagName=tagName.slice(space+1));var contentDOM=null,dom=xmlNS?doc.createElementNS(xmlNS,tagName):doc.createElement(tagName),attrs=structure[1],start=1;if(attrs&&"object"==typeof attrs&&null==attrs.nodeType&&!Array.isArray(attrs))for(var name in start=2,attrs)if(null!=attrs[name]){var space$1=name.indexOf(" ");space$1>0?dom.setAttributeNS(name.slice(0,space$1),name.slice(space$1+1),attrs[name]):dom.setAttribute(name,attrs[name])}for(var i=start;i<structure.length;i++){var child=structure[i];if(0===child){if(i<structure.length-1||i>start)throw new RangeError("Content hole must be the only child of its parent node");return{dom,contentDOM:dom}}var ref=DOMSerializer.renderSpec(doc,child,xmlNS),inner=ref.dom,innerContent=ref.contentDOM;if(dom.appendChild(inner),innerContent){if(contentDOM)throw new RangeError("Multiple content holes");contentDOM=innerContent}}return{dom,contentDOM}},DOMSerializer.fromSchema=function fromSchema(schema){return schema.cached.domSerializer||(schema.cached.domSerializer=new DOMSerializer(this.nodesFromSchema(schema),this.marksFromSchema(schema)))},DOMSerializer.nodesFromSchema=function nodesFromSchema(schema){var result=gatherToDOM(schema.nodes);return result.text||(result.text=function(node){return node.text}),result},DOMSerializer.marksFromSchema=function marksFromSchema(schema){return gatherToDOM(schema.marks)};var factor16=Math.pow(2,16);function recoverIndex(value){return 65535&value}var MapResult=function MapResult(pos,deleted,recover){void 0===deleted&&(deleted=!1),void 0===recover&&(recover=null),this.pos=pos,this.deleted=deleted,this.recover=recover},StepMap=function StepMap(ranges,inverted){void 0===inverted&&(inverted=!1),this.ranges=ranges,this.inverted=inverted};StepMap.prototype.recover=function recover(value){var diff=0,index=recoverIndex(value);if(!this.inverted)for(var i=0;i<index;i++)diff+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*index]+diff+function recoverOffset(value){return(value-(65535&value))/factor16}(value)},StepMap.prototype.mapResult=function mapResult(pos,assoc){return void 0===assoc&&(assoc=1),this._map(pos,assoc,!1)},StepMap.prototype.map=function map(pos,assoc){return void 0===assoc&&(assoc=1),this._map(pos,assoc,!0)},StepMap.prototype._map=function _map(pos,assoc,simple){for(var diff=0,oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,i=0;i<this.ranges.length;i+=3){var start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;var oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex],end=start+oldSize;if(pos<=end){var result=start+diff+((oldSize?pos==start?-1:pos==end?1:assoc:assoc)<0?0:newSize);if(simple)return result;var recover=pos==(assoc<0?start:end)?null:i/3+(pos-start)*factor16;return new MapResult(result,assoc<0?pos!=start:pos!=end,recover)}diff+=newSize-oldSize}return simple?pos+diff:new MapResult(pos+diff)},StepMap.prototype.touches=function touches(pos,recover){for(var diff=0,index=recoverIndex(recover),oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,i=0;i<this.ranges.length;i+=3){var start=this.ranges[i]-(this.inverted?diff:0);if(start>pos)break;var oldSize=this.ranges[i+oldIndex];if(pos<=start+oldSize&&i==3*index)return!0;diff+=this.ranges[i+newIndex]-oldSize}return!1},StepMap.prototype.forEach=function forEach(f){for(var oldIndex=this.inverted?2:1,newIndex=this.inverted?1:2,i=0,diff=0;i<this.ranges.length;i+=3){var start=this.ranges[i],oldStart=start-(this.inverted?diff:0),newStart=start+(this.inverted?0:diff),oldSize=this.ranges[i+oldIndex],newSize=this.ranges[i+newIndex];f(oldStart,oldStart+oldSize,newStart,newStart+newSize),diff+=newSize-oldSize}},StepMap.prototype.invert=function invert(){return new StepMap(this.ranges,!this.inverted)},StepMap.prototype.toString=function toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},StepMap.offset=function offset(n){return 0==n?StepMap.empty:new StepMap(n<0?[0,-n,0]:[0,0,n])},StepMap.empty=new StepMap([]);var Mapping=function Mapping(maps,mirror,from,to){this.maps=maps||[],this.from=from||0,this.to=null==to?this.maps.length:to,this.mirror=mirror};function TransformError(message){var err=Error.call(this,message);return err.__proto__=TransformError.prototype,err}Mapping.prototype.slice=function slice(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.maps.length),new Mapping(this.maps,this.mirror,from,to)},Mapping.prototype.copy=function copy(){return new Mapping(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},Mapping.prototype.appendMap=function appendMap(map,mirrors){this.to=this.maps.push(map),null!=mirrors&&this.setMirror(this.maps.length-1,mirrors)},Mapping.prototype.appendMapping=function appendMapping(mapping){for(var i=0,startSize=this.maps.length;i<mapping.maps.length;i++){var mirr=mapping.getMirror(i);this.appendMap(mapping.maps[i],null!=mirr&&mirr<i?startSize+mirr:null)}},Mapping.prototype.getMirror=function getMirror(n){if(this.mirror)for(var i=0;i<this.mirror.length;i++)if(this.mirror[i]==n)return this.mirror[i+(i%2?-1:1)]},Mapping.prototype.setMirror=function setMirror(n,m){this.mirror||(this.mirror=[]),this.mirror.push(n,m)},Mapping.prototype.appendMappingInverted=function appendMappingInverted(mapping){for(var i=mapping.maps.length-1,totalSize=this.maps.length+mapping.maps.length;i>=0;i--){var mirr=mapping.getMirror(i);this.appendMap(mapping.maps[i].invert(),null!=mirr&&mirr>i?totalSize-mirr-1:null)}},Mapping.prototype.invert=function invert(){var inverse=new Mapping;return inverse.appendMappingInverted(this),inverse},Mapping.prototype.map=function map(pos,assoc){if(void 0===assoc&&(assoc=1),this.mirror)return this._map(pos,assoc,!0);for(var i=this.from;i<this.to;i++)pos=this.maps[i].map(pos,assoc);return pos},Mapping.prototype.mapResult=function mapResult(pos,assoc){return void 0===assoc&&(assoc=1),this._map(pos,assoc,!1)},Mapping.prototype._map=function _map(pos,assoc,simple){for(var deleted=!1,i=this.from;i<this.to;i++){var result=this.maps[i].mapResult(pos,assoc);if(null!=result.recover){var corr=this.getMirror(i);if(null!=corr&&corr>i&&corr<this.to){i=corr,pos=this.maps[corr].recover(result.recover);continue}}result.deleted&&(deleted=!0),pos=result.pos}return simple?pos:new MapResult(pos,deleted)},TransformError.prototype=Object.create(Error.prototype),TransformError.prototype.constructor=TransformError,TransformError.prototype.name="TransformError";var Transform=function Transform(doc){this.doc=doc,this.steps=[],this.docs=[],this.mapping=new Mapping},prototypeAccessors$4={before:{configurable:!0},docChanged:{configurable:!0}};function mustOverride(){throw new Error("Override me")}prototypeAccessors$4.before.get=function(){return this.docs.length?this.docs[0]:this.doc},Transform.prototype.step=function step(object){var result=this.maybeStep(object);if(result.failed)throw new TransformError(result.failed);return this},Transform.prototype.maybeStep=function maybeStep(step){var result=step.apply(this.doc);return result.failed||this.addStep(step,result.doc),result},prototypeAccessors$4.docChanged.get=function(){return this.steps.length>0},Transform.prototype.addStep=function addStep(step,doc){this.docs.push(this.doc),this.steps.push(step),this.mapping.appendMap(step.getMap()),this.doc=doc},Object.defineProperties(Transform.prototype,prototypeAccessors$4);var stepsByID=Object.create(null),Step=function Step(){};Step.prototype.apply=function apply(_doc){return mustOverride()},Step.prototype.getMap=function getMap(){return StepMap.empty},Step.prototype.invert=function invert(_doc){return mustOverride()},Step.prototype.map=function map(_mapping){return mustOverride()},Step.prototype.merge=function merge(_other){return null},Step.prototype.toJSON=function toJSON(){return mustOverride()},Step.fromJSON=function fromJSON(schema,json){if(!json||!json.stepType)throw new RangeError("Invalid input for Step.fromJSON");var type=stepsByID[json.stepType];if(!type)throw new RangeError("No step type "+json.stepType+" defined");return type.fromJSON(schema,json)},Step.jsonID=function jsonID(id,stepClass){if(id in stepsByID)throw new RangeError("Duplicate use of step JSON ID "+id);return stepsByID[id]=stepClass,stepClass.prototype.jsonID=id,stepClass};var StepResult=function StepResult(doc,failed){this.doc=doc,this.failed=failed};StepResult.ok=function ok(doc){return new StepResult(doc,null)},StepResult.fail=function fail(message){return new StepResult(null,message)},StepResult.fromReplace=function fromReplace(doc,from,to,slice){try{return StepResult.ok(doc.replace(from,to,slice))}catch(e){if(e instanceof ReplaceError)return StepResult.fail(e.message);throw e}};var ReplaceStep=function(Step){function ReplaceStep(from,to,slice,structure){Step.call(this),this.from=from,this.to=to,this.slice=slice,this.structure=!!structure}return Step&&(ReplaceStep.__proto__=Step),ReplaceStep.prototype=Object.create(Step&&Step.prototype),ReplaceStep.prototype.constructor=ReplaceStep,ReplaceStep.prototype.apply=function apply(doc){return this.structure&&contentBetween(doc,this.from,this.to)?StepResult.fail("Structure replace would overwrite content"):StepResult.fromReplace(doc,this.from,this.to,this.slice)},ReplaceStep.prototype.getMap=function getMap(){return new StepMap([this.from,this.to-this.from,this.slice.size])},ReplaceStep.prototype.invert=function invert(doc){return new ReplaceStep(this.from,this.from+this.slice.size,doc.slice(this.from,this.to))},ReplaceStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted?null:new ReplaceStep(from.pos,Math.max(from.pos,to.pos),this.slice)},ReplaceStep.prototype.merge=function merge(other){if(!(other instanceof ReplaceStep)||other.structure||this.structure)return null;if(this.from+this.slice.size!=other.from||this.slice.openEnd||other.slice.openStart){if(other.to!=this.from||this.slice.openStart||other.slice.openEnd)return null;var slice$1=this.slice.size+other.slice.size==0?Slice.empty:new Slice(other.slice.content.append(this.slice.content),other.slice.openStart,this.slice.openEnd);return new ReplaceStep(other.from,this.to,slice$1,this.structure)}var slice=this.slice.size+other.slice.size==0?Slice.empty:new Slice(this.slice.content.append(other.slice.content),this.slice.openStart,other.slice.openEnd);return new ReplaceStep(this.from,this.to+(other.to-other.from),slice,this.structure)},ReplaceStep.prototype.toJSON=function toJSON(){var json={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json},ReplaceStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ReplaceStep(json.from,json.to,Slice.fromJSON(schema,json.slice),!!json.structure)},ReplaceStep}(Step);Step.jsonID("replace",ReplaceStep);var ReplaceAroundStep=function(Step){function ReplaceAroundStep(from,to,gapFrom,gapTo,slice,insert,structure){Step.call(this),this.from=from,this.to=to,this.gapFrom=gapFrom,this.gapTo=gapTo,this.slice=slice,this.insert=insert,this.structure=!!structure}return Step&&(ReplaceAroundStep.__proto__=Step),ReplaceAroundStep.prototype=Object.create(Step&&Step.prototype),ReplaceAroundStep.prototype.constructor=ReplaceAroundStep,ReplaceAroundStep.prototype.apply=function apply(doc){if(this.structure&&(contentBetween(doc,this.from,this.gapFrom)||contentBetween(doc,this.gapTo,this.to)))return StepResult.fail("Structure gap-replace would overwrite content");var gap=doc.slice(this.gapFrom,this.gapTo);if(gap.openStart||gap.openEnd)return StepResult.fail("Gap is not a flat range");var inserted=this.slice.insertAt(this.insert,gap.content);return inserted?StepResult.fromReplace(doc,this.from,this.to,inserted):StepResult.fail("Content does not fit in gap")},ReplaceAroundStep.prototype.getMap=function getMap(){return new StepMap([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},ReplaceAroundStep.prototype.invert=function invert(doc){var gap=this.gapTo-this.gapFrom;return new ReplaceAroundStep(this.from,this.from+this.slice.size+gap,this.from+this.insert,this.from+this.insert+gap,doc.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},ReplaceAroundStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1),gapFrom=mapping.map(this.gapFrom,-1),gapTo=mapping.map(this.gapTo,1);return from.deleted&&to.deleted||gapFrom<from.pos||gapTo>to.pos?null:new ReplaceAroundStep(from.pos,to.pos,gapFrom,gapTo,this.slice,this.insert,this.structure)},ReplaceAroundStep.prototype.toJSON=function toJSON(){var json={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(json.slice=this.slice.toJSON()),this.structure&&(json.structure=!0),json},ReplaceAroundStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to||"number"!=typeof json.gapFrom||"number"!=typeof json.gapTo||"number"!=typeof json.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ReplaceAroundStep(json.from,json.to,json.gapFrom,json.gapTo,Slice.fromJSON(schema,json.slice),json.insert,!!json.structure)},ReplaceAroundStep}(Step);function contentBetween(doc,from,to){for(var $from=doc.resolve(from),dist=to-from,depth=$from.depth;dist>0&&depth>0&&$from.indexAfter(depth)==$from.node(depth).childCount;)depth--,dist--;if(dist>0)for(var next=$from.node(depth).maybeChild($from.indexAfter(depth));dist>0;){if(!next||next.isLeaf)return!0;next=next.firstChild,dist--}return!1}function canCut(node,start,end){return(0==start||node.canReplace(start,node.childCount))&&(end==node.childCount||node.canReplace(0,end))}function liftTarget(range){for(var content=range.parent.content.cutByIndex(range.startIndex,range.endIndex),depth=range.depth;;--depth){var node=range.$from.node(depth),index=range.$from.index(depth),endIndex=range.$to.indexAfter(depth);if(depth<range.depth&&node.canReplace(index,endIndex,content))return depth;if(0==depth||node.type.spec.isolating||!canCut(node,index,endIndex))break}}function findWrapping(range,nodeType,attrs,innerRange){void 0===innerRange&&(innerRange=range);var around=function findWrappingOutside(range,type){var parent=range.parent,startIndex=range.startIndex,endIndex=range.endIndex,around=parent.contentMatchAt(startIndex).findWrapping(type);if(!around)return null;var outer=around.length?around[0]:type;return parent.canReplaceWith(startIndex,endIndex,outer)?around:null}(range,nodeType),inner=around&&function findWrappingInside(range,type){var parent=range.parent,startIndex=range.startIndex,endIndex=range.endIndex,inner=parent.child(startIndex),inside=type.contentMatch.findWrapping(inner.type);if(!inside)return null;for(var innerMatch=(inside.length?inside[inside.length-1]:type).contentMatch,i=startIndex;innerMatch&&i<endIndex;i++)innerMatch=innerMatch.matchType(parent.child(i).type);if(!innerMatch||!innerMatch.validEnd)return null;return inside}(innerRange,nodeType);return inner?around.map(withAttrs).concat({type:nodeType,attrs}).concat(inner.map(withAttrs)):null}function withAttrs(type){return{type,attrs:null}}function canSplit(doc,pos,depth,typesAfter){void 0===depth&&(depth=1);var $pos=doc.resolve(pos),base=$pos.depth-depth,innerType=typesAfter&&typesAfter[typesAfter.length-1]||$pos.parent;if(base<0||$pos.parent.type.spec.isolating||!$pos.parent.canReplace($pos.index(),$pos.parent.childCount)||!innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(),$pos.parent.childCount)))return!1;for(var d=$pos.depth-1,i=depth-2;d>base;d--,i--){var node=$pos.node(d),index$1=$pos.index(d);if(node.type.spec.isolating)return!1;var rest=node.content.cutByIndex(index$1,node.childCount),after=typesAfter&&typesAfter[i]||node;if(after!=node&&(rest=rest.replaceChild(0,after.type.create(after.attrs))),!node.canReplace(index$1+1,node.childCount)||!after.type.validContent(rest))return!1}var index=$pos.indexAfter(base),baseType=typesAfter&&typesAfter[0];return $pos.node(base).canReplaceWith(index,index,baseType?baseType.type:$pos.node(base+1).type)}function canJoin(doc,pos){var $pos=doc.resolve(pos),index=$pos.index();return function joinable(a,b){return a&&b&&!a.isLeaf&&a.canAppend(b)}($pos.nodeBefore,$pos.nodeAfter)&&$pos.parent.canReplace(index,index+1)}function dropPoint(doc,pos,slice){var $pos=doc.resolve(pos);if(!slice.content.size)return pos;for(var content=slice.content,i=0;i<slice.openStart;i++)content=content.firstChild.content;for(var pass=1;pass<=(0==slice.openStart&&slice.size?2:1);pass++)for(var d=$pos.depth;d>=0;d--){var bias=d==$pos.depth?0:$pos.pos<=($pos.start(d+1)+$pos.end(d+1))/2?-1:1,insertPos=$pos.index(d)+(bias>0?1:0),parent=$pos.node(d),fits=!1;if(1==pass)fits=parent.canReplace(insertPos,insertPos,content);else{var wrapping=parent.contentMatchAt(insertPos).findWrapping(content.firstChild.type);fits=wrapping&&parent.canReplaceWith(insertPos,insertPos,wrapping[0])}if(fits)return 0==bias?$pos.pos:bias<0?$pos.before(d+1):$pos.after(d+1)}return null}function mapFragment(fragment,f,parent){for(var mapped=[],i=0;i<fragment.childCount;i++){var child=fragment.child(i);child.content.size&&(child=child.copy(mapFragment(child.content,f,child))),child.isInline&&(child=f(child,parent,i)),mapped.push(child)}return Fragment.fromArray(mapped)}Step.jsonID("replaceAround",ReplaceAroundStep),Transform.prototype.lift=function(range,target){for(var $from=range.$from,$to=range.$to,depth=range.depth,gapStart=$from.before(depth+1),gapEnd=$to.after(depth+1),start=gapStart,end=gapEnd,before=Fragment.empty,openStart=0,d=depth,splitting=!1;d>target;d--)splitting||$from.index(d)>0?(splitting=!0,before=Fragment.from($from.node(d).copy(before)),openStart++):start--;for(var after=Fragment.empty,openEnd=0,d$1=depth,splitting$1=!1;d$1>target;d$1--)splitting$1||$to.after(d$1+1)<$to.end(d$1)?(splitting$1=!0,after=Fragment.from($to.node(d$1).copy(after)),openEnd++):end++;return this.step(new ReplaceAroundStep(start,end,gapStart,gapEnd,new Slice(before.append(after),openStart,openEnd),before.size-openStart,!0))},Transform.prototype.wrap=function(range,wrappers){for(var content=Fragment.empty,i=wrappers.length-1;i>=0;i--)content=Fragment.from(wrappers[i].type.create(wrappers[i].attrs,content));var start=range.start,end=range.end;return this.step(new ReplaceAroundStep(start,end,start,end,new Slice(content,0,0),wrappers.length,!0))},Transform.prototype.setBlockType=function(from,to,type,attrs){var this$1=this;if(void 0===to&&(to=from),!type.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var mapFrom=this.steps.length;return this.doc.nodesBetween(from,to,(function(node,pos){if(node.isTextblock&&!node.hasMarkup(type,attrs)&&function canChangeType(doc,pos,type){var $pos=doc.resolve(pos),index=$pos.index();return $pos.parent.canReplaceWith(index,index+1,type)}(this$1.doc,this$1.mapping.slice(mapFrom).map(pos),type)){this$1.clearIncompatible(this$1.mapping.slice(mapFrom).map(pos,1),type);var mapping=this$1.mapping.slice(mapFrom),startM=mapping.map(pos,1),endM=mapping.map(pos+node.nodeSize,1);return this$1.step(new ReplaceAroundStep(startM,endM,startM+1,endM-1,new Slice(Fragment.from(type.create(attrs,null,node.marks)),0,0),1,!0)),!1}})),this},Transform.prototype.setNodeMarkup=function(pos,type,attrs,marks){var node=this.doc.nodeAt(pos);if(!node)throw new RangeError("No node at given position");type||(type=node.type);var newNode=type.create(attrs,null,marks||node.marks);if(node.isLeaf)return this.replaceWith(pos,pos+node.nodeSize,newNode);if(!type.validContent(node.content))throw new RangeError("Invalid content for node type "+type.name);return this.step(new ReplaceAroundStep(pos,pos+node.nodeSize,pos+1,pos+node.nodeSize-1,new Slice(Fragment.from(newNode),0,0),1,!0))},Transform.prototype.split=function(pos,depth,typesAfter){void 0===depth&&(depth=1);for(var $pos=this.doc.resolve(pos),before=Fragment.empty,after=Fragment.empty,d=$pos.depth,e=$pos.depth-depth,i=depth-1;d>e;d--,i--){before=Fragment.from($pos.node(d).copy(before));var typeAfter=typesAfter&&typesAfter[i];after=Fragment.from(typeAfter?typeAfter.type.create(typeAfter.attrs,after):$pos.node(d).copy(after))}return this.step(new ReplaceStep(pos,pos,new Slice(before.append(after),depth,depth),!0))},Transform.prototype.join=function(pos,depth){void 0===depth&&(depth=1);var step=new ReplaceStep(pos-depth,pos+depth,Slice.empty,!0);return this.step(step)};var AddMarkStep=function(Step){function AddMarkStep(from,to,mark){Step.call(this),this.from=from,this.to=to,this.mark=mark}return Step&&(AddMarkStep.__proto__=Step),AddMarkStep.prototype=Object.create(Step&&Step.prototype),AddMarkStep.prototype.constructor=AddMarkStep,AddMarkStep.prototype.apply=function apply(doc){var this$1=this,oldSlice=doc.slice(this.from,this.to),$from=doc.resolve(this.from),parent=$from.node($from.sharedDepth(this.to)),slice=new Slice(mapFragment(oldSlice.content,(function(node,parent){return node.isAtom&&parent.type.allowsMarkType(this$1.mark.type)?node.mark(this$1.mark.addToSet(node.marks)):node}),parent),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)},AddMarkStep.prototype.invert=function invert(){return new RemoveMarkStep(this.from,this.to,this.mark)},AddMarkStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new AddMarkStep(from.pos,to.pos,this.mark)},AddMarkStep.prototype.merge=function merge(other){if(other instanceof AddMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from)return new AddMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark)},AddMarkStep.prototype.toJSON=function toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},AddMarkStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new AddMarkStep(json.from,json.to,schema.markFromJSON(json.mark))},AddMarkStep}(Step);Step.jsonID("addMark",AddMarkStep);var RemoveMarkStep=function(Step){function RemoveMarkStep(from,to,mark){Step.call(this),this.from=from,this.to=to,this.mark=mark}return Step&&(RemoveMarkStep.__proto__=Step),RemoveMarkStep.prototype=Object.create(Step&&Step.prototype),RemoveMarkStep.prototype.constructor=RemoveMarkStep,RemoveMarkStep.prototype.apply=function apply(doc){var this$1=this,oldSlice=doc.slice(this.from,this.to),slice=new Slice(mapFragment(oldSlice.content,(function(node){return node.mark(this$1.mark.removeFromSet(node.marks))})),oldSlice.openStart,oldSlice.openEnd);return StepResult.fromReplace(doc,this.from,this.to,slice)},RemoveMarkStep.prototype.invert=function invert(){return new AddMarkStep(this.from,this.to,this.mark)},RemoveMarkStep.prototype.map=function map(mapping){var from=mapping.mapResult(this.from,1),to=mapping.mapResult(this.to,-1);return from.deleted&&to.deleted||from.pos>=to.pos?null:new RemoveMarkStep(from.pos,to.pos,this.mark)},RemoveMarkStep.prototype.merge=function merge(other){if(other instanceof RemoveMarkStep&&other.mark.eq(this.mark)&&this.from<=other.to&&this.to>=other.from)return new RemoveMarkStep(Math.min(this.from,other.from),Math.max(this.to,other.to),this.mark)},RemoveMarkStep.prototype.toJSON=function toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},RemoveMarkStep.fromJSON=function fromJSON(schema,json){if("number"!=typeof json.from||"number"!=typeof json.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new RemoveMarkStep(json.from,json.to,schema.markFromJSON(json.mark))},RemoveMarkStep}(Step);function fitsTrivially($from,$to,slice){return!slice.openStart&&!slice.openEnd&&$from.start()==$to.start()&&$from.parent.canReplace($from.index(),$to.index(),slice.content)}Step.jsonID("removeMark",RemoveMarkStep),Transform.prototype.addMark=function(from,to,mark){var this$1=this,removed=[],added=[],removing=null,adding=null;return this.doc.nodesBetween(from,to,(function(node,pos,parent){if(node.isInline){var marks=node.marks;if(!mark.isInSet(marks)&&parent.type.allowsMarkType(mark.type)){for(var start=Math.max(pos,from),end=Math.min(pos+node.nodeSize,to),newSet=mark.addToSet(marks),i=0;i<marks.length;i++)marks[i].isInSet(newSet)||(removing&&removing.to==start&&removing.mark.eq(marks[i])?removing.to=end:removed.push(removing=new RemoveMarkStep(start,end,marks[i])));adding&&adding.to==start?adding.to=end:added.push(adding=new AddMarkStep(start,end,mark))}}})),removed.forEach((function(s){return this$1.step(s)})),added.forEach((function(s){return this$1.step(s)})),this},Transform.prototype.removeMark=function(from,to,mark){var this$1=this;void 0===mark&&(mark=null);var matched=[],step=0;return this.doc.nodesBetween(from,to,(function(node,pos){if(node.isInline){step++;var toRemove=null;if(mark instanceof MarkType)for(var found,set=node.marks;found=mark.isInSet(set);)(toRemove||(toRemove=[])).push(found),set=found.removeFromSet(set);else mark?mark.isInSet(node.marks)&&(toRemove=[mark]):toRemove=node.marks;if(toRemove&&toRemove.length)for(var end=Math.min(pos+node.nodeSize,to),i=0;i<toRemove.length;i++){for(var style=toRemove[i],found$1=void 0,j=0;j<matched.length;j++){var m=matched[j];m.step==step-1&&style.eq(matched[j].style)&&(found$1=m)}found$1?(found$1.to=end,found$1.step=step):matched.push({style,from:Math.max(pos,from),to:end,step})}}})),matched.forEach((function(m){return this$1.step(new RemoveMarkStep(m.from,m.to,m.style))})),this},Transform.prototype.clearIncompatible=function(pos,parentType,match){void 0===match&&(match=parentType.contentMatch);for(var node=this.doc.nodeAt(pos),delSteps=[],cur=pos+1,i=0;i<node.childCount;i++){var child=node.child(i),end=cur+child.nodeSize,allowed=match.matchType(child.type,child.attrs);if(allowed){match=allowed;for(var j=0;j<child.marks.length;j++)parentType.allowsMarkType(child.marks[j].type)||this.step(new RemoveMarkStep(cur,end,child.marks[j]))}else delSteps.push(new ReplaceStep(cur,end,Slice.empty));cur=end}if(!match.validEnd){var fill=match.fillBefore(Fragment.empty,!0);this.replace(cur,cur,new Slice(fill,0,0))}for(var i$1=delSteps.length-1;i$1>=0;i$1--)this.step(delSteps[i$1]);return this},Transform.prototype.replace=function(from,to,slice){void 0===to&&(to=from),void 0===slice&&(slice=Slice.empty);var step=function replaceStep(doc,from,to,slice){if(void 0===to&&(to=from),void 0===slice&&(slice=Slice.empty),from==to&&!slice.size)return null;var $from=doc.resolve(from),$to=doc.resolve(to);return fitsTrivially($from,$to,slice)?new ReplaceStep(from,to,slice):new Fitter($from,$to,slice).fit()}(this.doc,from,to,slice);return step&&this.step(step),this},Transform.prototype.replaceWith=function(from,to,content){return this.replace(from,to,new Slice(Fragment.from(content),0,0))},Transform.prototype.delete=function(from,to){return this.replace(from,to,Slice.empty)},Transform.prototype.insert=function(pos,content){return this.replaceWith(pos,pos,content)};var Fitter=function Fitter($from,$to,slice){this.$to=$to,this.$from=$from,this.unplaced=slice,this.frontier=[];for(var i=0;i<=$from.depth;i++){var node=$from.node(i);this.frontier.push({type:node.type,match:node.contentMatchAt($from.indexAfter(i))})}this.placed=Fragment.empty;for(var i$1=$from.depth;i$1>0;i$1--)this.placed=Fragment.from($from.node(i$1).copy(this.placed))},prototypeAccessors$1$2={depth:{configurable:!0}};function dropFromFragment(fragment,depth,count){return 0==depth?fragment.cutByIndex(count):fragment.replaceChild(0,fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content,depth-1,count)))}function addToFragment(fragment,depth,content){return 0==depth?fragment.append(content):fragment.replaceChild(fragment.childCount-1,fragment.lastChild.copy(addToFragment(fragment.lastChild.content,depth-1,content)))}function contentAt(fragment,depth){for(var i=0;i<depth;i++)fragment=fragment.firstChild.content;return fragment}function closeNodeStart(node,openStart,openEnd){if(openStart<=0)return node;var frag=node.content;return openStart>1&&(frag=frag.replaceChild(0,closeNodeStart(frag.firstChild,openStart-1,1==frag.childCount?openEnd-1:0))),openStart>0&&(frag=node.type.contentMatch.fillBefore(frag).append(frag),openEnd<=0&&(frag=frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty,!0)))),node.copy(frag)}function contentAfterFits($to,depth,type,match,open){var node=$to.node(depth),index=open?$to.indexAfter(depth):$to.index(depth);if(index==node.childCount&&!type.compatibleContent(node.type))return null;var fit=match.fillBefore(node.content,!0,index);return fit&&!function invalidMarks(type,fragment,start){for(var i=start;i<fragment.childCount;i++)if(!type.allowsMarks(fragment.child(i).marks))return!0;return!1}(type,node.content,index)?fit:null}function closeFragment(fragment,depth,oldOpen,newOpen,parent){if(depth<oldOpen){var first=fragment.firstChild;fragment=fragment.replaceChild(0,first.copy(closeFragment(first.content,depth+1,oldOpen,newOpen,first)))}if(depth>newOpen){var match=parent.contentMatchAt(0),start=match.fillBefore(fragment).append(fragment);fragment=start.append(match.matchFragment(start).fillBefore(Fragment.empty,!0))}return fragment}function coveredDepths($from,$to){for(var result=[],d=Math.min($from.depth,$to.depth);d>=0;d--){var start=$from.start(d);if(start<$from.pos-($from.depth-d)||$to.end(d)>$to.pos+($to.depth-d)||$from.node(d).type.spec.isolating||$to.node(d).type.spec.isolating)break;(start==$to.start(d)||d==$from.depth&&d==$to.depth&&$from.parent.inlineContent&&$to.parent.inlineContent&&d&&$to.start(d-1)==start-1)&&result.push(d)}return result}prototypeAccessors$1$2.depth.get=function(){return this.frontier.length-1},Fitter.prototype.fit=function fit(){for(;this.unplaced.size;){var fit=this.findFittable();fit?this.placeNodes(fit):this.openMore()||this.dropNode()}var moveInline=this.mustMoveInline(),placedSize=this.placed.size-this.depth-this.$from.depth,$from=this.$from,$to=this.close(moveInline<0?this.$to:$from.doc.resolve(moveInline));if(!$to)return null;for(var content=this.placed,openStart=$from.depth,openEnd=$to.depth;openStart&&openEnd&&1==content.childCount;)content=content.firstChild.content,openStart--,openEnd--;var slice=new Slice(content,openStart,openEnd);return moveInline>-1?new ReplaceAroundStep($from.pos,moveInline,this.$to.pos,this.$to.end(),slice,placedSize):slice.size||$from.pos!=this.$to.pos?new ReplaceStep($from.pos,$to.pos,slice):void 0},Fitter.prototype.findFittable=function findFittable(){for(var pass=1;pass<=2;pass++)for(var sliceDepth=this.unplaced.openStart;sliceDepth>=0;sliceDepth--)for(var parent=void 0,first=(sliceDepth?(parent=contentAt(this.unplaced.content,sliceDepth-1).firstChild).content:this.unplaced.content).firstChild,frontierDepth=this.depth;frontierDepth>=0;frontierDepth--){var ref=this.frontier[frontierDepth],type=ref.type,match=ref.match,wrap=void 0,inject=void 0;if(1==pass&&(first?match.matchType(first.type)||(inject=match.fillBefore(Fragment.from(first),!1)):type.compatibleContent(parent.type)))return{sliceDepth,frontierDepth,parent,inject};if(2==pass&&first&&(wrap=match.findWrapping(first.type)))return{sliceDepth,frontierDepth,parent,wrap};if(parent&&match.matchType(parent.type))break}},Fitter.prototype.openMore=function openMore(){var ref=this.unplaced,content=ref.content,openStart=ref.openStart,openEnd=ref.openEnd,inner=contentAt(content,openStart);return!(!inner.childCount||inner.firstChild.isLeaf)&&(this.unplaced=new Slice(content,openStart+1,Math.max(openEnd,inner.size+openStart>=content.size-openEnd?openStart+1:0)),!0)},Fitter.prototype.dropNode=function dropNode(){var ref=this.unplaced,content=ref.content,openStart=ref.openStart,openEnd=ref.openEnd,inner=contentAt(content,openStart);if(inner.childCount<=1&&openStart>0){var openAtEnd=content.size-openStart<=openStart+inner.size;this.unplaced=new Slice(dropFromFragment(content,openStart-1,1),openStart-1,openAtEnd?openStart-1:openEnd)}else this.unplaced=new Slice(dropFromFragment(content,openStart,1),openStart,openEnd)},Fitter.prototype.placeNodes=function placeNodes(ref){for(var sliceDepth=ref.sliceDepth,frontierDepth=ref.frontierDepth,parent=ref.parent,inject=ref.inject,wrap=ref.wrap;this.depth>frontierDepth;)this.closeFrontierNode();if(wrap)for(var i=0;i<wrap.length;i++)this.openFrontierNode(wrap[i]);var slice=this.unplaced,fragment=parent?parent.content:slice.content,openStart=slice.openStart-sliceDepth,taken=0,add=[],ref$1=this.frontier[frontierDepth],match=ref$1.match,type=ref$1.type;if(inject){for(var i$1=0;i$1<inject.childCount;i$1++)add.push(inject.child(i$1));match=match.matchFragment(inject)}for(var openEndCount=fragment.size+sliceDepth-(slice.content.size-slice.openEnd);taken<fragment.childCount;){var next=fragment.child(taken),matches=match.matchType(next.type);if(!matches)break;(++taken>1||0==openStart||next.content.size)&&(match=matches,add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)),1==taken?openStart:0,taken==fragment.childCount?openEndCount:-1)))}var toEnd=taken==fragment.childCount;toEnd||(openEndCount=-1),this.placed=addToFragment(this.placed,frontierDepth,Fragment.from(add)),this.frontier[frontierDepth].match=match,toEnd&&openEndCount<0&&parent&&parent.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var i$2=0,cur=fragment;i$2<openEndCount;i$2++){var node=cur.lastChild;this.frontier.push({type:node.type,match:node.contentMatchAt(node.childCount)}),cur=node.content}this.unplaced=toEnd?0==sliceDepth?Slice.empty:new Slice(dropFromFragment(slice.content,sliceDepth-1,1),sliceDepth-1,openEndCount<0?slice.openEnd:sliceDepth-1):new Slice(dropFromFragment(slice.content,sliceDepth,taken),slice.openStart,slice.openEnd)},Fitter.prototype.mustMoveInline=function mustMoveInline(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var level,top=this.frontier[this.depth];if(!top.type.isTextblock||!contentAfterFits(this.$to,this.$to.depth,top.type,top.match,!1)||this.$to.depth==this.depth&&(level=this.findCloseLevel(this.$to))&&level.depth==this.depth)return-1;for(var depth=this.$to.depth,after=this.$to.after(depth);depth>1&&after==this.$to.end(--depth);)++after;return after},Fitter.prototype.findCloseLevel=function findCloseLevel($to){scan:for(var i=Math.min(this.depth,$to.depth);i>=0;i--){var ref=this.frontier[i],match=ref.match,type=ref.type,dropInner=i<$to.depth&&$to.end(i+1)==$to.pos+($to.depth-(i+1)),fit=contentAfterFits($to,i,type,match,dropInner);if(fit){for(var d=i-1;d>=0;d--){var ref$1=this.frontier[d],match$1=ref$1.match,matches=contentAfterFits($to,d,ref$1.type,match$1,!0);if(!matches||matches.childCount)continue scan}return{depth:i,fit,move:dropInner?$to.doc.resolve($to.after(i+1)):$to}}}},Fitter.prototype.close=function close($to){var close=this.findCloseLevel($to);if(!close)return null;for(;this.depth>close.depth;)this.closeFrontierNode();close.fit.childCount&&(this.placed=addToFragment(this.placed,close.depth,close.fit)),$to=close.move;for(var d=close.depth+1;d<=$to.depth;d++){var node=$to.node(d),add=node.type.contentMatch.fillBefore(node.content,!0,$to.index(d));this.openFrontierNode(node.type,node.attrs,add)}return $to},Fitter.prototype.openFrontierNode=function openFrontierNode(type,attrs,content){var top=this.frontier[this.depth];top.match=top.match.matchType(type),this.placed=addToFragment(this.placed,this.depth,Fragment.from(type.create(attrs,content))),this.frontier.push({type,match:type.contentMatch})},Fitter.prototype.closeFrontierNode=function closeFrontierNode(){var add=this.frontier.pop().match.fillBefore(Fragment.empty,!0);add.childCount&&(this.placed=addToFragment(this.placed,this.frontier.length,add))},Object.defineProperties(Fitter.prototype,prototypeAccessors$1$2),Transform.prototype.replaceRange=function(from,to,slice){if(!slice.size)return this.deleteRange(from,to);var $from=this.doc.resolve(from),$to=this.doc.resolve(to);if(fitsTrivially($from,$to,slice))return this.step(new ReplaceStep(from,to,slice));var targetDepths=coveredDepths($from,this.doc.resolve(to));0==targetDepths[targetDepths.length-1]&&targetDepths.pop();var preferredTarget=-($from.depth+1);targetDepths.unshift(preferredTarget);for(var d=$from.depth,pos=$from.pos-1;d>0;d--,pos--){var spec=$from.node(d).type.spec;if(spec.defining||spec.isolating)break;targetDepths.indexOf(d)>-1?preferredTarget=d:$from.before(d)==pos&&targetDepths.splice(1,0,-d)}for(var preferredTargetIndex=targetDepths.indexOf(preferredTarget),leftNodes=[],preferredDepth=slice.openStart,content=slice.content,i=0;;i++){var node=content.firstChild;if(leftNodes.push(node),i==slice.openStart)break;content=node.content}preferredDepth>0&&leftNodes[preferredDepth-1].type.spec.defining&&$from.node(preferredTargetIndex).type!=leftNodes[preferredDepth-1].type?preferredDepth-=1:preferredDepth>=2&&leftNodes[preferredDepth-1].isTextblock&&leftNodes[preferredDepth-2].type.spec.defining&&$from.node(preferredTargetIndex).type!=leftNodes[preferredDepth-2].type&&(preferredDepth-=2);for(var j=slice.openStart;j>=0;j--){var openDepth=(j+preferredDepth+1)%(slice.openStart+1),insert=leftNodes[openDepth];if(insert)for(var i$1=0;i$1<targetDepths.length;i$1++){var targetDepth=targetDepths[(i$1+preferredTargetIndex)%targetDepths.length],expand=!0;targetDepth<0&&(expand=!1,targetDepth=-targetDepth);var parent=$from.node(targetDepth-1),index=$from.index(targetDepth-1);if(parent.canReplaceWith(index,index,insert.type,insert.marks))return this.replace($from.before(targetDepth),expand?$to.after(targetDepth):to,new Slice(closeFragment(slice.content,0,slice.openStart,openDepth),openDepth,slice.openEnd))}}for(var startSteps=this.steps.length,i$2=targetDepths.length-1;i$2>=0&&(this.replace(from,to,slice),!(this.steps.length>startSteps));i$2--){var depth=targetDepths[i$2];depth<0||(from=$from.before(depth),to=$to.after(depth))}return this},Transform.prototype.replaceRangeWith=function(from,to,node){if(!node.isInline&&from==to&&this.doc.resolve(from).parent.content.size){var point=function insertPoint(doc,pos,nodeType){var $pos=doc.resolve(pos);if($pos.parent.canReplaceWith($pos.index(),$pos.index(),nodeType))return pos;if(0==$pos.parentOffset)for(var d=$pos.depth-1;d>=0;d--){var index=$pos.index(d);if($pos.node(d).canReplaceWith(index,index,nodeType))return $pos.before(d+1);if(index>0)return null}if($pos.parentOffset==$pos.parent.content.size)for(var d$1=$pos.depth-1;d$1>=0;d$1--){var index$1=$pos.indexAfter(d$1);if($pos.node(d$1).canReplaceWith(index$1,index$1,nodeType))return $pos.after(d$1+1);if(index$1<$pos.node(d$1).childCount)return null}}(this.doc,from,node.type);null!=point&&(from=to=point)}return this.replaceRange(from,to,new Slice(Fragment.from(node),0,0))},Transform.prototype.deleteRange=function(from,to){for(var $from=this.doc.resolve(from),$to=this.doc.resolve(to),covered=coveredDepths($from,$to),i=0;i<covered.length;i++){var depth=covered[i],last=i==covered.length-1;if(last&&0==depth||$from.node(depth).type.contentMatch.validEnd)return this.delete($from.start(depth),$to.end(depth));if(depth>0&&(last||$from.node(depth-1).canReplace($from.index(depth-1),$to.indexAfter(depth-1))))return this.delete($from.before(depth),$to.after(depth))}for(var d=1;d<=$from.depth&&d<=$to.depth;d++)if(from-$from.start(d)==$from.depth-d&&to>$from.end(d)&&$to.end(d)-to!=$to.depth-d)return this.delete($from.before(d),to);return this.delete(from,to)};var classesById=Object.create(null),Selection=function Selection($anchor,$head,ranges){this.ranges=ranges||[new SelectionRange($anchor.min($head),$anchor.max($head))],this.$anchor=$anchor,this.$head=$head},prototypeAccessors$3={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};prototypeAccessors$3.anchor.get=function(){return this.$anchor.pos},prototypeAccessors$3.head.get=function(){return this.$head.pos},prototypeAccessors$3.from.get=function(){return this.$from.pos},prototypeAccessors$3.to.get=function(){return this.$to.pos},prototypeAccessors$3.$from.get=function(){return this.ranges[0].$from},prototypeAccessors$3.$to.get=function(){return this.ranges[0].$to},prototypeAccessors$3.empty.get=function(){for(var ranges=this.ranges,i=0;i<ranges.length;i++)if(ranges[i].$from.pos!=ranges[i].$to.pos)return!1;return!0},Selection.prototype.content=function content(){return this.$from.node(0).slice(this.from,this.to,!0)},Selection.prototype.replace=function replace(tr,content){void 0===content&&(content=Slice.empty);for(var lastNode=content.content.lastChild,lastParent=null,i=0;i<content.openEnd;i++)lastParent=lastNode,lastNode=lastNode.lastChild;for(var mapFrom=tr.steps.length,ranges=this.ranges,i$1=0;i$1<ranges.length;i$1++){var ref=ranges[i$1],$from=ref.$from,$to=ref.$to,mapping=tr.mapping.slice(mapFrom);tr.replaceRange(mapping.map($from.pos),mapping.map($to.pos),i$1?Slice.empty:content),0==i$1&&selectionToInsertionEnd$1(tr,mapFrom,(lastNode?lastNode.isInline:lastParent&&lastParent.isTextblock)?-1:1)}},Selection.prototype.replaceWith=function replaceWith(tr,node){for(var mapFrom=tr.steps.length,ranges=this.ranges,i=0;i<ranges.length;i++){var ref=ranges[i],$from=ref.$from,$to=ref.$to,mapping=tr.mapping.slice(mapFrom),from=mapping.map($from.pos),to=mapping.map($to.pos);i?tr.deleteRange(from,to):(tr.replaceRangeWith(from,to,node),selectionToInsertionEnd$1(tr,mapFrom,node.isInline?-1:1))}},Selection.findFrom=function findFrom($pos,dir,textOnly){var inner=$pos.parent.inlineContent?new TextSelection($pos):findSelectionIn($pos.node(0),$pos.parent,$pos.pos,$pos.index(),dir,textOnly);if(inner)return inner;for(var depth=$pos.depth-1;depth>=0;depth--){var found=dir<0?findSelectionIn($pos.node(0),$pos.node(depth),$pos.before(depth+1),$pos.index(depth),dir,textOnly):findSelectionIn($pos.node(0),$pos.node(depth),$pos.after(depth+1),$pos.index(depth)+1,dir,textOnly);if(found)return found}},Selection.near=function near($pos,bias){return void 0===bias&&(bias=1),this.findFrom($pos,bias)||this.findFrom($pos,-bias)||new AllSelection($pos.node(0))},Selection.atStart=function atStart(doc){return findSelectionIn(doc,doc,0,0,1)||new AllSelection(doc)},Selection.atEnd=function atEnd(doc){return findSelectionIn(doc,doc,doc.content.size,doc.childCount,-1)||new AllSelection(doc)},Selection.fromJSON=function fromJSON(doc,json){if(!json||!json.type)throw new RangeError("Invalid input for Selection.fromJSON");var cls=classesById[json.type];if(!cls)throw new RangeError("No selection type "+json.type+" defined");return cls.fromJSON(doc,json)},Selection.jsonID=function jsonID(id,selectionClass){if(id in classesById)throw new RangeError("Duplicate use of selection JSON ID "+id);return classesById[id]=selectionClass,selectionClass.prototype.jsonID=id,selectionClass},Selection.prototype.getBookmark=function getBookmark(){return TextSelection.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Selection.prototype,prototypeAccessors$3),Selection.prototype.visible=!0;var SelectionRange=function SelectionRange($from,$to){this.$from=$from,this.$to=$to},TextSelection=function(Selection){function TextSelection($anchor,$head){void 0===$head&&($head=$anchor),Selection.call(this,$anchor,$head)}Selection&&(TextSelection.__proto__=Selection),TextSelection.prototype=Object.create(Selection&&Selection.prototype),TextSelection.prototype.constructor=TextSelection;var prototypeAccessors$1={$cursor:{configurable:!0}};return prototypeAccessors$1.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},TextSelection.prototype.map=function map(doc,mapping){var $head=doc.resolve(mapping.map(this.head));if(!$head.parent.inlineContent)return Selection.near($head);var $anchor=doc.resolve(mapping.map(this.anchor));return new TextSelection($anchor.parent.inlineContent?$anchor:$head,$head)},TextSelection.prototype.replace=function replace(tr,content){if(void 0===content&&(content=Slice.empty),Selection.prototype.replace.call(this,tr,content),content==Slice.empty){var marks=this.$from.marksAcross(this.$to);marks&&tr.ensureMarks(marks)}},TextSelection.prototype.eq=function eq(other){return other instanceof TextSelection&&other.anchor==this.anchor&&other.head==this.head},TextSelection.prototype.getBookmark=function getBookmark(){return new TextBookmark(this.anchor,this.head)},TextSelection.prototype.toJSON=function toJSON(){return{type:"text",anchor:this.anchor,head:this.head}},TextSelection.fromJSON=function fromJSON(doc,json){if("number"!=typeof json.anchor||"number"!=typeof json.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new TextSelection(doc.resolve(json.anchor),doc.resolve(json.head))},TextSelection.create=function create(doc,anchor,head){void 0===head&&(head=anchor);var $anchor=doc.resolve(anchor);return new this($anchor,head==anchor?$anchor:doc.resolve(head))},TextSelection.between=function between($anchor,$head,bias){var dPos=$anchor.pos-$head.pos;if(bias&&!dPos||(bias=dPos>=0?1:-1),!$head.parent.inlineContent){var found=Selection.findFrom($head,bias,!0)||Selection.findFrom($head,-bias,!0);if(!found)return Selection.near($head,bias);$head=found.$head}return $anchor.parent.inlineContent||(0==dPos||($anchor=(Selection.findFrom($anchor,-bias,!0)||Selection.findFrom($anchor,bias,!0)).$anchor).pos<$head.pos!=dPos<0)&&($anchor=$head),new TextSelection($anchor,$head)},Object.defineProperties(TextSelection.prototype,prototypeAccessors$1),TextSelection}(Selection);Selection.jsonID("text",TextSelection);var TextBookmark=function TextBookmark(anchor,head){this.anchor=anchor,this.head=head};TextBookmark.prototype.map=function map(mapping){return new TextBookmark(mapping.map(this.anchor),mapping.map(this.head))},TextBookmark.prototype.resolve=function resolve(doc){return TextSelection.between(doc.resolve(this.anchor),doc.resolve(this.head))};var NodeSelection=function(Selection){function NodeSelection($pos){var node=$pos.nodeAfter,$end=$pos.node(0).resolve($pos.pos+node.nodeSize);Selection.call(this,$pos,$end),this.node=node}return Selection&&(NodeSelection.__proto__=Selection),NodeSelection.prototype=Object.create(Selection&&Selection.prototype),NodeSelection.prototype.constructor=NodeSelection,NodeSelection.prototype.map=function map(doc,mapping){var ref=mapping.mapResult(this.anchor),deleted=ref.deleted,pos=ref.pos,$pos=doc.resolve(pos);return deleted?Selection.near($pos):new NodeSelection($pos)},NodeSelection.prototype.content=function content(){return new Slice(Fragment.from(this.node),0,0)},NodeSelection.prototype.eq=function eq(other){return other instanceof NodeSelection&&other.anchor==this.anchor},NodeSelection.prototype.toJSON=function toJSON(){return{type:"node",anchor:this.anchor}},NodeSelection.prototype.getBookmark=function getBookmark(){return new NodeBookmark(this.anchor)},NodeSelection.fromJSON=function fromJSON(doc,json){if("number"!=typeof json.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new NodeSelection(doc.resolve(json.anchor))},NodeSelection.create=function create(doc,from){return new this(doc.resolve(from))},NodeSelection.isSelectable=function isSelectable(node){return!node.isText&&!1!==node.type.spec.selectable},NodeSelection}(Selection);NodeSelection.prototype.visible=!1,Selection.jsonID("node",NodeSelection);var NodeBookmark=function NodeBookmark(anchor){this.anchor=anchor};NodeBookmark.prototype.map=function map(mapping){var ref=mapping.mapResult(this.anchor),deleted=ref.deleted,pos=ref.pos;return deleted?new TextBookmark(pos,pos):new NodeBookmark(pos)},NodeBookmark.prototype.resolve=function resolve(doc){var $pos=doc.resolve(this.anchor),node=$pos.nodeAfter;return node&&NodeSelection.isSelectable(node)?new NodeSelection($pos):Selection.near($pos)};var AllSelection=function(Selection){function AllSelection(doc){Selection.call(this,doc.resolve(0),doc.resolve(doc.content.size))}return Selection&&(AllSelection.__proto__=Selection),AllSelection.prototype=Object.create(Selection&&Selection.prototype),AllSelection.prototype.constructor=AllSelection,AllSelection.prototype.replace=function replace(tr,content){if(void 0===content&&(content=Slice.empty),content==Slice.empty){tr.delete(0,tr.doc.content.size);var sel=Selection.atStart(tr.doc);sel.eq(tr.selection)||tr.setSelection(sel)}else Selection.prototype.replace.call(this,tr,content)},AllSelection.prototype.toJSON=function toJSON(){return{type:"all"}},AllSelection.fromJSON=function fromJSON(doc){return new AllSelection(doc)},AllSelection.prototype.map=function map(doc){return new AllSelection(doc)},AllSelection.prototype.eq=function eq(other){return other instanceof AllSelection},AllSelection.prototype.getBookmark=function getBookmark(){return AllBookmark},AllSelection}(Selection);Selection.jsonID("all",AllSelection);var AllBookmark={map:function map(){return this},resolve:function resolve(doc){return new AllSelection(doc)}};function findSelectionIn(doc,node,pos,index,dir,text){if(node.inlineContent)return TextSelection.create(doc,pos);for(var i=index-(dir>0?0:1);dir>0?i<node.childCount:i>=0;i+=dir){var child=node.child(i);if(child.isAtom){if(!text&&NodeSelection.isSelectable(child))return NodeSelection.create(doc,pos-(dir<0?child.nodeSize:0))}else{var inner=findSelectionIn(doc,child,pos+dir,dir<0?child.childCount:0,dir,text);if(inner)return inner}pos+=child.nodeSize*dir}}function selectionToInsertionEnd$1(tr,startLen,bias){var last=tr.steps.length-1;if(!(last<startLen)){var end,step=tr.steps[last];if(step instanceof ReplaceStep||step instanceof ReplaceAroundStep)tr.mapping.maps[last].forEach((function(_from,_to,_newFrom,newTo){null==end&&(end=newTo)})),tr.setSelection(Selection.near(tr.doc.resolve(end),bias))}}var Transaction=function(Transform){function Transaction(state){Transform.call(this,state.doc),this.time=Date.now(),this.curSelection=state.selection,this.curSelectionFor=0,this.storedMarks=state.storedMarks,this.updated=0,this.meta=Object.create(null)}Transform&&(Transaction.__proto__=Transform),Transaction.prototype=Object.create(Transform&&Transform.prototype),Transaction.prototype.constructor=Transaction;var prototypeAccessors={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return prototypeAccessors.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},Transaction.prototype.setSelection=function setSelection(selection){if(selection.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=selection,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},prototypeAccessors.selectionSet.get=function(){return(1&this.updated)>0},Transaction.prototype.setStoredMarks=function setStoredMarks(marks){return this.storedMarks=marks,this.updated|=2,this},Transaction.prototype.ensureMarks=function ensureMarks(marks){return Mark$1.sameSet(this.storedMarks||this.selection.$from.marks(),marks)||this.setStoredMarks(marks),this},Transaction.prototype.addStoredMark=function addStoredMark(mark){return this.ensureMarks(mark.addToSet(this.storedMarks||this.selection.$head.marks()))},Transaction.prototype.removeStoredMark=function removeStoredMark(mark){return this.ensureMarks(mark.removeFromSet(this.storedMarks||this.selection.$head.marks()))},prototypeAccessors.storedMarksSet.get=function(){return(2&this.updated)>0},Transaction.prototype.addStep=function addStep(step,doc){Transform.prototype.addStep.call(this,step,doc),this.updated=-3&this.updated,this.storedMarks=null},Transaction.prototype.setTime=function setTime(time){return this.time=time,this},Transaction.prototype.replaceSelection=function replaceSelection(slice){return this.selection.replace(this,slice),this},Transaction.prototype.replaceSelectionWith=function replaceSelectionWith(node,inheritMarks){var selection=this.selection;return!1!==inheritMarks&&(node=node.mark(this.storedMarks||(selection.empty?selection.$from.marks():selection.$from.marksAcross(selection.$to)||Mark$1.none))),selection.replaceWith(this,node),this},Transaction.prototype.deleteSelection=function deleteSelection(){return this.selection.replace(this),this},Transaction.prototype.insertText=function insertText(text,from,to){void 0===to&&(to=from);var schema=this.doc.type.schema;if(null==from)return text?this.replaceSelectionWith(schema.text(text),!0):this.deleteSelection();if(!text)return this.deleteRange(from,to);var marks=this.storedMarks;if(!marks){var $from=this.doc.resolve(from);marks=to==from?$from.marks():$from.marksAcross(this.doc.resolve(to))}return this.replaceRangeWith(from,to,schema.text(text,marks)),this.selection.empty||this.setSelection(Selection.near(this.selection.$to)),this},Transaction.prototype.setMeta=function setMeta(key,value){return this.meta["string"==typeof key?key:key.key]=value,this},Transaction.prototype.getMeta=function getMeta(key){return this.meta["string"==typeof key?key:key.key]},prototypeAccessors.isGeneric.get=function(){for(var _ in this.meta)return!1;return!0},Transaction.prototype.scrollIntoView=function scrollIntoView(){return this.updated|=4,this},prototypeAccessors.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(Transaction.prototype,prototypeAccessors),Transaction}(Transform);function bind(f,self){return self&&f?f.bind(self):f}var FieldDesc=function FieldDesc(name,desc,self){this.name=name,this.init=bind(desc.init,self),this.apply=bind(desc.apply,self)},baseFields=[new FieldDesc("doc",{init:function init(config){return config.doc||config.schema.topNodeType.createAndFill()},apply:function apply(tr){return tr.doc}}),new FieldDesc("selection",{init:function init(config,instance){return config.selection||Selection.atStart(instance.doc)},apply:function apply(tr){return tr.selection}}),new FieldDesc("storedMarks",{init:function init(config){return config.storedMarks||null},apply:function apply(tr,_marks,_old,state){return state.selection.$cursor?tr.storedMarks:null}}),new FieldDesc("scrollToSelection",{init:function init(){return 0},apply:function apply(tr,prev){return tr.scrolledIntoView?prev+1:prev}})],Configuration=function Configuration(schema,plugins){var this$1=this;this.schema=schema,this.fields=baseFields.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),plugins&&plugins.forEach((function(plugin){if(this$1.pluginsByKey[plugin.key])throw new RangeError("Adding different instances of a keyed plugin ("+plugin.key+")");this$1.plugins.push(plugin),this$1.pluginsByKey[plugin.key]=plugin,plugin.spec.state&&this$1.fields.push(new FieldDesc(plugin.key,plugin.spec.state,plugin))}))},EditorState=function EditorState(config){this.config=config},prototypeAccessors$1$1={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};prototypeAccessors$1$1.schema.get=function(){return this.config.schema},prototypeAccessors$1$1.plugins.get=function(){return this.config.plugins},EditorState.prototype.apply=function apply(tr){return this.applyTransaction(tr).state},EditorState.prototype.filterTransaction=function filterTransaction(tr,ignore){void 0===ignore&&(ignore=-1);for(var i=0;i<this.config.plugins.length;i++)if(i!=ignore){var plugin=this.config.plugins[i];if(plugin.spec.filterTransaction&&!plugin.spec.filterTransaction.call(plugin,tr,this))return!1}return!0},EditorState.prototype.applyTransaction=function applyTransaction(rootTr){if(!this.filterTransaction(rootTr))return{state:this,transactions:[]};for(var trs=[rootTr],newState=this.applyInner(rootTr),seen=null;;){for(var haveNew=!1,i=0;i<this.config.plugins.length;i++){var plugin=this.config.plugins[i];if(plugin.spec.appendTransaction){var n=seen?seen[i].n:0,oldState=seen?seen[i].state:this,tr=n<trs.length&&plugin.spec.appendTransaction.call(plugin,n?trs.slice(n):trs,oldState,newState);if(tr&&newState.filterTransaction(tr,i)){if(tr.setMeta("appendedTransaction",rootTr),!seen){seen=[];for(var j=0;j<this.config.plugins.length;j++)seen.push(j<i?{state:newState,n:trs.length}:{state:this,n:0})}trs.push(tr),newState=newState.applyInner(tr),haveNew=!0}seen&&(seen[i]={state:newState,n:trs.length})}}if(!haveNew)return{state:newState,transactions:trs}}},EditorState.prototype.applyInner=function applyInner(tr){if(!tr.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var newInstance=new EditorState(this.config),fields=this.config.fields,i=0;i<fields.length;i++){var field=fields[i];newInstance[field.name]=field.apply(tr,this[field.name],this,newInstance)}for(var i$1=0;i$1<applyListeners.length;i$1++)applyListeners[i$1](this,tr,newInstance);return newInstance},prototypeAccessors$1$1.tr.get=function(){return new Transaction(this)},EditorState.create=function create(config){for(var $config=new Configuration(config.doc?config.doc.type.schema:config.schema,config.plugins),instance=new EditorState($config),i=0;i<$config.fields.length;i++)instance[$config.fields[i].name]=$config.fields[i].init(config,instance);return instance},EditorState.prototype.reconfigure=function reconfigure(config){for(var $config=new Configuration(this.schema,config.plugins),fields=$config.fields,instance=new EditorState($config),i=0;i<fields.length;i++){var name=fields[i].name;instance[name]=this.hasOwnProperty(name)?this[name]:fields[i].init(config,instance)}return instance},EditorState.prototype.toJSON=function toJSON(pluginFields){var result={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(result.storedMarks=this.storedMarks.map((function(m){return m.toJSON()}))),pluginFields&&"object"==typeof pluginFields)for(var prop in pluginFields){if("doc"==prop||"selection"==prop)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var plugin=pluginFields[prop],state=plugin.spec.state;state&&state.toJSON&&(result[prop]=state.toJSON.call(plugin,this[plugin.key]))}return result},EditorState.fromJSON=function fromJSON(config,json,pluginFields){if(!json)throw new RangeError("Invalid input for EditorState.fromJSON");if(!config.schema)throw new RangeError("Required config field 'schema' missing");var $config=new Configuration(config.schema,config.plugins),instance=new EditorState($config);return $config.fields.forEach((function(field){if("doc"==field.name)instance.doc=Node$1.fromJSON(config.schema,json.doc);else if("selection"==field.name)instance.selection=Selection.fromJSON(instance.doc,json.selection);else if("storedMarks"==field.name)json.storedMarks&&(instance.storedMarks=json.storedMarks.map(config.schema.markFromJSON));else{if(pluginFields)for(var prop in pluginFields){var plugin=pluginFields[prop],state=plugin.spec.state;if(plugin.key==field.name&&state&&state.fromJSON&&Object.prototype.hasOwnProperty.call(json,prop))return void(instance[field.name]=state.fromJSON.call(plugin,config,json[prop],instance))}instance[field.name]=field.init(config,instance)}})),instance},EditorState.addApplyListener=function addApplyListener(f){applyListeners.push(f)},EditorState.removeApplyListener=function removeApplyListener(f){var found=applyListeners.indexOf(f);found>-1&&applyListeners.splice(found,1)},Object.defineProperties(EditorState.prototype,prototypeAccessors$1$1);var applyListeners=[];function bindProps(obj,self,target){for(var prop in obj){var val=obj[prop];val instanceof Function?val=val.bind(self):"handleDOMEvents"==prop&&(val=bindProps(val,self,{})),target[prop]=val}return target}var Plugin=function Plugin(spec){this.props={},spec.props&&bindProps(spec.props,this,this.props),this.spec=spec,this.key=spec.key?spec.key.key:createKey("plugin")};Plugin.prototype.getState=function getState(state){return state[this.key]};var keys=Object.create(null);function createKey(name){return name in keys?name+"$"+ ++keys[name]:(keys[name]=0,name+"$")}var PluginKey=function PluginKey(name){void 0===name&&(name="key"),this.key=createKey(name)};function deleteSelection$2(state,dispatch){return!state.selection.empty&&(dispatch&&dispatch(state.tr.deleteSelection().scrollIntoView()),!0)}function joinBackward$2(state,dispatch,view){var $cursor=state.selection.$cursor;if(!$cursor||(view?!view.endOfTextblock("backward",state):$cursor.parentOffset>0))return!1;var $cut=findCutBefore($cursor);if(!$cut){var range=$cursor.blockRange(),target=range&&liftTarget(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}var before=$cut.nodeBefore;if(!before.type.spec.isolating&&deleteBarrier(state,$cut,dispatch))return!0;if(0==$cursor.parent.content.size&&(textblockAt(before,"end")||NodeSelection.isSelectable(before))){if(dispatch){var tr=state.tr.deleteRange($cursor.before(),$cursor.after());tr.setSelection(textblockAt(before,"end")?Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos,-1)),-1):NodeSelection.create(tr.doc,$cut.pos-before.nodeSize)),dispatch(tr.scrollIntoView())}return!0}return!(!before.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos-before.nodeSize,$cut.pos).scrollIntoView()),!0)}function textblockAt(node,side,only){for(;node;node="start"==side?node.firstChild:node.lastChild){if(node.isTextblock)return!0;if(only&&1!=node.childCount)return!1}return!1}function selectNodeBackward$2(state,dispatch,view){var ref=state.selection,$head=ref.$head,$cut=$head;if(!ref.empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("backward",state):$head.parentOffset>0)return!1;$cut=findCutBefore($head)}var node=$cut&&$cut.nodeBefore;return!(!node||!NodeSelection.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(NodeSelection.create(state.doc,$cut.pos-node.nodeSize)).scrollIntoView()),!0)}function findCutBefore($pos){if(!$pos.parent.type.spec.isolating)for(var i=$pos.depth-1;i>=0;i--){if($pos.index(i)>0)return $pos.doc.resolve($pos.before(i+1));if($pos.node(i).type.spec.isolating)break}return null}function joinForward$2(state,dispatch,view){var $cursor=state.selection.$cursor;if(!$cursor||(view?!view.endOfTextblock("forward",state):$cursor.parentOffset<$cursor.parent.content.size))return!1;var $cut=findCutAfter($cursor);if(!$cut)return!1;var after=$cut.nodeAfter;if(deleteBarrier(state,$cut,dispatch))return!0;if(0==$cursor.parent.content.size&&(textblockAt(after,"start")||NodeSelection.isSelectable(after))){if(dispatch){var tr=state.tr.deleteRange($cursor.before(),$cursor.after());tr.setSelection(textblockAt(after,"start")?Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)),1):NodeSelection.create(tr.doc,tr.mapping.map($cut.pos))),dispatch(tr.scrollIntoView())}return!0}return!(!after.isAtom||$cut.depth!=$cursor.depth-1)&&(dispatch&&dispatch(state.tr.delete($cut.pos,$cut.pos+after.nodeSize).scrollIntoView()),!0)}function selectNodeForward$2(state,dispatch,view){var ref=state.selection,$head=ref.$head,$cut=$head;if(!ref.empty)return!1;if($head.parent.isTextblock){if(view?!view.endOfTextblock("forward",state):$head.parentOffset<$head.parent.content.size)return!1;$cut=findCutAfter($head)}var node=$cut&&$cut.nodeAfter;return!(!node||!NodeSelection.isSelectable(node))&&(dispatch&&dispatch(state.tr.setSelection(NodeSelection.create(state.doc,$cut.pos)).scrollIntoView()),!0)}function findCutAfter($pos){if(!$pos.parent.type.spec.isolating)for(var i=$pos.depth-1;i>=0;i--){var parent=$pos.node(i);if($pos.index(i)+1<parent.childCount)return $pos.doc.resolve($pos.after(i+1));if(parent.type.spec.isolating)break}return null}function lift$2(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to),target=range&&liftTarget(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}function newlineInCode$2(state,dispatch){var ref=state.selection,$head=ref.$head,$anchor=ref.$anchor;return!(!$head.parent.type.spec.code||!$head.sameParent($anchor))&&(dispatch&&dispatch(state.tr.insertText("\n").scrollIntoView()),!0)}function defaultBlockAt(match){for(var i=0;i<match.edgeCount;i++){var type=match.edge(i).type;if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}function exitCode$2(state,dispatch){var ref=state.selection,$head=ref.$head,$anchor=ref.$anchor;if(!$head.parent.type.spec.code||!$head.sameParent($anchor))return!1;var above=$head.node(-1),after=$head.indexAfter(-1),type=defaultBlockAt(above.contentMatchAt(after));if(!above.canReplaceWith(after,after,type))return!1;if(dispatch){var pos=$head.after(),tr=state.tr.replaceWith(pos,pos,type.createAndFill());tr.setSelection(Selection.near(tr.doc.resolve(pos),1)),dispatch(tr.scrollIntoView())}return!0}function createParagraphNear$2(state,dispatch){var sel=state.selection,$from=sel.$from,$to=sel.$to;if(sel instanceof AllSelection||$from.parent.inlineContent||$to.parent.inlineContent)return!1;var type=defaultBlockAt($to.parent.contentMatchAt($to.indexAfter()));if(!type||!type.isTextblock)return!1;if(dispatch){var side=(!$from.parentOffset&&$to.index()<$to.parent.childCount?$from:$to).pos,tr=state.tr.insert(side,type.createAndFill());tr.setSelection(TextSelection.create(tr.doc,side+1)),dispatch(tr.scrollIntoView())}return!0}function liftEmptyBlock$2(state,dispatch){var $cursor=state.selection.$cursor;if(!$cursor||$cursor.parent.content.size)return!1;if($cursor.depth>1&&$cursor.after()!=$cursor.end(-1)){var before=$cursor.before();if(canSplit(state.doc,before))return dispatch&&dispatch(state.tr.split(before).scrollIntoView()),!0}var range=$cursor.blockRange(),target=range&&liftTarget(range);return null!=target&&(dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0)}function deleteBarrier(state,$cut,dispatch){var conn,match,before=$cut.nodeBefore,after=$cut.nodeAfter;if(before.type.spec.isolating||after.type.spec.isolating)return!1;if(function joinMaybeClear(state,$pos,dispatch){var before=$pos.nodeBefore,after=$pos.nodeAfter,index=$pos.index();return!(!(before&&after&&before.type.compatibleContent(after.type))||(!before.content.size&&$pos.parent.canReplace(index-1,index)?(dispatch&&dispatch(state.tr.delete($pos.pos-before.nodeSize,$pos.pos).scrollIntoView()),0):!$pos.parent.canReplace(index,index+1)||!after.isTextblock&&!canJoin(state.doc,$pos.pos)||(dispatch&&dispatch(state.tr.clearIncompatible($pos.pos,before.type,before.contentMatchAt(before.childCount)).join($pos.pos).scrollIntoView()),0)))}(state,$cut,dispatch))return!0;var canDelAfter=$cut.parent.canReplace($cut.index(),$cut.index()+1);if(canDelAfter&&(conn=(match=before.contentMatchAt(before.childCount)).findWrapping(after.type))&&match.matchType(conn[0]||after.type).validEnd){if(dispatch){for(var end=$cut.pos+after.nodeSize,wrap=Fragment.empty,i=conn.length-1;i>=0;i--)wrap=Fragment.from(conn[i].create(null,wrap));wrap=Fragment.from(before.copy(wrap));var tr=state.tr.step(new ReplaceAroundStep($cut.pos-1,end,$cut.pos,end,new Slice(wrap,1,0),conn.length,!0)),joinAt=end+2*conn.length;canJoin(tr.doc,joinAt)&&tr.join(joinAt),dispatch(tr.scrollIntoView())}return!0}var selAfter=Selection.findFrom($cut,1),range=selAfter&&selAfter.$from.blockRange(selAfter.$to),target=range&&liftTarget(range);if(null!=target&&target>=$cut.depth)return dispatch&&dispatch(state.tr.lift(range,target).scrollIntoView()),!0;if(canDelAfter&&textblockAt(after,"start",!0)&&textblockAt(before,"end")){for(var at=before,wrap$1=[];wrap$1.push(at),!at.isTextblock;)at=at.lastChild;for(var afterText=after,afterDepth=1;!afterText.isTextblock;afterText=afterText.firstChild)afterDepth++;if(at.canReplace(at.childCount,at.childCount,afterText.content)){if(dispatch){for(var end$1=Fragment.empty,i$1=wrap$1.length-1;i$1>=0;i$1--)end$1=Fragment.from(wrap$1[i$1].copy(end$1));dispatch(state.tr.step(new ReplaceAroundStep($cut.pos-wrap$1.length,$cut.pos+after.nodeSize,$cut.pos+afterDepth,$cut.pos+after.nodeSize-afterDepth,new Slice(end$1,wrap$1.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function wrapIn$2(nodeType,attrs){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to),wrapping=range&&findWrapping(range,nodeType,attrs);return!!wrapping&&(dispatch&&dispatch(state.tr.wrap(range,wrapping).scrollIntoView()),!0)}}function setBlockType(nodeType,attrs){return function(state,dispatch){var ref=state.selection,from=ref.from,to=ref.to,applicable=!1;return state.doc.nodesBetween(from,to,(function(node,pos){if(applicable)return!1;if(node.isTextblock&&!node.hasMarkup(nodeType,attrs))if(node.type==nodeType)applicable=!0;else{var $pos=state.doc.resolve(pos),index=$pos.index();applicable=$pos.parent.canReplaceWith(index,index+1,nodeType)}})),!!applicable&&(dispatch&&dispatch(state.tr.setBlockType(from,to,nodeType,attrs).scrollIntoView()),!0)}}function chainCommands(){for(var commands=[],len=arguments.length;len--;)commands[len]=arguments[len];return function(state,dispatch,view){for(var i=0;i<commands.length;i++)if(commands[i](state,dispatch,view))return!0;return!1}}PluginKey.prototype.get=function get(state){return state.config.pluginsByKey[this.key]},PluginKey.prototype.getState=function getState(state){return state[this.key]};chainCommands(deleteSelection$2,joinBackward$2,selectNodeBackward$2),chainCommands(deleteSelection$2,joinForward$2,selectNodeForward$2);function wrapInList$2(listType,attrs){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to),doJoin=!1,outerRange=range;if(!range)return!1;if(range.depth>=2&&$from.node(range.depth-1).type.compatibleContent(listType)&&0==range.startIndex){if(0==$from.index(range.depth-1))return!1;var $insert=state.doc.resolve(range.start-2);outerRange=new NodeRange($insert,$insert,range.depth),range.endIndex<range.parent.childCount&&(range=new NodeRange($from,state.doc.resolve($to.end(range.depth)),range.depth)),doJoin=!0}var wrap=findWrapping(outerRange,listType,attrs,range);return!!wrap&&(dispatch&&dispatch(function doWrapInList(tr,range,wrappers,joinBefore,listType){for(var content=Fragment.empty,i=wrappers.length-1;i>=0;i--)content=Fragment.from(wrappers[i].type.create(wrappers[i].attrs,content));tr.step(new ReplaceAroundStep(range.start-(joinBefore?2:0),range.end,range.start,range.end,new Slice(content,0,0),wrappers.length,!0));for(var found=0,i$1=0;i$1<wrappers.length;i$1++)wrappers[i$1].type==listType&&(found=i$1+1);for(var splitDepth=wrappers.length-found,splitPos=range.start+wrappers.length-(joinBefore?2:0),parent=range.parent,i$2=range.startIndex,e=range.endIndex,first=!0;i$2<e;i$2++,first=!1)!first&&canSplit(tr.doc,splitPos,splitDepth)&&(tr.split(splitPos,splitDepth),splitPos+=2*splitDepth),splitPos+=parent.child(i$2).nodeSize;return tr}(state.tr,range,wrap,doJoin,listType).scrollIntoView()),!0)}}function liftListItem$2(itemType){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to,(function(node){return node.childCount&&node.firstChild.type==itemType}));return!!range&&(!dispatch||($from.node(range.depth-1).type==itemType?function liftToOuterList(state,dispatch,itemType,range){var tr=state.tr,end=range.end,endOfList=range.$to.end(range.depth);end<endOfList&&(tr.step(new ReplaceAroundStep(end-1,endOfList,end,endOfList,new Slice(Fragment.from(itemType.create(null,range.parent.copy())),1,0),1,!0)),range=new NodeRange(tr.doc.resolve(range.$from.pos),tr.doc.resolve(endOfList),range.depth));return dispatch(tr.lift(range,liftTarget(range)).scrollIntoView()),!0}(state,dispatch,itemType,range):function liftOutOfList(state,dispatch,range){for(var tr=state.tr,list=range.parent,pos=range.end,i=range.endIndex-1,e=range.startIndex;i>e;i--)pos-=list.child(i).nodeSize,tr.delete(pos-1,pos+1);var $start=tr.doc.resolve(range.start),item=$start.nodeAfter;if(tr.mapping.map(range.end)!=range.start+$start.nodeAfter.nodeSize)return!1;var atStart=0==range.startIndex,atEnd=range.endIndex==list.childCount,parent=$start.node(-1),indexBefore=$start.index(-1);if(!parent.canReplace(indexBefore+(atStart?0:1),indexBefore+1,item.content.append(atEnd?Fragment.empty:Fragment.from(list))))return!1;var start=$start.pos,end=start+item.nodeSize;return tr.step(new ReplaceAroundStep(start-(atStart?1:0),end+(atEnd?1:0),start+1,end-1,new Slice((atStart?Fragment.empty:Fragment.from(list.copy(Fragment.empty))).append(atEnd?Fragment.empty:Fragment.from(list.copy(Fragment.empty))),atStart?0:1,atEnd?0:1),atStart?0:1)),dispatch(tr.scrollIntoView()),!0}(state,dispatch,range)))}}chainCommands(newlineInCode$2,createParagraphNear$2,liftEmptyBlock$2,(function splitBlock$2(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to;if(state.selection instanceof NodeSelection&&state.selection.node.isBlock)return!(!$from.parentOffset||!canSplit(state.doc,$from.pos))&&(dispatch&&dispatch(state.tr.split($from.pos).scrollIntoView()),!0);if(!$from.parent.isBlock)return!1;if(dispatch){var atEnd=$to.parentOffset==$to.parent.content.size,tr=state.tr;(state.selection instanceof TextSelection||state.selection instanceof AllSelection)&&tr.deleteSelection();var deflt=0==$from.depth?null:defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1))),types=atEnd&&deflt?[{type:deflt}]:null,can=canSplit(tr.doc,tr.mapping.map($from.pos),1,types);if(types||can||!canSplit(tr.doc,tr.mapping.map($from.pos),1,deflt&&[{type:deflt}])||(types=[{type:deflt}],can=!0),can&&(tr.split(tr.mapping.map($from.pos),1,types),!atEnd&&!$from.parentOffset&&$from.parent.type!=deflt)){var first=tr.mapping.map($from.before()),$first=tr.doc.resolve(first);$from.node(-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&tr.setNodeMarkup(tr.mapping.map($from.before()),deflt)}dispatch(tr.scrollIntoView())}return!0})),"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform();var result={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var ie_edge=/Edge\/(\d+)/.exec(navigator.userAgent),ie_upto10=/MSIE \d/.test(navigator.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ie$1=result.ie=!!(ie_upto10||ie_11up||ie_edge);result.ie_version=ie_upto10?document.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:null,result.gecko=!ie$1&&/gecko\/(\d+)/i.test(navigator.userAgent),result.gecko_version=result.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var chrome$1=!ie$1&&/Chrome\/(\d+)/.exec(navigator.userAgent);result.chrome=!!chrome$1,result.chrome_version=chrome$1&&+chrome$1[1],result.safari=!ie$1&&/Apple Computer/.test(navigator.vendor),result.ios=result.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),result.mac=result.ios||/Mac/.test(navigator.platform),result.android=/Android \d/.test(navigator.userAgent),result.webkit="webkitFontSmoothing"in document.documentElement.style,result.webkit_version=result.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var domIndex=function domIndex(node){for(var index=0;;index++)if(!(node=node.previousSibling))return index},parentNode=function parentNode(node){var parent=node.assignedSlot||node.parentNode;return parent&&11==parent.nodeType?parent.host:parent},reusedRange=null,textRange=function textRange(node,from,to){var range=reusedRange||(reusedRange=document.createRange());return range.setEnd(node,null==to?node.nodeValue.length:to),range.setStart(node,from||0),range},isEquivalentPosition=function isEquivalentPosition(node,off,targetNode,targetOff){return targetNode&&(scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1))},atomElements=/^(img|br|input|textarea|hr)$/i;function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return!0;if(off==(dir<0?0:nodeSize(node))){var parent=node.parentNode;if(1!=parent.nodeType||hasBlockDesc(node)||atomElements.test(node.nodeName)||"false"==node.contentEditable)return!1;off=domIndex(node)+(dir<0?0:1),node=parent}else{if(1!=node.nodeType)return!1;if("false"==(node=node.childNodes[off+(dir<0?-1:0)]).contentEditable)return!1;off=dir<0?nodeSize(node):0}}}function nodeSize(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function hasBlockDesc(dom){for(var desc,cur=dom;cur&&!(desc=cur.pmViewDesc);cur=cur.parentNode);return desc&&desc.node&&desc.node.isBlock&&(desc.dom==dom||desc.contentDOM==dom)}var selectionCollapsed=function selectionCollapsed(domSel){var collapsed=domSel.isCollapsed;return collapsed&&result.chrome&&domSel.rangeCount&&!domSel.getRangeAt(0).collapsed&&(collapsed=!1),collapsed};function keyEvent(keyCode,key){var event=document.createEvent("Event");return event.initEvent("keydown",!0,!0),event.keyCode=keyCode,event.key=event.code=key,event}function windowRect(doc){return{left:0,right:doc.documentElement.clientWidth,top:0,bottom:doc.documentElement.clientHeight}}function getSide(value,side){return"number"==typeof value?value:value[side]}function clientRect(node){var rect=node.getBoundingClientRect(),scaleX=rect.width/node.offsetWidth||1,scaleY=rect.height/node.offsetHeight||1;return{left:rect.left,right:rect.left+node.clientWidth*scaleX,top:rect.top,bottom:rect.top+node.clientHeight*scaleY}}function scrollRectIntoView(view,rect,startDOM){for(var scrollThreshold=view.someProp("scrollThreshold")||0,scrollMargin=view.someProp("scrollMargin")||5,doc=view.dom.ownerDocument,parent=startDOM||view.dom;parent;parent=parentNode(parent))if(1==parent.nodeType){var atTop=parent==doc.body||1!=parent.nodeType,bounding=atTop?windowRect(doc):clientRect(parent),moveX=0,moveY=0;if(rect.top<bounding.top+getSide(scrollThreshold,"top")?moveY=-(bounding.top-rect.top+getSide(scrollMargin,"top")):rect.bottom>bounding.bottom-getSide(scrollThreshold,"bottom")&&(moveY=rect.bottom-bounding.bottom+getSide(scrollMargin,"bottom")),rect.left<bounding.left+getSide(scrollThreshold,"left")?moveX=-(bounding.left-rect.left+getSide(scrollMargin,"left")):rect.right>bounding.right-getSide(scrollThreshold,"right")&&(moveX=rect.right-bounding.right+getSide(scrollMargin,"right")),moveX||moveY)if(atTop)doc.defaultView.scrollBy(moveX,moveY);else{var startX=parent.scrollLeft,startY=parent.scrollTop;moveY&&(parent.scrollTop+=moveY),moveX&&(parent.scrollLeft+=moveX);var dX=parent.scrollLeft-startX,dY=parent.scrollTop-startY;rect={left:rect.left-dX,top:rect.top-dY,right:rect.right-dX,bottom:rect.bottom-dY}}if(atTop)break}}function scrollStack(dom){for(var stack=[],doc=dom.ownerDocument;dom&&(stack.push({dom,top:dom.scrollTop,left:dom.scrollLeft}),dom!=doc);dom=parentNode(dom));return stack}function restoreScrollStack(stack,dTop){for(var i=0;i<stack.length;i++){var ref=stack[i],dom=ref.dom,top=ref.top,left=ref.left;dom.scrollTop!=top+dTop&&(dom.scrollTop=top+dTop),dom.scrollLeft!=left&&(dom.scrollLeft=left)}}var preventScrollSupported=null;function findOffsetInNode(node,coords){for(var closest,coordsClosest,dxClosest=2e8,offset=0,rowBot=coords.top,rowTop=coords.top,child=node.firstChild,childIndex=0;child;child=child.nextSibling,childIndex++){var rects=void 0;if(1==child.nodeType)rects=child.getClientRects();else{if(3!=child.nodeType)continue;rects=textRange(child).getClientRects()}for(var i=0;i<rects.length;i++){var rect=rects[i];if(rect.top<=rowBot&&rect.bottom>=rowTop){rowBot=Math.max(rect.bottom,rowBot),rowTop=Math.min(rect.top,rowTop);var dx=rect.left>coords.left?rect.left-coords.left:rect.right<coords.left?coords.left-rect.right:0;if(dx<dxClosest){closest=child,dxClosest=dx,coordsClosest=dx&&3==closest.nodeType?{left:rect.right<coords.left?rect.right:rect.left,top:coords.top}:coords,1==child.nodeType&&dx&&(offset=childIndex+(coords.left>=(rect.left+rect.right)/2?1:0));continue}}!closest&&(coords.left>=rect.right&&coords.top>=rect.top||coords.left>=rect.left&&coords.top>=rect.bottom)&&(offset=childIndex+1)}}return closest&&3==closest.nodeType?function findOffsetInText(node,coords){for(var len=node.nodeValue.length,range=document.createRange(),i=0;i<len;i++){range.setEnd(node,i+1),range.setStart(node,i);var rect=singleRect(range,1);if(rect.top!=rect.bottom&&inRect(coords,rect))return{node,offset:i+(coords.left>=(rect.left+rect.right)/2?1:0)}}return{node,offset:0}}(closest,coordsClosest):!closest||dxClosest&&1==closest.nodeType?{node,offset}:findOffsetInNode(closest,coordsClosest)}function inRect(coords,rect){return coords.left>=rect.left-1&&coords.left<=rect.right+1&&coords.top>=rect.top-1&&coords.top<=rect.bottom+1}function elementFromPoint(element,coords,box){var len=element.childNodes.length;if(len&&box.top<box.bottom)for(var startI=Math.max(0,Math.min(len-1,Math.floor(len*(coords.top-box.top)/(box.bottom-box.top))-2)),i=startI;;){var child=element.childNodes[i];if(1==child.nodeType)for(var rects=child.getClientRects(),j=0;j<rects.length;j++){var rect=rects[j];if(inRect(coords,rect))return elementFromPoint(child,coords,rect)}if((i=(i+1)%len)==startI)break}return element}function posAtCoords(view,coords){var assign,assign$1,node,offset,doc=view.dom.ownerDocument;if(doc.caretPositionFromPoint)try{var pos$1=doc.caretPositionFromPoint(coords.left,coords.top);pos$1&&(node=(assign=pos$1).offsetNode,offset=assign.offset)}catch(_){}if(!node&&doc.caretRangeFromPoint){var range=doc.caretRangeFromPoint(coords.left,coords.top);range&&(node=(assign$1=range).startContainer,offset=assign$1.startOffset)}var pos,elt=(view.root.elementFromPoint?view.root:doc).elementFromPoint(coords.left,coords.top+1);if(!elt||!view.dom.contains(1!=elt.nodeType?elt.parentNode:elt)){var box=view.dom.getBoundingClientRect();if(!inRect(coords,box))return null;if(!(elt=elementFromPoint(view.dom,coords,box)))return null}if(result.safari)for(var p=elt;node&&p;p=parentNode(p))p.draggable&&(node=offset=null);if(elt=function targetKludge(dom,coords){var parent=dom.parentNode;return parent&&/^li$/i.test(parent.nodeName)&&coords.left<dom.getBoundingClientRect().left?parent:dom}(elt,coords),node){if(result.gecko&&1==node.nodeType&&(offset=Math.min(offset,node.childNodes.length))<node.childNodes.length){var box$1,next=node.childNodes[offset];"IMG"==next.nodeName&&(box$1=next.getBoundingClientRect()).right<=coords.left&&box$1.bottom>coords.top&&offset++}node==view.dom&&offset==node.childNodes.length-1&&1==node.lastChild.nodeType&&coords.top>node.lastChild.getBoundingClientRect().bottom?pos=view.state.doc.content.size:0!=offset&&1==node.nodeType&&"BR"==node.childNodes[offset-1].nodeName||(pos=function posFromCaret(view,node,offset,coords){for(var outside=-1,cur=node;cur!=view.dom;){var desc=view.docView.nearestDesc(cur,!0);if(!desc)return null;if(desc.node.isBlock&&desc.parent){var rect=desc.dom.getBoundingClientRect();if(rect.left>coords.left||rect.top>coords.top)outside=desc.posBefore;else{if(!(rect.right<coords.left||rect.bottom<coords.top))break;outside=desc.posAfter}}cur=desc.dom.parentNode}return outside>-1?outside:view.docView.posFromDOM(node,offset)}(view,node,offset,coords))}null==pos&&(pos=function posFromElement(view,elt,coords){var ref=findOffsetInNode(elt,coords),node=ref.node,offset=ref.offset,bias=-1;if(1==node.nodeType&&!node.firstChild){var rect=node.getBoundingClientRect();bias=rect.left!=rect.right&&coords.left>(rect.left+rect.right)/2?1:-1}return view.docView.posFromDOM(node,offset,bias)}(view,elt,coords));var desc=view.docView.nearestDesc(elt,!0);return{pos,inside:desc?desc.posAtStart-desc.border:-1}}function singleRect(object,bias){var rects=object.getClientRects();return rects.length?rects[bias<0?0:rects.length-1]:object.getBoundingClientRect()}var BIDI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function coordsAtPos(view,pos,side){var ref=view.docView.domFromPos(pos,side<0?-1:1),node=ref.node,offset=ref.offset,supportEmptyRange=result.webkit||result.gecko;if(3==node.nodeType){if(!supportEmptyRange||!BIDI.test(node.nodeValue)&&(side<0?offset:offset!=node.nodeValue.length)){var from=offset,to=offset,takeSide=side<0?1:-1;return side<0&&!offset?(to++,takeSide=-1):side>=0&&offset==node.nodeValue.length?(from--,takeSide=1):side<0?from--:to++,flattenV(singleRect(textRange(node,from,to),takeSide),takeSide<0)}var rect=singleRect(textRange(node,offset,offset),side);if(result.gecko&&offset&&/\s/.test(node.nodeValue[offset-1])&&offset<node.nodeValue.length){var rectBefore=singleRect(textRange(node,offset-1,offset-1),-1);if(rectBefore.top==rect.top){var rectAfter=singleRect(textRange(node,offset,offset+1),-1);if(rectAfter.top!=rect.top)return flattenV(rectAfter,rectAfter.left<rectBefore.left)}}return rect}if(!view.state.doc.resolve(pos).parent.inlineContent){if(offset&&(side<0||offset==nodeSize(node))){var before=node.childNodes[offset-1];if(1==before.nodeType)return flattenH(before.getBoundingClientRect(),!1)}if(offset<nodeSize(node)){var after=node.childNodes[offset];if(1==after.nodeType)return flattenH(after.getBoundingClientRect(),!0)}return flattenH(node.getBoundingClientRect(),side>=0)}if(offset&&(side<0||offset==nodeSize(node))){var before$1=node.childNodes[offset-1],target=3==before$1.nodeType?textRange(before$1,nodeSize(before$1)-(supportEmptyRange?0:1)):1!=before$1.nodeType||"BR"==before$1.nodeName&&before$1.nextSibling?null:before$1;if(target)return flattenV(singleRect(target,1),!1)}if(offset<nodeSize(node)){for(var after$1=node.childNodes[offset];after$1.pmViewDesc&&after$1.pmViewDesc.ignoreForCoords;)after$1=after$1.nextSibling;var target$1=after$1?3==after$1.nodeType?textRange(after$1,0,supportEmptyRange?0:1):1==after$1.nodeType?after$1:null:null;if(target$1)return flattenV(singleRect(target$1,-1),!0)}return flattenV(singleRect(3==node.nodeType?textRange(node):node,-side),side>=0)}function flattenV(rect,left){if(0==rect.width)return rect;var x=left?rect.left:rect.right;return{top:rect.top,bottom:rect.bottom,left:x,right:x}}function flattenH(rect,top){if(0==rect.height)return rect;var y=top?rect.top:rect.bottom;return{top:y,bottom:y,left:rect.left,right:rect.right}}function withFlushedState(view,state,f){var viewState=view.state,active=view.root.activeElement;viewState!=state&&view.updateState(state),active!=view.dom&&view.focus();try{return f()}finally{viewState!=state&&view.updateState(viewState),active!=view.dom&&active&&active.focus()}}var maybeRTL=/[\u0590-\u08ac]/;var cachedState=null,cachedDir=null,cachedResult=!1;function endOfTextblock(view,state,dir){return cachedState==state&&cachedDir==dir?cachedResult:(cachedState=state,cachedDir=dir,cachedResult="up"==dir||"down"==dir?function endOfTextblockVertical(view,state,dir){var sel=state.selection,$pos="up"==dir?sel.$from:sel.$to;return withFlushedState(view,state,(function(){for(var dom=view.docView.domFromPos($pos.pos,"up"==dir?-1:1).node;;){var nearest=view.docView.nearestDesc(dom,!0);if(!nearest)break;if(nearest.node.isBlock){dom=nearest.dom;break}dom=nearest.dom.parentNode}for(var coords=coordsAtPos(view,$pos.pos,1),child=dom.firstChild;child;child=child.nextSibling){var boxes=void 0;if(1==child.nodeType)boxes=child.getClientRects();else{if(3!=child.nodeType)continue;boxes=textRange(child,0,child.nodeValue.length).getClientRects()}for(var i=0;i<boxes.length;i++){var box=boxes[i];if(box.bottom>box.top+1&&("up"==dir?coords.top-box.top>2*(box.bottom-coords.top):box.bottom-coords.bottom>2*(coords.bottom-box.top)))return!1}}return!0}))}(view,state,dir):function endOfTextblockHorizontal(view,state,dir){var $head=state.selection.$head;if(!$head.parent.isTextblock)return!1;var offset=$head.parentOffset,atStart=!offset,atEnd=offset==$head.parent.content.size,sel=view.root.getSelection();return maybeRTL.test($head.parent.textContent)&&sel.modify?withFlushedState(view,state,(function(){var oldRange=sel.getRangeAt(0),oldNode=sel.focusNode,oldOff=sel.focusOffset,oldBidiLevel=sel.caretBidiLevel;sel.modify("move",dir,"character");var result=!($head.depth?view.docView.domAfterPos($head.before()):view.dom).contains(1==sel.focusNode.nodeType?sel.focusNode:sel.focusNode.parentNode)||oldNode==sel.focusNode&&oldOff==sel.focusOffset;return sel.removeAllRanges(),sel.addRange(oldRange),null!=oldBidiLevel&&(sel.caretBidiLevel=oldBidiLevel),result})):"left"==dir||"backward"==dir?atStart:atEnd}(view,state,dir))}var ViewDesc=function ViewDesc(parent,children,dom,contentDOM){this.parent=parent,this.children=children,this.dom=dom,dom.pmViewDesc=this,this.contentDOM=contentDOM,this.dirty=0},prototypeAccessors={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};ViewDesc.prototype.matchesWidget=function matchesWidget(){return!1},ViewDesc.prototype.matchesMark=function matchesMark(){return!1},ViewDesc.prototype.matchesNode=function matchesNode(){return!1},ViewDesc.prototype.matchesHack=function matchesHack(_nodeName){return!1},ViewDesc.prototype.parseRule=function parseRule(){return null},ViewDesc.prototype.stopEvent=function stopEvent(){return!1},prototypeAccessors.size.get=function(){for(var size=0,i=0;i<this.children.length;i++)size+=this.children[i].size;return size},prototypeAccessors.border.get=function(){return 0},ViewDesc.prototype.destroy=function destroy(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var i=0;i<this.children.length;i++)this.children[i].destroy()},ViewDesc.prototype.posBeforeChild=function posBeforeChild(child){for(var i=0,pos=this.posAtStart;i<this.children.length;i++){var cur=this.children[i];if(cur==child)return pos;pos+=cur.size}},prototypeAccessors.posBefore.get=function(){return this.parent.posBeforeChild(this)},prototypeAccessors.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},prototypeAccessors.posAfter.get=function(){return this.posBefore+this.size},prototypeAccessors.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},ViewDesc.prototype.localPosFromDOM=function localPosFromDOM(dom,offset,bias){if(this.contentDOM&&this.contentDOM.contains(1==dom.nodeType?dom:dom.parentNode)){if(bias<0){var domBefore,desc;if(dom==this.contentDOM)domBefore=dom.childNodes[offset-1];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domBefore=dom.previousSibling}for(;domBefore&&(!(desc=domBefore.pmViewDesc)||desc.parent!=this);)domBefore=domBefore.previousSibling;return domBefore?this.posBeforeChild(desc)+desc.size:this.posAtStart}var domAfter,desc$1;if(dom==this.contentDOM)domAfter=dom.childNodes[offset];else{for(;dom.parentNode!=this.contentDOM;)dom=dom.parentNode;domAfter=dom.nextSibling}for(;domAfter&&(!(desc$1=domAfter.pmViewDesc)||desc$1.parent!=this);)domAfter=domAfter.nextSibling;return domAfter?this.posBeforeChild(desc$1):this.posAtEnd}var atEnd;if(dom==this.dom&&this.contentDOM)atEnd=offset>domIndex(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))atEnd=2&dom.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==offset)for(var search=dom;;search=search.parentNode){if(search==this.dom){atEnd=!1;break}if(search.parentNode.firstChild!=search)break}if(null==atEnd&&offset==dom.childNodes.length)for(var search$1=dom;;search$1=search$1.parentNode){if(search$1==this.dom){atEnd=!0;break}if(search$1.parentNode.lastChild!=search$1)break}}return(null==atEnd?bias>0:atEnd)?this.posAtEnd:this.posAtStart},ViewDesc.prototype.nearestDesc=function nearestDesc(dom,onlyNodes){for(var first=!0,cur=dom;cur;cur=cur.parentNode){var desc=this.getDesc(cur);if(desc&&(!onlyNodes||desc.node)){if(!first||!desc.nodeDOM||(1==desc.nodeDOM.nodeType?desc.nodeDOM.contains(1==dom.nodeType?dom:dom.parentNode):desc.nodeDOM==dom))return desc;first=!1}}},ViewDesc.prototype.getDesc=function getDesc(dom){for(var desc=dom.pmViewDesc,cur=desc;cur;cur=cur.parent)if(cur==this)return desc},ViewDesc.prototype.posFromDOM=function posFromDOM(dom,offset,bias){for(var scan=dom;scan;scan=scan.parentNode){var desc=this.getDesc(scan);if(desc)return desc.localPosFromDOM(dom,offset,bias)}return-1},ViewDesc.prototype.descAt=function descAt(pos){for(var i=0,offset=0;i<this.children.length;i++){var child=this.children[i],end=offset+child.size;if(offset==pos&&end!=offset){for(;!child.border&&child.children.length;)child=child.children[0];return child}if(pos<end)return child.descAt(pos-offset-child.border);offset=end}},ViewDesc.prototype.domFromPos=function domFromPos(pos,side){if(!this.contentDOM)return{node:this.dom,offset:0};for(var i=0,offset=0,curPos=0;i<this.children.length;i++){var child=this.children[i],end=curPos+child.size;if(end>pos||child instanceof TrailingHackViewDesc){offset=pos-curPos;break}curPos=end}if(offset)return this.children[i].domFromPos(offset-this.children[i].border,side);for(var prev=void 0;i&&!(prev=this.children[i-1]).size&&prev instanceof WidgetViewDesc&&prev.widget.type.side>=0;i--);if(side<=0){for(var prev$1,enter=!0;(prev$1=i?this.children[i-1]:null)&&prev$1.dom.parentNode!=this.contentDOM;i--,enter=!1);return prev$1&&side&&enter&&!prev$1.border&&!prev$1.domAtom?prev$1.domFromPos(prev$1.size,side):{node:this.contentDOM,offset:prev$1?domIndex(prev$1.dom)+1:0}}for(var next,enter$1=!0;(next=i<this.children.length?this.children[i]:null)&&next.dom.parentNode!=this.contentDOM;i++,enter$1=!1);return next&&enter$1&&!next.border&&!next.domAtom?next.domFromPos(0,side):{node:this.contentDOM,offset:next?domIndex(next.dom):this.contentDOM.childNodes.length}},ViewDesc.prototype.parseRange=function parseRange(from,to,base){if(void 0===base&&(base=0),0==this.children.length)return{node:this.contentDOM,from,to,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var fromOffset=-1,toOffset=-1,offset=base,i=0;;i++){var child=this.children[i],end=offset+child.size;if(-1==fromOffset&&from<=end){var childBase=offset+child.border;if(from>=childBase&&to<=end-child.border&&child.node&&child.contentDOM&&this.contentDOM.contains(child.contentDOM))return child.parseRange(from,to,childBase);from=offset;for(var j=i;j>0;j--){var prev=this.children[j-1];if(prev.size&&prev.dom.parentNode==this.contentDOM&&!prev.emptyChildAt(1)){fromOffset=domIndex(prev.dom)+1;break}from-=prev.size}-1==fromOffset&&(fromOffset=0)}if(fromOffset>-1&&(end>to||i==this.children.length-1)){to=end;for(var j$1=i+1;j$1<this.children.length;j$1++){var next=this.children[j$1];if(next.size&&next.dom.parentNode==this.contentDOM&&!next.emptyChildAt(-1)){toOffset=domIndex(next.dom);break}to+=next.size}-1==toOffset&&(toOffset=this.contentDOM.childNodes.length);break}offset=end}return{node:this.contentDOM,from,to,fromOffset,toOffset}},ViewDesc.prototype.emptyChildAt=function emptyChildAt(side){if(this.border||!this.contentDOM||!this.children.length)return!1;var child=this.children[side<0?0:this.children.length-1];return 0==child.size||child.emptyChildAt(side)},ViewDesc.prototype.domAfterPos=function domAfterPos(pos){var ref=this.domFromPos(pos,0),node=ref.node,offset=ref.offset;if(1!=node.nodeType||offset==node.childNodes.length)throw new RangeError("No node after pos "+pos);return node.childNodes[offset]},ViewDesc.prototype.setSelection=function setSelection(anchor,head,root,force){for(var from=Math.min(anchor,head),to=Math.max(anchor,head),i=0,offset=0;i<this.children.length;i++){var child=this.children[i],end=offset+child.size;if(from>offset&&to<end)return child.setSelection(anchor-offset-child.border,head-offset-child.border,root,force);offset=end}var anchorDOM=this.domFromPos(anchor,anchor?-1:1),headDOM=head==anchor?anchorDOM:this.domFromPos(head,head?-1:1),domSel=root.getSelection(),brKludge=!1;if((result.gecko||result.safari)&&anchor==head){var node=anchorDOM.node,offset$1=anchorDOM.offset;if(3==node.nodeType){if((brKludge=offset$1&&"\n"==node.nodeValue[offset$1-1])&&offset$1==node.nodeValue.length)for(var scan=node,after=void 0;scan;scan=scan.parentNode){if(after=scan.nextSibling){"BR"==after.nodeName&&(anchorDOM=headDOM={node:after.parentNode,offset:domIndex(after)+1});break}var desc=scan.pmViewDesc;if(desc&&desc.node&&desc.node.isBlock)break}}else{var prev=node.childNodes[offset$1-1];brKludge=prev&&("BR"==prev.nodeName||"false"==prev.contentEditable)}}if(result.gecko&&domSel.focusNode&&domSel.focusNode!=headDOM.node&&1==domSel.focusNode.nodeType){var after$1=domSel.focusNode.childNodes[domSel.focusOffset];after$1&&"false"==after$1.contentEditable&&(force=!0)}if(force||brKludge&&result.safari||!isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)||!isEquivalentPosition(headDOM.node,headDOM.offset,domSel.focusNode,domSel.focusOffset)){var domSelExtended=!1;if((domSel.extend||anchor==head)&&!brKludge){domSel.collapse(anchorDOM.node,anchorDOM.offset);try{anchor!=head&&domSel.extend(headDOM.node,headDOM.offset),domSelExtended=!0}catch(err){if(!(err instanceof DOMException))throw err}}if(!domSelExtended){if(anchor>head){var tmp=anchorDOM;anchorDOM=headDOM,headDOM=tmp}var range=document.createRange();range.setEnd(headDOM.node,headDOM.offset),range.setStart(anchorDOM.node,anchorDOM.offset),domSel.removeAllRanges(),domSel.addRange(range)}}},ViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return!this.contentDOM&&"selection"!=mutation.type},prototypeAccessors.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},ViewDesc.prototype.markDirty=function markDirty(from,to){for(var offset=0,i=0;i<this.children.length;i++){var child=this.children[i],end=offset+child.size;if(offset==end?from<=end&&to>=offset:from<end&&to>offset){var startInside=offset+child.border,endInside=end-child.border;if(from>=startInside&&to<=endInside)return this.dirty=from==offset||to==end?2:1,void(from!=startInside||to!=endInside||!child.contentLost&&child.dom.parentNode==this.contentDOM?child.markDirty(from-startInside,to-startInside):child.dirty=3);child.dirty=child.dom!=child.contentDOM||child.dom.parentNode!=this.contentDOM||child.children.length?3:2}offset=end}this.dirty=2},ViewDesc.prototype.markParentsDirty=function markParentsDirty(){for(var level=1,node=this.parent;node;node=node.parent,level++){var dirty=1==level?2:1;node.dirty<dirty&&(node.dirty=dirty)}},prototypeAccessors.domAtom.get=function(){return!1},prototypeAccessors.ignoreForCoords.get=function(){return!1},Object.defineProperties(ViewDesc.prototype,prototypeAccessors);var nothing=[],WidgetViewDesc=function(ViewDesc){function WidgetViewDesc(parent,widget,view,pos){var self,dom=widget.type.toDOM;if("function"==typeof dom&&(dom=dom(view,(function(){return self?self.parent?self.parent.posBeforeChild(self):void 0:pos}))),!widget.type.spec.raw){if(1!=dom.nodeType){var wrap=document.createElement("span");wrap.appendChild(dom),dom=wrap}dom.contentEditable=!1,dom.classList.add("ProseMirror-widget")}ViewDesc.call(this,parent,nothing,dom,null),this.widget=widget,self=this}ViewDesc&&(WidgetViewDesc.__proto__=ViewDesc),WidgetViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),WidgetViewDesc.prototype.constructor=WidgetViewDesc;var prototypeAccessors$1={domAtom:{configurable:!0}};return WidgetViewDesc.prototype.matchesWidget=function matchesWidget(widget){return 0==this.dirty&&widget.type.eq(this.widget.type)},WidgetViewDesc.prototype.parseRule=function parseRule(){return{ignore:!0}},WidgetViewDesc.prototype.stopEvent=function stopEvent(event){var stop=this.widget.spec.stopEvent;return!!stop&&stop(event)},WidgetViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return"selection"!=mutation.type||this.widget.spec.ignoreSelection},WidgetViewDesc.prototype.destroy=function destroy(){this.widget.type.destroy(this.dom),ViewDesc.prototype.destroy.call(this)},prototypeAccessors$1.domAtom.get=function(){return!0},Object.defineProperties(WidgetViewDesc.prototype,prototypeAccessors$1),WidgetViewDesc}(ViewDesc),CompositionViewDesc=function(ViewDesc){function CompositionViewDesc(parent,dom,textDOM,text){ViewDesc.call(this,parent,nothing,dom,null),this.textDOM=textDOM,this.text=text}ViewDesc&&(CompositionViewDesc.__proto__=ViewDesc),CompositionViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),CompositionViewDesc.prototype.constructor=CompositionViewDesc;var prototypeAccessors$2={size:{configurable:!0}};return prototypeAccessors$2.size.get=function(){return this.text.length},CompositionViewDesc.prototype.localPosFromDOM=function localPosFromDOM(dom,offset){return dom!=this.textDOM?this.posAtStart+(offset?this.size:0):this.posAtStart+offset},CompositionViewDesc.prototype.domFromPos=function domFromPos(pos){return{node:this.textDOM,offset:pos}},CompositionViewDesc.prototype.ignoreMutation=function ignoreMutation(mut){return"characterData"===mut.type&&mut.target.nodeValue==mut.oldValue},Object.defineProperties(CompositionViewDesc.prototype,prototypeAccessors$2),CompositionViewDesc}(ViewDesc),MarkViewDesc=function(ViewDesc){function MarkViewDesc(parent,mark,dom,contentDOM){ViewDesc.call(this,parent,[],dom,contentDOM),this.mark=mark}return ViewDesc&&(MarkViewDesc.__proto__=ViewDesc),MarkViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),MarkViewDesc.prototype.constructor=MarkViewDesc,MarkViewDesc.create=function create(parent,mark,inline,view){var custom=view.nodeViews[mark.type.name],spec=custom&&custom(mark,view,inline);return spec&&spec.dom||(spec=DOMSerializer.renderSpec(document,mark.type.spec.toDOM(mark,inline))),new MarkViewDesc(parent,mark,spec.dom,spec.contentDOM||spec.dom)},MarkViewDesc.prototype.parseRule=function parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},MarkViewDesc.prototype.matchesMark=function matchesMark(mark){return 3!=this.dirty&&this.mark.eq(mark)},MarkViewDesc.prototype.markDirty=function markDirty(from,to){if(ViewDesc.prototype.markDirty.call(this,from,to),0!=this.dirty){for(var parent=this.parent;!parent.node;)parent=parent.parent;parent.dirty<this.dirty&&(parent.dirty=this.dirty),this.dirty=0}},MarkViewDesc.prototype.slice=function slice(from,to,view){var copy=MarkViewDesc.create(this.parent,this.mark,!0,view),nodes=this.children,size=this.size;to<size&&(nodes=replaceNodes(nodes,to,size,view)),from>0&&(nodes=replaceNodes(nodes,0,from,view));for(var i=0;i<nodes.length;i++)nodes[i].parent=copy;return copy.children=nodes,copy},MarkViewDesc}(ViewDesc),NodeViewDesc=function(ViewDesc){function NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos){ViewDesc.call(this,parent,node.isLeaf?nothing:[],dom,contentDOM),this.nodeDOM=nodeDOM,this.node=node,this.outerDeco=outerDeco,this.innerDeco=innerDeco,contentDOM&&this.updateChildren(view,pos)}ViewDesc&&(NodeViewDesc.__proto__=ViewDesc),NodeViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),NodeViewDesc.prototype.constructor=NodeViewDesc;var prototypeAccessors$3={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return NodeViewDesc.create=function create(parent,node,outerDeco,innerDeco,view,pos){var assign,descObj,custom=view.nodeViews[node.type.name],spec=custom&&custom(node,view,(function(){return descObj?descObj.parent?descObj.parent.posBeforeChild(descObj):void 0:pos}),outerDeco,innerDeco),dom=spec&&spec.dom,contentDOM=spec&&spec.contentDOM;if(node.isText)if(dom){if(3!=dom.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else dom=document.createTextNode(node.text);else dom||(dom=(assign=DOMSerializer.renderSpec(document,node.type.spec.toDOM(node))).dom,contentDOM=assign.contentDOM);contentDOM||node.isText||"BR"==dom.nodeName||(dom.hasAttribute("contenteditable")||(dom.contentEditable=!1),node.type.spec.draggable&&(dom.draggable=!0));var nodeDOM=dom;return dom=applyOuterDeco(dom,outerDeco,node),spec?descObj=new CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,spec,view,pos+1):node.isText?new TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view):new NodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos+1)},NodeViewDesc.prototype.parseRule=function parseRule(){var this$1=this;if(this.node.type.spec.reparseInView)return null;var rule={node:this.node.type.name,attrs:this.node.attrs};return"pre"==this.node.type.whitespace&&(rule.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?rule.contentElement=this.contentDOM:rule.getContent=function(){return this$1.contentDOM?Fragment.empty:this$1.node.content},rule},NodeViewDesc.prototype.matchesNode=function matchesNode(node,outerDeco,innerDeco){return 0==this.dirty&&node.eq(this.node)&&sameOuterDeco(outerDeco,this.outerDeco)&&innerDeco.eq(this.innerDeco)},prototypeAccessors$3.size.get=function(){return this.node.nodeSize},prototypeAccessors$3.border.get=function(){return this.node.isLeaf?0:1},NodeViewDesc.prototype.updateChildren=function updateChildren(view,pos){var this$1=this,inline=this.node.inlineContent,off=pos,composition=view.composing&&this.localCompositionInfo(view,pos),localComposition=composition&&composition.pos>-1?composition:null,compositionInChild=composition&&composition.pos<0,updater=new ViewTreeUpdater(this,localComposition&&localComposition.node);!function iterDeco(parent,deco,onWidget,onNode){var locals=deco.locals(parent),offset=0;if(0==locals.length){for(var i=0;i<parent.childCount;i++){var child=parent.child(i);onNode(child,locals,deco.forChild(offset,child),i),offset+=child.nodeSize}return}for(var decoIndex=0,active=[],restNode=null,parentIndex=0;;){if(decoIndex<locals.length&&locals[decoIndex].to==offset){for(var widget=locals[decoIndex++],widgets=void 0;decoIndex<locals.length&&locals[decoIndex].to==offset;)(widgets||(widgets=[widget])).push(locals[decoIndex++]);if(widgets){widgets.sort(compareSide);for(var i$1=0;i$1<widgets.length;i$1++)onWidget(widgets[i$1],parentIndex,!!restNode)}else onWidget(widget,parentIndex,!!restNode)}var child$1=void 0,index=void 0;if(restNode)index=-1,child$1=restNode,restNode=null;else{if(!(parentIndex<parent.childCount))break;index=parentIndex,child$1=parent.child(parentIndex++)}for(var i$2=0;i$2<active.length;i$2++)active[i$2].to<=offset&&active.splice(i$2--,1);for(;decoIndex<locals.length&&locals[decoIndex].from<=offset&&locals[decoIndex].to>offset;)active.push(locals[decoIndex++]);var end=offset+child$1.nodeSize;if(child$1.isText){var cutAt=end;decoIndex<locals.length&&locals[decoIndex].from<cutAt&&(cutAt=locals[decoIndex].from);for(var i$3=0;i$3<active.length;i$3++)active[i$3].to<cutAt&&(cutAt=active[i$3].to);cutAt<end&&(restNode=child$1.cut(cutAt-offset),child$1=child$1.cut(0,cutAt-offset),end=cutAt,index=-1)}onNode(child$1,active.length?child$1.isInline&&!child$1.isLeaf?active.filter((function(d){return!d.inline})):active.slice():nothing,deco.forChild(offset,child$1),index),offset=end}}(this.node,this.innerDeco,(function(widget,i,insideNode){widget.spec.marks?updater.syncToMarks(widget.spec.marks,inline,view):widget.type.side>=0&&!insideNode&&updater.syncToMarks(i==this$1.node.childCount?Mark$1.none:this$1.node.child(i).marks,inline,view),updater.placeWidget(widget,view,off)}),(function(child,outerDeco,innerDeco,i){var compIndex;updater.syncToMarks(child.marks,inline,view),updater.findNodeMatch(child,outerDeco,innerDeco,i)||compositionInChild&&view.state.selection.from>off&&view.state.selection.to<off+child.nodeSize&&(compIndex=updater.findIndexWithChild(composition.node))>-1&&updater.updateNodeAt(child,outerDeco,innerDeco,compIndex,view)||updater.updateNextNode(child,outerDeco,innerDeco,view,i)||updater.addNode(child,outerDeco,innerDeco,view,off),off+=child.nodeSize})),updater.syncToMarks(nothing,inline,view),this.node.isTextblock&&updater.addTextblockHacks(),updater.destroyRest(),(updater.changed||2==this.dirty)&&(localComposition&&this.protectLocalComposition(view,localComposition),renderDescs(this.contentDOM,this.children,view),result.ios&&function iosHacks(dom){if("UL"==dom.nodeName||"OL"==dom.nodeName){var oldCSS=dom.style.cssText;dom.style.cssText=oldCSS+"; list-style: square !important",window.getComputedStyle(dom).listStyle,dom.style.cssText=oldCSS}}(this.dom))},NodeViewDesc.prototype.localCompositionInfo=function localCompositionInfo(view,pos){var ref=view.state.selection,from=ref.from,to=ref.to;if(!(!(view.state.selection instanceof TextSelection)||from<pos||to>pos+this.node.content.size)){var sel=view.root.getSelection(),textNode=function nearbyTextNode(node,offset){for(;;){if(3==node.nodeType)return node;if(1==node.nodeType&&offset>0){if(node.childNodes.length>offset&&3==node.childNodes[offset].nodeType)return node.childNodes[offset];offset=nodeSize(node=node.childNodes[offset-1])}else{if(!(1==node.nodeType&&offset<node.childNodes.length))return null;node=node.childNodes[offset],offset=0}}}(sel.focusNode,sel.focusOffset);if(textNode&&this.dom.contains(textNode.parentNode)){if(this.node.inlineContent){var text=textNode.nodeValue,textPos=function findTextInFragment(frag,text,from,to){for(var i=0,pos=0;i<frag.childCount&&pos<=to;){var child=frag.child(i++),childStart=pos;if(pos+=child.nodeSize,child.isText){for(var str=child.text;i<frag.childCount;){var next=frag.child(i++);if(pos+=next.nodeSize,!next.isText)break;str+=next.text}if(pos>=from&&childStart<to){var found=str.lastIndexOf(text,to-childStart-1);if(found>=0&&found+text.length+childStart>=from)return childStart+found}}}return-1}(this.node.content,text,from-pos,to-pos);return textPos<0?null:{node:textNode,pos:textPos,text}}return{node:textNode,pos:-1}}}},NodeViewDesc.prototype.protectLocalComposition=function protectLocalComposition(view,ref){var node=ref.node,pos=ref.pos,text=ref.text;if(!this.getDesc(node)){for(var topNode=node;topNode.parentNode!=this.contentDOM;topNode=topNode.parentNode){for(;topNode.previousSibling;)topNode.parentNode.removeChild(topNode.previousSibling);for(;topNode.nextSibling;)topNode.parentNode.removeChild(topNode.nextSibling);topNode.pmViewDesc&&(topNode.pmViewDesc=null)}var desc=new CompositionViewDesc(this,topNode,node,text);view.compositionNodes.push(desc),this.children=replaceNodes(this.children,pos,pos+text.length,view,desc)}},NodeViewDesc.prototype.update=function update(node,outerDeco,innerDeco,view){return!(3==this.dirty||!node.sameMarkup(this.node))&&(this.updateInner(node,outerDeco,innerDeco,view),!0)},NodeViewDesc.prototype.updateInner=function updateInner(node,outerDeco,innerDeco,view){this.updateOuterDeco(outerDeco),this.node=node,this.innerDeco=innerDeco,this.contentDOM&&this.updateChildren(view,this.posAtStart),this.dirty=0},NodeViewDesc.prototype.updateOuterDeco=function updateOuterDeco(outerDeco){if(!sameOuterDeco(outerDeco,this.outerDeco)){var needsWrap=1!=this.nodeDOM.nodeType,oldDOM=this.dom;this.dom=patchOuterDeco(this.dom,this.nodeDOM,computeOuterDeco(this.outerDeco,this.node,needsWrap),computeOuterDeco(outerDeco,this.node,needsWrap)),this.dom!=oldDOM&&(oldDOM.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=outerDeco}},NodeViewDesc.prototype.selectNode=function selectNode(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},NodeViewDesc.prototype.deselectNode=function deselectNode(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},prototypeAccessors$3.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(NodeViewDesc.prototype,prototypeAccessors$3),NodeViewDesc}(ViewDesc);function docViewDesc(doc,outerDeco,innerDeco,dom,view){return applyOuterDeco(dom,outerDeco,doc),new NodeViewDesc(null,doc,outerDeco,innerDeco,dom,dom,dom,view,0)}var TextViewDesc=function(NodeViewDesc){function TextViewDesc(parent,node,outerDeco,innerDeco,dom,nodeDOM,view){NodeViewDesc.call(this,parent,node,outerDeco,innerDeco,dom,null,nodeDOM,view)}NodeViewDesc&&(TextViewDesc.__proto__=NodeViewDesc),TextViewDesc.prototype=Object.create(NodeViewDesc&&NodeViewDesc.prototype),TextViewDesc.prototype.constructor=TextViewDesc;var prototypeAccessors$4={domAtom:{configurable:!0}};return TextViewDesc.prototype.parseRule=function parseRule(){for(var skip=this.nodeDOM.parentNode;skip&&skip!=this.dom&&!skip.pmIsDeco;)skip=skip.parentNode;return{skip:skip||!0}},TextViewDesc.prototype.update=function update(node,outerDeco,_,view){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!node.sameMarkup(this.node))&&(this.updateOuterDeco(outerDeco),0==this.dirty&&node.text==this.node.text||node.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=node.text,view.trackWrites==this.nodeDOM&&(view.trackWrites=null)),this.node=node,this.dirty=0,!0)},TextViewDesc.prototype.inParent=function inParent(){for(var parentDOM=this.parent.contentDOM,n=this.nodeDOM;n;n=n.parentNode)if(n==parentDOM)return!0;return!1},TextViewDesc.prototype.domFromPos=function domFromPos(pos){return{node:this.nodeDOM,offset:pos}},TextViewDesc.prototype.localPosFromDOM=function localPosFromDOM(dom,offset,bias){return dom==this.nodeDOM?this.posAtStart+Math.min(offset,this.node.text.length):NodeViewDesc.prototype.localPosFromDOM.call(this,dom,offset,bias)},TextViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return"characterData"!=mutation.type&&"selection"!=mutation.type},TextViewDesc.prototype.slice=function slice(from,to,view){var node=this.node.cut(from,to),dom=document.createTextNode(node.text);return new TextViewDesc(this.parent,node,this.outerDeco,this.innerDeco,dom,dom,view)},TextViewDesc.prototype.markDirty=function markDirty(from,to){NodeViewDesc.prototype.markDirty.call(this,from,to),this.dom==this.nodeDOM||0!=from&&to!=this.nodeDOM.nodeValue.length||(this.dirty=3)},prototypeAccessors$4.domAtom.get=function(){return!1},Object.defineProperties(TextViewDesc.prototype,prototypeAccessors$4),TextViewDesc}(NodeViewDesc),TrailingHackViewDesc=function(ViewDesc){function TrailingHackViewDesc(){ViewDesc.apply(this,arguments)}ViewDesc&&(TrailingHackViewDesc.__proto__=ViewDesc),TrailingHackViewDesc.prototype=Object.create(ViewDesc&&ViewDesc.prototype),TrailingHackViewDesc.prototype.constructor=TrailingHackViewDesc;var prototypeAccessors$5={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return TrailingHackViewDesc.prototype.parseRule=function parseRule(){return{ignore:!0}},TrailingHackViewDesc.prototype.matchesHack=function matchesHack(nodeName){return 0==this.dirty&&this.dom.nodeName==nodeName},prototypeAccessors$5.domAtom.get=function(){return!0},prototypeAccessors$5.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(TrailingHackViewDesc.prototype,prototypeAccessors$5),TrailingHackViewDesc}(ViewDesc),CustomNodeViewDesc=function(NodeViewDesc){function CustomNodeViewDesc(parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,spec,view,pos){NodeViewDesc.call(this,parent,node,outerDeco,innerDeco,dom,contentDOM,nodeDOM,view,pos),this.spec=spec}return NodeViewDesc&&(CustomNodeViewDesc.__proto__=NodeViewDesc),CustomNodeViewDesc.prototype=Object.create(NodeViewDesc&&NodeViewDesc.prototype),CustomNodeViewDesc.prototype.constructor=CustomNodeViewDesc,CustomNodeViewDesc.prototype.update=function update(node,outerDeco,innerDeco,view){if(3==this.dirty)return!1;if(this.spec.update){var result=this.spec.update(node,outerDeco,innerDeco);return result&&this.updateInner(node,outerDeco,innerDeco,view),result}return!(!this.contentDOM&&!node.isLeaf)&&NodeViewDesc.prototype.update.call(this,node,outerDeco,innerDeco,view)},CustomNodeViewDesc.prototype.selectNode=function selectNode(){this.spec.selectNode?this.spec.selectNode():NodeViewDesc.prototype.selectNode.call(this)},CustomNodeViewDesc.prototype.deselectNode=function deselectNode(){this.spec.deselectNode?this.spec.deselectNode():NodeViewDesc.prototype.deselectNode.call(this)},CustomNodeViewDesc.prototype.setSelection=function setSelection(anchor,head,root,force){this.spec.setSelection?this.spec.setSelection(anchor,head,root):NodeViewDesc.prototype.setSelection.call(this,anchor,head,root,force)},CustomNodeViewDesc.prototype.destroy=function destroy(){this.spec.destroy&&this.spec.destroy(),NodeViewDesc.prototype.destroy.call(this)},CustomNodeViewDesc.prototype.stopEvent=function stopEvent(event){return!!this.spec.stopEvent&&this.spec.stopEvent(event)},CustomNodeViewDesc.prototype.ignoreMutation=function ignoreMutation(mutation){return this.spec.ignoreMutation?this.spec.ignoreMutation(mutation):NodeViewDesc.prototype.ignoreMutation.call(this,mutation)},CustomNodeViewDesc}(NodeViewDesc);function renderDescs(parentDOM,descs,view){for(var dom=parentDOM.firstChild,written=!1,i=0;i<descs.length;i++){var desc=descs[i],childDOM=desc.dom;if(childDOM.parentNode==parentDOM){for(;childDOM!=dom;)dom=rm(dom),written=!0;dom=dom.nextSibling}else written=!0,parentDOM.insertBefore(childDOM,dom);if(desc instanceof MarkViewDesc){var pos=dom?dom.previousSibling:parentDOM.lastChild;renderDescs(desc.contentDOM,desc.children,view),dom=pos?pos.nextSibling:parentDOM.firstChild}}for(;dom;)dom=rm(dom),written=!0;written&&view.trackWrites==parentDOM&&(view.trackWrites=null)}function OuterDecoLevel(nodeName){nodeName&&(this.nodeName=nodeName)}OuterDecoLevel.prototype=Object.create(null);var noDeco=[new OuterDecoLevel];function computeOuterDeco(outerDeco,node,needsWrap){if(0==outerDeco.length)return noDeco;for(var top=needsWrap?noDeco[0]:new OuterDecoLevel,result=[top],i=0;i<outerDeco.length;i++){var attrs=outerDeco[i].type.attrs;if(attrs)for(var name in attrs.nodeName&&result.push(top=new OuterDecoLevel(attrs.nodeName)),attrs){var val=attrs[name];null!=val&&(needsWrap&&1==result.length&&result.push(top=new OuterDecoLevel(node.isInline?"span":"div")),"class"==name?top.class=(top.class?top.class+" ":"")+val:"style"==name?top.style=(top.style?top.style+";":"")+val:"nodeName"!=name&&(top[name]=val))}}return result}function patchOuterDeco(outerDOM,nodeDOM,prevComputed,curComputed){if(prevComputed==noDeco&&curComputed==noDeco)return nodeDOM;for(var curDOM=nodeDOM,i=0;i<curComputed.length;i++){var deco=curComputed[i],prev=prevComputed[i];if(i){var parent=void 0;prev&&prev.nodeName==deco.nodeName&&curDOM!=outerDOM&&(parent=curDOM.parentNode)&&parent.tagName.toLowerCase()==deco.nodeName||((parent=document.createElement(deco.nodeName)).pmIsDeco=!0,parent.appendChild(curDOM),prev=noDeco[0]),curDOM=parent}patchAttributes(curDOM,prev||noDeco[0],deco)}return curDOM}function patchAttributes(dom,prev,cur){for(var name in prev)"class"==name||"style"==name||"nodeName"==name||name in cur||dom.removeAttribute(name);for(var name$1 in cur)"class"!=name$1&&"style"!=name$1&&"nodeName"!=name$1&&cur[name$1]!=prev[name$1]&&dom.setAttribute(name$1,cur[name$1]);if(prev.class!=cur.class){for(var prevList=prev.class?prev.class.split(" ").filter(Boolean):nothing,curList=cur.class?cur.class.split(" ").filter(Boolean):nothing,i=0;i<prevList.length;i++)-1==curList.indexOf(prevList[i])&&dom.classList.remove(prevList[i]);for(var i$1=0;i$1<curList.length;i$1++)-1==prevList.indexOf(curList[i$1])&&dom.classList.add(curList[i$1]);0==dom.classList.length&&dom.removeAttribute("class")}if(prev.style!=cur.style){if(prev.style)for(var m,prop=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;m=prop.exec(prev.style);)dom.style.removeProperty(m[1]);cur.style&&(dom.style.cssText+=cur.style)}}function applyOuterDeco(dom,deco,node){return patchOuterDeco(dom,dom,noDeco,computeOuterDeco(deco,node,1!=dom.nodeType))}function sameOuterDeco(a,b){if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(!a[i].type.eq(b[i].type))return!1;return!0}function rm(dom){var next=dom.nextSibling;return dom.parentNode.removeChild(dom),next}var ViewTreeUpdater=function ViewTreeUpdater(top,lockedNode){this.top=top,this.lock=lockedNode,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function preMatch(frag,parentDesc){var curDesc=parentDesc,descI=curDesc.children.length,fI=frag.childCount,matched=new Map,matches=[];outer:for(;fI>0;){for(var desc=void 0;;)if(descI){var next=curDesc.children[descI-1];if(!(next instanceof MarkViewDesc)){desc=next,descI--;break}curDesc=next,descI=next.children.length}else{if(curDesc==parentDesc)break outer;descI=curDesc.parent.children.indexOf(curDesc),curDesc=curDesc.parent}var node=desc.node;if(node){if(node!=frag.child(fI-1))break;--fI,matched.set(desc,fI),matches.push(desc)}}return{index:fI,matched,matches:matches.reverse()}}(top.node.content,top)};function compareSide(a,b){return a.type.side-b.type.side}function replaceNodes(nodes,from,to,view,replacement){for(var result=[],i=0,off=0;i<nodes.length;i++){var child=nodes[i],start=off,end=off+=child.size;start>=to||end<=from?result.push(child):(start<from&&result.push(child.slice(0,from-start,view)),replacement&&(result.push(replacement),replacement=null),end>to&&result.push(child.slice(to-start,child.size,view)))}return result}function selectionFromDOM(view,origin){var domSel=view.root.getSelection(),doc=view.state.doc;if(!domSel.focusNode)return null;var nearestDesc=view.docView.nearestDesc(domSel.focusNode),inWidget=nearestDesc&&0==nearestDesc.size,head=view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset);if(head<0)return null;var $anchor,selection,$head=doc.resolve(head);if(selectionCollapsed(domSel)){for($anchor=$head;nearestDesc&&!nearestDesc.node;)nearestDesc=nearestDesc.parent;if(nearestDesc&&nearestDesc.node.isAtom&&NodeSelection.isSelectable(nearestDesc.node)&&nearestDesc.parent&&(!nearestDesc.node.isInline||!function isOnEdge(node,offset,parent){for(var atStart=0==offset,atEnd=offset==nodeSize(node);atStart||atEnd;){if(node==parent)return!0;var index=domIndex(node);if(!(node=node.parentNode))return!1;atStart=atStart&&0==index,atEnd=atEnd&&index==nodeSize(node)}}(domSel.focusNode,domSel.focusOffset,nearestDesc.dom))){var pos=nearestDesc.posBefore;selection=new NodeSelection(head==pos?$head:doc.resolve(pos))}}else{var anchor=view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset);if(anchor<0)return null;$anchor=doc.resolve(anchor)}selection||(selection=selectionBetween(view,$anchor,$head,"pointer"==origin||view.state.selection.head<$head.pos&&!inWidget?1:-1));return selection}function editorOwnsSelection(view){return view.editable?view.hasFocus():hasSelection(view)&&document.activeElement&&document.activeElement.contains(view.dom)}function selectionToDOM(view,force){var sel=view.state.selection;if(syncNodeSelection(view,sel),editorOwnsSelection(view)){if(!force&&view.mouseDown&&view.mouseDown.allowDefault&&result.chrome){var domSel=view.root.getSelection(),curSel=view.domObserver.currentSelection;if(domSel.anchorNode&&isEquivalentPosition(domSel.anchorNode,domSel.anchorOffset,curSel.anchorNode,curSel.anchorOffset))return view.mouseDown.delayedSelectionSync=!0,void view.domObserver.setCurSelection()}if(view.domObserver.disconnectSelection(),view.cursorWrapper)!function selectCursorWrapper(view){var domSel=view.root.getSelection(),range=document.createRange(),node=view.cursorWrapper.dom,img="IMG"==node.nodeName;img?range.setEnd(node.parentNode,domIndex(node)+1):range.setEnd(node,0);range.collapse(!1),domSel.removeAllRanges(),domSel.addRange(range),!img&&!view.state.selection.visible&&result.ie&&result.ie_version<=11&&(node.disabled=!0,node.disabled=!1)}(view);else{var resetEditableFrom,resetEditableTo,anchor=sel.anchor,head=sel.head;!brokenSelectBetweenUneditable||sel instanceof TextSelection||(sel.$from.parent.inlineContent||(resetEditableFrom=temporarilyEditableNear(view,sel.from)),sel.empty||sel.$from.parent.inlineContent||(resetEditableTo=temporarilyEditableNear(view,sel.to))),view.docView.setSelection(anchor,head,view.root,force),brokenSelectBetweenUneditable&&(resetEditableFrom&&resetEditable(resetEditableFrom),resetEditableTo&&resetEditable(resetEditableTo)),sel.visible?view.dom.classList.remove("ProseMirror-hideselection"):(view.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function removeClassOnSelectionChange(view){var doc=view.dom.ownerDocument;doc.removeEventListener("selectionchange",view.hideSelectionGuard);var domSel=view.root.getSelection(),node=domSel.anchorNode,offset=domSel.anchorOffset;doc.addEventListener("selectionchange",view.hideSelectionGuard=function(){domSel.anchorNode==node&&domSel.anchorOffset==offset||(doc.removeEventListener("selectionchange",view.hideSelectionGuard),setTimeout((function(){editorOwnsSelection(view)&&!view.state.selection.visible||view.dom.classList.remove("ProseMirror-hideselection")}),20))})}(view))}view.domObserver.setCurSelection(),view.domObserver.connectSelection()}}ViewTreeUpdater.prototype.destroyBetween=function destroyBetween(start,end){if(start!=end){for(var i=start;i<end;i++)this.top.children[i].destroy();this.top.children.splice(start,end-start),this.changed=!0}},ViewTreeUpdater.prototype.destroyRest=function destroyRest(){this.destroyBetween(this.index,this.top.children.length)},ViewTreeUpdater.prototype.syncToMarks=function syncToMarks(marks,inline,view){for(var keep=0,depth=this.stack.length>>1,maxKeep=Math.min(depth,marks.length);keep<maxKeep&&(keep==depth-1?this.top:this.stack[keep+1<<1]).matchesMark(marks[keep])&&!1!==marks[keep].type.spec.spanning;)keep++;for(;keep<depth;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),depth--;for(;depth<marks.length;){this.stack.push(this.top,this.index+1);for(var found=-1,i=this.index;i<Math.min(this.index+3,this.top.children.length);i++)if(this.top.children[i].matchesMark(marks[depth])){found=i;break}if(found>-1)found>this.index&&(this.changed=!0,this.destroyBetween(this.index,found)),this.top=this.top.children[this.index];else{var markDesc=MarkViewDesc.create(this.top,marks[depth],inline,view);this.top.children.splice(this.index,0,markDesc),this.top=markDesc,this.changed=!0}this.index=0,depth++}},ViewTreeUpdater.prototype.findNodeMatch=function findNodeMatch(node,outerDeco,innerDeco,index){var targetDesc,found=-1;if(index>=this.preMatch.index&&(targetDesc=this.preMatch.matches[index-this.preMatch.index]).parent==this.top&&targetDesc.matchesNode(node,outerDeco,innerDeco))found=this.top.children.indexOf(targetDesc,this.index);else for(var i=this.index,e=Math.min(this.top.children.length,i+5);i<e;i++){var child=this.top.children[i];if(child.matchesNode(node,outerDeco,innerDeco)&&!this.preMatch.matched.has(child)){found=i;break}}return!(found<0)&&(this.destroyBetween(this.index,found),this.index++,!0)},ViewTreeUpdater.prototype.updateNodeAt=function updateNodeAt(node,outerDeco,innerDeco,index,view){return!!this.top.children[index].update(node,outerDeco,innerDeco,view)&&(this.destroyBetween(this.index,index),this.index=index+1,!0)},ViewTreeUpdater.prototype.findIndexWithChild=function findIndexWithChild(domNode){for(;;){var parent=domNode.parentNode;if(!parent)return-1;if(parent==this.top.contentDOM){var desc=domNode.pmViewDesc;if(desc)for(var i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==desc)return i;return-1}domNode=parent}},ViewTreeUpdater.prototype.updateNextNode=function updateNextNode(node,outerDeco,innerDeco,view,index){for(var i=this.index;i<this.top.children.length;i++){var next=this.top.children[i];if(next instanceof NodeViewDesc){var preMatch=this.preMatch.matched.get(next);if(null!=preMatch&&preMatch!=index)return!1;var nextDOM=next.dom;if(!(this.lock&&(nextDOM==this.lock||1==nextDOM.nodeType&&nextDOM.contains(this.lock.parentNode))&&!(node.isText&&next.node&&next.node.isText&&next.nodeDOM.nodeValue==node.text&&3!=next.dirty&&sameOuterDeco(outerDeco,next.outerDeco)))&&next.update(node,outerDeco,innerDeco,view))return this.destroyBetween(this.index,i),next.dom!=nextDOM&&(this.changed=!0),this.index++,!0;break}}return!1},ViewTreeUpdater.prototype.addNode=function addNode(node,outerDeco,innerDeco,view,pos){this.top.children.splice(this.index++,0,NodeViewDesc.create(this.top,node,outerDeco,innerDeco,view,pos)),this.changed=!0},ViewTreeUpdater.prototype.placeWidget=function placeWidget(widget,view,pos){var next=this.index<this.top.children.length?this.top.children[this.index]:null;if(!next||!next.matchesWidget(widget)||widget!=next.widget&&next.widget.type.toDOM.parentNode){var desc=new WidgetViewDesc(this.top,widget,view,pos);this.top.children.splice(this.index++,0,desc),this.changed=!0}else this.index++},ViewTreeUpdater.prototype.addTextblockHacks=function addTextblockHacks(){for(var lastChild=this.top.children[this.index-1];lastChild instanceof MarkViewDesc;)lastChild=lastChild.children[lastChild.children.length-1];lastChild&&lastChild instanceof TextViewDesc&&!/\n$/.test(lastChild.node.text)||((result.safari||result.chrome)&&lastChild&&"false"==lastChild.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},ViewTreeUpdater.prototype.addHackNode=function addHackNode(nodeName){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(nodeName))this.index++;else{var dom=document.createElement(nodeName);"IMG"==nodeName&&(dom.className="ProseMirror-separator"),"BR"==nodeName&&(dom.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new TrailingHackViewDesc(this.top,nothing,dom,null)),this.changed=!0}};var brokenSelectBetweenUneditable=result.safari||result.chrome&&result.chrome_version<63;function temporarilyEditableNear(view,pos){var ref=view.docView.domFromPos(pos,0),node=ref.node,offset=ref.offset,after=offset<node.childNodes.length?node.childNodes[offset]:null,before=offset?node.childNodes[offset-1]:null;if(result.safari&&after&&"false"==after.contentEditable)return setEditable(after);if(!(after&&"false"!=after.contentEditable||before&&"false"!=before.contentEditable)){if(after)return setEditable(after);if(before)return setEditable(before)}}function setEditable(element){return element.contentEditable="true",result.safari&&element.draggable&&(element.draggable=!1,element.wasDraggable=!0),element}function resetEditable(element){element.contentEditable="false",element.wasDraggable&&(element.draggable=!0,element.wasDraggable=null)}function syncNodeSelection(view,sel){if(sel instanceof NodeSelection){var desc=view.docView.descAt(sel.from);desc!=view.lastSelectedViewDesc&&(clearNodeSelection(view),desc&&desc.selectNode(),view.lastSelectedViewDesc=desc)}else clearNodeSelection(view)}function clearNodeSelection(view){view.lastSelectedViewDesc&&(view.lastSelectedViewDesc.parent&&view.lastSelectedViewDesc.deselectNode(),view.lastSelectedViewDesc=null)}function selectionBetween(view,$anchor,$head,bias){return view.someProp("createSelectionBetween",(function(f){return f(view,$anchor,$head)}))||TextSelection.between($anchor,$head,bias)}function hasSelection(view){var sel=view.root.getSelection();if(!sel.anchorNode)return!1;try{return view.dom.contains(3==sel.anchorNode.nodeType?sel.anchorNode.parentNode:sel.anchorNode)&&(view.editable||view.dom.contains(3==sel.focusNode.nodeType?sel.focusNode.parentNode:sel.focusNode))}catch(_){return!1}}function moveSelectionBlock(state,dir){var ref=state.selection,$anchor=ref.$anchor,$head=ref.$head,$side=dir>0?$anchor.max($head):$anchor.min($head),$start=$side.parent.inlineContent?$side.depth?state.doc.resolve(dir>0?$side.after():$side.before()):null:$side;return $start&&Selection.findFrom($start,dir)}function apply(view,sel){return view.dispatch(view.state.tr.setSelection(sel).scrollIntoView()),!0}function selectHorizontally(view,dir,mods){var sel=view.state.selection;if(!(sel instanceof TextSelection)){if(sel instanceof NodeSelection&&sel.node.isInline)return apply(view,new TextSelection(dir>0?sel.$to:sel.$from));var next$1=moveSelectionBlock(view.state,dir);return!!next$1&&apply(view,next$1)}if(!sel.empty||mods.indexOf("s")>-1)return!1;if(view.endOfTextblock(dir>0?"right":"left")){var next=moveSelectionBlock(view.state,dir);return!!(next&&next instanceof NodeSelection)&&apply(view,next)}if(!(result.mac&&mods.indexOf("m")>-1)){var desc,$head=sel.$head,node=$head.textOffset?null:dir<0?$head.nodeBefore:$head.nodeAfter;if(!node||node.isText)return!1;var nodePos=dir<0?$head.pos-node.nodeSize:$head.pos;return!!(node.isAtom||(desc=view.docView.descAt(nodePos))&&!desc.contentDOM)&&(NodeSelection.isSelectable(node)?apply(view,new NodeSelection(dir<0?view.state.doc.resolve($head.pos-node.nodeSize):$head)):!!result.webkit&&apply(view,new TextSelection(view.state.doc.resolve(dir<0?nodePos:nodePos+node.nodeSize))))}}function nodeLen(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function isIgnorable(dom){var desc=dom.pmViewDesc;return desc&&0==desc.size&&(dom.nextSibling||"BR"!=dom.nodeName)}function skipIgnoredNodesLeft(view){var sel=view.root.getSelection(),node=sel.focusNode,offset=sel.focusOffset;if(node){var moveNode,moveOffset,force=!1;for(result.gecko&&1==node.nodeType&&offset<nodeLen(node)&&isIgnorable(node.childNodes[offset])&&(force=!0);;)if(offset>0){if(1!=node.nodeType)break;var before=node.childNodes[offset-1];if(isIgnorable(before))moveNode=node,moveOffset=--offset;else{if(3!=before.nodeType)break;offset=(node=before).nodeValue.length}}else{if(isBlockNode(node))break;for(var prev=node.previousSibling;prev&&isIgnorable(prev);)moveNode=node.parentNode,moveOffset=domIndex(prev),prev=prev.previousSibling;if(prev)offset=nodeLen(node=prev);else{if((node=node.parentNode)==view.dom)break;offset=0}}force?setSelFocus(view,sel,node,offset):moveNode&&setSelFocus(view,sel,moveNode,moveOffset)}}function skipIgnoredNodesRight(view){var sel=view.root.getSelection(),node=sel.focusNode,offset=sel.focusOffset;if(node){for(var moveNode,moveOffset,len=nodeLen(node);;)if(offset<len){if(1!=node.nodeType)break;if(!isIgnorable(node.childNodes[offset]))break;moveNode=node,moveOffset=++offset}else{if(isBlockNode(node))break;for(var next=node.nextSibling;next&&isIgnorable(next);)moveNode=next.parentNode,moveOffset=domIndex(next)+1,next=next.nextSibling;if(next)offset=0,len=nodeLen(node=next);else{if((node=node.parentNode)==view.dom)break;offset=len=0}}moveNode&&setSelFocus(view,sel,moveNode,moveOffset)}}function isBlockNode(dom){var desc=dom.pmViewDesc;return desc&&desc.node&&desc.node.isBlock}function setSelFocus(view,sel,node,offset){if(selectionCollapsed(sel)){var range=document.createRange();range.setEnd(node,offset),range.setStart(node,offset),sel.removeAllRanges(),sel.addRange(range)}else sel.extend&&sel.extend(node,offset);view.domObserver.setCurSelection();var state=view.state;setTimeout((function(){view.state==state&&selectionToDOM(view)}),50)}function selectVertically(view,dir,mods){var sel=view.state.selection;if(sel instanceof TextSelection&&!sel.empty||mods.indexOf("s")>-1)return!1;if(result.mac&&mods.indexOf("m")>-1)return!1;var $from=sel.$from,$to=sel.$to;if(!$from.parent.inlineContent||view.endOfTextblock(dir<0?"up":"down")){var next=moveSelectionBlock(view.state,dir);if(next&&next instanceof NodeSelection)return apply(view,next)}if(!$from.parent.inlineContent){var side=dir<0?$from:$to,beyond=sel instanceof AllSelection?Selection.near(side,dir):Selection.findFrom(side,dir);return!!beyond&&apply(view,beyond)}return!1}function stopNativeHorizontalDelete(view,dir){if(!(view.state.selection instanceof TextSelection))return!0;var ref=view.state.selection,$head=ref.$head,$anchor=ref.$anchor,empty=ref.empty;if(!$head.sameParent($anchor))return!0;if(!empty)return!1;if(view.endOfTextblock(dir>0?"forward":"backward"))return!0;var nextNode=!$head.textOffset&&(dir<0?$head.nodeBefore:$head.nodeAfter);if(nextNode&&!nextNode.isText){var tr=view.state.tr;return dir<0?tr.delete($head.pos-nextNode.nodeSize,$head.pos):tr.delete($head.pos,$head.pos+nextNode.nodeSize),view.dispatch(tr),!0}return!1}function switchEditable(view,node,state){view.domObserver.stop(),node.contentEditable=state,view.domObserver.start()}function captureKeyDown(view,event){var code=event.keyCode,mods=function getMods(event){var result="";return event.ctrlKey&&(result+="c"),event.metaKey&&(result+="m"),event.altKey&&(result+="a"),event.shiftKey&&(result+="s"),result}(event);return 8==code||result.mac&&72==code&&"c"==mods?stopNativeHorizontalDelete(view,-1)||skipIgnoredNodesLeft(view):46==code||result.mac&&68==code&&"c"==mods?stopNativeHorizontalDelete(view,1)||skipIgnoredNodesRight(view):13==code||27==code||(37==code?selectHorizontally(view,-1,mods)||skipIgnoredNodesLeft(view):39==code?selectHorizontally(view,1,mods)||skipIgnoredNodesRight(view):38==code?selectVertically(view,-1,mods)||skipIgnoredNodesLeft(view):40==code?function safariDownArrowBug(view){if(result.safari&&!(view.state.selection.$head.parentOffset>0)){var ref=view.root.getSelection(),focusNode=ref.focusNode,focusOffset=ref.focusOffset;if(focusNode&&1==focusNode.nodeType&&0==focusOffset&&focusNode.firstChild&&"false"==focusNode.firstChild.contentEditable){var child=focusNode.firstChild;switchEditable(view,child,!0),setTimeout((function(){return switchEditable(view,child,!1)}),20)}}}(view)||selectVertically(view,1,mods)||skipIgnoredNodesRight(view):mods==(result.mac?"m":"c")&&(66==code||73==code||89==code||90==code))}function ruleFromNode(dom){var desc=dom.pmViewDesc;if(desc)return desc.parseRule();if("BR"==dom.nodeName&&dom.parentNode){if(result.safari&&/^(ul|ol)$/i.test(dom.parentNode.nodeName)){var skip=document.createElement("div");return skip.appendChild(document.createElement("li")),{skip}}if(dom.parentNode.lastChild==dom||result.safari&&/^(tr|table)$/i.test(dom.parentNode.nodeName))return{ignore:!0}}else if("IMG"==dom.nodeName&&dom.getAttribute("mark-placeholder"))return{ignore:!0}}function readDOMChange(view,from,to,typeOver,addedNodes){if(from<0){var origin=view.lastSelectionTime>Date.now()-50?view.lastSelectionOrigin:null,newSel=selectionFromDOM(view,origin);if(newSel&&!view.state.selection.eq(newSel)){var tr$1=view.state.tr.setSelection(newSel);"pointer"==origin?tr$1.setMeta("pointer",!0):"key"==origin&&tr$1.scrollIntoView(),view.dispatch(tr$1)}}else{var $before=view.state.doc.resolve(from),shared=$before.sharedDepth(to);from=$before.before(shared+1),to=view.state.doc.resolve(to).after(shared+1);var sel=view.state.selection,parse=function parseBetween(view,from_,to_){var ref=view.docView.parseRange(from_,to_),parent=ref.node,fromOffset=ref.fromOffset,toOffset=ref.toOffset,from=ref.from,to=ref.to,domSel=view.root.getSelection(),find=null,anchor=domSel.anchorNode;if(anchor&&view.dom.contains(1==anchor.nodeType?anchor:anchor.parentNode)&&(find=[{node:anchor,offset:domSel.anchorOffset}],selectionCollapsed(domSel)||find.push({node:domSel.focusNode,offset:domSel.focusOffset})),result.chrome&&8===view.lastKeyCode)for(var off=toOffset;off>fromOffset;off--){var node=parent.childNodes[off-1],desc=node.pmViewDesc;if("BR"==node.nodeName&&!desc){toOffset=off;break}if(!desc||desc.size)break}var startDoc=view.state.doc,parser=view.someProp("domParser")||DOMParser.fromSchema(view.state.schema),$from=startDoc.resolve(from),sel=null,doc=parser.parse(parent,{topNode:$from.parent,topMatch:$from.parent.contentMatchAt($from.index()),topOpen:!0,from:fromOffset,to:toOffset,preserveWhitespace:"pre"!=$from.parent.type.whitespace||"full",editableContent:!0,findPositions:find,ruleFromNode,context:$from});if(find&&null!=find[0].pos){var anchor$1=find[0].pos,head=find[1]&&find[1].pos;null==head&&(head=anchor$1),sel={anchor:anchor$1+from,head:head+from}}return{doc,sel,from,to}}(view,from,to);if(result.chrome&&view.cursorWrapper&&parse.sel&&parse.sel.anchor==view.cursorWrapper.deco.from){var text=view.cursorWrapper.deco.type.toDOM.nextSibling,size=text&&text.nodeValue?text.nodeValue.length:1;parse.sel={anchor:parse.sel.anchor+size,head:parse.sel.anchor+size}}var preferredPos,preferredSide,doc=view.state.doc,compare=doc.slice(parse.from,parse.to);8===view.lastKeyCode&&Date.now()-100<view.lastKeyCodeTime?(preferredPos=view.state.selection.to,preferredSide="end"):(preferredPos=view.state.selection.from,preferredSide="start"),view.lastKeyCode=null;var change=function findDiff(a,b,pos,preferredPos,preferredSide){var start=a.findDiffStart(b,pos);if(null==start)return null;var ref=a.findDiffEnd(b,pos+a.size,pos+b.size),endA=ref.a,endB=ref.b;if("end"==preferredSide){preferredPos-=endA+Math.max(0,start-Math.min(endA,endB))-start}if(endA<start&&a.size<b.size){endB=(start-=preferredPos<=start&&preferredPos>=endA?start-preferredPos:0)+(endB-endA),endA=start}else if(endB<start){endA=(start-=preferredPos<=start&&preferredPos>=endB?start-preferredPos:0)+(endA-endB),endB=start}return{start,endA,endB}}(compare.content,parse.doc.content,parse.from,preferredPos,preferredSide);if(!change){if(!(typeOver&&sel instanceof TextSelection&&!sel.empty&&sel.$head.sameParent(sel.$anchor))||view.composing||parse.sel&&parse.sel.anchor!=parse.sel.head){if((result.ios&&view.lastIOSEnter>Date.now()-225||result.android)&&addedNodes.some((function(n){return"DIV"==n.nodeName||"P"==n.nodeName}))&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))return void(view.lastIOSEnter=0);if(parse.sel){var sel$1=resolveSelection(view,view.state.doc,parse.sel);sel$1&&!sel$1.eq(view.state.selection)&&view.dispatch(view.state.tr.setSelection(sel$1))}return}change={start:sel.from,endA:sel.to,endB:sel.to}}view.domChangeCount++,view.state.selection.from<view.state.selection.to&&change.start==change.endB&&view.state.selection instanceof TextSelection&&(change.start>view.state.selection.from&&change.start<=view.state.selection.from+2?change.start=view.state.selection.from:change.endA<view.state.selection.to&&change.endA>=view.state.selection.to-2&&(change.endB+=view.state.selection.to-change.endA,change.endA=view.state.selection.to)),result.ie&&result.ie_version<=11&&change.endB==change.start+1&&change.endA==change.start&&change.start>parse.from&&" "==parse.doc.textBetween(change.start-parse.from-1,change.start-parse.from+1)&&(change.start--,change.endA--,change.endB--);var nextSel,$from=parse.doc.resolveNoCache(change.start-parse.from),$to=parse.doc.resolveNoCache(change.endB-parse.from),inlineChange=$from.sameParent($to)&&$from.parent.inlineContent;if((result.ios&&view.lastIOSEnter>Date.now()-225&&(!inlineChange||addedNodes.some((function(n){return"DIV"==n.nodeName||"P"==n.nodeName})))||!inlineChange&&$from.pos<parse.doc.content.size&&(nextSel=Selection.findFrom(parse.doc.resolve($from.pos+1),1,!0))&&nextSel.head==$to.pos)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})))view.lastIOSEnter=0;else if(view.state.selection.anchor>change.start&&function looksLikeJoin(old,start,end,$newStart,$newEnd){if(!$newStart.parent.isTextblock||end-start<=$newEnd.pos-$newStart.pos||skipClosingAndOpening($newStart,!0,!1)<$newEnd.pos)return!1;var $start=old.resolve(start);if($start.parentOffset<$start.parent.content.size||!$start.parent.isTextblock)return!1;var $next=old.resolve(skipClosingAndOpening($start,!0,!0));if(!$next.parent.isTextblock||$next.pos>end||skipClosingAndOpening($next,!0,!1)<end)return!1;return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)}(doc,change.start,change.endA,$from,$to)&&view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(8,"Backspace"))})))result.android&&result.chrome&&view.domObserver.suppressSelectionUpdates();else{result.chrome&&result.android&&change.toB==change.from&&(view.lastAndroidDelete=Date.now()),result.android&&!inlineChange&&$from.start()!=$to.start()&&0==$to.parentOffset&&$from.depth==$to.depth&&parse.sel&&parse.sel.anchor==parse.sel.head&&parse.sel.head==change.endA&&(change.endB-=2,$to=parse.doc.resolveNoCache(change.endB-parse.from),setTimeout((function(){view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))}))}),20));var tr,storedMarks,markChange,$from1,chFrom=change.start,chTo=change.endA;if(inlineChange)if($from.pos==$to.pos)result.ie&&result.ie_version<=11&&0==$from.parentOffset&&(view.domObserver.suppressSelectionUpdates(),setTimeout((function(){return selectionToDOM(view)}),20)),tr=view.state.tr.delete(chFrom,chTo),storedMarks=doc.resolve(change.start).marksAcross(doc.resolve(change.endA));else if(change.endA==change.endB&&($from1=doc.resolve(change.start))&&(markChange=function isMarkChange(cur,prev){for(var type,mark,update,curMarks=cur.firstChild.marks,prevMarks=prev.firstChild.marks,added=curMarks,removed=prevMarks,i=0;i<prevMarks.length;i++)added=prevMarks[i].removeFromSet(added);for(var i$1=0;i$1<curMarks.length;i$1++)removed=curMarks[i$1].removeFromSet(removed);if(1==added.length&&0==removed.length)mark=added[0],type="add",update=function update(node){return node.mark(mark.addToSet(node.marks))};else{if(0!=added.length||1!=removed.length)return null;mark=removed[0],type="remove",update=function update(node){return node.mark(mark.removeFromSet(node.marks))}}for(var updated=[],i$2=0;i$2<prev.childCount;i$2++)updated.push(update(prev.child(i$2)));if(Fragment.from(updated).eq(cur))return{mark,type}}($from.parent.content.cut($from.parentOffset,$to.parentOffset),$from1.parent.content.cut($from1.parentOffset,change.endA-$from1.start()))))tr=view.state.tr,"add"==markChange.type?tr.addMark(chFrom,chTo,markChange.mark):tr.removeMark(chFrom,chTo,markChange.mark);else if($from.parent.child($from.index()).isText&&$from.index()==$to.index()-($to.textOffset?0:1)){var text$1=$from.parent.textBetween($from.parentOffset,$to.parentOffset);if(view.someProp("handleTextInput",(function(f){return f(view,chFrom,chTo,text$1)})))return;tr=view.state.tr.insertText(text$1,chFrom,chTo)}if(tr||(tr=view.state.tr.replace(chFrom,chTo,parse.doc.slice(change.start-parse.from,change.endB-parse.from))),parse.sel){var sel$2=resolveSelection(view,tr.doc,parse.sel);sel$2&&!(result.chrome&&result.android&&view.composing&&sel$2.empty&&(change.start!=change.endB||view.lastAndroidDelete<Date.now()-100)&&(sel$2.head==chFrom||sel$2.head==tr.mapping.map(chTo)-1)||result.ie&&sel$2.empty&&sel$2.head==chFrom)&&tr.setSelection(sel$2)}storedMarks&&tr.ensureMarks(storedMarks),view.dispatch(tr.scrollIntoView())}}}function resolveSelection(view,doc,parsedSel){return Math.max(parsedSel.anchor,parsedSel.head)>doc.content.size?null:selectionBetween(view,doc.resolve(parsedSel.anchor),doc.resolve(parsedSel.head))}function skipClosingAndOpening($pos,fromEnd,mayOpen){for(var depth=$pos.depth,end=fromEnd?$pos.end():$pos.pos;depth>0&&(fromEnd||$pos.indexAfter(depth)==$pos.node(depth).childCount);)depth--,end++,fromEnd=!1;if(mayOpen)for(var next=$pos.node(depth).maybeChild($pos.indexAfter(depth));next&&!next.isLeaf;)next=next.firstChild,end++;return end}function serializeForClipboard(view,slice){for(var context=[],content=slice.content,openStart=slice.openStart,openEnd=slice.openEnd;openStart>1&&openEnd>1&&1==content.childCount&&1==content.firstChild.childCount;){openStart--,openEnd--;var node=content.firstChild;context.push(node.type.name,node.attrs!=node.type.defaultAttrs?node.attrs:null),content=node.content}var serializer=view.someProp("clipboardSerializer")||DOMSerializer.fromSchema(view.state.schema),doc=detachedDoc(),wrap=doc.createElement("div");wrap.appendChild(serializer.serializeFragment(content,{document:doc}));for(var needsWrap,firstChild=wrap.firstChild;firstChild&&1==firstChild.nodeType&&(needsWrap=wrapMap[firstChild.nodeName.toLowerCase()]);){for(var i=needsWrap.length-1;i>=0;i--){for(var wrapper=doc.createElement(needsWrap[i]);wrap.firstChild;)wrapper.appendChild(wrap.firstChild);wrap.appendChild(wrapper),"tbody"!=needsWrap[i]&&(openStart++,openEnd++)}firstChild=wrap.firstChild}return firstChild&&1==firstChild.nodeType&&firstChild.setAttribute("data-pm-slice",openStart+" "+openEnd+" "+JSON.stringify(context)),{dom:wrap,text:view.someProp("clipboardTextSerializer",(function(f){return f(slice)}))||slice.content.textBetween(0,slice.content.size,"\n\n")}}function parseFromClipboard(view,text,html,plainText,$context){var dom,slice,inCode=$context.parent.type.spec.code;if(!html&&!text)return null;var asText=text&&(plainText||inCode||!html);if(asText){if(view.someProp("transformPastedText",(function(f){text=f(text,inCode||plainText)})),inCode)return text?new Slice(Fragment.from(view.state.schema.text(text.replace(/\r\n?/g,"\n"))),0,0):Slice.empty;var parsed=view.someProp("clipboardTextParser",(function(f){return f(text,$context,plainText)}));if(parsed)slice=parsed;else{var marks=$context.marks(),schema=view.state.schema,serializer=DOMSerializer.fromSchema(schema);dom=document.createElement("div"),text.split(/(?:\r\n?|\n)+/).forEach((function(block){var p=dom.appendChild(document.createElement("p"));block&&p.appendChild(serializer.serializeNode(schema.text(block,marks)))}))}}else view.someProp("transformPastedHTML",(function(f){html=f(html)})),dom=function readHTML(html){var metas=/^(\s*<meta [^>]*>)*/.exec(html);metas&&(html=html.slice(metas[0].length));var wrap,elt=detachedDoc().createElement("div"),firstTag=/<([a-z][^>\s]+)/i.exec(html);(wrap=firstTag&&wrapMap[firstTag[1].toLowerCase()])&&(html=wrap.map((function(n){return"<"+n+">"})).join("")+html+wrap.map((function(n){return"</"+n+">"})).reverse().join(""));if(elt.innerHTML=html,wrap)for(var i=0;i<wrap.length;i++)elt=elt.querySelector(wrap[i])||elt;return elt}(html),result.webkit&&function restoreReplacedSpaces(dom){for(var nodes=dom.querySelectorAll(result.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),i=0;i<nodes.length;i++){var node=nodes[i];1==node.childNodes.length&&""==node.textContent&&node.parentNode&&node.parentNode.replaceChild(dom.ownerDocument.createTextNode(" "),node)}}(dom);var contextNode=dom&&dom.querySelector("[data-pm-slice]"),sliceData=contextNode&&/^(\d+) (\d+) (.*)/.exec(contextNode.getAttribute("data-pm-slice"));if(!slice){var parser=view.someProp("clipboardParser")||view.someProp("domParser")||DOMParser.fromSchema(view.state.schema);slice=parser.parseSlice(dom,{preserveWhitespace:!(!asText&&!sliceData),context:$context,ruleFromNode:function ruleFromNode(dom){if("BR"==dom.nodeName&&!dom.nextSibling&&dom.parentNode&&!inlineParents.test(dom.parentNode.nodeName))return{ignore:!0}}})}if(sliceData)slice=function addContext(slice,context){if(!slice.size)return slice;var array,schema=slice.content.firstChild.type.schema;try{array=JSON.parse(context)}catch(e){return slice}for(var content=slice.content,openStart=slice.openStart,openEnd=slice.openEnd,i=array.length-2;i>=0;i-=2){var type=schema.nodes[array[i]];if(!type||type.hasRequiredAttrs())break;content=Fragment.from(type.create(array[i+1],content)),openStart++,openEnd++}return new Slice(content,openStart,openEnd)}(closeSlice(slice,+sliceData[1],+sliceData[2]),sliceData[3]);else if(slice=Slice.maxOpen(function normalizeSiblings(fragment,$context){if(fragment.childCount<2)return fragment;for(var loop=function loop(d){var match=$context.node(d).contentMatchAt($context.index(d)),lastWrap=void 0,result=[];if(fragment.forEach((function(node){if(result){var inLast,wrap=match.findWrapping(node.type);if(!wrap)return result=null;if(inLast=result.length&&lastWrap.length&&addToSibling(wrap,lastWrap,node,result[result.length-1],0))result[result.length-1]=inLast;else{result.length&&(result[result.length-1]=closeRight(result[result.length-1],lastWrap.length));var wrapped=withWrappers(node,wrap);result.push(wrapped),match=match.matchType(wrapped.type,wrapped.attrs),lastWrap=wrap}}})),result)return{v:Fragment.from(result)}},d=$context.depth;d>=0;d--){var returned=loop(d);if(returned)return returned.v}return fragment}(slice.content,$context),!0),slice.openStart||slice.openEnd){for(var openStart=0,openEnd=0,node=slice.content.firstChild;openStart<slice.openStart&&!node.type.spec.isolating;openStart++,node=node.firstChild);for(var node$1=slice.content.lastChild;openEnd<slice.openEnd&&!node$1.type.spec.isolating;openEnd++,node$1=node$1.lastChild);slice=closeSlice(slice,openStart,openEnd)}return view.someProp("transformPasted",(function(f){slice=f(slice)})),slice}var inlineParents=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function withWrappers(node,wrap,from){void 0===from&&(from=0);for(var i=wrap.length-1;i>=from;i--)node=wrap[i].create(null,Fragment.from(node));return node}function addToSibling(wrap,lastWrap,node,sibling,depth){if(depth<wrap.length&&depth<lastWrap.length&&wrap[depth]==lastWrap[depth]){var inner=addToSibling(wrap,lastWrap,node,sibling.lastChild,depth+1);if(inner)return sibling.copy(sibling.content.replaceChild(sibling.childCount-1,inner));if(sibling.contentMatchAt(sibling.childCount).matchType(depth==wrap.length-1?node.type:wrap[depth+1]))return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node,wrap,depth+1))))}}function closeRight(node,depth){if(0==depth)return node;var fragment=node.content.replaceChild(node.childCount-1,closeRight(node.lastChild,depth-1)),fill=node.contentMatchAt(node.childCount).fillBefore(Fragment.empty,!0);return node.copy(fragment.append(fill))}function closeRange(fragment,side,from,to,depth,openEnd){var node=side<0?fragment.firstChild:fragment.lastChild,inner=node.content;return depth<to-1&&(inner=closeRange(inner,side,from,to,depth+1,openEnd)),depth>=from&&(inner=side<0?node.contentMatchAt(0).fillBefore(inner,fragment.childCount>1||openEnd<=depth).append(inner):inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty,!0))),fragment.replaceChild(side<0?0:fragment.childCount-1,node.copy(inner))}function closeSlice(slice,openStart,openEnd){return openStart<slice.openStart&&(slice=new Slice(closeRange(slice.content,-1,openStart,slice.openStart,0,slice.openEnd),openStart,slice.openEnd)),openEnd<slice.openEnd&&(slice=new Slice(closeRange(slice.content,1,openEnd,slice.openEnd,0,0),slice.openStart,openEnd)),slice}var wrapMap={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},_detachedDoc=null;function detachedDoc(){return _detachedDoc||(_detachedDoc=document.implementation.createHTMLDocument("title"))}var observeOptions={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},useCharData=result.ie&&result.ie_version<=11,SelectionState=function SelectionState(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};SelectionState.prototype.set=function set(sel){this.anchorNode=sel.anchorNode,this.anchorOffset=sel.anchorOffset,this.focusNode=sel.focusNode,this.focusOffset=sel.focusOffset},SelectionState.prototype.eq=function eq(sel){return sel.anchorNode==this.anchorNode&&sel.anchorOffset==this.anchorOffset&&sel.focusNode==this.focusNode&&sel.focusOffset==this.focusOffset};var DOMObserver=function DOMObserver(view,handleDOMChange){var this$1=this;this.view=view,this.handleDOMChange=handleDOMChange,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(mutations){for(var i=0;i<mutations.length;i++)this$1.queue.push(mutations[i]);result.ie&&result.ie_version<=11&&mutations.some((function(m){return"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length}))?this$1.flushSoon():this$1.flush()})),this.currentSelection=new SelectionState,useCharData&&(this.onCharData=function(e){this$1.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this$1.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};DOMObserver.prototype.flushSoon=function flushSoon(){var this$1=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){this$1.flushingSoon=-1,this$1.flush()}),20))},DOMObserver.prototype.forceFlush=function forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},DOMObserver.prototype.start=function start(){this.observer&&this.observer.observe(this.view.dom,observeOptions),useCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},DOMObserver.prototype.stop=function stop(){var this$1=this;if(this.observer){var take=this.observer.takeRecords();if(take.length){for(var i=0;i<take.length;i++)this.queue.push(take[i]);window.setTimeout((function(){return this$1.flush()}),20)}this.observer.disconnect()}useCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},DOMObserver.prototype.connectSelection=function connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},DOMObserver.prototype.disconnectSelection=function disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},DOMObserver.prototype.suppressSelectionUpdates=function suppressSelectionUpdates(){var this$1=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return this$1.suppressingSelectionUpdates=!1}),50)},DOMObserver.prototype.onSelectionChange=function onSelectionChange(){if(function hasFocusAndSelection(view){return(!view.editable||view.root.activeElement==view.dom)&&hasSelection(view)}(this.view)){if(this.suppressingSelectionUpdates)return selectionToDOM(this.view);if(result.ie&&result.ie_version<=11&&!this.view.state.selection.empty){var sel=this.view.root.getSelection();if(sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset))return this.flushSoon()}this.flush()}},DOMObserver.prototype.setCurSelection=function setCurSelection(){this.currentSelection.set(this.view.root.getSelection())},DOMObserver.prototype.ignoreSelectionChange=function ignoreSelectionChange(sel){if(0==sel.rangeCount)return!0;var container=sel.getRangeAt(0).commonAncestorContainer,desc=this.view.docView.nearestDesc(container);return desc&&desc.ignoreMutation({type:"selection",target:3==container.nodeType?container.parentNode:container})?(this.setCurSelection(),!0):void 0},DOMObserver.prototype.flush=function flush(){if(this.view.docView&&!(this.flushingSoon>-1)){var mutations=this.observer?this.observer.takeRecords():[];this.queue.length&&(mutations=this.queue.concat(mutations),this.queue.length=0);var sel=this.view.root.getSelection(),newSel=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(sel)&&hasSelection(this.view)&&!this.ignoreSelectionChange(sel),from=-1,to=-1,typeOver=!1,added=[];if(this.view.editable)for(var i=0;i<mutations.length;i++){var result$1=this.registerMutation(mutations[i],added);result$1&&(from=from<0?result$1.from:Math.min(result$1.from,from),to=to<0?result$1.to:Math.max(result$1.to,to),result$1.typeOver&&(typeOver=!0))}if(result.gecko&&added.length>1){var brs=added.filter((function(n){return"BR"==n.nodeName}));if(2==brs.length){var a=brs[0],b=brs[1];a.parentNode&&a.parentNode.parentNode==b.parentNode?b.remove():a.remove()}}(from>-1||newSel)&&(from>-1&&(this.view.docView.markDirty(from,to),function checkCSS(view){if(cssChecked)return;cssChecked=!0,"normal"==getComputedStyle(view.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(from,to,typeOver,added),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(sel)||selectionToDOM(this.view),this.currentSelection.set(sel))}},DOMObserver.prototype.registerMutation=function registerMutation(mut,added){if(added.indexOf(mut.target)>-1)return null;var desc=this.view.docView.nearestDesc(mut.target);if("attributes"==mut.type&&(desc==this.view.docView||"contenteditable"==mut.attributeName||"style"==mut.attributeName&&!mut.oldValue&&!mut.target.getAttribute("style")))return null;if(!desc||desc.ignoreMutation(mut))return null;if("childList"==mut.type){for(var i=0;i<mut.addedNodes.length;i++)added.push(mut.addedNodes[i]);if(desc.contentDOM&&desc.contentDOM!=desc.dom&&!desc.contentDOM.contains(mut.target))return{from:desc.posBefore,to:desc.posAfter};var prev=mut.previousSibling,next=mut.nextSibling;if(result.ie&&result.ie_version<=11&&mut.addedNodes.length)for(var i$1=0;i$1<mut.addedNodes.length;i$1++){var ref=mut.addedNodes[i$1],previousSibling=ref.previousSibling,nextSibling=ref.nextSibling;(!previousSibling||Array.prototype.indexOf.call(mut.addedNodes,previousSibling)<0)&&(prev=previousSibling),(!nextSibling||Array.prototype.indexOf.call(mut.addedNodes,nextSibling)<0)&&(next=nextSibling)}var fromOffset=prev&&prev.parentNode==mut.target?domIndex(prev)+1:0,from=desc.localPosFromDOM(mut.target,fromOffset,-1),toOffset=next&&next.parentNode==mut.target?domIndex(next):mut.target.childNodes.length;return{from,to:desc.localPosFromDOM(mut.target,toOffset,1)}}return"attributes"==mut.type?{from:desc.posAtStart-desc.border,to:desc.posAtEnd+desc.border}:{from:desc.posAtStart,to:desc.posAtEnd,typeOver:mut.target.nodeValue==mut.oldValue}};var cssChecked=!1;var handlers={},editHandlers={};function setSelectionOrigin(view,origin){view.lastSelectionOrigin=origin,view.lastSelectionTime=Date.now()}function ensureListeners(view){view.someProp("handleDOMEvents",(function(currentHandlers){for(var type in currentHandlers)view.eventHandlers[type]||view.dom.addEventListener(type,view.eventHandlers[type]=function(event){return runCustomHandler(view,event)})}))}function runCustomHandler(view,event){return view.someProp("handleDOMEvents",(function(handlers){var handler=handlers[event.type];return!!handler&&(handler(view,event)||event.defaultPrevented)}))}function eventCoords(event){return{left:event.clientX,top:event.clientY}}function runHandlerOnContext(view,propName,pos,inside,event){if(-1==inside)return!1;for(var $pos=view.state.doc.resolve(inside),loop=function loop(i){if(view.someProp(propName,(function(f){return i>$pos.depth?f(view,pos,$pos.nodeAfter,$pos.before(i),event,!0):f(view,pos,$pos.node(i),$pos.before(i),event,!1)})))return{v:!0}},i=$pos.depth+1;i>0;i--){var returned=loop(i);if(returned)return returned.v}return!1}function updateSelection(view,selection,origin){view.focused||view.focus();var tr=view.state.tr.setSelection(selection);"pointer"==origin&&tr.setMeta("pointer",!0),view.dispatch(tr)}function handleSingleClick(view,pos,inside,event,selectNode){return runHandlerOnContext(view,"handleClickOn",pos,inside,event)||view.someProp("handleClick",(function(f){return f(view,pos,event)}))||(selectNode?function selectClickedNode(view,inside){if(-1==inside)return!1;var selectedNode,selectAt,sel=view.state.selection;sel instanceof NodeSelection&&(selectedNode=sel.node);for(var $pos=view.state.doc.resolve(inside),i=$pos.depth+1;i>0;i--){var node=i>$pos.depth?$pos.nodeAfter:$pos.node(i);if(NodeSelection.isSelectable(node)){selectAt=selectedNode&&sel.$from.depth>0&&i>=sel.$from.depth&&$pos.before(sel.$from.depth+1)==sel.$from.pos?$pos.before(sel.$from.depth):$pos.before(i);break}}return null!=selectAt&&(updateSelection(view,NodeSelection.create(view.state.doc,selectAt),"pointer"),!0)}(view,inside):function selectClickedLeaf(view,inside){if(-1==inside)return!1;var $pos=view.state.doc.resolve(inside),node=$pos.nodeAfter;return!!(node&&node.isAtom&&NodeSelection.isSelectable(node))&&(updateSelection(view,new NodeSelection($pos),"pointer"),!0)}(view,inside))}function handleDoubleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleDoubleClickOn",pos,inside,event)||view.someProp("handleDoubleClick",(function(f){return f(view,pos,event)}))}function handleTripleClick(view,pos,inside,event){return runHandlerOnContext(view,"handleTripleClickOn",pos,inside,event)||view.someProp("handleTripleClick",(function(f){return f(view,pos,event)}))||function defaultTripleClick(view,inside,event){if(0!=event.button)return!1;var doc=view.state.doc;if(-1==inside)return!!doc.inlineContent&&(updateSelection(view,TextSelection.create(doc,0,doc.content.size),"pointer"),!0);for(var $pos=doc.resolve(inside),i=$pos.depth+1;i>0;i--){var node=i>$pos.depth?$pos.nodeAfter:$pos.node(i),nodePos=$pos.before(i);if(node.inlineContent)updateSelection(view,TextSelection.create(doc,nodePos+1,nodePos+1+node.content.size),"pointer");else{if(!NodeSelection.isSelectable(node))continue;updateSelection(view,NodeSelection.create(doc,nodePos),"pointer")}return!0}}(view,inside,event)}function forceDOMFlush(view){return endComposition(view)}editHandlers.keydown=function(view,event){if(view.shiftKey=16==event.keyCode||event.shiftKey,!inOrNearComposition(view,event)&&(view.lastKeyCode=event.keyCode,view.lastKeyCodeTime=Date.now(),!result.android||!result.chrome||13!=event.keyCode))if(229!=event.keyCode&&view.domObserver.forceFlush(),!result.ios||13!=event.keyCode||event.ctrlKey||event.altKey||event.metaKey)view.someProp("handleKeyDown",(function(f){return f(view,event)}))||captureKeyDown(view,event)?event.preventDefault():setSelectionOrigin(view,"key");else{var now=Date.now();view.lastIOSEnter=now,view.lastIOSEnterFallbackTimeout=setTimeout((function(){view.lastIOSEnter==now&&(view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(13,"Enter"))})),view.lastIOSEnter=0)}),200)}},editHandlers.keyup=function(view,e){16==e.keyCode&&(view.shiftKey=!1)},editHandlers.keypress=function(view,event){if(!(inOrNearComposition(view,event)||!event.charCode||event.ctrlKey&&!event.altKey||result.mac&&event.metaKey))if(view.someProp("handleKeyPress",(function(f){return f(view,event)})))event.preventDefault();else{var sel=view.state.selection;if(!(sel instanceof TextSelection&&sel.$from.sameParent(sel.$to))){var text=String.fromCharCode(event.charCode);view.someProp("handleTextInput",(function(f){return f(view,sel.$from.pos,sel.$to.pos,text)}))||view.dispatch(view.state.tr.insertText(text).scrollIntoView()),event.preventDefault()}}};var selectNodeModifier=result.mac?"metaKey":"ctrlKey";handlers.mousedown=function(view,event){view.shiftKey=event.shiftKey;var flushed=forceDOMFlush(view),now=Date.now(),type="singleClick";now-view.lastClick.time<500&&function isNear(event,click){var dx=click.x-event.clientX,dy=click.y-event.clientY;return dx*dx+dy*dy<100}(event,view.lastClick)&&!event[selectNodeModifier]&&("singleClick"==view.lastClick.type?type="doubleClick":"doubleClick"==view.lastClick.type&&(type="tripleClick")),view.lastClick={time:now,x:event.clientX,y:event.clientY,type};var pos=view.posAtCoords(eventCoords(event));pos&&("singleClick"==type?(view.mouseDown&&view.mouseDown.done(),view.mouseDown=new MouseDown(view,pos,event,flushed)):("doubleClick"==type?handleDoubleClick:handleTripleClick)(view,pos.pos,pos.inside,event)?event.preventDefault():setSelectionOrigin(view,"pointer"))};var MouseDown=function MouseDown(view,pos,event,flushed){var targetNode,targetPos,this$1=this;if(this.view=view,this.startDoc=view.state.doc,this.pos=pos,this.event=event,this.flushed=flushed,this.selectNode=event[selectNodeModifier],this.allowDefault=event.shiftKey,this.delayedSelectionSync=!1,pos.inside>-1)targetNode=view.state.doc.nodeAt(pos.inside),targetPos=pos.inside;else{var $pos=view.state.doc.resolve(pos.pos);targetNode=$pos.parent,targetPos=$pos.depth?$pos.before():0}this.mightDrag=null;var target=flushed?null:event.target,targetDesc=target?view.docView.nearestDesc(target,!0):null;this.target=targetDesc?targetDesc.dom:null;var selection=view.state.selection;(0==event.button&&targetNode.type.spec.draggable&&!1!==targetNode.type.spec.selectable||selection instanceof NodeSelection&&selection.from<=targetPos&&selection.to>targetPos)&&(this.mightDrag={node:targetNode,pos:targetPos,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&result.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){this$1.view.mouseDown==this$1&&this$1.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),view.root.addEventListener("mouseup",this.up=this.up.bind(this)),view.root.addEventListener("mousemove",this.move=this.move.bind(this)),setSelectionOrigin(view,"pointer")};function inOrNearComposition(view,event){return!!view.composing||!!(result.safari&&Math.abs(event.timeStamp-view.compositionEndedAt)<500)&&(view.compositionEndedAt=-2e8,!0)}MouseDown.prototype.done=function done(){var this$1=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return selectionToDOM(this$1.view)})),this.view.mouseDown=null},MouseDown.prototype.up=function up(event){if(this.done(),this.view.dom.contains(3==event.target.nodeType?event.target.parentNode:event.target)){var pos=this.pos;this.view.state.doc!=this.startDoc&&(pos=this.view.posAtCoords(eventCoords(event))),this.allowDefault||!pos?setSelectionOrigin(this.view,"pointer"):handleSingleClick(this.view,pos.pos,pos.inside,event,this.selectNode)?event.preventDefault():0==event.button&&(this.flushed||result.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||result.chrome&&!(this.view.state.selection instanceof TextSelection)&&Math.min(Math.abs(pos.pos-this.view.state.selection.from),Math.abs(pos.pos-this.view.state.selection.to))<=2)?(updateSelection(this.view,Selection.near(this.view.state.doc.resolve(pos.pos)),"pointer"),event.preventDefault()):setSelectionOrigin(this.view,"pointer")}},MouseDown.prototype.move=function move(event){!this.allowDefault&&(Math.abs(this.event.x-event.clientX)>4||Math.abs(this.event.y-event.clientY)>4)&&(this.allowDefault=!0),setSelectionOrigin(this.view,"pointer"),0==event.buttons&&this.done()},handlers.touchdown=function(view){forceDOMFlush(view),setSelectionOrigin(view,"pointer")},handlers.contextmenu=function(view){return forceDOMFlush(view)};var timeoutComposition=result.android?5e3:-1;function scheduleComposeEnd(view,delay){clearTimeout(view.composingTimeout),delay>-1&&(view.composingTimeout=setTimeout((function(){return endComposition(view)}),delay))}function clearComposition(view){for(view.composing&&(view.composing=!1,view.compositionEndedAt=function timestampFromCustomEvent(){var event=document.createEvent("Event");return event.initEvent("event",!0,!0),event.timeStamp}());view.compositionNodes.length>0;)view.compositionNodes.pop().markParentsDirty()}function endComposition(view,forceUpdate){if(!(result.android&&view.domObserver.flushingSoon>=0)){if(view.domObserver.forceFlush(),clearComposition(view),forceUpdate||view.docView.dirty){var sel=selectionFromDOM(view);return sel&&!sel.eq(view.state.selection)?view.dispatch(view.state.tr.setSelection(sel)):view.updateState(view.state),!0}return!1}}editHandlers.compositionstart=editHandlers.compositionupdate=function(view){if(!view.composing){view.domObserver.flush();var state=view.state,$pos=state.selection.$from;if(state.selection.empty&&(state.storedMarks||!$pos.textOffset&&$pos.parentOffset&&$pos.nodeBefore.marks.some((function(m){return!1===m.type.spec.inclusive}))))view.markCursor=view.state.storedMarks||$pos.marks(),endComposition(view,!0),view.markCursor=null;else if(endComposition(view),result.gecko&&state.selection.empty&&$pos.parentOffset&&!$pos.textOffset&&$pos.nodeBefore.marks.length)for(var sel=view.root.getSelection(),node=sel.focusNode,offset=sel.focusOffset;node&&1==node.nodeType&&0!=offset;){var before=offset<0?node.lastChild:node.childNodes[offset-1];if(!before)break;if(3==before.nodeType){sel.collapse(before,before.nodeValue.length);break}node=before,offset=-1}view.composing=!0}scheduleComposeEnd(view,timeoutComposition)},editHandlers.compositionend=function(view,event){view.composing&&(view.composing=!1,view.compositionEndedAt=event.timeStamp,scheduleComposeEnd(view,20))};var brokenClipboardAPI=result.ie&&result.ie_version<15||result.ios&&result.webkit_version<604;function doPaste(view,text,html,e){var slice=parseFromClipboard(view,text,html,view.shiftKey,view.state.selection.$from);if(view.someProp("handlePaste",(function(f){return f(view,e,slice||Slice.empty)})))return!0;if(!slice)return!1;var singleNode=function sliceSingleNode(slice){return 0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount?slice.content.firstChild:null}(slice),tr=singleNode?view.state.tr.replaceSelectionWith(singleNode,view.shiftKey):view.state.tr.replaceSelection(slice);return view.dispatch(tr.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}handlers.copy=editHandlers.cut=function(view,e){var sel=view.state.selection,cut="cut"==e.type;if(!sel.empty){var data=brokenClipboardAPI?null:e.clipboardData,ref=serializeForClipboard(view,sel.content()),dom=ref.dom,text=ref.text;data?(e.preventDefault(),data.clearData(),data.setData("text/html",dom.innerHTML),data.setData("text/plain",text)):function captureCopy(view,dom){if(view.dom.parentNode){var wrap=view.dom.parentNode.appendChild(document.createElement("div"));wrap.appendChild(dom),wrap.style.cssText="position: fixed; left: -10000px; top: 10px";var sel=getSelection(),range=document.createRange();range.selectNodeContents(dom),view.dom.blur(),sel.removeAllRanges(),sel.addRange(range),setTimeout((function(){wrap.parentNode&&wrap.parentNode.removeChild(wrap),view.focus()}),50)}}(view,dom),cut&&view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},editHandlers.paste=function(view,e){if(!view.composing||result.android){var data=brokenClipboardAPI?null:e.clipboardData;data&&doPaste(view,data.getData("text/plain"),data.getData("text/html"),e)?e.preventDefault():function capturePaste(view,e){if(view.dom.parentNode){var plainText=view.shiftKey||view.state.selection.$from.parent.type.spec.code,target=view.dom.parentNode.appendChild(document.createElement(plainText?"textarea":"div"));plainText||(target.contentEditable="true"),target.style.cssText="position: fixed; left: -10000px; top: 10px",target.focus(),setTimeout((function(){view.focus(),target.parentNode&&target.parentNode.removeChild(target),plainText?doPaste(view,target.value,null,e):doPaste(view,target.textContent,target.innerHTML,e)}),50)}}(view,e)}};var Dragging=function Dragging(slice,move){this.slice=slice,this.move=move},dragCopyModifier=result.mac?"altKey":"ctrlKey";for(var prop$1 in handlers.dragstart=function(view,e){var mouseDown=view.mouseDown;if(mouseDown&&mouseDown.done(),e.dataTransfer){var sel=view.state.selection,pos=sel.empty?null:view.posAtCoords(eventCoords(e));if(pos&&pos.pos>=sel.from&&pos.pos<=(sel instanceof NodeSelection?sel.to-1:sel.to));else if(mouseDown&&mouseDown.mightDrag)view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc,mouseDown.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var desc=view.docView.nearestDesc(e.target,!0);desc&&desc.node.type.spec.draggable&&desc!=view.docView&&view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc,desc.posBefore)))}var slice=view.state.selection.content(),ref=serializeForClipboard(view,slice),dom=ref.dom,text=ref.text;e.dataTransfer.clearData(),e.dataTransfer.setData(brokenClipboardAPI?"Text":"text/html",dom.innerHTML),e.dataTransfer.effectAllowed="copyMove",brokenClipboardAPI||e.dataTransfer.setData("text/plain",text),view.dragging=new Dragging(slice,!e[dragCopyModifier])}},handlers.dragend=function(view){var dragging=view.dragging;window.setTimeout((function(){view.dragging==dragging&&(view.dragging=null)}),50)},editHandlers.dragover=editHandlers.dragenter=function(_,e){return e.preventDefault()},editHandlers.drop=function(view,e){var dragging=view.dragging;if(view.dragging=null,e.dataTransfer){var eventPos=view.posAtCoords(eventCoords(e));if(eventPos){var $mouse=view.state.doc.resolve(eventPos.pos);if($mouse){var slice=dragging&&dragging.slice;slice?view.someProp("transformPasted",(function(f){slice=f(slice)})):slice=parseFromClipboard(view,e.dataTransfer.getData(brokenClipboardAPI?"Text":"text/plain"),brokenClipboardAPI?null:e.dataTransfer.getData("text/html"),!1,$mouse);var move=dragging&&!e[dragCopyModifier];if(view.someProp("handleDrop",(function(f){return f(view,e,slice||Slice.empty,move)})))e.preventDefault();else if(slice){e.preventDefault();var insertPos=slice?dropPoint(view.state.doc,$mouse.pos,slice):$mouse.pos;null==insertPos&&(insertPos=$mouse.pos);var tr=view.state.tr;move&&tr.deleteSelection();var pos=tr.mapping.map(insertPos),isNode=0==slice.openStart&&0==slice.openEnd&&1==slice.content.childCount,beforeInsert=tr.doc;if(isNode?tr.replaceRangeWith(pos,pos,slice.content.firstChild):tr.replaceRange(pos,pos,slice),!tr.doc.eq(beforeInsert)){var $pos=tr.doc.resolve(pos);if(isNode&&NodeSelection.isSelectable(slice.content.firstChild)&&$pos.nodeAfter&&$pos.nodeAfter.sameMarkup(slice.content.firstChild))tr.setSelection(new NodeSelection($pos));else{var end=tr.mapping.map(insertPos);tr.mapping.maps[tr.mapping.maps.length-1].forEach((function(_from,_to,_newFrom,newTo){return end=newTo})),tr.setSelection(selectionBetween(view,$pos,tr.doc.resolve(end)))}view.focus(),view.dispatch(tr.setMeta("uiEvent","drop"))}}}}}},handlers.focus=function(view){view.focused||(view.domObserver.stop(),view.dom.classList.add("ProseMirror-focused"),view.domObserver.start(),view.focused=!0,setTimeout((function(){view.docView&&view.hasFocus()&&!view.domObserver.currentSelection.eq(view.root.getSelection())&&selectionToDOM(view)}),20))},handlers.blur=function(view,e){view.focused&&(view.domObserver.stop(),view.dom.classList.remove("ProseMirror-focused"),view.domObserver.start(),e.relatedTarget&&view.dom.contains(e.relatedTarget)&&view.domObserver.currentSelection.set({}),view.focused=!1)},handlers.beforeinput=function(view,event){if(result.chrome&&result.android&&"deleteContentBackward"==event.inputType){view.domObserver.flushSoon();var domChangeCount=view.domChangeCount;setTimeout((function(){if(view.domChangeCount==domChangeCount&&(view.dom.blur(),view.focus(),!view.someProp("handleKeyDown",(function(f){return f(view,keyEvent(8,"Backspace"))})))){var $cursor=view.state.selection.$cursor;$cursor&&$cursor.pos>0&&view.dispatch(view.state.tr.delete($cursor.pos-1,$cursor.pos).scrollIntoView())}}),50)}},editHandlers)handlers[prop$1]=editHandlers[prop$1];function compareObjs(a,b){if(a==b)return!0;for(var p in a)if(a[p]!==b[p])return!1;for(var p$1 in b)if(!(p$1 in a))return!1;return!0}var WidgetType=function WidgetType(toDOM,spec){this.spec=spec||noSpec,this.side=this.spec.side||0,this.toDOM=toDOM};WidgetType.prototype.map=function map(mapping,span,offset,oldOffset){var ref=mapping.mapResult(span.from+oldOffset,this.side<0?-1:1),pos=ref.pos;return ref.deleted?null:new Decoration(pos-offset,pos-offset,this)},WidgetType.prototype.valid=function valid(){return!0},WidgetType.prototype.eq=function eq(other){return this==other||other instanceof WidgetType&&(this.spec.key&&this.spec.key==other.spec.key||this.toDOM==other.toDOM&&compareObjs(this.spec,other.spec))},WidgetType.prototype.destroy=function destroy(node){this.spec.destroy&&this.spec.destroy(node)};var InlineType=function InlineType(attrs,spec){this.spec=spec||noSpec,this.attrs=attrs};InlineType.prototype.map=function map(mapping,span,offset,oldOffset){var from=mapping.map(span.from+oldOffset,this.spec.inclusiveStart?-1:1)-offset,to=mapping.map(span.to+oldOffset,this.spec.inclusiveEnd?1:-1)-offset;return from>=to?null:new Decoration(from,to,this)},InlineType.prototype.valid=function valid(_,span){return span.from<span.to},InlineType.prototype.eq=function eq(other){return this==other||other instanceof InlineType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)},InlineType.is=function is(span){return span.type instanceof InlineType};var NodeType=function NodeType(attrs,spec){this.spec=spec||noSpec,this.attrs=attrs};NodeType.prototype.map=function map(mapping,span,offset,oldOffset){var from=mapping.mapResult(span.from+oldOffset,1);if(from.deleted)return null;var to=mapping.mapResult(span.to+oldOffset,-1);return to.deleted||to.pos<=from.pos?null:new Decoration(from.pos-offset,to.pos-offset,this)},NodeType.prototype.valid=function valid(node,span){var child,ref=node.content.findIndex(span.from),index=ref.index,offset=ref.offset;return offset==span.from&&!(child=node.child(index)).isText&&offset+child.nodeSize==span.to},NodeType.prototype.eq=function eq(other){return this==other||other instanceof NodeType&&compareObjs(this.attrs,other.attrs)&&compareObjs(this.spec,other.spec)};var Decoration=function Decoration(from,to,type){this.from=from,this.to=to,this.type=type},prototypeAccessors$1={spec:{configurable:!0},inline:{configurable:!0}};Decoration.prototype.copy=function copy(from,to){return new Decoration(from,to,this.type)},Decoration.prototype.eq=function eq(other,offset){return void 0===offset&&(offset=0),this.type.eq(other.type)&&this.from+offset==other.from&&this.to+offset==other.to},Decoration.prototype.map=function map(mapping,offset,oldOffset){return this.type.map(mapping,this,offset,oldOffset)},Decoration.widget=function widget(pos,toDOM,spec){return new Decoration(pos,pos,new WidgetType(toDOM,spec))},Decoration.inline=function inline(from,to,attrs,spec){return new Decoration(from,to,new InlineType(attrs,spec))},Decoration.node=function node(from,to,attrs,spec){return new Decoration(from,to,new NodeType(attrs,spec))},prototypeAccessors$1.spec.get=function(){return this.type.spec},prototypeAccessors$1.inline.get=function(){return this.type instanceof InlineType},Object.defineProperties(Decoration.prototype,prototypeAccessors$1);var none=[],noSpec={},DecorationSet=function DecorationSet(local,children){this.local=local&&local.length?local:none,this.children=children&&children.length?children:none};DecorationSet.create=function create(doc,decorations){return decorations.length?buildTree(decorations,doc,0,noSpec):empty$1},DecorationSet.prototype.find=function find(start,end,predicate){var result=[];return this.findInner(null==start?0:start,null==end?1e9:end,result,0,predicate),result},DecorationSet.prototype.findInner=function findInner(start,end,result,offset,predicate){for(var i=0;i<this.local.length;i++){var span=this.local[i];span.from<=end&&span.to>=start&&(!predicate||predicate(span.spec))&&result.push(span.copy(span.from+offset,span.to+offset))}for(var i$1=0;i$1<this.children.length;i$1+=3)if(this.children[i$1]<end&&this.children[i$1+1]>start){var childOff=this.children[i$1]+1;this.children[i$1+2].findInner(start-childOff,end-childOff,result,offset+childOff,predicate)}},DecorationSet.prototype.map=function map(mapping,doc,options){return this==empty$1||0==mapping.maps.length?this:this.mapInner(mapping,doc,0,0,options||noSpec)},DecorationSet.prototype.mapInner=function mapInner(mapping,node,offset,oldOffset,options){for(var newLocal,i=0;i<this.local.length;i++){var mapped=this.local[i].map(mapping,offset,oldOffset);mapped&&mapped.type.valid(node,mapped)?(newLocal||(newLocal=[])).push(mapped):options.onRemove&&options.onRemove(this.local[i].spec)}return this.children.length?function mapChildren(oldChildren,newLocal,mapping,node,offset,oldOffset,options){for(var children=oldChildren.slice(),shift=function shift(oldStart,oldEnd,newStart,newEnd){for(var i=0;i<children.length;i+=3){var end=children[i+1],dSize=void 0;-1==end||oldStart>end+oldOffset||(oldEnd>=children[i]+oldOffset?children[i+1]=-1:newStart>=offset&&(dSize=newEnd-newStart-(oldEnd-oldStart))&&(children[i]+=dSize,children[i+1]+=dSize))}},i=0;i<mapping.maps.length;i++)mapping.maps[i].forEach(shift);for(var mustRebuild=!1,i$1=0;i$1<children.length;i$1+=3)if(-1==children[i$1+1]){var from=mapping.map(oldChildren[i$1]+oldOffset),fromLocal=from-offset;if(fromLocal<0||fromLocal>=node.content.size){mustRebuild=!0;continue}var toLocal=mapping.map(oldChildren[i$1+1]+oldOffset,-1)-offset,ref=node.content.findIndex(fromLocal),index=ref.index,childOffset=ref.offset,childNode=node.maybeChild(index);if(childNode&&childOffset==fromLocal&&childOffset+childNode.nodeSize==toLocal){var mapped=children[i$1+2].mapInner(mapping,childNode,from+1,oldChildren[i$1]+oldOffset+1,options);mapped!=empty$1?(children[i$1]=fromLocal,children[i$1+1]=toLocal,children[i$1+2]=mapped):(children[i$1+1]=-2,mustRebuild=!0)}else mustRebuild=!0}if(mustRebuild){var decorations=function mapAndGatherRemainingDecorations(children,oldChildren,decorations,mapping,offset,oldOffset,options){function gather(set,oldOffset){for(var i=0;i<set.local.length;i++){var mapped=set.local[i].map(mapping,offset,oldOffset);mapped?decorations.push(mapped):options.onRemove&&options.onRemove(set.local[i].spec)}for(var i$1=0;i$1<set.children.length;i$1+=3)gather(set.children[i$1+2],set.children[i$1]+oldOffset+1)}for(var i=0;i<children.length;i+=3)-1==children[i+1]&&gather(children[i+2],oldChildren[i]+oldOffset+1);return decorations}(children,oldChildren,newLocal||[],mapping,offset,oldOffset,options),built=buildTree(decorations,node,0,options);newLocal=built.local;for(var i$2=0;i$2<children.length;i$2+=3)children[i$2+1]<0&&(children.splice(i$2,3),i$2-=3);for(var i$3=0,j=0;i$3<built.children.length;i$3+=3){for(var from$1=built.children[i$3];j<children.length&&children[j]<from$1;)j+=3;children.splice(j,0,built.children[i$3],built.children[i$3+1],built.children[i$3+2])}}return new DecorationSet(newLocal&&newLocal.sort(byPos),children)}(this.children,newLocal,mapping,node,offset,oldOffset,options):newLocal?new DecorationSet(newLocal.sort(byPos)):empty$1},DecorationSet.prototype.add=function add(doc,decorations){return decorations.length?this==empty$1?DecorationSet.create(doc,decorations):this.addInner(doc,decorations,0):this},DecorationSet.prototype.addInner=function addInner(doc,decorations,offset){var children,this$1=this,childIndex=0;doc.forEach((function(childNode,childOffset){var found,baseOffset=childOffset+offset;if(found=takeSpansForNode(decorations,childNode,baseOffset)){for(children||(children=this$1.children.slice());childIndex<children.length&&children[childIndex]<childOffset;)childIndex+=3;children[childIndex]==childOffset?children[childIndex+2]=children[childIndex+2].addInner(childNode,found,baseOffset+1):children.splice(childIndex,0,childOffset,childOffset+childNode.nodeSize,buildTree(found,childNode,baseOffset+1,noSpec)),childIndex+=3}}));for(var local=moveSpans(childIndex?withoutNulls(decorations):decorations,-offset),i=0;i<local.length;i++)local[i].type.valid(doc,local[i])||local.splice(i--,1);return new DecorationSet(local.length?this.local.concat(local).sort(byPos):this.local,children||this.children)},DecorationSet.prototype.remove=function remove(decorations){return 0==decorations.length||this==empty$1?this:this.removeInner(decorations,0)},DecorationSet.prototype.removeInner=function removeInner(decorations,offset){for(var children=this.children,local=this.local,i=0;i<children.length;i+=3){for(var found=void 0,from=children[i]+offset,to=children[i+1]+offset,j=0,span=void 0;j<decorations.length;j++)(span=decorations[j])&&span.from>from&&span.to<to&&(decorations[j]=null,(found||(found=[])).push(span));if(found){children==this.children&&(children=this.children.slice());var removed=children[i+2].removeInner(found,from+1);removed!=empty$1?children[i+2]=removed:(children.splice(i,3),i-=3)}}if(local.length)for(var i$1=0,span$1=void 0;i$1<decorations.length;i$1++)if(span$1=decorations[i$1])for(var j$1=0;j$1<local.length;j$1++)local[j$1].eq(span$1,offset)&&(local==this.local&&(local=this.local.slice()),local.splice(j$1--,1));return children==this.children&&local==this.local?this:local.length||children.length?new DecorationSet(local,children):empty$1},DecorationSet.prototype.forChild=function forChild(offset,node){if(this==empty$1)return this;if(node.isLeaf)return DecorationSet.empty;for(var child,local,i=0;i<this.children.length;i+=3)if(this.children[i]>=offset){this.children[i]==offset&&(child=this.children[i+2]);break}for(var start=offset+1,end=start+node.content.size,i$1=0;i$1<this.local.length;i$1++){var dec=this.local[i$1];if(dec.from<end&&dec.to>start&&dec.type instanceof InlineType){var from=Math.max(start,dec.from)-start,to=Math.min(end,dec.to)-start;from<to&&(local||(local=[])).push(dec.copy(from,to))}}if(local){var localSet=new DecorationSet(local.sort(byPos));return child?new DecorationGroup([localSet,child]):localSet}return child||empty$1},DecorationSet.prototype.eq=function eq(other){if(this==other)return!0;if(!(other instanceof DecorationSet)||this.local.length!=other.local.length||this.children.length!=other.children.length)return!1;for(var i=0;i<this.local.length;i++)if(!this.local[i].eq(other.local[i]))return!1;for(var i$1=0;i$1<this.children.length;i$1+=3)if(this.children[i$1]!=other.children[i$1]||this.children[i$1+1]!=other.children[i$1+1]||!this.children[i$1+2].eq(other.children[i$1+2]))return!1;return!0},DecorationSet.prototype.locals=function locals(node){return removeOverlap(this.localsInner(node))},DecorationSet.prototype.localsInner=function localsInner(node){if(this==empty$1)return none;if(node.inlineContent||!this.local.some(InlineType.is))return this.local;for(var result=[],i=0;i<this.local.length;i++)this.local[i].type instanceof InlineType||result.push(this.local[i]);return result};var empty$1=new DecorationSet;DecorationSet.empty=empty$1,DecorationSet.removeOverlap=removeOverlap;var DecorationGroup=function DecorationGroup(members){this.members=members};function moveSpans(spans,offset){if(!offset||!spans.length)return spans;for(var result=[],i=0;i<spans.length;i++){var span=spans[i];result.push(new Decoration(span.from+offset,span.to+offset,span.type))}return result}function takeSpansForNode(spans,node,offset){if(node.isLeaf)return null;for(var end=offset+node.nodeSize,found=null,i=0,span=void 0;i<spans.length;i++)(span=spans[i])&&span.from>offset&&span.to<end&&((found||(found=[])).push(span),spans[i]=null);return found}function withoutNulls(array){for(var result=[],i=0;i<array.length;i++)null!=array[i]&&result.push(array[i]);return result}function buildTree(spans,node,offset,options){var children=[],hasNulls=!1;node.forEach((function(childNode,localStart){var found=takeSpansForNode(spans,childNode,localStart+offset);if(found){hasNulls=!0;var subtree=buildTree(found,childNode,offset+localStart+1,options);subtree!=empty$1&&children.push(localStart,localStart+childNode.nodeSize,subtree)}}));for(var locals=moveSpans(hasNulls?withoutNulls(spans):spans,-offset).sort(byPos),i=0;i<locals.length;i++)locals[i].type.valid(node,locals[i])||(options.onRemove&&options.onRemove(locals[i].spec),locals.splice(i--,1));return locals.length||children.length?new DecorationSet(locals,children):empty$1}function byPos(a,b){return a.from-b.from||a.to-b.to}function removeOverlap(spans){for(var working=spans,i=0;i<working.length-1;i++){var span=working[i];if(span.from!=span.to)for(var j=i+1;j<working.length;j++){var next=working[j];if(next.from!=span.from){next.from<span.to&&(working==spans&&(working=spans.slice()),working[i]=span.copy(span.from,next.from),insertAhead(working,j,span.copy(next.from,span.to)));break}next.to!=span.to&&(working==spans&&(working=spans.slice()),working[j]=next.copy(next.from,span.to),insertAhead(working,j+1,next.copy(span.to,next.to)))}}return working}function insertAhead(array,i,deco){for(;i<array.length&&byPos(deco,array[i])>0;)i++;array.splice(i,0,deco)}function viewDecorations(view){var found=[];return view.someProp("decorations",(function(f){var result=f(view.state);result&&result!=empty$1&&found.push(result)})),view.cursorWrapper&&found.push(DecorationSet.create(view.state.doc,[view.cursorWrapper.deco])),DecorationGroup.from(found)}DecorationGroup.prototype.map=function map(mapping,doc){var mappedDecos=this.members.map((function(member){return member.map(mapping,doc,noSpec)}));return DecorationGroup.from(mappedDecos)},DecorationGroup.prototype.forChild=function forChild(offset,child){if(child.isLeaf)return DecorationSet.empty;for(var found=[],i=0;i<this.members.length;i++){var result=this.members[i].forChild(offset,child);result!=empty$1&&(result instanceof DecorationGroup?found=found.concat(result.members):found.push(result))}return DecorationGroup.from(found)},DecorationGroup.prototype.eq=function eq(other){if(!(other instanceof DecorationGroup)||other.members.length!=this.members.length)return!1;for(var i=0;i<this.members.length;i++)if(!this.members[i].eq(other.members[i]))return!1;return!0},DecorationGroup.prototype.locals=function locals(node){for(var result,sorted=!0,i=0;i<this.members.length;i++){var locals=this.members[i].localsInner(node);if(locals.length)if(result){sorted&&(result=result.slice(),sorted=!1);for(var j=0;j<locals.length;j++)result.push(locals[j])}else result=locals}return result?removeOverlap(sorted?result:result.sort(byPos)):none},DecorationGroup.from=function from(members){switch(members.length){case 0:return empty$1;case 1:return members[0];default:return new DecorationGroup(members)}};var EditorView=function EditorView(place,props){this._props=props,this.state=props.state,this.directPlugins=props.plugins||[],this.directPlugins.forEach(checkStateComponent),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=place&&place.mount||document.createElement("div"),place&&(place.appendChild?place.appendChild(this.dom):place.apply?place(this.dom):place.mount&&(this.mounted=!0)),this.editable=getEditable(this),this.markCursor=null,this.cursorWrapper=null,updateCursorWrapper(this),this.nodeViews=buildNodeViews(this),this.docView=docViewDesc(this.state.doc,computeDocDeco(this),viewDecorations(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function initInput(view){view.shiftKey=!1,view.mouseDown=null,view.lastKeyCode=null,view.lastKeyCodeTime=0,view.lastClick={time:0,x:0,y:0,type:""},view.lastSelectionOrigin=null,view.lastSelectionTime=0,view.lastIOSEnter=0,view.lastIOSEnterFallbackTimeout=null,view.lastAndroidDelete=0,view.composing=!1,view.composingTimeout=null,view.compositionNodes=[],view.compositionEndedAt=-2e8,view.domObserver=new DOMObserver(view,(function(from,to,typeOver,added){return readDOMChange(view,from,to,typeOver,added)})),view.domObserver.start(),view.domChangeCount=0,view.eventHandlers=Object.create(null);var loop=function loop(event){var handler=handlers[event];view.dom.addEventListener(event,view.eventHandlers[event]=function(event){!function eventBelongsToView(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(var node=event.target;node!=view.dom;node=node.parentNode)if(!node||11==node.nodeType||node.pmViewDesc&&node.pmViewDesc.stopEvent(event))return!1;return!0}(view,event)||runCustomHandler(view,event)||!view.editable&&event.type in editHandlers||handler(view,event)})};for(var event in handlers)loop(event);result.safari&&view.dom.addEventListener("input",(function(){return null})),ensureListeners(view)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},prototypeAccessors$2={props:{configurable:!0},root:{configurable:!0},isDestroyed:{configurable:!0}};function computeDocDeco(view){var attrs=Object.create(null);return attrs.class="ProseMirror",attrs.contenteditable=String(view.editable),attrs.translate="no",view.someProp("attributes",(function(value){if("function"==typeof value&&(value=value(view.state)),value)for(var attr in value)"class"==attr&&(attrs.class+=" "+value[attr]),"style"==attr?attrs.style=(attrs.style?attrs.style+";":"")+value[attr]:attrs[attr]||"contenteditable"==attr||"nodeName"==attr||(attrs[attr]=String(value[attr]))})),[Decoration.node(0,view.state.doc.content.size,attrs)]}function updateCursorWrapper(view){if(view.markCursor){var dom=document.createElement("img");dom.className="ProseMirror-separator",dom.setAttribute("mark-placeholder","true"),view.cursorWrapper={dom,deco:Decoration.widget(view.state.selection.head,dom,{raw:!0,marks:view.markCursor})}}else view.cursorWrapper=null}function getEditable(view){return!view.someProp("editable",(function(value){return!1===value(view.state)}))}function buildNodeViews(view){var result={};return view.someProp("nodeViews",(function(obj){for(var prop in obj)Object.prototype.hasOwnProperty.call(result,prop)||(result[prop]=obj[prop])})),result}function checkStateComponent(plugin){if(plugin.spec.state||plugin.spec.filterTransaction||plugin.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}prototypeAccessors$2.props.get=function(){if(this._props.state!=this.state){var prev=this._props;for(var name in this._props={},prev)this._props[name]=prev[name];this._props.state=this.state}return this._props},EditorView.prototype.update=function update(props){props.handleDOMEvents!=this._props.handleDOMEvents&&ensureListeners(this),this._props=props,props.plugins&&(props.plugins.forEach(checkStateComponent),this.directPlugins=props.plugins),this.updateStateInner(props.state,!0)},EditorView.prototype.setProps=function setProps(props){var updated={};for(var name in this._props)updated[name]=this._props[name];for(var name$1 in updated.state=this.state,props)updated[name$1]=props[name$1];this.update(updated)},EditorView.prototype.updateState=function updateState(state){this.updateStateInner(state,this.state.plugins!=state.plugins)},EditorView.prototype.updateStateInner=function updateStateInner(state,reconfigured){var this$1=this,prev=this.state,redraw=!1,updateSel=!1;if(state.storedMarks&&this.composing&&(clearComposition(this),updateSel=!0),this.state=state,reconfigured){var nodeViews=buildNodeViews(this);(function changedNodeViews(a,b){var nA=0,nB=0;for(var prop in a){if(a[prop]!=b[prop])return!0;nA++}for(var _ in b)nB++;return nA!=nB})(nodeViews,this.nodeViews)&&(this.nodeViews=nodeViews,redraw=!0),ensureListeners(this)}this.editable=getEditable(this),updateCursorWrapper(this);var innerDeco=viewDecorations(this),outerDeco=computeDocDeco(this),scroll=reconfigured?"reset":state.scrollToSelection>prev.scrollToSelection?"to selection":"preserve",updateDoc=redraw||!this.docView.matchesNode(state.doc,outerDeco,innerDeco);!updateDoc&&state.selection.eq(prev.selection)||(updateSel=!0);var oldScrollPos="preserve"==scroll&&updateSel&&null==this.dom.style.overflowAnchor&&function storeScrollPos(view){for(var refDOM,refTop,rect=view.dom.getBoundingClientRect(),startY=Math.max(0,rect.top),x=(rect.left+rect.right)/2,y=startY+1;y<Math.min(innerHeight,rect.bottom);y+=5){var dom=view.root.elementFromPoint(x,y);if(dom!=view.dom&&view.dom.contains(dom)){var localRect=dom.getBoundingClientRect();if(localRect.top>=startY-20){refDOM=dom,refTop=localRect.top;break}}}return{refDOM,refTop,stack:scrollStack(view.dom)}}(this);if(updateSel){this.domObserver.stop();var forceSelUpdate=updateDoc&&(result.ie||result.chrome)&&!this.composing&&!prev.selection.empty&&!state.selection.empty&&function selectionContextChanged(sel1,sel2){var depth=Math.min(sel1.$anchor.sharedDepth(sel1.head),sel2.$anchor.sharedDepth(sel2.head));return sel1.$anchor.start(depth)!=sel2.$anchor.start(depth)}(prev.selection,state.selection);if(updateDoc){var chromeKludge=result.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!redraw&&this.docView.update(state.doc,outerDeco,innerDeco,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=docViewDesc(state.doc,outerDeco,innerDeco,this.dom,this)),chromeKludge&&!this.trackWrites&&(forceSelUpdate=!0)}forceSelUpdate||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&function anchorInRightPlace(view){var anchorDOM=view.docView.domFromPos(view.state.selection.anchor,0),domSel=view.root.getSelection();return isEquivalentPosition(anchorDOM.node,anchorDOM.offset,domSel.anchorNode,domSel.anchorOffset)}(this))?selectionToDOM(this,forceSelUpdate):(syncNodeSelection(this,state.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(prev),"reset"==scroll)this.dom.scrollTop=0;else if("to selection"==scroll){var startDOM=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(f){return f(this$1)}))||(state.selection instanceof NodeSelection?scrollRectIntoView(this,this.docView.domAfterPos(state.selection.from).getBoundingClientRect(),startDOM):scrollRectIntoView(this,this.coordsAtPos(state.selection.head,1),startDOM))}else oldScrollPos&&function resetScrollPos(ref){var refDOM=ref.refDOM,refTop=ref.refTop,stack=ref.stack,newRefTop=refDOM?refDOM.getBoundingClientRect().top:0;restoreScrollStack(stack,0==newRefTop?0:newRefTop-refTop)}(oldScrollPos)},EditorView.prototype.destroyPluginViews=function destroyPluginViews(){for(var view;view=this.pluginViews.pop();)view.destroy&&view.destroy()},EditorView.prototype.updatePluginViews=function updatePluginViews(prevState){if(prevState&&prevState.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var i$2=0;i$2<this.pluginViews.length;i$2++){var pluginView=this.pluginViews[i$2];pluginView.update&&pluginView.update(this,prevState)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var i=0;i<this.directPlugins.length;i++){var plugin=this.directPlugins[i];plugin.spec.view&&this.pluginViews.push(plugin.spec.view(this))}for(var i$1=0;i$1<this.state.plugins.length;i$1++){var plugin$1=this.state.plugins[i$1];plugin$1.spec.view&&this.pluginViews.push(plugin$1.spec.view(this))}}},EditorView.prototype.someProp=function someProp(propName,f){var value,prop=this._props&&this._props[propName];if(null!=prop&&(value=f?f(prop):prop))return value;for(var i=0;i<this.directPlugins.length;i++){var prop$1=this.directPlugins[i].props[propName];if(null!=prop$1&&(value=f?f(prop$1):prop$1))return value}var plugins=this.state.plugins;if(plugins)for(var i$1=0;i$1<plugins.length;i$1++){var prop$2=plugins[i$1].props[propName];if(null!=prop$2&&(value=f?f(prop$2):prop$2))return value}},EditorView.prototype.hasFocus=function hasFocus(){return this.root.activeElement==this.dom},EditorView.prototype.focus=function focus(){this.domObserver.stop(),this.editable&&function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported)return dom.focus(preventScrollSupported);var stored=scrollStack(dom);dom.focus(null==preventScrollSupported?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),preventScrollSupported||(preventScrollSupported=!1,restoreScrollStack(stored,0))}(this.dom),selectionToDOM(this),this.domObserver.start()},prototypeAccessors$2.root.get=function(){var cached=this._root;if(null==cached)for(var search=this.dom.parentNode;search;search=search.parentNode)if(9==search.nodeType||11==search.nodeType&&search.host)return search.getSelection||(Object.getPrototypeOf(search).getSelection=function(){return document.getSelection()}),this._root=search;return cached||document},EditorView.prototype.posAtCoords=function posAtCoords$1(coords){return posAtCoords(this,coords)},EditorView.prototype.coordsAtPos=function coordsAtPos$1(pos,side){return void 0===side&&(side=1),coordsAtPos(this,pos,side)},EditorView.prototype.domAtPos=function domAtPos(pos,side){return void 0===side&&(side=0),this.docView.domFromPos(pos,side)},EditorView.prototype.nodeDOM=function nodeDOM(pos){var desc=this.docView.descAt(pos);return desc?desc.nodeDOM:null},EditorView.prototype.posAtDOM=function posAtDOM(node,offset,bias){void 0===bias&&(bias=-1);var pos=this.docView.posFromDOM(node,offset,bias);if(null==pos)throw new RangeError("DOM position not inside the editor");return pos},EditorView.prototype.endOfTextblock=function endOfTextblock$1(dir,state){return endOfTextblock(this,state||this.state,dir)},EditorView.prototype.destroy=function destroy(){this.docView&&(!function destroyInput(view){for(var type in view.domObserver.stop(),view.eventHandlers)view.dom.removeEventListener(type,view.eventHandlers[type]);clearTimeout(view.composingTimeout),clearTimeout(view.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],viewDecorations(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},prototypeAccessors$2.isDestroyed.get=function(){return null==this.docView},EditorView.prototype.dispatchEvent=function dispatchEvent$1(event){return function dispatchEvent(view,event){runCustomHandler(view,event)||!handlers[event.type]||!view.editable&&event.type in editHandlers||handlers[event.type](view,event)}(this,event)},EditorView.prototype.dispatch=function dispatch(tr){var dispatchTransaction=this._props.dispatchTransaction;dispatchTransaction?dispatchTransaction.call(this,tr):this.updateState(this.state.apply(tr))},Object.defineProperties(EditorView.prototype,prototypeAccessors$2);for(var base$1={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},chrome="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),safari="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),gecko="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),mac$2="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ie="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),brokenModifierNames=chrome&&(mac$2||+chrome[1]<57)||gecko&&mac$2,i$1=0;i$1<10;i$1++)base$1[48+i$1]=base$1[96+i$1]=String(i$1);for(i$1=1;i$1<=24;i$1++)base$1[i$1+111]="F"+i$1;for(i$1=65;i$1<=90;i$1++)base$1[i$1]=String.fromCharCode(i$1+32),shift[i$1]=String.fromCharCode(i$1);for(var code$1 in base$1)shift.hasOwnProperty(code$1)||(shift[code$1]=base$1[code$1]);var mac$1="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function normalizeKeyName$1(name){var alt,ctrl,shift,meta,parts=name.split(/-(?!$)/),result=parts[parts.length-1];"Space"==result&&(result=" ");for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);mac$1?meta=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta&&(result="Meta-"+result),shift&&(result="Shift-"+result),result}function modifiers(name,event,shift){return event.altKey&&(name="Alt-"+name),event.ctrlKey&&(name="Ctrl-"+name),event.metaKey&&(name="Meta-"+name),!1!==shift&&event.shiftKey&&(name="Shift-"+name),name}function keydownHandler(bindings){var map=function normalize$1(map){var copy=Object.create(null);for(var prop in map)copy[normalizeKeyName$1(prop)]=map[prop];return copy}(bindings);return function(view,event){var baseName,name=function keyName(event){var name=!(brokenModifierNames&&(event.ctrlKey||event.altKey||event.metaKey)||(safari||ie)&&event.shiftKey&&event.key&&1==event.key.length)&&event.key||(event.shiftKey?shift:base$1)[event.keyCode]||event.key||"Unidentified";return"Esc"==name&&(name="Escape"),"Del"==name&&(name="Delete"),"Left"==name&&(name="ArrowLeft"),"Up"==name&&(name="ArrowUp"),"Right"==name&&(name="ArrowRight"),"Down"==name&&(name="ArrowDown"),name}(event),isChar=1==name.length&&" "!=name,direct=map[modifiers(name,event,!isChar)];if(direct&&direct(view.state,view.dispatch,view))return!0;if(isChar&&(event.shiftKey||event.altKey||event.metaKey||name.charCodeAt(0)>127)&&(baseName=base$1[event.keyCode])&&baseName!=name){var fromCode=map[modifiers(baseName,event,!0)];if(fromCode&&fromCode(view.state,view.dispatch,view))return!0}else if(isChar&&event.shiftKey){var withShift=map[modifiers(name,event,!0)];if(withShift&&withShift(view.state,view.dispatch,view))return!0}return!1}}function isPlainObject(value){return"Object"===function getType(value){return Object.prototype.toString.call(value).slice(8,-1)}(value)&&(value.constructor===Object&&Object.getPrototypeOf(value)===Object.prototype)}function mergeDeep(target,source){var output=Object.assign({},target);return isPlainObject(target)&&isPlainObject(source)&&Object.keys(source).forEach((function(key){var _Object$assign,_Object$assign2;isPlainObject(source[key])?key in target?output[key]=mergeDeep(target[key],source[key]):Object.assign(output,((_Object$assign={})[key]=source[key],_Object$assign)):Object.assign(output,((_Object$assign2={})[key]=source[key],_Object$assign2))})),output}function isFunction$1(value){return"function"==typeof value}function callOrReturn(value){var context=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(isFunction$1(value)){for(var _len=arguments.length,props=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)props[_key-2]=arguments[_key];return context?value.bind(context).apply(void 0,props):value.apply(void 0,props)}return value}function getExtensionField(extension,field,context){return void 0===extension.config[field]&&extension.parent?getExtensionField(extension.parent,field,context):"function"==typeof extension.config[field]?extension.config[field].bind(Object.assign({},context,{parent:extension.parent?getExtensionField(extension.parent,field,context):null})):extension.config[field]}var Extension=function(){function Extension(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Extension),this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Object.assign({},this.config,config),this.name=this.config.name,config.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+this.name+'".'),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}return _createClass(Extension,[{key:"configure",value:function configure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}},{key:"extend",value:function extend(){var extendedConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=new Extension(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+extension.name+'".'),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}],[{key:"create",value:function create(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Extension(config)}}]),Extension}();function getTextBetween(startNode,range,options){var from=range.from,to=range.to,_ref=options||{},_ref$blockSeparator=_ref.blockSeparator,blockSeparator=void 0===_ref$blockSeparator?"\n\n":_ref$blockSeparator,_ref$textSerializers=_ref.textSerializers,textSerializers=void 0===_ref$textSerializers?{}:_ref$textSerializers,text="",separated=!0;return startNode.nodesBetween(from,to,(function(node,pos,parent,index){var _a,textSerializer=null==textSerializers?void 0:textSerializers[node.type.name];textSerializer?(node.isBlock&&!separated&&(text+=blockSeparator,separated=!0),text+=textSerializer({node,pos,parent,index})):node.isText?(text+=null===(_a=null==node?void 0:node.text)||void 0===_a?void 0:_a.slice(Math.max(from,pos)-pos,to-pos),separated=!1):node.isBlock&&!separated&&(text+=blockSeparator,separated=!0)})),text}function getTextSeralizersFromSchema(schema){return Object.fromEntries(Object.entries(schema.nodes).filter((function(_ref2){return _slicedToArray(_ref2,2)[1].spec.toText})).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2);return[_ref5[0],_ref5[1].spec.toText]})))}var ClipboardTextSerializer=Extension.create({name:"clipboardTextSerializer",addProseMirrorPlugins:function addProseMirrorPlugins(){var _this=this;return[new Plugin({key:new PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:function clipboardTextSerializer(){var editor=_this.editor,state=editor.state,schema=editor.schema,doc=state.doc,ranges=state.selection.ranges,from=Math.min.apply(Math,_toConsumableArray(ranges.map((function(range){return range.$from.pos})))),to=Math.max.apply(Math,_toConsumableArray(ranges.map((function(range){return range.$to.pos}))));return getTextBetween(doc,{from,to},{textSerializers:getTextSeralizersFromSchema(schema)})}}})]}}),blur$1=Object.freeze({__proto__:null,blur:function blur(){return function(_ref6){var editor=_ref6.editor,view=_ref6.view;return requestAnimationFrame((function(){editor.isDestroyed||view.dom.blur()})),!0}}}),clearContent$1=Object.freeze({__proto__:null,clearContent:function clearContent(){var emitUpdate=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(_ref7){return _ref7.commands.setContent("",emitUpdate)}}}),clearNodes$1=Object.freeze({__proto__:null,clearNodes:function clearNodes(){return function(_ref8){var state=_ref8.state,tr=_ref8.tr,dispatch=_ref8.dispatch,ranges=tr.selection.ranges;return!dispatch||(ranges.forEach((function(_ref9){var $from=_ref9.$from,$to=_ref9.$to;state.doc.nodesBetween($from.pos,$to.pos,(function(node,pos){if(!node.type.isText){var doc=tr.doc,mapping=tr.mapping,$mappedFrom=doc.resolve(mapping.map(pos)),$mappedTo=doc.resolve(mapping.map(pos+node.nodeSize)),nodeRange=$mappedFrom.blockRange($mappedTo);if(nodeRange){var targetLiftDepth=liftTarget(nodeRange);if(node.type.isTextblock){var defaultType=$mappedFrom.parent.contentMatchAt($mappedFrom.index()).defaultType;tr.setNodeMarkup(nodeRange.start,defaultType)}(targetLiftDepth||0===targetLiftDepth)&&tr.lift(nodeRange,targetLiftDepth)}}}))})),!0)}}}),command$1=Object.freeze({__proto__:null,command:function command(fn){return function(props){return fn(props)}}}),createParagraphNear$1=Object.freeze({__proto__:null,createParagraphNear:function createParagraphNear(){return function(_ref10){return createParagraphNear$2(_ref10.state,_ref10.dispatch)}}});function getNodeType(nameOrType,schema){if("string"==typeof nameOrType){if(!schema.nodes[nameOrType])throw Error("There is no node type named '"+nameOrType+"'. Maybe you forgot to add the extension?");return schema.nodes[nameOrType]}return nameOrType}var deleteNode$1=Object.freeze({__proto__:null,deleteNode:function deleteNode(typeOrName){return function(_ref11){for(var tr=_ref11.tr,state=_ref11.state,dispatch=_ref11.dispatch,type=getNodeType(typeOrName,state.schema),$pos=tr.selection.$anchor,depth=$pos.depth;depth>0;depth-=1){if($pos.node(depth).type===type){if(dispatch){var from=$pos.before(depth),to=$pos.after(depth);tr.delete(from,to).scrollIntoView()}return!0}}return!1}}}),deleteRange$1=Object.freeze({__proto__:null,deleteRange:function deleteRange(range){return function(_ref12){var tr=_ref12.tr,dispatch=_ref12.dispatch,from=range.from,to=range.to;return dispatch&&tr.delete(from,to),!0}}}),deleteSelection$1=Object.freeze({__proto__:null,deleteSelection:function deleteSelection(){return function(_ref13){return deleteSelection$2(_ref13.state,_ref13.dispatch)}}}),enter$1=Object.freeze({__proto__:null,enter:function enter(){return function(_ref14){return _ref14.commands.keyboardShortcut("Enter")}}}),exitCode$1=Object.freeze({__proto__:null,exitCode:function exitCode(){return function(_ref15){return exitCode$2(_ref15.state,_ref15.dispatch)}}});function getMarkType(nameOrType,schema){if("string"==typeof nameOrType){if(!schema.marks[nameOrType])throw Error("There is no mark type named '"+nameOrType+"'. Maybe you forgot to add the extension?");return schema.marks[nameOrType]}return nameOrType}function isRegExp$1(value){return"[object RegExp]"===Object.prototype.toString.call(value)}function objectIncludes(object1,object2){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0},keys=Object.keys(object2);return!keys.length||keys.every((function(key){return options.strict?object2[key]===object1[key]:isRegExp$1(object2[key])?object2[key].test(object1[key]):object2[key]===object1[key]}))}function findMarkInSet(marks,type){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return marks.find((function(item){return item.type===type&&objectIncludes(item.attrs,attributes)}))}function isMarkInSet(marks,type){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return!!findMarkInSet(marks,type,attributes)}function getMarkRange($pos,type){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if($pos&&type){var start=$pos.parent.childAfter($pos.parentOffset);if(start.node){var mark=findMarkInSet(start.node.marks,type,attributes);if(mark){var startIndex=$pos.index(),startPos=$pos.start()+start.offset,endIndex=startIndex+1,endPos=startPos+start.node.nodeSize;for(findMarkInSet(start.node.marks,type,attributes);startIndex>0&&mark.isInSet($pos.parent.child(startIndex-1).marks);)startIndex-=1,startPos-=$pos.parent.child(startIndex).nodeSize;for(;endIndex<$pos.parent.childCount&&isMarkInSet($pos.parent.child(endIndex).marks,type,attributes);)endPos+=$pos.parent.child(endIndex).nodeSize,endIndex+=1;return{from:startPos,to:endPos}}}}}var extendMarkRange$1=Object.freeze({__proto__:null,extendMarkRange:function extendMarkRange(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref16){var tr=_ref16.tr,state=_ref16.state,dispatch=_ref16.dispatch,type=getMarkType(typeOrName,state.schema),doc=tr.doc,selection=tr.selection,$from=selection.$from,from=selection.from,to=selection.to;if(dispatch){var _range=getMarkRange($from,type,attributes);if(_range&&_range.from<=from&&_range.to>=to){var newSelection=TextSelection.create(doc,_range.from,_range.to);tr.setSelection(newSelection)}}return!0}}}),first$1=Object.freeze({__proto__:null,first:function first(commands){return function(props){for(var items="function"==typeof commands?commands(props):commands,_i2=0;_i2<items.length;_i2+=1)if(items[_i2](props))return!0;return!1}}});function isObject$1(value){return value&&"object"==typeof value&&!Array.isArray(value)&&!function isClass(value){var _a;return"class"===(null===(_a=value.constructor)||void 0===_a?void 0:_a.toString().substring(0,5))}(value)}function isTextSelection(value){return isObject$1(value)&&value instanceof TextSelection}function isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function minMax(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,min=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,max=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(value,min),max)}function resolveFocusPosition(doc){var position=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!position)return null;if("start"===position||!0===position)return Selection.atStart(doc);if("end"===position)return Selection.atEnd(doc);if("all"===position)return TextSelection.create(doc,0,doc.content.size);var minPos=Selection.atStart(doc).from,maxPos=Selection.atEnd(doc).to,resolvedFrom=minMax(position,minPos,maxPos),resolvedEnd=minMax(position,minPos,maxPos);return TextSelection.create(doc,resolvedFrom,resolvedEnd)}var focus$1=Object.freeze({__proto__:null,focus:function focus(){var position=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,options=arguments.length>1?arguments[1]:void 0;return function(_ref17){var editor=_ref17.editor,view=_ref17.view,tr=_ref17.tr,dispatch=_ref17.dispatch;options=Object.assign({scrollIntoView:!0},options);var delayedFocus=function delayedFocus(){isiOS()&&view.dom.focus(),requestAnimationFrame((function(){editor.isDestroyed||(view.focus(),(null==options?void 0:options.scrollIntoView)&&editor.commands.scrollIntoView())}))};if(view.hasFocus()&&null===position||!1===position)return!0;if(dispatch&&null===position&&!isTextSelection(editor.state.selection))return delayedFocus(),!0;var selection=resolveFocusPosition(editor.state.doc,position)||editor.state.selection,isSameSelection=editor.state.selection.eq(selection);return dispatch&&(isSameSelection||tr.setSelection(selection),isSameSelection&&tr.storedMarks&&tr.setStoredMarks(tr.storedMarks),delayedFocus()),!0}}}),forEach$1=Object.freeze({__proto__:null,forEach:function forEach(items,fn){return function(props){return items.every((function(item,index){return fn(item,Object.assign({},props,{index}))}))}}}),insertContent$1=Object.freeze({__proto__:null,insertContent:function insertContent(value,options){return function(_ref18){var tr=_ref18.tr;return _ref18.commands.insertContentAt({from:tr.selection.from,to:tr.selection.to},value,options)}}});function elementFromString(value){var wrappedValue="<body>"+value+"</body>";return(new window.DOMParser).parseFromString(wrappedValue,"text/html").body}function createNodeFromContent(content,schema,options){if(options=Object.assign({slice:!0,parseOptions:{}},options),"object"==typeof content&&null!==content)try{return Array.isArray(content)?Fragment.fromArray(content.map((function(item){return schema.nodeFromJSON(item)}))):schema.nodeFromJSON(content)}catch(error){return console.warn("[tiptap warn]: Invalid content.","Passed value:",content,"Error:",error),createNodeFromContent("",schema,options)}if("string"==typeof content){var parser=DOMParser.fromSchema(schema);return options.slice?parser.parseSlice(elementFromString(content),options.parseOptions).content:parser.parse(elementFromString(content),options.parseOptions)}return createNodeFromContent("",schema,options)}var insertContentAt$1=Object.freeze({__proto__:null,insertContentAt:function insertContentAt(position,value,options){return function(_ref19){var tr=_ref19.tr,dispatch=_ref19.dispatch,editor=_ref19.editor;if(dispatch){options=Object.assign({parseOptions:{},updateSelection:!0},options);var content=createNodeFromContent(value,editor.schema,{parseOptions:Object.assign({preserveWhitespace:"full"},options.parseOptions)});if("<>"===content.toString())return!0;var _ref20="number"==typeof position?{from:position,to:position}:position,from=_ref20.from,to=_ref20.to,isOnlyBlockContent=!0;if((function isFragment(nodeOrFragment){return nodeOrFragment.toString().startsWith("<")}(content)?content:[content]).forEach((function(node){node.check(),isOnlyBlockContent=!!isOnlyBlockContent&&node.isBlock})),from===to&&isOnlyBlockContent){var parent=tr.doc.resolve(from).parent;parent.isTextblock&&!parent.type.spec.code&&!parent.childCount&&(from-=1,to+=1)}tr.replaceWith(from,to,content),options.updateSelection&&function selectionToInsertionEnd(tr,startLen,bias){var last=tr.steps.length-1;if(!(last<startLen)){var step=tr.steps[last];if(step instanceof ReplaceStep||step instanceof ReplaceAroundStep){var map=tr.mapping.maps[last],end=0;map.forEach((function(_from,_to,_newFrom,newTo){0===end&&(end=newTo)})),tr.setSelection(Selection.near(tr.doc.resolve(end),bias))}}}(tr,tr.steps.length-1,-1)}return!0}}}),joinBackward$1=Object.freeze({__proto__:null,joinBackward:function joinBackward(){return function(_ref21){return joinBackward$2(_ref21.state,_ref21.dispatch)}}}),joinForward$1=Object.freeze({__proto__:null,joinForward:function joinForward(){return function(_ref22){return joinForward$2(_ref22.state,_ref22.dispatch)}}}),mac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var keyboardShortcut$1=Object.freeze({__proto__:null,keyboardShortcut:function keyboardShortcut(name){return function(_ref23){var editor=_ref23.editor,view=_ref23.view,tr=_ref23.tr,dispatch=_ref23.dispatch,keys=function normalizeKeyName(name){var alt,ctrl,shift,meta,parts=name.split(/-(?!$)/),result=parts[parts.length-1];"Space"===result&&(result=" ");for(var _i3=0;_i3<parts.length-1;_i3+=1){var mod=parts[_i3];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=!0;else{if(!/^mod$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);mac?meta=!0:ctrl=!0}}return alt&&(result="Alt-"+result),ctrl&&(result="Ctrl-"+result),meta&&(result="Meta-"+result),shift&&(result="Shift-"+result),result}(name).split(/-(?!$)/),key=keys.find((function(item){return!["Alt","Ctrl","Meta","Shift"].includes(item)})),event=new KeyboardEvent("keydown",{key:"Space"===key?" ":key,altKey:keys.includes("Alt"),ctrlKey:keys.includes("Ctrl"),metaKey:keys.includes("Meta"),shiftKey:keys.includes("Shift"),bubbles:!0,cancelable:!0}),capturedTransaction=editor.captureTransaction((function(){view.someProp("handleKeyDown",(function(f){return f(view,event)}))}));return null==capturedTransaction||capturedTransaction.steps.forEach((function(step){var newStep=step.map(tr.mapping);newStep&&dispatch&&tr.maybeStep(newStep)})),!0}}});function isNodeActive(state,typeOrName){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_state$selection=state.selection,from=_state$selection.from,to=_state$selection.to,empty=_state$selection.empty,type=typeOrName?getNodeType(typeOrName,state.schema):null,nodeRanges=[];state.doc.nodesBetween(from,to,(function(node,pos){if(!node.isText){var relativeFrom=Math.max(from,pos),relativeTo=Math.min(to,pos+node.nodeSize);nodeRanges.push({node,from:relativeFrom,to:relativeTo})}}));var selectionRange=to-from,matchedNodeRanges=nodeRanges.filter((function(nodeRange){return!type||type.name===nodeRange.node.type.name})).filter((function(nodeRange){return objectIncludes(nodeRange.node.attrs,attributes,{strict:!1})}));if(empty)return!!matchedNodeRanges.length;var range=matchedNodeRanges.reduce((function(sum,nodeRange){return sum+nodeRange.to-nodeRange.from}),0);return range>=selectionRange}var lift$1=Object.freeze({__proto__:null,lift:function lift(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref24){var state=_ref24.state,dispatch=_ref24.dispatch;return!!isNodeActive(state,getNodeType(typeOrName,state.schema),attributes)&&lift$2(state,dispatch)}}}),liftEmptyBlock$1=Object.freeze({__proto__:null,liftEmptyBlock:function liftEmptyBlock(){return function(_ref25){return liftEmptyBlock$2(_ref25.state,_ref25.dispatch)}}}),liftListItem$1=Object.freeze({__proto__:null,liftListItem:function liftListItem(typeOrName){return function(_ref26){var state=_ref26.state,dispatch=_ref26.dispatch;return liftListItem$2(getNodeType(typeOrName,state.schema))(state,dispatch)}}}),newlineInCode$1=Object.freeze({__proto__:null,newlineInCode:function newlineInCode(){return function(_ref27){return newlineInCode$2(_ref27.state,_ref27.dispatch)}}});function getSchemaTypeNameByName(name,schema){return schema.nodes[name]?"node":schema.marks[name]?"mark":null}function deleteProps(obj,propOrProps){var props="string"==typeof propOrProps?[propOrProps]:propOrProps;return Object.keys(obj).reduce((function(newObj,prop){return props.includes(prop)||(newObj[prop]=obj[prop]),newObj}),{})}var resetAttributes$1=Object.freeze({__proto__:null,resetAttributes:function resetAttributes(typeOrName,attributes){return function(_ref28){var tr=_ref28.tr,state=_ref28.state,dispatch=_ref28.dispatch,nodeType=null,markType=null,schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return!!schemaType&&("node"===schemaType&&(nodeType=getNodeType(typeOrName,state.schema)),"mark"===schemaType&&(markType=getMarkType(typeOrName,state.schema)),dispatch&&tr.selection.ranges.forEach((function(range){state.doc.nodesBetween(range.$from.pos,range.$to.pos,(function(node,pos){nodeType&&nodeType===node.type&&tr.setNodeMarkup(pos,void 0,deleteProps(node.attrs,attributes)),markType&&node.marks.length&&node.marks.forEach((function(mark){markType===mark.type&&tr.addMark(pos,pos+node.nodeSize,markType.create(deleteProps(mark.attrs,attributes)))}))}))})),!0)}}}),scrollIntoView$1=Object.freeze({__proto__:null,scrollIntoView:function scrollIntoView(){return function(_ref29){var tr=_ref29.tr;return _ref29.dispatch&&tr.scrollIntoView(),!0}}}),selectAll$1=Object.freeze({__proto__:null,selectAll:function selectAll(){return function(_ref30){var tr=_ref30.tr;return _ref30.commands.setTextSelection({from:0,to:tr.doc.content.size})}}}),selectNodeBackward$1=Object.freeze({__proto__:null,selectNodeBackward:function selectNodeBackward(){return function(_ref31){return selectNodeBackward$2(_ref31.state,_ref31.dispatch)}}}),selectNodeForward$1=Object.freeze({__proto__:null,selectNodeForward:function selectNodeForward(){return function(_ref32){return selectNodeForward$2(_ref32.state,_ref32.dispatch)}}}),selectParentNode$1=Object.freeze({__proto__:null,selectParentNode:function selectParentNode(){return function(_ref33){return function selectParentNode$2(state,dispatch){var pos,ref=state.selection,$from=ref.$from,to=ref.to,same=$from.sharedDepth(to);return 0!=same&&(pos=$from.before(same),dispatch&&dispatch(state.tr.setSelection(NodeSelection.create(state.doc,pos))),!0)}(_ref33.state,_ref33.dispatch)}}});function createDocument(content,schema){var parseOptions=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return createNodeFromContent(content,schema,{slice:!1,parseOptions})}var setContent$1=Object.freeze({__proto__:null,setContent:function setContent(content){var emitUpdate=arguments.length>1&&void 0!==arguments[1]&&arguments[1],parseOptions=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(_ref34){var tr=_ref34.tr,editor=_ref34.editor,dispatch=_ref34.dispatch,doc=tr.doc,document=createDocument(content,editor.schema,parseOptions),selection=TextSelection.create(doc,0,doc.content.size);return dispatch&&tr.setSelection(selection).replaceSelectionWith(document,!1).setMeta("preventUpdate",!emitUpdate),!0}}});function getMarkAttributes(state,typeOrName){var type=getMarkType(typeOrName,state.schema),_state$selection2=state.selection,from=_state$selection2.from,to=_state$selection2.to,empty=_state$selection2.empty,marks=[];empty?(state.storedMarks&&marks.push.apply(marks,_toConsumableArray(state.storedMarks)),marks.push.apply(marks,_toConsumableArray(state.selection.$head.marks()))):state.doc.nodesBetween(from,to,(function(node){marks.push.apply(marks,_toConsumableArray(node.marks))}));var mark=marks.find((function(markItem){return markItem.type.name===type.name}));return mark?Object.assign({},mark.attrs):{}}var setMark$1=Object.freeze({__proto__:null,setMark:function setMark(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref35){var tr=_ref35.tr,state=_ref35.state,dispatch=_ref35.dispatch,selection=tr.selection,empty=selection.empty,ranges=selection.ranges,type=getMarkType(typeOrName,state.schema);if(dispatch)if(empty){var oldAttributes=getMarkAttributes(state,type);tr.addStoredMark(type.create(Object.assign({},oldAttributes,attributes)))}else ranges.forEach((function(range){var from=range.$from.pos,to=range.$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){var trimmedFrom=Math.max(pos,from),trimmedTo=Math.min(pos+node.nodeSize,to);node.marks.find((function(mark){return mark.type===type}))?node.marks.forEach((function(mark){type===mark.type&&tr.addMark(trimmedFrom,trimmedTo,type.create(Object.assign({},mark.attrs,attributes)))})):tr.addMark(trimmedFrom,trimmedTo,type.create(attributes))}))}));return!0}}}),setMeta$1=Object.freeze({__proto__:null,setMeta:function setMeta(key,value){return function(_ref36){return _ref36.tr.setMeta(key,value),!0}}}),setNode$1=Object.freeze({__proto__:null,setNode:function setNode(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref37){var state=_ref37.state,dispatch=_ref37.dispatch,chain=_ref37.chain,type=getNodeType(typeOrName,state.schema);return type.isTextblock?chain().command((function(_ref38){var commands=_ref38.commands;return!!setBlockType(type,attributes)(state)||commands.clearNodes()})).command((function(_ref39){var updatedState=_ref39.state;return setBlockType(type,attributes)(updatedState,dispatch)})).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}}}),setNodeSelection$1=Object.freeze({__proto__:null,setNodeSelection:function setNodeSelection(position){return function(_ref40){var tr=_ref40.tr;if(_ref40.dispatch){var _doc2=tr.doc,minPos=Selection.atStart(_doc2).from,maxPos=Selection.atEnd(_doc2).to,resolvedPos=minMax(position,minPos,maxPos),selection=NodeSelection.create(_doc2,resolvedPos);tr.setSelection(selection)}return!0}}}),setTextSelection$1=Object.freeze({__proto__:null,setTextSelection:function setTextSelection(position){return function(_ref41){var tr=_ref41.tr;if(_ref41.dispatch){var _doc3=tr.doc,_ref42="number"==typeof position?{from:position,to:position}:position,from=_ref42.from,to=_ref42.to,minPos=Selection.atStart(_doc3).from,maxPos=Selection.atEnd(_doc3).to,resolvedFrom=minMax(from,minPos,maxPos),resolvedEnd=minMax(to,minPos,maxPos),selection=TextSelection.create(_doc3,resolvedFrom,resolvedEnd);tr.setSelection(selection)}return!0}}}),sinkListItem$1=Object.freeze({__proto__:null,sinkListItem:function sinkListItem(typeOrName){return function(_ref43){var state=_ref43.state,dispatch=_ref43.dispatch;return function sinkListItem$2(itemType){return function(state,dispatch){var ref=state.selection,$from=ref.$from,$to=ref.$to,range=$from.blockRange($to,(function(node){return node.childCount&&node.firstChild.type==itemType}));if(!range)return!1;var startIndex=range.startIndex;if(0==startIndex)return!1;var parent=range.parent,nodeBefore=parent.child(startIndex-1);if(nodeBefore.type!=itemType)return!1;if(dispatch){var nestedBefore=nodeBefore.lastChild&&nodeBefore.lastChild.type==parent.type,inner=Fragment.from(nestedBefore?itemType.create():null),slice=new Slice(Fragment.from(itemType.create(null,Fragment.from(parent.type.create(null,inner)))),nestedBefore?3:1,0),before=range.start,after=range.end;dispatch(state.tr.step(new ReplaceAroundStep(before-(nestedBefore?3:1),after,before,after,slice,1,!0)).scrollIntoView())}return!0}}(getNodeType(typeOrName,state.schema))(state,dispatch)}}});function getSplittedAttributes(extensionAttributes,typeName,attributes){return Object.fromEntries(Object.entries(attributes).filter((function(_ref44){var name=_slicedToArray(_ref44,1)[0],extensionAttribute=extensionAttributes.find((function(item){return item.type===typeName&&item.name===name}));return!!extensionAttribute&&extensionAttribute.attribute.keepOnSplit})))}function defaultBlockAt$1(match){for(var _i4=0;_i4<match.edgeCount;_i4+=1){var type=match.edge(_i4).type;if(type.isTextblock&&!type.hasRequiredAttrs())return type}return null}function ensureMarks(state,splittableMarks){var marks=state.storedMarks||state.selection.$to.parentOffset&&state.selection.$from.marks();if(marks){var filteredMarks=marks.filter((function(mark){return null==splittableMarks?void 0:splittableMarks.includes(mark.type.name)}));state.tr.ensureMarks(filteredMarks)}}var splitBlock$1=Object.freeze({__proto__:null,splitBlock:function splitBlock(){var _ref46=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref46$keepMarks=_ref46.keepMarks,keepMarks=void 0===_ref46$keepMarks||_ref46$keepMarks;return function(_ref47){var tr=_ref47.tr,state=_ref47.state,dispatch=_ref47.dispatch,editor=_ref47.editor,selection=tr.selection,doc=tr.doc,$from=selection.$from,$to=selection.$to,newAttributes=getSplittedAttributes(editor.extensionManager.attributes,$from.node().type.name,$from.node().attrs);if(selection instanceof NodeSelection&&selection.node.isBlock)return!(!$from.parentOffset||!canSplit(doc,$from.pos))&&(dispatch&&(keepMarks&&ensureMarks(state,editor.extensionManager.splittableMarks),tr.split($from.pos).scrollIntoView()),!0);if(!$from.parent.isBlock)return!1;if(dispatch){var atEnd=$to.parentOffset===$to.parent.content.size;selection instanceof TextSelection&&tr.deleteSelection();var deflt=0===$from.depth?void 0:defaultBlockAt$1($from.node(-1).contentMatchAt($from.indexAfter(-1))),types=atEnd&&deflt?[{type:deflt,attrs:newAttributes}]:void 0,can=canSplit(tr.doc,tr.mapping.map($from.pos),1,types);if(types||can||!canSplit(tr.doc,tr.mapping.map($from.pos),1,deflt?[{type:deflt}]:void 0)||(can=!0,types=deflt?[{type:deflt,attrs:newAttributes}]:void 0),can&&(tr.split(tr.mapping.map($from.pos),1,types),deflt&&!atEnd&&!$from.parentOffset&&$from.parent.type!==deflt)){var _first=tr.mapping.map($from.before()),$first=tr.doc.resolve(_first);$from.node(-1).canReplaceWith($first.index(),$first.index()+1,deflt)&&tr.setNodeMarkup(tr.mapping.map($from.before()),deflt)}keepMarks&&ensureMarks(state,editor.extensionManager.splittableMarks),tr.scrollIntoView()}return!0}}}),splitListItem$1=Object.freeze({__proto__:null,splitListItem:function splitListItem(typeOrName){return function(_ref48){var _a,tr=_ref48.tr,state=_ref48.state,dispatch=_ref48.dispatch,editor=_ref48.editor,type=getNodeType(typeOrName,state.schema),_state$selection3=state.selection,$from=_state$selection3.$from,$to=_state$selection3.$to,node=state.selection.node;if(node&&node.isBlock||$from.depth<2||!$from.sameParent($to))return!1;var grandParent=$from.node(-1);if(grandParent.type!==type)return!1;var extensionAttributes=editor.extensionManager.attributes;if(0===$from.parent.content.size&&$from.node(-1).childCount===$from.indexAfter(-1)){if(2===$from.depth||$from.node(-3).type!==type||$from.index(-2)!==$from.node(-2).childCount-1)return!1;if(dispatch){for(var wrap=Fragment.empty,depthBefore=$from.index(-1)?1:$from.index(-2)?2:3,d=$from.depth-depthBefore;d>=$from.depth-3;d-=1)wrap=Fragment.from($from.node(d).copy(wrap));var depthAfter=$from.indexAfter(-1)<$from.node(-2).childCount?1:$from.indexAfter(-2)<$from.node(-3).childCount?2:3,_newNextTypeAttributes=getSplittedAttributes(extensionAttributes,$from.node().type.name,$from.node().attrs),_nextType=(null===(_a=type.contentMatch.defaultType)||void 0===_a?void 0:_a.createAndFill(_newNextTypeAttributes))||void 0;wrap=wrap.append(Fragment.from(type.createAndFill(null,_nextType)||void 0));var start=$from.before($from.depth-(depthBefore-1));tr.replace(start,$from.after(-depthAfter),new Slice(wrap,4-depthBefore,0));var sel=-1;tr.doc.nodesBetween(start,tr.doc.content.size,(function(n,pos){if(sel>-1)return!1;n.isTextblock&&0===n.content.size&&(sel=pos+1)})),sel>-1&&tr.setSelection(TextSelection.near(tr.doc.resolve(sel))),tr.scrollIntoView()}return!0}var nextType=$to.pos===$from.end()?grandParent.contentMatchAt(0).defaultType:null,newTypeAttributes=getSplittedAttributes(extensionAttributes,grandParent.type.name,grandParent.attrs),newNextTypeAttributes=getSplittedAttributes(extensionAttributes,$from.node().type.name,$from.node().attrs);tr.delete($from.pos,$to.pos);var types=nextType?[{type,attrs:newTypeAttributes},{type:nextType,attrs:newNextTypeAttributes}]:[{type,attrs:newTypeAttributes}];return!!canSplit(tr.doc,$from.pos,2)&&(dispatch&&tr.split($from.pos,2,types).scrollIntoView(),!0)}}});function findParentNode(predicate){return function(selection){return function findParentNodeClosestToPos($pos,predicate){for(var _i5=$pos.depth;_i5>0;_i5-=1){var node=$pos.node(_i5);if(predicate(node))return{pos:_i5>0?$pos.before(_i5):0,start:$pos.start(_i5),depth:_i5,node}}}(selection.$from,predicate)}}function splitExtensions(extensions){return{baseExtensions:extensions.filter((function(extension){return"extension"===extension.type})),nodeExtensions:extensions.filter((function(extension){return"node"===extension.type})),markExtensions:extensions.filter((function(extension){return"mark"===extension.type}))}}function isList(name,extensions){var extension=splitExtensions(extensions).nodeExtensions.find((function(item){return item.name===name}));if(!extension)return!1;var group=callOrReturn(getExtensionField(extension,"group",{name:extension.name,options:extension.options,storage:extension.storage}));return"string"==typeof group&&group.split(" ").includes("list")}var joinListBackwards=function joinListBackwards(tr,listType){var list=findParentNode((function(node){return node.type===listType}))(tr.selection);if(!list)return!0;var before=tr.doc.resolve(Math.max(0,list.pos-1)).before(list.depth);if(void 0===before)return!0;var nodeBefore=tr.doc.nodeAt(before);return list.node.type!==(null==nodeBefore?void 0:nodeBefore.type)||!canJoin(tr.doc,list.pos)||(tr.join(list.pos),!0)},joinListForwards=function joinListForwards(tr,listType){var list=findParentNode((function(node){return node.type===listType}))(tr.selection);if(!list)return!0;var after=tr.doc.resolve(list.start).after(list.depth);if(void 0===after)return!0;var nodeAfter=tr.doc.nodeAt(after);return list.node.type!==(null==nodeAfter?void 0:nodeAfter.type)||!canJoin(tr.doc,after)||(tr.join(after),!0)},toggleList$1=Object.freeze({__proto__:null,toggleList:function toggleList(listTypeOrName,itemTypeOrName){return function(_ref49){var editor=_ref49.editor,tr=_ref49.tr,state=_ref49.state,dispatch=_ref49.dispatch,chain=_ref49.chain,commands=_ref49.commands,can=_ref49.can,extensions=editor.extensionManager.extensions,listType=getNodeType(listTypeOrName,state.schema),itemType=getNodeType(itemTypeOrName,state.schema),selection=state.selection,$from=selection.$from,$to=selection.$to,range=$from.blockRange($to);if(!range)return!1;var parentList=findParentNode((function(node){return isList(node.type.name,extensions)}))(selection);if(range.depth>=1&&parentList&&range.depth-parentList.depth<=1){if(parentList.node.type===listType)return commands.liftListItem(itemType);if(isList(parentList.node.type.name,extensions)&&listType.validContent(parentList.node.content)&&dispatch)return chain().command((function(){return tr.setNodeMarkup(parentList.pos,listType),!0})).command((function(){return joinListBackwards(tr,listType)})).command((function(){return joinListForwards(tr,listType)})).run()}return chain().command((function(){return!!can().wrapInList(listType)||commands.clearNodes()})).wrapInList(listType).command((function(){return joinListBackwards(tr,listType)})).command((function(){return joinListForwards(tr,listType)})).run()}}});function isMarkActive(state,typeOrName){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_state$selection4=state.selection,empty=_state$selection4.empty,ranges=_state$selection4.ranges,type=typeOrName?getMarkType(typeOrName,state.schema):null;if(empty)return!!(state.storedMarks||state.selection.$from.marks()).filter((function(mark){return!type||type.name===mark.type.name})).find((function(mark){return objectIncludes(mark.attrs,attributes,{strict:!1})}));var selectionRange=0,markRanges=[];if(ranges.forEach((function(_ref50){var $from=_ref50.$from,$to=_ref50.$to,from=$from.pos,to=$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){if(node.isText||node.marks.length){var relativeFrom=Math.max(from,pos),relativeTo=Math.min(to,pos+node.nodeSize);selectionRange+=relativeTo-relativeFrom,markRanges.push.apply(markRanges,_toConsumableArray(node.marks.map((function(mark){return{mark,from:relativeFrom,to:relativeTo}}))))}}))})),0===selectionRange)return!1;var matchedRange=markRanges.filter((function(markRange){return!type||type.name===markRange.mark.type.name})).filter((function(markRange){return objectIncludes(markRange.mark.attrs,attributes,{strict:!1})})).reduce((function(sum,markRange){return sum+markRange.to-markRange.from}),0),excludedRange=markRanges.filter((function(markRange){return!type||markRange.mark.type!==type&&markRange.mark.type.excludes(type)})).reduce((function(sum,markRange){return sum+markRange.to-markRange.from}),0),range=matchedRange>0?matchedRange+excludedRange:matchedRange;return range>=selectionRange}var toggleMark$1=Object.freeze({__proto__:null,toggleMark:function toggleMark(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(_ref51){var state=_ref51.state,commands=_ref51.commands,_options$extendEmptyM=options.extendEmptyMarkRange,extendEmptyMarkRange=void 0!==_options$extendEmptyM&&_options$extendEmptyM,type=getMarkType(typeOrName,state.schema);return isMarkActive(state,type,attributes)?commands.unsetMark(type,{extendEmptyMarkRange}):commands.setMark(type,attributes)}}}),toggleNode$1=Object.freeze({__proto__:null,toggleNode:function toggleNode(typeOrName,toggleTypeOrName){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(_ref52){var state=_ref52.state,commands=_ref52.commands,type=getNodeType(typeOrName,state.schema),toggleType=getNodeType(toggleTypeOrName,state.schema);return isNodeActive(state,type,attributes)?commands.setNode(toggleType):commands.setNode(type,attributes)}}}),toggleWrap$1=Object.freeze({__proto__:null,toggleWrap:function toggleWrap(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref53){var state=_ref53.state,commands=_ref53.commands,type=getNodeType(typeOrName,state.schema);return isNodeActive(state,type,attributes)?commands.lift(type):commands.wrapIn(type,attributes)}}}),undoInputRule$1=Object.freeze({__proto__:null,undoInputRule:function undoInputRule(){return function(_ref54){for(var state=_ref54.state,dispatch=_ref54.dispatch,plugins=state.plugins,_i6=0;_i6<plugins.length;_i6+=1){var plugin=plugins[_i6],undoable=void 0;if(plugin.spec.isInputRules&&(undoable=plugin.getState(state))){if(dispatch){for(var tr=state.tr,toUndo=undoable.transform,j=toUndo.steps.length-1;j>=0;j-=1)tr.step(toUndo.steps[j].invert(toUndo.docs[j]));if(undoable.text){var marks=tr.doc.resolve(undoable.from).marks();tr.replaceWith(undoable.from,undoable.to,state.schema.text(undoable.text,marks))}else tr.delete(undoable.from,undoable.to)}return!0}}return!1}}}),unsetAllMarks$1=Object.freeze({__proto__:null,unsetAllMarks:function unsetAllMarks(){return function(_ref55){var tr=_ref55.tr,dispatch=_ref55.dispatch,selection=tr.selection,empty=selection.empty,ranges=selection.ranges;return empty||dispatch&&ranges.forEach((function(range){tr.removeMark(range.$from.pos,range.$to.pos)})),!0}}}),unsetMark$1=Object.freeze({__proto__:null,unsetMark:function unsetMark(typeOrName){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref56){var _a,tr=_ref56.tr,state=_ref56.state,dispatch=_ref56.dispatch,_options$extendEmptyM2=options.extendEmptyMarkRange,extendEmptyMarkRange=void 0!==_options$extendEmptyM2&&_options$extendEmptyM2,selection=tr.selection,type=getMarkType(typeOrName,state.schema),$from=selection.$from,empty=selection.empty,ranges=selection.ranges;if(!dispatch)return!0;if(empty&&extendEmptyMarkRange){var from=selection.from,to=selection.to,_attrs=null===(_a=$from.marks().find((function(mark){return mark.type===type})))||void 0===_a?void 0:_a.attrs,_range2=getMarkRange($from,type,_attrs);_range2&&(from=_range2.from,to=_range2.to),tr.removeMark(from,to,type)}else ranges.forEach((function(range){tr.removeMark(range.$from.pos,range.$to.pos,type)}));return tr.removeStoredMark(type),!0}}}),updateAttributes$1=Object.freeze({__proto__:null,updateAttributes:function updateAttributes(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref57){var tr=_ref57.tr,state=_ref57.state,dispatch=_ref57.dispatch,nodeType=null,markType=null,schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return!!schemaType&&("node"===schemaType&&(nodeType=getNodeType(typeOrName,state.schema)),"mark"===schemaType&&(markType=getMarkType(typeOrName,state.schema)),dispatch&&tr.selection.ranges.forEach((function(range){var from=range.$from.pos,to=range.$to.pos;state.doc.nodesBetween(from,to,(function(node,pos){nodeType&&nodeType===node.type&&tr.setNodeMarkup(pos,void 0,Object.assign({},node.attrs,attributes)),markType&&node.marks.length&&node.marks.forEach((function(mark){if(markType===mark.type){var trimmedFrom=Math.max(pos,from),trimmedTo=Math.min(pos+node.nodeSize,to);tr.addMark(trimmedFrom,trimmedTo,markType.create(Object.assign({},mark.attrs,attributes)))}}))}))})),!0)}}}),wrapIn$1=Object.freeze({__proto__:null,wrapIn:function wrapIn(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref58){var state=_ref58.state,dispatch=_ref58.dispatch;return wrapIn$2(getNodeType(typeOrName,state.schema),attributes)(state,dispatch)}}}),wrapInList$1=Object.freeze({__proto__:null,wrapInList:function wrapInList(typeOrName){var attributes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(_ref59){var state=_ref59.state,dispatch=_ref59.dispatch;return wrapInList$2(getNodeType(typeOrName,state.schema),attributes)(state,dispatch)}}}),Commands=Extension.create({name:"commands",addCommands:function addCommands(){return Object.assign({},blur$1,clearContent$1,clearNodes$1,command$1,createParagraphNear$1,deleteNode$1,deleteRange$1,deleteSelection$1,enter$1,exitCode$1,extendMarkRange$1,first$1,focus$1,forEach$1,insertContent$1,insertContentAt$1,joinBackward$1,joinForward$1,keyboardShortcut$1,lift$1,liftEmptyBlock$1,liftListItem$1,newlineInCode$1,resetAttributes$1,scrollIntoView$1,selectAll$1,selectNodeBackward$1,selectNodeForward$1,selectParentNode$1,setContent$1,setMark$1,setMeta$1,setNode$1,setNodeSelection$1,setTextSelection$1,sinkListItem$1,splitBlock$1,splitListItem$1,toggleList$1,toggleMark$1,toggleNode$1,toggleWrap$1,undoInputRule$1,unsetAllMarks$1,unsetMark$1,updateAttributes$1,wrapIn$1,wrapInList$1)}}),Editable=Extension.create({name:"editable",addProseMirrorPlugins:function addProseMirrorPlugins(){var _this2=this;return[new Plugin({key:new PluginKey("editable"),props:{editable:function editable(){return _this2.editor.options.editable}}})]}}),FocusEvents=Extension.create({name:"focusEvents",addProseMirrorPlugins:function addProseMirrorPlugins(){var editor=this.editor;return[new Plugin({key:new PluginKey("focusEvents"),props:{handleDOMEvents:{focus:function focus(view,event){editor.isFocused=!0;var transaction=editor.state.tr.setMeta("focus",{event}).setMeta("addToHistory",!1);return view.dispatch(transaction),!1},blur:function blur(view,event){editor.isFocused=!1;var transaction=editor.state.tr.setMeta("blur",{event}).setMeta("addToHistory",!1);return view.dispatch(transaction),!1}}}})]}});function createChainableState(config){var state=config.state,transaction=config.transaction,selection=transaction.selection,doc=transaction.doc,storedMarks=transaction.storedMarks;return Object.assign({},state,{schema:state.schema,plugins:state.plugins,apply:state.apply.bind(state),applyTransaction:state.applyTransaction.bind(state),reconfigure:state.reconfigure.bind(state),toJSON:state.toJSON.bind(state),get storedMarks(){return storedMarks},get selection(){return selection},get doc(){return doc},get tr(){return selection=transaction.selection,doc=transaction.doc,storedMarks=transaction.storedMarks,transaction}})}var CommandManager=function(){function CommandManager(props){_classCallCheck(this,CommandManager),this.editor=props.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=props.state}return _createClass(CommandManager,[{key:"hasCustomState",get:function get(){return!!this.customState}},{key:"state",get:function get(){return this.customState||this.editor.state}},{key:"commands",get:function get(){var _this3=this,rawCommands=this.rawCommands,editor=this.editor,state=this.state,view=editor.view,tr=state.tr,props=this.buildProps(tr);return Object.fromEntries(Object.entries(rawCommands).map((function(_ref60){var _ref61=_slicedToArray(_ref60,2),name=_ref61[0],command=_ref61[1];return[name,function method(){var callback=command.apply(void 0,arguments)(props);return tr.getMeta("preventDispatch")||_this3.hasCustomState||view.dispatch(tr),callback}]})))}},{key:"chain",get:function get(){var _this4=this;return function(){return _this4.createChain()}}},{key:"can",get:function get(){var _this5=this;return function(){return _this5.createCan()}}},{key:"createChain",value:function createChain(startTr){var _this6=this,shouldDispatch=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],rawCommands=this.rawCommands,editor=this.editor,state=this.state,view=editor.view,callbacks=[],hasStartTransaction=!!startTr,tr=startTr||state.tr,run=function run(){return hasStartTransaction||!shouldDispatch||tr.getMeta("preventDispatch")||_this6.hasCustomState||view.dispatch(tr),callbacks.every((function(callback){return!0===callback}))},chain=Object.assign({},Object.fromEntries(Object.entries(rawCommands).map((function(_ref62){var _ref63=_slicedToArray(_ref62,2),name=_ref63[0],command=_ref63[1];return[name,function chainedCommand(){var props=_this6.buildProps(tr,shouldDispatch),callback=command.apply(void 0,arguments)(props);return callbacks.push(callback),chain}]}))),{run});return chain}},{key:"createCan",value:function createCan(startTr){var _this7=this,rawCommands=this.rawCommands,state=this.state,tr=startTr||state.tr,props=this.buildProps(tr,undefined),formattedCommands=Object.fromEntries(Object.entries(rawCommands).map((function(_ref64){var _ref65=_slicedToArray(_ref64,2),name=_ref65[0],command=_ref65[1];return[name,function(){return command.apply(void 0,arguments)(Object.assign({},props,{dispatch:undefined}))}]})));return Object.assign({},formattedCommands,{chain:function chain(){return _this7.createChain(tr,undefined)}})}},{key:"buildProps",value:function buildProps(tr){var _this8=this,shouldDispatch=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],rawCommands=this.rawCommands,editor=this.editor,state=this.state,view=editor.view;state.storedMarks&&tr.setStoredMarks(state.storedMarks);var props={tr,editor,view,state:createChainableState({state,transaction:tr}),dispatch:shouldDispatch?function(){}:void 0,chain:function chain(){return _this8.createChain(tr)},can:function can(){return _this8.createCan(tr)},get commands(){return Object.fromEntries(Object.entries(rawCommands).map((function(_ref66){var _ref67=_slicedToArray(_ref66,2),name=_ref67[0],command=_ref67[1];return[name,function(){return command.apply(void 0,arguments)(props)}]})))}};return props}}]),CommandManager}(),Keymap=Extension.create({name:"keymap",addKeyboardShortcuts:function addKeyboardShortcuts(){var _this9=this,handleBackspace=function handleBackspace(){return _this9.editor.commands.first((function(_ref68){var commands=_ref68.commands;return[function(){return commands.undoInputRule()},function(){return commands.command((function(_ref69){var tr=_ref69.tr,selection=tr.selection,doc=tr.doc,empty=selection.empty,$anchor=selection.$anchor,pos=$anchor.pos,parent=$anchor.parent,isAtStart=Selection.atStart(doc).from===pos;return!(!(empty&&isAtStart&&parent.type.isTextblock)||parent.textContent.length)&&commands.clearNodes()}))},function(){return commands.deleteSelection()},function(){return commands.joinBackward()},function(){return commands.selectNodeBackward()}]}))},handleDelete=function handleDelete(){return _this9.editor.commands.first((function(_ref70){var commands=_ref70.commands;return[function(){return commands.deleteSelection()},function(){return commands.joinForward()},function(){return commands.selectNodeForward()}]}))};return{Enter:function Enter(){return _this9.editor.commands.first((function(_ref71){var commands=_ref71.commands;return[function(){return commands.newlineInCode()},function(){return commands.createParagraphNear()},function(){return commands.liftEmptyBlock()},function(){return commands.splitBlock()}]}))},"Mod-Enter":function ModEnter(){return _this9.editor.commands.exitCode()},Backspace:handleBackspace,"Mod-Backspace":handleBackspace,"Shift-Backspace":handleBackspace,Delete:handleDelete,"Mod-Delete":handleDelete,"Mod-a":function ModA(){return _this9.editor.commands.selectAll()}}},addProseMirrorPlugins:function addProseMirrorPlugins(){var _this10=this;return[new Plugin({key:new PluginKey("clearDocument"),appendTransaction:function appendTransaction(transactions,oldState,newState){if(transactions.some((function(transaction){return transaction.docChanged}))&&!oldState.doc.eq(newState.doc)){var _oldState$selection=oldState.selection,empty=_oldState$selection.empty,from=_oldState$selection.from,to=_oldState$selection.to,allFrom=Selection.atStart(oldState.doc).from,allEnd=Selection.atEnd(oldState.doc).to,allWasSelected=from===allFrom&&to===allEnd,isEmpty=0===newState.doc.textBetween(0,newState.doc.content.size," "," ").length;if(!empty&&allWasSelected&&isEmpty){var tr=newState.tr,state=createChainableState({state:newState,transaction:tr});if(new CommandManager({editor:_this10.editor,state}).commands.clearNodes(),tr.steps.length)return tr}}}})]}}),Tabindex=Extension.create({name:"tabindex",addProseMirrorPlugins:function addProseMirrorPlugins(){return[new Plugin({key:new PluginKey("tabindex"),props:{attributes:{tabindex:"0"}}})]}}),extensions=Object.freeze({__proto__:null,ClipboardTextSerializer,Commands,Editable,FocusEvents,Keymap,Tabindex});function _getAttributes(state,typeOrName){var schemaType=getSchemaTypeNameByName("string"==typeof typeOrName?typeOrName:typeOrName.name,state.schema);return"node"===schemaType?function getNodeAttributes(state,typeOrName){var type=getNodeType(typeOrName,state.schema),_state$selection5=state.selection,from=_state$selection5.from,to=_state$selection5.to,nodes=[];state.doc.nodesBetween(from,to,(function(node){nodes.push(node)}));var node=nodes.reverse().find((function(nodeItem){return nodeItem.type.name===type.name}));return node?Object.assign({},node.attrs):{}}(state,typeOrName):"mark"===schemaType?getMarkAttributes(state,typeOrName):{}}var InputRule=function InputRule(config){_classCallCheck(this,InputRule),this.find=config.find,this.handler=config.handler};function run$1$1(config){var _a,editor=config.editor,from=config.from,to=config.to,text=config.text,rules=config.rules,plugin=config.plugin,view=editor.view;if(view.composing)return!1;var $from=view.state.doc.resolve(from);if($from.parent.type.spec.code||(null===(_a=$from.nodeBefore||$from.nodeAfter)||void 0===_a?void 0:_a.marks.find((function(mark){return mark.type.spec.code}))))return!1;var matched=!1,textBefore=$from.parent.textBetween(Math.max(0,$from.parentOffset-500),$from.parentOffset,void 0," ")+text;return rules.forEach((function(rule){if(!matched){var match=function inputRuleMatcherHandler(text,find){if(isRegExp$1(find))return find.exec(text);var inputRuleMatch=find(text);if(!inputRuleMatch)return null;var result=[];return result.push(inputRuleMatch.text),result.index=inputRuleMatch.index,result.input=text,result.data=inputRuleMatch.data,inputRuleMatch.replaceWith&&(inputRuleMatch.text.includes(inputRuleMatch.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),result.push(inputRuleMatch.replaceWith)),result}(textBefore,rule.find);if(match){var tr=view.state.tr,state=createChainableState({state:view.state,transaction:tr}),range={from:from-(match[0].length-text.length),to},_CommandManager2=new CommandManager({editor,state}),commands=_CommandManager2.commands,chain=_CommandManager2.chain,can=_CommandManager2.can;null!==rule.handler({state,range,match,commands,chain,can})&&tr.steps.length&&(tr.setMeta(plugin,{transform:tr,from,to,text}),view.dispatch(tr),matched=!0)}}})),matched}function inputRulesPlugin(props){var editor=props.editor,rules=props.rules,plugin=new Plugin({state:{init:function init(){return null},apply:function apply(tr,prev){var stored=tr.getMeta(this);return stored||(tr.selectionSet||tr.docChanged?null:prev)}},props:{handleTextInput:function handleTextInput(view,from,to,text){return run$1$1({editor,from,to,text,rules,plugin})},handleDOMEvents:{compositionend:function compositionend(view){return setTimeout((function(){var $cursor=view.state.selection.$cursor;$cursor&&run$1$1({editor,from:$cursor.pos,to:$cursor.pos,text:"",rules,plugin})})),!1}},handleKeyDown:function handleKeyDown(view,event){if("Enter"!==event.key)return!1;var $cursor=view.state.selection.$cursor;return!!$cursor&&run$1$1({editor,from:$cursor.pos,to:$cursor.pos,text:"\n",rules,plugin})}},isInputRules:!0});return plugin}var PasteRule=function PasteRule(config){_classCallCheck(this,PasteRule),this.find=config.find,this.handler=config.handler};function run$2(config){var editor=config.editor,state=config.state,from=config.from,to=config.to,rule=config.rule,_CommandManager3=new CommandManager({editor,state}),commands=_CommandManager3.commands,chain=_CommandManager3.chain,can=_CommandManager3.can,handlers=[];return state.doc.nodesBetween(from,to,(function(node,pos){if(node.isTextblock&&!node.type.spec.code){var resolvedFrom=Math.max(from,pos),resolvedTo=Math.min(to,pos+node.content.size),matches=function pasteRuleMatcherHandler(text,find){if(isRegExp$1(find))return _toConsumableArray(text.matchAll(find));var matches=find(text);return matches?matches.map((function(pasteRuleMatch){var result=[];return result.push(pasteRuleMatch.text),result.index=pasteRuleMatch.index,result.input=text,result.data=pasteRuleMatch.data,pasteRuleMatch.replaceWith&&(pasteRuleMatch.text.includes(pasteRuleMatch.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),result.push(pasteRuleMatch.replaceWith)),result})):[]}(node.textBetween(resolvedFrom-pos,resolvedTo-pos,void 0,""),rule.find);matches.forEach((function(match){if(void 0!==match.index){var start=resolvedFrom+match.index+1,end=start+match[0].length,range={from:state.tr.mapping.map(start),to:state.tr.mapping.map(end)},handler=rule.handler({state,range,match,commands,chain,can});handlers.push(handler)}}))}})),handlers.every((function(handler){return null!==handler}))}function getAttributesFromExtensions(extensions){var extensionAttributes=[],_splitExtensions2=splitExtensions(extensions),nodeExtensions=_splitExtensions2.nodeExtensions,markExtensions=_splitExtensions2.markExtensions,nodeAndMarkExtensions=[].concat(_toConsumableArray(nodeExtensions),_toConsumableArray(markExtensions)),defaultAttribute={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return extensions.forEach((function(extension){var addGlobalAttributes=getExtensionField(extension,"addGlobalAttributes",{name:extension.name,options:extension.options,storage:extension.storage});addGlobalAttributes&&addGlobalAttributes().forEach((function(globalAttribute){globalAttribute.types.forEach((function(type){Object.entries(globalAttribute.attributes).forEach((function(_ref72){var _ref73=_slicedToArray(_ref72,2),name=_ref73[0],attribute=_ref73[1];extensionAttributes.push({type,name,attribute:Object.assign({},defaultAttribute,attribute)})}))}))}))})),nodeAndMarkExtensions.forEach((function(extension){var context={name:extension.name,options:extension.options,storage:extension.storage},addAttributes=getExtensionField(extension,"addAttributes",context);if(addAttributes){var attributes=addAttributes();Object.entries(attributes).forEach((function(_ref74){var _ref75=_slicedToArray(_ref74,2),name=_ref75[0],attribute=_ref75[1];extensionAttributes.push({type:extension.name,name,attribute:Object.assign({},defaultAttribute,attribute)})}))}})),extensionAttributes}function mergeAttributes(){for(var _len2=arguments.length,objects=new Array(_len2),_key2=0;_key2<_len2;_key2++)objects[_key2]=arguments[_key2];return objects.filter((function(item){return!!item})).reduce((function(items,item){var mergedAttributes=Object.assign({},items);return Object.entries(item).forEach((function(_ref76){var _ref77=_slicedToArray(_ref76,2),key=_ref77[0],value=_ref77[1];mergedAttributes[key]?mergedAttributes[key]="class"===key?[mergedAttributes[key],value].join(" "):"style"===key?[mergedAttributes[key],value].join("; "):value:mergedAttributes[key]=value})),mergedAttributes}),{})}function getRenderedAttributes(nodeOrMark,extensionAttributes){return extensionAttributes.filter((function(item){return item.attribute.rendered})).map((function(item){var _ref78;return item.attribute.renderHTML?item.attribute.renderHTML(nodeOrMark.attrs)||{}:((_ref78={})[item.name]=nodeOrMark.attrs[item.name],_ref78)})).reduce((function(attributes,attribute){return mergeAttributes(attributes,attribute)}),{})}function injectExtensionAttributesToParseRule(parseRule,extensionAttributes){return parseRule.style?parseRule:Object.assign({},parseRule,{getAttrs:function getAttrs(node){var oldAttributes=parseRule.getAttrs?parseRule.getAttrs(node):parseRule.attrs;if(!1===oldAttributes)return!1;var newAttributes=extensionAttributes.filter((function(item){return item.attribute.rendered})).reduce((function(items,item){var _Object$assign3,value=item.attribute.parseHTML?item.attribute.parseHTML(node):function fromString(value){return"string"!=typeof value?value:value.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(value):"true"===value||"false"!==value&&value}(node.getAttribute(item.name));return isObject$1(value)&&console.warn('[tiptap warn]: BREAKING CHANGE: "parseHTML" for your attribute "'+item.name+'" returns an object but should return the value itself. If this is expected you can ignore this message. This warning will be removed in one of the next releases. Further information: https://github.com/ueberdosis/tiptap/issues/1863'),null==value?items:Object.assign({},items,((_Object$assign3={})[item.name]=value,_Object$assign3))}),{});return Object.assign({},oldAttributes,newAttributes)}})}function cleanUpSchemaItem(data){return Object.fromEntries(Object.entries(data).filter((function(_ref79){var _ref80=_slicedToArray(_ref79,2),key=_ref80[0],value=_ref80[1];return("attrs"!==key||!function isEmptyObject(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(value).length&&value.constructor===Object}(value))&&null!=value})))}function getSchemaTypeByName(name,schema){return schema.nodes[name]||schema.marks[name]||null}function isExtensionRulesEnabled(extension,enabled){return Array.isArray(enabled)?enabled.some((function(enabledExtension){return("string"==typeof enabledExtension?enabledExtension:enabledExtension.name)===extension.name})):enabled}var ExtensionManager=function(){function ExtensionManager(extensions,editor){var _this11=this;_classCallCheck(this,ExtensionManager),this.splittableMarks=[],this.editor=editor,this.extensions=ExtensionManager.resolve(extensions),this.schema=function getSchemaByResolvedExtensions(extensions){var _a,allAttributes=getAttributesFromExtensions(extensions),_splitExtensions3=splitExtensions(extensions),nodeExtensions=_splitExtensions3.nodeExtensions,markExtensions=_splitExtensions3.markExtensions,topNode=null===(_a=nodeExtensions.find((function(extension){return getExtensionField(extension,"topNode")})))||void 0===_a?void 0:_a.name,nodes=Object.fromEntries(nodeExtensions.map((function(extension){var extensionAttributes=allAttributes.filter((function(attribute){return attribute.type===extension.name})),context={name:extension.name,options:extension.options,storage:extension.storage},extraNodeFields=extensions.reduce((function(fields,e){var extendNodeSchema=getExtensionField(e,"extendNodeSchema",context);return Object.assign({},fields,extendNodeSchema?extendNodeSchema(extension):{})}),{}),schema=cleanUpSchemaItem(Object.assign({},extraNodeFields,{content:callOrReturn(getExtensionField(extension,"content",context)),marks:callOrReturn(getExtensionField(extension,"marks",context)),group:callOrReturn(getExtensionField(extension,"group",context)),inline:callOrReturn(getExtensionField(extension,"inline",context)),atom:callOrReturn(getExtensionField(extension,"atom",context)),selectable:callOrReturn(getExtensionField(extension,"selectable",context)),draggable:callOrReturn(getExtensionField(extension,"draggable",context)),code:callOrReturn(getExtensionField(extension,"code",context)),defining:callOrReturn(getExtensionField(extension,"defining",context)),isolating:callOrReturn(getExtensionField(extension,"isolating",context)),attrs:Object.fromEntries(extensionAttributes.map((function(extensionAttribute){var _a;return[extensionAttribute.name,{default:null===(_a=null==extensionAttribute?void 0:extensionAttribute.attribute)||void 0===_a?void 0:_a.default}]})))})),parseHTML=callOrReturn(getExtensionField(extension,"parseHTML",context));parseHTML&&(schema.parseDOM=parseHTML.map((function(parseRule){return injectExtensionAttributesToParseRule(parseRule,extensionAttributes)})));var renderHTML=getExtensionField(extension,"renderHTML",context);renderHTML&&(schema.toDOM=function(node){return renderHTML({node,HTMLAttributes:getRenderedAttributes(node,extensionAttributes)})});var renderText=getExtensionField(extension,"renderText",context);return renderText&&(schema.toText=renderText),[extension.name,schema]}))),marks=Object.fromEntries(markExtensions.map((function(extension){var extensionAttributes=allAttributes.filter((function(attribute){return attribute.type===extension.name})),context={name:extension.name,options:extension.options,storage:extension.storage},extraMarkFields=extensions.reduce((function(fields,e){var extendMarkSchema=getExtensionField(e,"extendMarkSchema",context);return Object.assign({},fields,extendMarkSchema?extendMarkSchema(extension):{})}),{}),schema=cleanUpSchemaItem(Object.assign({},extraMarkFields,{inclusive:callOrReturn(getExtensionField(extension,"inclusive",context)),excludes:callOrReturn(getExtensionField(extension,"excludes",context)),group:callOrReturn(getExtensionField(extension,"group",context)),spanning:callOrReturn(getExtensionField(extension,"spanning",context)),code:callOrReturn(getExtensionField(extension,"code",context)),attrs:Object.fromEntries(extensionAttributes.map((function(extensionAttribute){var _a;return[extensionAttribute.name,{default:null===(_a=null==extensionAttribute?void 0:extensionAttribute.attribute)||void 0===_a?void 0:_a.default}]})))})),parseHTML=callOrReturn(getExtensionField(extension,"parseHTML",context));parseHTML&&(schema.parseDOM=parseHTML.map((function(parseRule){return injectExtensionAttributesToParseRule(parseRule,extensionAttributes)})));var renderHTML=getExtensionField(extension,"renderHTML",context);return renderHTML&&(schema.toDOM=function(mark){return renderHTML({mark,HTMLAttributes:getRenderedAttributes(mark,extensionAttributes)})}),[extension.name,schema]})));return new Schema({topNode,nodes,marks})}(this.extensions),this.extensions.forEach((function(extension){var _a;_this11.editor.extensionStorage[extension.name]=extension.storage;var context={name:extension.name,options:extension.options,storage:extension.storage,editor:_this11.editor,type:getSchemaTypeByName(extension.name,_this11.schema)};"mark"===extension.type&&((null===(_a=callOrReturn(getExtensionField(extension,"keepOnSplit",context)))||void 0===_a||_a)&&_this11.splittableMarks.push(extension.name));var onBeforeCreate=getExtensionField(extension,"onBeforeCreate",context);onBeforeCreate&&_this11.editor.on("beforeCreate",onBeforeCreate);var onCreate=getExtensionField(extension,"onCreate",context);onCreate&&_this11.editor.on("create",onCreate);var onUpdate=getExtensionField(extension,"onUpdate",context);onUpdate&&_this11.editor.on("update",onUpdate);var onSelectionUpdate=getExtensionField(extension,"onSelectionUpdate",context);onSelectionUpdate&&_this11.editor.on("selectionUpdate",onSelectionUpdate);var onTransaction=getExtensionField(extension,"onTransaction",context);onTransaction&&_this11.editor.on("transaction",onTransaction);var onFocus=getExtensionField(extension,"onFocus",context);onFocus&&_this11.editor.on("focus",onFocus);var onBlur=getExtensionField(extension,"onBlur",context);onBlur&&_this11.editor.on("blur",onBlur);var onDestroy=getExtensionField(extension,"onDestroy",context);onDestroy&&_this11.editor.on("destroy",onDestroy)}))}return _createClass(ExtensionManager,[{key:"commands",get:function get(){var _this12=this;return this.extensions.reduce((function(commands,extension){var addCommands=getExtensionField(extension,"addCommands",{name:extension.name,options:extension.options,storage:extension.storage,editor:_this12.editor,type:getSchemaTypeByName(extension.name,_this12.schema)});return addCommands?Object.assign({},commands,addCommands()):commands}),{})}},{key:"plugins",get:function get(){var _this13=this,editor=this.editor,extensions=ExtensionManager.sort(_toConsumableArray(this.extensions).reverse()),inputRules=[],pasteRules=[],allPlugins=extensions.map((function(extension){var context={name:extension.name,options:extension.options,storage:extension.storage,editor,type:getSchemaTypeByName(extension.name,_this13.schema)},plugins=[],addKeyboardShortcuts=getExtensionField(extension,"addKeyboardShortcuts",context);if(addKeyboardShortcuts){var keyMapPlugin=function keymap(bindings){return new Plugin({props:{handleKeyDown:keydownHandler(bindings)}})}(Object.fromEntries(Object.entries(addKeyboardShortcuts()).map((function(_ref81){var _ref82=_slicedToArray(_ref81,2),shortcut=_ref82[0],method=_ref82[1];return[shortcut,function(){return method({editor})}]}))));plugins.push(keyMapPlugin)}var addInputRules=getExtensionField(extension,"addInputRules",context);isExtensionRulesEnabled(extension,editor.options.enableInputRules)&&addInputRules&&inputRules.push.apply(inputRules,_toConsumableArray(addInputRules()));var addPasteRules=getExtensionField(extension,"addPasteRules",context);isExtensionRulesEnabled(extension,editor.options.enablePasteRules)&&addPasteRules&&pasteRules.push.apply(pasteRules,_toConsumableArray(addPasteRules()));var addProseMirrorPlugins=getExtensionField(extension,"addProseMirrorPlugins",context);if(addProseMirrorPlugins){var proseMirrorPlugins=addProseMirrorPlugins();plugins.push.apply(plugins,_toConsumableArray(proseMirrorPlugins))}return plugins})).flat();return[inputRulesPlugin({editor,rules:inputRules})].concat(_toConsumableArray(function pasteRulesPlugin(props){var editor=props.editor,rules=props.rules,isProseMirrorHTML=!1;return rules.map((function(rule){return new Plugin({props:{handlePaste:function handlePaste(view,event){var _a,html=null===(_a=event.clipboardData)||void 0===_a?void 0:_a.getData("text/html");return isProseMirrorHTML=!!(null==html?void 0:html.includes("data-pm-slice")),!1}},appendTransaction:function appendTransaction(transactions,oldState,state){if(transactions[0].getMeta("paste")&&!isProseMirrorHTML){var from=oldState.doc.content.findDiffStart(state.doc.content),to=oldState.doc.content.findDiffEnd(state.doc.content);if(function isNumber(value){return"number"==typeof value}(from)&&to&&from!==to.b){var tr=state.tr,chainableState=createChainableState({state,transaction:tr});if(run$2({editor,state:chainableState,from:Math.max(from-1,0),to:to.b,rule})&&tr.steps.length)return tr}}}})}))}({editor,rules:pasteRules})),_toConsumableArray(allPlugins))}},{key:"attributes",get:function get(){return getAttributesFromExtensions(this.extensions)}},{key:"nodeViews",get:function get(){var _this14=this,editor=this.editor,nodeExtensions=splitExtensions(this.extensions).nodeExtensions;return Object.fromEntries(nodeExtensions.filter((function(extension){return!!getExtensionField(extension,"addNodeView")})).map((function(extension){var extensionAttributes=_this14.attributes.filter((function(attribute){return attribute.type===extension.name})),context={name:extension.name,options:extension.options,storage:extension.storage,editor,type:getNodeType(extension.name,_this14.schema)},addNodeView=getExtensionField(extension,"addNodeView",context);if(!addNodeView)return[];return[extension.name,function nodeview(node,view,getPos,decorations){var HTMLAttributes=getRenderedAttributes(node,extensionAttributes);return addNodeView()({editor,node,getPos,decorations,HTMLAttributes,extension})}]})))}}],[{key:"resolve",value:function resolve(extensions){var resolvedExtensions=ExtensionManager.sort(ExtensionManager.flatten(extensions)),duplicatedNames=function findDuplicates(items){var filtered=items.filter((function(el,index){return items.indexOf(el)!==index}));return _toConsumableArray(new Set(filtered))}(resolvedExtensions.map((function(extension){return extension.name})));return duplicatedNames.length&&console.warn("[tiptap warn]: Duplicate extension names found: ["+duplicatedNames.map((function(item){return"'"+item+"'"})).join(", ")+"]. This can lead to issues."),resolvedExtensions}},{key:"flatten",value:function flatten(extensions){var _this15=this;return extensions.map((function(extension){var addExtensions=getExtensionField(extension,"addExtensions",{name:extension.name,options:extension.options,storage:extension.storage});return addExtensions?[extension].concat(_toConsumableArray(_this15.flatten(addExtensions()))):extension})).flat(10)}},{key:"sort",value:function sort(extensions){return extensions.sort((function(a,b){var priorityA=getExtensionField(a,"priority")||100,priorityB=getExtensionField(b,"priority")||100;return priorityA>priorityB?-1:priorityA<priorityB?1:0}))}}]),ExtensionManager}(),Editor=function(_EventEmitter){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(subClass,"prototype",{value:Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(Editor,_EventEmitter);var _super=_createSuper(Editor);function Editor(){var _this17,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Editor),(_this17=_super.call(this)).isFocused=!1,_this17.extensionStorage={},_this17.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:function onBeforeCreate(){return null},onCreate:function onCreate(){return null},onUpdate:function onUpdate(){return null},onSelectionUpdate:function onSelectionUpdate(){return null},onTransaction:function onTransaction(){return null},onFocus:function onFocus(){return null},onBlur:function onBlur(){return null},onDestroy:function onDestroy(){return null}},_this17.isCapturingTransaction=!1,_this17.capturedTransaction=null,_this17.setOptions(options),_this17.createExtensionManager(),_this17.createCommandManager(),_this17.createSchema(),_this17.on("beforeCreate",_this17.options.onBeforeCreate),_this17.emit("beforeCreate",{editor:_assertThisInitialized(_this17)}),_this17.createView(),_this17.injectCSS(),_this17.on("create",_this17.options.onCreate),_this17.on("update",_this17.options.onUpdate),_this17.on("selectionUpdate",_this17.options.onSelectionUpdate),_this17.on("transaction",_this17.options.onTransaction),_this17.on("focus",_this17.options.onFocus),_this17.on("blur",_this17.options.onBlur),_this17.on("destroy",_this17.options.onDestroy),window.setTimeout((function(){_this17.isDestroyed||(_this17.commands.focus(_this17.options.autofocus),_this17.emit("create",{editor:_assertThisInitialized(_this17)}))}),0),_this17}return _createClass(Editor,[{key:"storage",get:function get(){return this.extensionStorage}},{key:"commands",get:function get(){return this.commandManager.commands}},{key:"chain",value:function chain(){return this.commandManager.chain()}},{key:"can",value:function can(){return this.commandManager.can()}},{key:"injectCSS",value:function injectCSS(){this.options.injectCSS&&document&&(this.css=function createStyleTag(style){var tipTapStyleTag=document.querySelector("style[data-tiptap-style]");if(null!==tipTapStyleTag)return tipTapStyleTag;var styleNode=document.createElement("style");return styleNode.setAttribute("data-tiptap-style",""),styleNode.innerHTML=style,document.getElementsByTagName("head")[0].appendChild(styleNode),styleNode}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}'))}},{key:"setOptions",value:function setOptions(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=Object.assign({},this.options,options),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}},{key:"setEditable",value:function setEditable(editable){this.setOptions({editable})}},{key:"isEditable",get:function get(){return this.options.editable&&this.view&&this.view.editable}},{key:"state",get:function get(){return this.view.state}},{key:"registerPlugin",value:function registerPlugin(plugin,handlePlugins){var plugins=isFunction$1(handlePlugins)?handlePlugins(plugin,this.state.plugins):[].concat(_toConsumableArray(this.state.plugins),[plugin]),state=this.state.reconfigure({plugins});this.view.updateState(state)}},{key:"unregisterPlugin",value:function unregisterPlugin(nameOrPluginKey){if(!this.isDestroyed){var name="string"==typeof nameOrPluginKey?nameOrPluginKey+"$":nameOrPluginKey.key,state=this.state.reconfigure({plugins:this.state.plugins.filter((function(plugin){return!plugin.key.startsWith(name)}))});this.view.updateState(state)}}},{key:"createExtensionManager",value:function createExtensionManager(){var coreExtensions=this.options.enableCoreExtensions?Object.values(extensions):[],allExtensions=[].concat(_toConsumableArray(coreExtensions),_toConsumableArray(this.options.extensions)).filter((function(extension){return["extension","node","mark"].includes(null==extension?void 0:extension.type)}));this.extensionManager=new ExtensionManager(allExtensions,this)}},{key:"createCommandManager",value:function createCommandManager(){this.commandManager=new CommandManager({editor:this})}},{key:"createSchema",value:function createSchema(){this.schema=this.extensionManager.schema}},{key:"createView",value:function createView(){var doc=createDocument(this.options.content,this.schema,this.options.parseOptions),selection=resolveFocusPosition(doc,this.options.autofocus);this.view=new EditorView(this.options.element,Object.assign({},this.options.editorProps,{dispatchTransaction:this.dispatchTransaction.bind(this),state:EditorState.create({doc,selection})}));var newState=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(newState),this.createNodeViews(),this.view.dom.editor=this}},{key:"createNodeViews",value:function createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}},{key:"captureTransaction",value:function captureTransaction(fn){this.isCapturingTransaction=!0,fn(),this.isCapturingTransaction=!1;var tr=this.capturedTransaction;return this.capturedTransaction=null,tr}},{key:"dispatchTransaction",value:function dispatchTransaction(transaction){var _this18=this;if(this.isCapturingTransaction)return this.capturedTransaction?void transaction.steps.forEach((function(step){var _a;return null===(_a=_this18.capturedTransaction)||void 0===_a?void 0:_a.step(step)})):void(this.capturedTransaction=transaction);var state=this.state.apply(transaction),selectionHasChanged=!this.state.selection.eq(state.selection);this.view.updateState(state),this.emit("transaction",{editor:this,transaction}),selectionHasChanged&&this.emit("selectionUpdate",{editor:this,transaction});var focus=transaction.getMeta("focus"),blur=transaction.getMeta("blur");focus&&this.emit("focus",{editor:this,event:focus.event,transaction}),blur&&this.emit("blur",{editor:this,event:blur.event,transaction}),transaction.docChanged&&!transaction.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction})}},{key:"getAttributes",value:function getAttributes(nameOrType){return _getAttributes(this.state,nameOrType)}},{key:"isActive",value:function isActive(nameOrAttributes,attributesOrUndefined){var name="string"==typeof nameOrAttributes?nameOrAttributes:null,attributes="string"==typeof nameOrAttributes?attributesOrUndefined:nameOrAttributes;return function _isActive(state,name){var attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!name)return isNodeActive(state,null,attributes)||isMarkActive(state,null,attributes);var schemaType=getSchemaTypeNameByName(name,state.schema);return"node"===schemaType?isNodeActive(state,name,attributes):"mark"===schemaType&&isMarkActive(state,name,attributes)}(this.state,name,attributes)}},{key:"getJSON",value:function getJSON(){return this.state.doc.toJSON()}},{key:"getHTML",value:function getHTML(){return function getHTMLFromFragment(fragment,schema){var documentFragment=DOMSerializer.fromSchema(schema).serializeFragment(fragment),container=document.implementation.createHTMLDocument().createElement("div");return container.appendChild(documentFragment),container.innerHTML}(this.state.doc.content,this.schema)}},{key:"getText",value:function getText(options){var _ref83=options||{},_ref83$blockSeparator=_ref83.blockSeparator,blockSeparator=void 0===_ref83$blockSeparator?"\n\n":_ref83$blockSeparator,_ref83$textSerializer=_ref83.textSerializers,textSerializers=void 0===_ref83$textSerializer?{}:_ref83$textSerializer;return function _getText(node,options){return getTextBetween(node,{from:0,to:node.content.size},options)}(this.state.doc,{blockSeparator,textSerializers:Object.assign({},textSerializers,getTextSeralizersFromSchema(this.schema))})}},{key:"isEmpty",get:function get(){return function isNodeEmpty(node){var _a,defaultContent=null===(_a=node.type.createAndFill())||void 0===_a?void 0:_a.toJSON(),content=node.toJSON();return JSON.stringify(defaultContent)===JSON.stringify(content)}(this.state.doc)}},{key:"getCharacterCount",value:function getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}},{key:"destroy",value:function destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}},{key:"isDestroyed",get:function get(){var _a;return!(null===(_a=this.view)||void 0===_a?void 0:_a.docView)}}]),Editor}(function(){function EventEmitter(){_classCallCheck(this,EventEmitter),this.callbacks={}}return _createClass(EventEmitter,[{key:"on",value:function on(event,fn){return this.callbacks[event]||(this.callbacks[event]=[]),this.callbacks[event].push(fn),this}},{key:"emit",value:function emit(event){for(var _this16=this,_len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)args[_key3-1]=arguments[_key3];var callbacks=this.callbacks[event];return callbacks&&callbacks.forEach((function(callback){return callback.apply(_this16,args)})),this}},{key:"off",value:function off(event,fn){var callbacks=this.callbacks[event];return callbacks&&(fn?this.callbacks[event]=callbacks.filter((function(callback){return callback!==fn})):delete this.callbacks[event]),this}},{key:"removeAllListeners",value:function removeAllListeners(){this.callbacks={}}}]),EventEmitter}()),Node=function(){function Node(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Node),this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Object.assign({},this.config,config),this.name=this.config.name,config.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+this.name+'".'),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}return _createClass(Node,[{key:"configure",value:function configure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}},{key:"extend",value:function extend(){var extendedConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=new Node(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+extension.name+'".'),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}],[{key:"create",value:function create(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Node(config)}}]),Node}(),Mark=function(){function Mark(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Mark),this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Object.assign({},this.config,config),this.name=this.config.name,config.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+this.name+'".'),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=callOrReturn(getExtensionField(this,"addOptions",{name:this.name}))),this.storage=callOrReturn(getExtensionField(this,"addStorage",{name:this.name,options:this.options}))||{}}return _createClass(Mark,[{key:"configure",value:function configure(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=this.extend();return extension.options=mergeDeep(this.options,options),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}},{key:"extend",value:function extend(){var extendedConfig=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},extension=new Mark(extendedConfig);return extension.parent=this,this.child=extension,extension.name=extendedConfig.name?extendedConfig.name:extension.parent.name,extendedConfig.defaultOptions&&console.warn('[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "'+extension.name+'".'),extension.options=callOrReturn(getExtensionField(extension,"addOptions",{name:extension.name})),extension.storage=callOrReturn(getExtensionField(extension,"addStorage",{name:extension.name,options:extension.options})),extension}}],[{key:"create",value:function create(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Mark(config)}}]),Mark}();function nodeInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref84){var state=_ref84.state,range=_ref84.range,match=_ref84.match,attributes=callOrReturn(config.getAttributes,void 0,match)||{},tr=state.tr,start=range.from,end=range.to;if(match[1]){var matchStart=start+match[0].lastIndexOf(match[1]);matchStart>end?matchStart=end:end=matchStart+match[1].length;var lastChar=match[0][match[0].length-1];tr.insertText(lastChar,start+match[0].length-1),tr.replaceWith(matchStart,end,config.type.create(attributes))}else match[0]&&tr.replaceWith(start,end,config.type.create(attributes))}})}function getMarksBetween(from,to,doc){var marks=[];return from===to?doc.resolve(from).marks().forEach((function(mark){var range=getMarkRange(doc.resolve(from-1),mark.type);range&&marks.push(Object.assign({mark},range))})):doc.nodesBetween(from,to,(function(node,pos){marks.push.apply(marks,_toConsumableArray(node.marks.map((function(mark){return{from:pos,to:pos+node.nodeSize,mark}}))))})),marks}function markInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref85){var state=_ref85.state,range=_ref85.range,match=_ref85.match,attributes=callOrReturn(config.getAttributes,void 0,match);if(!1===attributes||null===attributes)return null;var tr=state.tr,captureGroup=match[match.length-1],fullMatch=match[0],markEnd=range.to;if(captureGroup){var startSpaces=fullMatch.search(/\S/),textStart=range.from+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;if(getMarksBetween(range.from,range.to,state.doc).filter((function(item){return item.mark.type.excluded.find((function(type){return type===config.type&&type!==item.mark.type}))})).filter((function(item){return item.to>textStart})).length)return null;textEnd<range.to&&tr.delete(textEnd,range.to),textStart>range.from&&tr.delete(range.from+startSpaces,textStart),markEnd=range.from+startSpaces+captureGroup.length,tr.addMark(range.from+startSpaces,markEnd,config.type.create(attributes||{})),tr.removeStoredMark(config.type)}}})}function textblockTypeInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref86){var state=_ref86.state,range=_ref86.range,match=_ref86.match,$start=state.doc.resolve(range.from),attributes=callOrReturn(config.getAttributes,void 0,match)||{};if(!$start.node(-1).canReplaceWith($start.index(-1),$start.indexAfter(-1),config.type))return null;state.tr.delete(range.from,range.to).setBlockType(range.from,range.from,config.type,attributes)}})}function wrappingInputRule(config){return new InputRule({find:config.find,handler:function handler(_ref87){var state=_ref87.state,range=_ref87.range,match=_ref87.match,attributes=callOrReturn(config.getAttributes,void 0,match)||{},tr=state.tr.delete(range.from,range.to),blockRange=tr.doc.resolve(range.from).blockRange(),wrapping=blockRange&&findWrapping(blockRange,config.type,attributes);if(!wrapping)return null;tr.wrap(blockRange,wrapping);var before=tr.doc.resolve(range.from-1).nodeBefore;before&&before.type===config.type&&canJoin(tr.doc,range.from-1)&&(!config.joinPredicate||config.joinPredicate(match,before))&&tr.join(range.from-1)}})}function markPasteRule(config){return new PasteRule({find:config.find,handler:function handler(_ref88){var state=_ref88.state,range=_ref88.range,match=_ref88.match,attributes=callOrReturn(config.getAttributes,void 0,match);if(!1===attributes||null===attributes)return null;var tr=state.tr,captureGroup=match[match.length-1],fullMatch=match[0],markEnd=range.to;if(captureGroup){var startSpaces=fullMatch.search(/\S/),textStart=range.from+fullMatch.indexOf(captureGroup),textEnd=textStart+captureGroup.length;if(getMarksBetween(range.from,range.to,state.doc).filter((function(item){return item.mark.type.excluded.find((function(type){return type===config.type&&type!==item.mark.type}))})).filter((function(item){return item.to>textStart})).length)return null;textEnd<range.to&&tr.delete(textEnd,range.to),textStart>range.from&&tr.delete(range.from+startSpaces,textStart),markEnd=range.from+startSpaces+captureGroup.length,tr.addMark(range.from+startSpaces,markEnd,config.type.create(attributes||{})),tr.removeStoredMark(config.type)}}})}function simplifyChangedRanges(changes){var uniqueChanges=function removeDuplicates(array){var by=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify,seen={};return array.filter((function(item){var key=by(item);return!Object.prototype.hasOwnProperty.call(seen,key)&&(seen[key]=!0)}))}(changes);return 1===uniqueChanges.length?uniqueChanges:uniqueChanges.filter((function(change,index){var rest=uniqueChanges.filter((function(_,i){return i!==index}));return!rest.some((function(otherChange){return change.oldRange.from>=otherChange.oldRange.from&&change.oldRange.to<=otherChange.oldRange.to&&change.newRange.from>=otherChange.newRange.from&&change.newRange.to<=otherChange.newRange.to}))}))}var inputRegex$5=/^\s*>\s$/,Blockquote=Node.create({name:"blockquote",addOptions:function addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML:function parseHTML(){return[{tag:"blockquote"}]},renderHTML:function renderHTML(_ref90){var HTMLAttributes=_ref90.HTMLAttributes;return["blockquote",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this19=this;return{setBlockquote:function setBlockquote(){return function(_ref91){return _ref91.commands.wrapIn(_this19.name)}},toggleBlockquote:function toggleBlockquote(){return function(_ref92){return _ref92.commands.toggleWrap(_this19.name)}},unsetBlockquote:function unsetBlockquote(){return function(_ref93){return _ref93.commands.lift(_this19.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this20=this;return{"Mod-Shift-b":function ModShiftB(){return _this20.editor.commands.toggleBlockquote()}}},addInputRules:function addInputRules(){return[wrappingInputRule({find:inputRegex$5,type:this.type})]}}),starInputRegex$1=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,starPasteRegex$1=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,underscoreInputRegex$1=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,underscorePasteRegex$1=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Bold=Mark.create({name:"bold",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:function getAttrs(node){return"normal"!==node.style.fontWeight&&null}},{style:"font-weight",getAttrs:function getAttrs(value){return/^(bold(er)?|[5-9]\d{2,})$/.test(value)&&null}}]},renderHTML:function renderHTML(_ref94){var HTMLAttributes=_ref94.HTMLAttributes;return["strong",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this21=this;return{setBold:function setBold(){return function(_ref95){return _ref95.commands.setMark(_this21.name)}},toggleBold:function toggleBold(){return function(_ref96){return _ref96.commands.toggleMark(_this21.name)}},unsetBold:function unsetBold(){return function(_ref97){return _ref97.commands.unsetMark(_this21.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this22=this;return{"Mod-b":function ModB(){return _this22.editor.commands.toggleBold()}}},addInputRules:function addInputRules(){return[markInputRule({find:starInputRegex$1,type:this.type}),markInputRule({find:underscoreInputRegex$1,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:starPasteRegex$1,type:this.type}),markPasteRule({find:underscorePasteRegex$1,type:this.type})]}}),inputRegex$4=/^\s*([-+*])\s$/,BulletList$1=Node.create({name:"bulletList",addOptions:function addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content:function content(){return this.options.itemTypeName+"+"},parseHTML:function parseHTML(){return[{tag:"ul"}]},renderHTML:function renderHTML(_ref98){var HTMLAttributes=_ref98.HTMLAttributes;return["ul",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this23=this;return{toggleBulletList:function toggleBulletList(){return function(_ref99){return _ref99.commands.toggleList(_this23.name,_this23.options.itemTypeName)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this24=this;return{"Mod-Shift-8":function ModShift8(){return _this24.editor.commands.toggleBulletList()}}},addInputRules:function addInputRules(){return[wrappingInputRule({find:inputRegex$4,type:this.type})]}}),inputRegex$3=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,pasteRegex$1=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Code=Mark.create({name:"code",addOptions:function addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,parseHTML:function parseHTML(){return[{tag:"code"}]},renderHTML:function renderHTML(_ref100){var HTMLAttributes=_ref100.HTMLAttributes;return["code",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this25=this;return{setCode:function setCode(){return function(_ref101){return _ref101.commands.setMark(_this25.name)}},toggleCode:function toggleCode(){return function(_ref102){return _ref102.commands.toggleMark(_this25.name)}},unsetCode:function unsetCode(){return function(_ref103){return _ref103.commands.unsetMark(_this25.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this26=this;return{"Mod-e":function ModE(){return _this26.editor.commands.toggleCode()}}},addInputRules:function addInputRules(){return[markInputRule({find:inputRegex$3,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:pasteRegex$1,type:this.type})]}}),backtickInputRegex=/^```([a-z]+)?[\s\n]$/,tildeInputRegex=/^~~~([a-z]+)?[\s\n]$/,CodeBlock=Node.create({name:"codeBlock",addOptions:function addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes:function addAttributes(){var _this27=this;return{language:{default:null,parseHTML:function parseHTML(element){var _a,languageClassPrefix=_this27.options.languageClassPrefix,language=_toConsumableArray((null===(_a=element.firstElementChild)||void 0===_a?void 0:_a.classList)||[]).filter((function(className){return className.startsWith(languageClassPrefix)})).map((function(className){return className.replace(languageClassPrefix,"")}))[0];return language||null},renderHTML:function renderHTML(attributes){return attributes.language?{class:_this27.options.languageClassPrefix+attributes.language}:null}}}},parseHTML:function parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML:function renderHTML(_ref104){var HTMLAttributes=_ref104.HTMLAttributes;return["pre",this.options.HTMLAttributes,["code",HTMLAttributes,0]]},addCommands:function addCommands(){var _this28=this;return{setCodeBlock:function setCodeBlock(attributes){return function(_ref105){return _ref105.commands.setNode(_this28.name,attributes)}},toggleCodeBlock:function toggleCodeBlock(attributes){return function(_ref106){return _ref106.commands.toggleNode(_this28.name,"paragraph",attributes)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this29=this;return{"Mod-Alt-c":function ModAltC(){return _this29.editor.commands.toggleCodeBlock()},Backspace:function Backspace(){var _this29$editor$state$=_this29.editor.state.selection,empty=_this29$editor$state$.empty,$anchor=_this29$editor$state$.$anchor,isAtStart=1===$anchor.pos;return!(!empty||$anchor.parent.type.name!==_this29.name)&&(!(!isAtStart&&$anchor.parent.textContent.length)&&_this29.editor.commands.clearNodes())},Enter:function Enter(_ref107){var editor=_ref107.editor;if(!_this29.options.exitOnTripleEnter)return!1;var selection=editor.state.selection,$from=selection.$from;if(!selection.empty||$from.parent.type!==_this29.type)return!1;var isAtEnd=$from.parentOffset===$from.parent.nodeSize-2,endsWithDoubleNewline=$from.parent.textContent.endsWith("\n\n");return!(!isAtEnd||!endsWithDoubleNewline)&&editor.chain().command((function(_ref108){return _ref108.tr.delete($from.pos-2,$from.pos),!0})).exitCode().run()},ArrowDown:function ArrowDown(_ref109){var editor=_ref109.editor;if(!_this29.options.exitOnArrowDown)return!1;var state=editor.state,selection=state.selection,doc=state.doc,$from=selection.$from;if(!selection.empty||$from.parent.type!==_this29.type)return!1;if(!($from.parentOffset===$from.parent.nodeSize-2))return!1;var after=$from.after();return void 0!==after&&(!doc.nodeAt(after)&&editor.commands.exitCode())}}},addInputRules:function addInputRules(){return[textblockTypeInputRule({find:backtickInputRegex,type:this.type,getAttributes:function getAttributes(match){return{language:match[1]}}}),textblockTypeInputRule({find:tildeInputRegex,type:this.type,getAttributes:function getAttributes(match){return{language:match[1]}}})]},addProseMirrorPlugins:function addProseMirrorPlugins(){var _this30=this;return[new Plugin({key:new PluginKey("codeBlockVSCodeHandler"),props:{handlePaste:function handlePaste(view,event){if(!event.clipboardData)return!1;if(_this30.editor.isActive(_this30.type.name))return!1;var text=event.clipboardData.getData("text/plain"),vscode=event.clipboardData.getData("vscode-editor-data"),vscodeData=vscode?JSON.parse(vscode):void 0,language=null==vscodeData?void 0:vscodeData.mode;if(!text||!language)return!1;var tr=view.state.tr;return tr.replaceSelectionWith(_this30.type.create({language})),tr.setSelection(TextSelection.near(tr.doc.resolve(Math.max(0,tr.selection.from-2)))),tr.insertText(text.replace(/\r\n?/g,"\n")),tr.setMeta("paste",!0),view.dispatch(tr),!0}}})]}}),Document=Node.create({name:"doc",topNode:!0,content:"block+"});var DropCursorView=function DropCursorView(editorView,options){var this$1=this;this.editorView=editorView,this.width=options.width||1,this.color=options.color||"black",this.class=options.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(name){var handler=function handler(e){return this$1[name](e)};return editorView.dom.addEventListener(name,handler),{name,handler}}))};DropCursorView.prototype.destroy=function destroy(){var this$1=this;this.handlers.forEach((function(ref){var name=ref.name,handler=ref.handler;return this$1.editorView.dom.removeEventListener(name,handler)}))},DropCursorView.prototype.update=function update(editorView,prevState){null!=this.cursorPos&&prevState.doc!=editorView.state.doc&&(this.cursorPos>editorView.state.doc.content.size?this.setCursor(null):this.updateOverlay())},DropCursorView.prototype.setCursor=function setCursor(pos){pos!=this.cursorPos&&(this.cursorPos=pos,null==pos?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},DropCursorView.prototype.updateOverlay=function updateOverlay(){var rect,$pos=this.editorView.state.doc.resolve(this.cursorPos);if(!$pos.parent.inlineContent){var before=$pos.nodeBefore,after=$pos.nodeAfter;if(before||after){var nodeRect=this.editorView.nodeDOM(this.cursorPos-(before?before.nodeSize:0)).getBoundingClientRect(),top=before?nodeRect.bottom:nodeRect.top;before&&after&&(top=(top+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),rect={left:nodeRect.left,right:nodeRect.right,top:top-this.width/2,bottom:top+this.width/2}}}if(!rect){var coords=this.editorView.coordsAtPos(this.cursorPos);rect={left:coords.left-this.width/2,right:coords.left+this.width/2,top:coords.top,bottom:coords.bottom}}var parentLeft,parentTop,parent=this.editorView.dom.offsetParent;if(this.element||(this.element=parent.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!parent||parent==document.body&&"static"==getComputedStyle(parent).position)parentLeft=-pageXOffset,parentTop=-pageYOffset;else{var rect$1=parent.getBoundingClientRect();parentLeft=rect$1.left-parent.scrollLeft,parentTop=rect$1.top-parent.scrollTop}this.element.style.left=rect.left-parentLeft+"px",this.element.style.top=rect.top-parentTop+"px",this.element.style.width=rect.right-rect.left+"px",this.element.style.height=rect.bottom-rect.top+"px"},DropCursorView.prototype.scheduleRemoval=function scheduleRemoval(timeout){var this$1=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return this$1.setCursor(null)}),timeout)},DropCursorView.prototype.dragover=function dragover(event){if(this.editorView.editable){var pos=this.editorView.posAtCoords({left:event.clientX,top:event.clientY}),node=pos&&pos.inside>=0&&this.editorView.state.doc.nodeAt(pos.inside),disableDropCursor=node&&node.type.spec.disableDropCursor,disabled="function"==typeof disableDropCursor?disableDropCursor(this.editorView,pos):disableDropCursor;if(pos&&!disabled){var target=pos.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(target=dropPoint(this.editorView.state.doc,target,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(target),this.scheduleRemoval(5e3)}}},DropCursorView.prototype.dragend=function dragend(){this.scheduleRemoval(20)},DropCursorView.prototype.drop=function drop(){this.scheduleRemoval(20)},DropCursorView.prototype.dragleave=function dragleave(event){event.target!=this.editorView.dom&&this.editorView.dom.contains(event.relatedTarget)||this.setCursor(null)};var Dropcursor=Extension.create({name:"dropCursor",addOptions:function addOptions(){return{color:"currentColor",width:1,class:null}},addProseMirrorPlugins:function addProseMirrorPlugins(){return[(options=this.options,void 0===options&&(options={}),new Plugin({view:function view(editorView){return new DropCursorView(editorView,options)}}))];var options}}),GapCursor=function(Selection){function GapCursor($pos){Selection.call(this,$pos,$pos)}return Selection&&(GapCursor.__proto__=Selection),GapCursor.prototype=Object.create(Selection&&Selection.prototype),GapCursor.prototype.constructor=GapCursor,GapCursor.prototype.map=function map(doc,mapping){var $pos=doc.resolve(mapping.map(this.head));return GapCursor.valid($pos)?new GapCursor($pos):Selection.near($pos)},GapCursor.prototype.content=function content(){return Slice.empty},GapCursor.prototype.eq=function eq(other){return other instanceof GapCursor&&other.head==this.head},GapCursor.prototype.toJSON=function toJSON(){return{type:"gapcursor",pos:this.head}},GapCursor.fromJSON=function fromJSON(doc,json){if("number"!=typeof json.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new GapCursor(doc.resolve(json.pos))},GapCursor.prototype.getBookmark=function getBookmark(){return new GapBookmark(this.anchor)},GapCursor.valid=function valid($pos){var parent=$pos.parent;if(parent.isTextblock||!function closedBefore($pos){for(var d=$pos.depth;d>=0;d--){var index=$pos.index(d),parent=$pos.node(d);if(0!=index)for(var before=parent.child(index-1);;before=before.lastChild){if(0==before.childCount&&!before.inlineContent||before.isAtom||before.type.spec.isolating)return!0;if(before.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos)||!function closedAfter($pos){for(var d=$pos.depth;d>=0;d--){var index=$pos.indexAfter(d),parent=$pos.node(d);if(index!=parent.childCount)for(var after=parent.child(index);;after=after.firstChild){if(0==after.childCount&&!after.inlineContent||after.isAtom||after.type.spec.isolating)return!0;if(after.inlineContent)return!1}else if(parent.type.spec.isolating)return!0}return!0}($pos))return!1;var override=parent.type.spec.allowGapCursor;if(null!=override)return override;var deflt=parent.contentMatchAt($pos.index()).defaultType;return deflt&&deflt.isTextblock},GapCursor.findFrom=function findFrom($pos,dir,mustMove){search:for(;;){if(!mustMove&&GapCursor.valid($pos))return $pos;for(var pos=$pos.pos,next=null,d=$pos.depth;;d--){var parent=$pos.node(d);if(dir>0?$pos.indexAfter(d)<parent.childCount:$pos.index(d)>0){next=parent.child(dir>0?$pos.indexAfter(d):$pos.index(d)-1);break}if(0==d)return null;pos+=dir;var $cur=$pos.doc.resolve(pos);if(GapCursor.valid($cur))return $cur}for(;;){var inside=dir>0?next.firstChild:next.lastChild;if(!inside){if(next.isAtom&&!next.isText&&!NodeSelection.isSelectable(next)){$pos=$pos.doc.resolve(pos+next.nodeSize*dir),mustMove=!1;continue search}break}next=inside,pos+=dir;var $cur$1=$pos.doc.resolve(pos);if(GapCursor.valid($cur$1))return $cur$1}return null}},GapCursor}(Selection);GapCursor.prototype.visible=!1,Selection.jsonID("gapcursor",GapCursor);var GapBookmark=function GapBookmark(pos){this.pos=pos};GapBookmark.prototype.map=function map(mapping){return new GapBookmark(mapping.map(this.pos))},GapBookmark.prototype.resolve=function resolve(doc){var $pos=doc.resolve(this.pos);return GapCursor.valid($pos)?new GapCursor($pos):Selection.near($pos)};var gapCursor=function gapCursor(){return new Plugin({props:{decorations:drawGapCursor,createSelectionBetween:function createSelectionBetween(_view,$anchor,$head){if($anchor.pos==$head.pos&&GapCursor.valid($head))return new GapCursor($head)},handleClick,handleKeyDown}})},handleKeyDown=keydownHandler({ArrowLeft:arrow("horiz",-1),ArrowRight:arrow("horiz",1),ArrowUp:arrow("vert",-1),ArrowDown:arrow("vert",1)});function arrow(axis,dir){var dirStr="vert"==axis?dir>0?"down":"up":dir>0?"right":"left";return function(state,dispatch,view){var sel=state.selection,$start=dir>0?sel.$to:sel.$from,mustMove=sel.empty;if(sel instanceof TextSelection){if(!view.endOfTextblock(dirStr)||0==$start.depth)return!1;mustMove=!1,$start=state.doc.resolve(dir>0?$start.after():$start.before())}var $found=GapCursor.findFrom($start,dir,mustMove);return!!$found&&(dispatch&&dispatch(state.tr.setSelection(new GapCursor($found))),!0)}}function handleClick(view,pos,event){if(!view.editable)return!1;var $pos=view.state.doc.resolve(pos);if(!GapCursor.valid($pos))return!1;var inside=view.posAtCoords({left:event.clientX,top:event.clientY}).inside;return!(inside>-1&&NodeSelection.isSelectable(view.state.doc.nodeAt(inside)))&&(view.dispatch(view.state.tr.setSelection(new GapCursor($pos))),!0)}function drawGapCursor(state){if(!(state.selection instanceof GapCursor))return null;var node=document.createElement("div");return node.className="ProseMirror-gapcursor",DecorationSet.create(state.doc,[Decoration.widget(state.selection.head,node,{key:"gapcursor"})])}var Gapcursor=Extension.create({name:"gapCursor",addProseMirrorPlugins:function addProseMirrorPlugins(){return[gapCursor()]},extendNodeSchema:function extendNodeSchema(extension){var _a;return{allowGapCursor:null!==(_a=callOrReturn(getExtensionField(extension,"allowGapCursor",{name:extension.name,options:extension.options,storage:extension.storage})))&&void 0!==_a?_a:null}}}),HardBreak=Node.create({name:"hardBreak",addOptions:function addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML:function parseHTML(){return[{tag:"br"}]},renderHTML:function renderHTML(_ref110){var HTMLAttributes=_ref110.HTMLAttributes;return["br",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes)]},renderText:function renderText(){return"\n"},addCommands:function addCommands(){var _this31=this;return{setHardBreak:function setHardBreak(){return function(_ref111){var commands=_ref111.commands,chain=_ref111.chain,state=_ref111.state,editor=_ref111.editor;return commands.first([function(){return commands.exitCode()},function(){return commands.command((function(){var selection=state.selection,storedMarks=state.storedMarks;if(selection.$from.parent.type.spec.isolating)return!1;var keepMarks=_this31.options.keepMarks,splittableMarks=editor.extensionManager.splittableMarks,marks=storedMarks||selection.$to.parentOffset&&selection.$from.marks();return chain().insertContent({type:_this31.name}).command((function(_ref112){var tr=_ref112.tr;if(_ref112.dispatch&&marks&&keepMarks){var filteredMarks=marks.filter((function(mark){return splittableMarks.includes(mark.type.name)}));tr.ensureMarks(filteredMarks)}return!0})).run()}))}])}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this32=this;return{"Mod-Enter":function ModEnter(){return _this32.editor.commands.setHardBreak()},"Shift-Enter":function ShiftEnter(){return _this32.editor.commands.setHardBreak()}}}}),Heading=Node.create({name:"heading",addOptions:function addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes:function addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML:function parseHTML(){return this.options.levels.map((function(level){return{tag:"h"+level,attrs:{level}}}))},renderHTML:function renderHTML(_ref113){var node=_ref113.node,HTMLAttributes=_ref113.HTMLAttributes;return["h"+(this.options.levels.includes(node.attrs.level)?node.attrs.level:this.options.levels[0]),mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this33=this;return{setHeading:function setHeading(attributes){return function(_ref114){var commands=_ref114.commands;return!!_this33.options.levels.includes(attributes.level)&&commands.setNode(_this33.name,attributes)}},toggleHeading:function toggleHeading(attributes){return function(_ref115){var commands=_ref115.commands;return!!_this33.options.levels.includes(attributes.level)&&commands.toggleNode(_this33.name,"paragraph",attributes)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this34=this;return this.options.levels.reduce((function(items,level){var _Object$assign4;return Object.assign({},items,((_Object$assign4={})["Mod-Alt-"+level]=function ModAlt(){return _this34.editor.commands.toggleHeading({level})},_Object$assign4))}),{})},addInputRules:function addInputRules(){var _this35=this;return this.options.levels.map((function(level){return textblockTypeInputRule({find:new RegExp("^(#{1,"+level+"})\\s$"),type:_this35.type,getAttributes:{level}})}))}}),RopeSequence=function RopeSequence(){};RopeSequence.prototype.append=function append(other){return other.length?(other=RopeSequence.from(other),!this.length&&other||other.length<200&&this.leafAppend(other)||this.length<200&&other.leafPrepend(this)||this.appendInner(other)):this},RopeSequence.prototype.prepend=function prepend(other){return other.length?RopeSequence.from(other).append(this):this},RopeSequence.prototype.appendInner=function appendInner(other){return new Append(this,other)},RopeSequence.prototype.slice=function slice(from,to){return void 0===from&&(from=0),void 0===to&&(to=this.length),from>=to?RopeSequence.empty:this.sliceInner(Math.max(0,from),Math.min(this.length,to))},RopeSequence.prototype.get=function get(i){if(!(i<0||i>=this.length))return this.getInner(i)},RopeSequence.prototype.forEach=function forEach(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length),from<=to?this.forEachInner(f,from,to,0):this.forEachInvertedInner(f,from,to,0)},RopeSequence.prototype.map=function map(f,from,to){void 0===from&&(from=0),void 0===to&&(to=this.length);var result=[];return this.forEach((function(elt,i){return result.push(f(elt,i))}),from,to),result},RopeSequence.from=function from(values){return values instanceof RopeSequence?values:values&&values.length?new Leaf(values):RopeSequence.empty};var Leaf=function(RopeSequence){function Leaf(values){RopeSequence.call(this),this.values=values}RopeSequence&&(Leaf.__proto__=RopeSequence),Leaf.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Leaf.prototype.constructor=Leaf;var prototypeAccessors={length:{configurable:!0},depth:{configurable:!0}};return Leaf.prototype.flatten=function flatten(){return this.values},Leaf.prototype.sliceInner=function sliceInner(from,to){return 0==from&&to==this.length?this:new Leaf(this.values.slice(from,to))},Leaf.prototype.getInner=function getInner(i){return this.values[i]},Leaf.prototype.forEachInner=function forEachInner(f,from,to,start){for(var i=from;i<to;i++)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){for(var i=from-1;i>=to;i--)if(!1===f(this.values[i],start+i))return!1},Leaf.prototype.leafAppend=function leafAppend(other){if(this.length+other.length<=200)return new Leaf(this.values.concat(other.flatten()))},Leaf.prototype.leafPrepend=function leafPrepend(other){if(this.length+other.length<=200)return new Leaf(other.flatten().concat(this.values))},prototypeAccessors.length.get=function(){return this.values.length},prototypeAccessors.depth.get=function(){return 0},Object.defineProperties(Leaf.prototype,prototypeAccessors),Leaf}(RopeSequence);RopeSequence.empty=new Leaf([]);var Append=function(RopeSequence){function Append(left,right){RopeSequence.call(this),this.left=left,this.right=right,this.length=left.length+right.length,this.depth=Math.max(left.depth,right.depth)+1}return RopeSequence&&(Append.__proto__=RopeSequence),Append.prototype=Object.create(RopeSequence&&RopeSequence.prototype),Append.prototype.constructor=Append,Append.prototype.flatten=function flatten(){return this.left.flatten().concat(this.right.flatten())},Append.prototype.getInner=function getInner(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},Append.prototype.forEachInner=function forEachInner(f,from,to,start){var leftLen=this.left.length;return!(from<leftLen&&!1===this.left.forEachInner(f,from,Math.min(to,leftLen),start))&&(!(to>leftLen&&!1===this.right.forEachInner(f,Math.max(from-leftLen,0),Math.min(this.length,to)-leftLen,start+leftLen))&&void 0)},Append.prototype.forEachInvertedInner=function forEachInvertedInner(f,from,to,start){var leftLen=this.left.length;return!(from>leftLen&&!1===this.right.forEachInvertedInner(f,from-leftLen,Math.max(to,leftLen)-leftLen,start+leftLen))&&(!(to<leftLen&&!1===this.left.forEachInvertedInner(f,Math.min(from,leftLen),to,start))&&void 0)},Append.prototype.sliceInner=function sliceInner(from,to){if(0==from&&to==this.length)return this;var leftLen=this.left.length;return to<=leftLen?this.left.slice(from,to):from>=leftLen?this.right.slice(from-leftLen,to-leftLen):this.left.slice(from,leftLen).append(this.right.slice(0,to-leftLen))},Append.prototype.leafAppend=function leafAppend(other){var inner=this.right.leafAppend(other);if(inner)return new Append(this.left,inner)},Append.prototype.leafPrepend=function leafPrepend(other){var inner=this.left.leafPrepend(other);if(inner)return new Append(inner,this.right)},Append.prototype.appendInner=function appendInner(other){return this.left.depth>=Math.max(this.right.depth,other.depth)+1?new Append(this.left,new Append(this.right,other)):new Append(this,other)},Append}(RopeSequence),ropeSequence=RopeSequence,Branch=function Branch(items,eventCount){this.items=items,this.eventCount=eventCount};Branch.prototype.popEvent=function popEvent(state,preserveItems){var this$1=this;if(0==this.eventCount)return null;for(var remap,mapFrom,end=this.items.length;;end--){if(this.items.get(end-1).selection){--end;break}}preserveItems&&(remap=this.remapping(end,this.items.length),mapFrom=remap.maps.length);var selection,remaining,transform=state.tr,addAfter=[],addBefore=[];return this.items.forEach((function(item,i){if(!item.step)return remap||(remap=this$1.remapping(end,i+1),mapFrom=remap.maps.length),mapFrom--,void addBefore.push(item);if(remap){addBefore.push(new Item(item.map));var map,step=item.step.map(remap.slice(mapFrom));step&&transform.maybeStep(step).doc&&(map=transform.mapping.maps[transform.mapping.maps.length-1],addAfter.push(new Item(map,null,null,addAfter.length+addBefore.length))),mapFrom--,map&&remap.appendMap(map,mapFrom)}else transform.maybeStep(item.step);return item.selection?(selection=remap?item.selection.map(remap.slice(mapFrom)):item.selection,remaining=new Branch(this$1.items.slice(0,end).append(addBefore.reverse().concat(addAfter)),this$1.eventCount-1),!1):void 0}),this.items.length,0),{remaining,transform,selection}},Branch.prototype.addTransform=function addTransform(transform,selection,histOptions,preserveItems){for(var newItems=[],eventCount=this.eventCount,oldItems=this.items,lastItem=!preserveItems&&oldItems.length?oldItems.get(oldItems.length-1):null,i=0;i<transform.steps.length;i++){var merged,step=transform.steps[i].invert(transform.docs[i]),item=new Item(transform.mapping.maps[i],step,selection);(merged=lastItem&&lastItem.merge(item))&&(item=merged,i?newItems.pop():oldItems=oldItems.slice(0,oldItems.length-1)),newItems.push(item),selection&&(eventCount++,selection=null),preserveItems||(lastItem=item)}var overflow=eventCount-histOptions.depth;return overflow>DEPTH_OVERFLOW&&(oldItems=function cutOffEvents(items,n){var cutPoint;return items.forEach((function(item,i){if(item.selection&&0==n--)return cutPoint=i,!1})),items.slice(cutPoint)}(oldItems,overflow),eventCount-=overflow),new Branch(oldItems.append(newItems),eventCount)},Branch.prototype.remapping=function remapping(from,to){var maps=new Mapping;return this.items.forEach((function(item,i){var mirrorPos=null!=item.mirrorOffset&&i-item.mirrorOffset>=from?maps.maps.length-item.mirrorOffset:null;maps.appendMap(item.map,mirrorPos)}),from,to),maps},Branch.prototype.addMaps=function addMaps(array){return 0==this.eventCount?this:new Branch(this.items.append(array.map((function(map){return new Item(map)}))),this.eventCount)},Branch.prototype.rebased=function rebased(rebasedTransform,rebasedCount){if(!this.eventCount)return this;var rebasedItems=[],start=Math.max(0,this.items.length-rebasedCount),mapping=rebasedTransform.mapping,newUntil=rebasedTransform.steps.length,eventCount=this.eventCount;this.items.forEach((function(item){item.selection&&eventCount--}),start);var iRebased=rebasedCount;this.items.forEach((function(item){var pos=mapping.getMirror(--iRebased);if(null!=pos){newUntil=Math.min(newUntil,pos);var map=mapping.maps[pos];if(item.step){var step=rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos]),selection=item.selection&&item.selection.map(mapping.slice(iRebased+1,pos));selection&&eventCount++,rebasedItems.push(new Item(map,step,selection))}else rebasedItems.push(new Item(map))}}),start);for(var newMaps=[],i=rebasedCount;i<newUntil;i++)newMaps.push(new Item(mapping.maps[i]));var items=this.items.slice(0,start).append(newMaps).append(rebasedItems),branch=new Branch(items,eventCount);return branch.emptyItemCount()>500&&(branch=branch.compress(this.items.length-rebasedItems.length)),branch},Branch.prototype.emptyItemCount=function emptyItemCount(){var count=0;return this.items.forEach((function(item){item.step||count++})),count},Branch.prototype.compress=function compress(upto){void 0===upto&&(upto=this.items.length);var remap=this.remapping(0,upto),mapFrom=remap.maps.length,items=[],events=0;return this.items.forEach((function(item,i){if(i>=upto)items.push(item),item.selection&&events++;else if(item.step){var step=item.step.map(remap.slice(mapFrom)),map=step&&step.getMap();if(mapFrom--,map&&remap.appendMap(map,mapFrom),step){var selection=item.selection&&item.selection.map(remap.slice(mapFrom));selection&&events++;var merged,newItem=new Item(map.invert(),step,selection),last=items.length-1;(merged=items.length&&items[last].merge(newItem))?items[last]=merged:items.push(newItem)}}else item.map&&mapFrom--}),this.items.length,0),new Branch(ropeSequence.from(items.reverse()),events)},Branch.empty=new Branch(ropeSequence.empty,0);var Item=function Item(map,step,selection,mirrorOffset){this.map=map,this.step=step,this.selection=selection,this.mirrorOffset=mirrorOffset};Item.prototype.merge=function merge(other){if(this.step&&other.step&&!other.selection){var step=other.step.merge(this.step);if(step)return new Item(step.getMap().invert(),step,this.selection)}};var HistoryState=function HistoryState(done,undone,prevRanges,prevTime){this.done=done,this.undone=undone,this.prevRanges=prevRanges,this.prevTime=prevTime},DEPTH_OVERFLOW=20;function rangesFor(map){var result=[];return map.forEach((function(_from,_to,from,to){return result.push(from,to)})),result}function mapRanges(ranges,mapping){if(!ranges)return null;for(var result=[],i=0;i<ranges.length;i+=2){var from=mapping.map(ranges[i],1),to=mapping.map(ranges[i+1],-1);from<=to&&result.push(from,to)}return result}function histTransaction(history,state,dispatch,redo){var preserveItems=mustPreserveItems(state),histOptions=historyKey.get(state).spec.config,pop=(redo?history.undone:history.done).popEvent(state,preserveItems);if(pop){var selection=pop.selection.resolve(pop.transform.doc),added=(redo?history.done:history.undone).addTransform(pop.transform,state.selection.getBookmark(),histOptions,preserveItems),newHist=new HistoryState(redo?added:pop.remaining,redo?pop.remaining:added,null,0);dispatch(pop.transform.setSelection(selection).setMeta(historyKey,{redo,historyState:newHist}).scrollIntoView())}}var cachedPreserveItems=!1,cachedPreserveItemsPlugins=null;function mustPreserveItems(state){var plugins=state.plugins;if(cachedPreserveItemsPlugins!=plugins){cachedPreserveItems=!1,cachedPreserveItemsPlugins=plugins;for(var i=0;i<plugins.length;i++)if(plugins[i].spec.historyPreserveItems){cachedPreserveItems=!0;break}}return cachedPreserveItems}var historyKey=new PluginKey("history"),closeHistoryKey=new PluginKey("closeHistory");function history(config){return config={depth:config&&config.depth||100,newGroupDelay:config&&config.newGroupDelay||500},new Plugin({key:historyKey,state:{init:function init(){return new HistoryState(Branch.empty,Branch.empty,null,0)},apply:function apply(tr,hist,state){return function applyTransaction(history,state,tr,options){var rebased,historyTr=tr.getMeta(historyKey);if(historyTr)return historyTr.historyState;tr.getMeta(closeHistoryKey)&&(history=new HistoryState(history.done,history.undone,null,0));var appended=tr.getMeta("appendedTransaction");if(0==tr.steps.length)return history;if(appended&&appended.getMeta(historyKey))return appended.getMeta(historyKey).redo?new HistoryState(history.done.addTransform(tr,null,options,mustPreserveItems(state)),history.undone,rangesFor(tr.mapping.maps[tr.steps.length-1]),history.prevTime):new HistoryState(history.done,history.undone.addTransform(tr,null,options,mustPreserveItems(state)),null,history.prevTime);if(!1===tr.getMeta("addToHistory")||appended&&!1===appended.getMeta("addToHistory"))return(rebased=tr.getMeta("rebased"))?new HistoryState(history.done.rebased(tr,rebased),history.undone.rebased(tr,rebased),mapRanges(history.prevRanges,tr.mapping),history.prevTime):new HistoryState(history.done.addMaps(tr.mapping.maps),history.undone.addMaps(tr.mapping.maps),mapRanges(history.prevRanges,tr.mapping),history.prevTime);var newGroup=0==history.prevTime||!appended&&(history.prevTime<(tr.time||0)-options.newGroupDelay||!function isAdjacentTo(transform,prevRanges){if(!prevRanges)return!1;if(!transform.docChanged)return!0;var adjacent=!1;return transform.mapping.maps[0].forEach((function(start,end){for(var i=0;i<prevRanges.length;i+=2)start<=prevRanges[i+1]&&end>=prevRanges[i]&&(adjacent=!0)})),adjacent}(tr,history.prevRanges)),prevRanges=appended?mapRanges(history.prevRanges,tr.mapping):rangesFor(tr.mapping.maps[tr.steps.length-1]);return new HistoryState(history.done.addTransform(tr,newGroup?state.selection.getBookmark():null,options,mustPreserveItems(state)),Branch.empty,prevRanges,tr.time)}(hist,state,tr,config)}},config,props:{handleDOMEvents:{beforeinput:function beforeinput(view,e){var handled="historyUndo"==e.inputType?_undo(view.state,view.dispatch):"historyRedo"==e.inputType&&_redo(view.state,view.dispatch);return handled&&e.preventDefault(),handled}}}})}function _undo(state,dispatch){var hist=historyKey.getState(state);return!(!hist||0==hist.done.eventCount)&&(dispatch&&histTransaction(hist,state,dispatch,!1),!0)}function _redo(state,dispatch){var hist=historyKey.getState(state);return!(!hist||0==hist.undone.eventCount)&&(dispatch&&histTransaction(hist,state,dispatch,!0),!0)}var ViewMode,History=Extension.create({name:"history",addOptions:function addOptions(){return{depth:100,newGroupDelay:500}},addCommands:function addCommands(){return{undo:function undo(){return function(_ref116){return _undo(_ref116.state,_ref116.dispatch)}},redo:function redo(){return function(_ref117){return _redo(_ref117.state,_ref117.dispatch)}}}},addProseMirrorPlugins:function addProseMirrorPlugins(){return[history(this.options)]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this36=this;return{"Mod-z":function ModZ(){return _this36.editor.commands.undo()},"Mod-y":function ModY(){return _this36.editor.commands.redo()},"Shift-Mod-z":function ShiftModZ(){return _this36.editor.commands.redo()},"Mod-":function Mod(){return _this36.editor.commands.undo()},"Shift-Mod-":function ShiftMod(){return _this36.editor.commands.redo()}}}}),HorizontalRule=Node.create({name:"horizontalRule",addOptions:function addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML:function parseHTML(){return[{tag:"hr"}]},renderHTML:function renderHTML(_ref118){var HTMLAttributes=_ref118.HTMLAttributes;return["hr",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes)]},addCommands:function addCommands(){var _this37=this;return{setHorizontalRule:function setHorizontalRule(){return function(_ref119){return(0,_ref119.chain)().insertContent({type:_this37.name}).command((function(_ref120){var _a,tr=_ref120.tr;if(_ref120.dispatch){var _tr$selection$$from=tr.selection.$from,parent=_tr$selection$$from.parent,posAfter=_tr$selection$$from.pos+1;if(tr.doc.nodeAt(posAfter))tr.setSelection(TextSelection.create(tr.doc,posAfter));else{var node=null===(_a=parent.type.contentMatch.defaultType)||void 0===_a?void 0:_a.create();node&&(tr.insert(posAfter,node),tr.setSelection(TextSelection.create(tr.doc,posAfter)))}tr.scrollIntoView()}return!0})).run()}}}},addInputRules:function addInputRules(){return[nodeInputRule({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),starInputRegex=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,starPasteRegex=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,underscoreInputRegex=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,underscorePasteRegex=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Italic=Mark.create({name:"italic",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:function getAttrs(node){return"normal"!==node.style.fontStyle&&null}},{style:"font-style=italic"}]},renderHTML:function renderHTML(_ref121){var HTMLAttributes=_ref121.HTMLAttributes;return["em",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this38=this;return{setItalic:function setItalic(){return function(_ref122){return _ref122.commands.setMark(_this38.name)}},toggleItalic:function toggleItalic(){return function(_ref123){return _ref123.commands.toggleMark(_this38.name)}},unsetItalic:function unsetItalic(){return function(_ref124){return _ref124.commands.unsetMark(_this38.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this39=this;return{"Mod-i":function ModI(){return _this39.editor.commands.toggleItalic()}}},addInputRules:function addInputRules(){return[markInputRule({find:starInputRegex,type:this.type}),markInputRule({find:underscoreInputRegex,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:starPasteRegex,type:this.type}),markPasteRule({find:underscorePasteRegex,type:this.type})]}}),ListItem=Node.create({name:"listItem",addOptions:function addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML:function parseHTML(){return[{tag:"li"}]},renderHTML:function renderHTML(_ref125){var HTMLAttributes=_ref125.HTMLAttributes;return["li",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this40=this;return{Enter:function Enter(){return _this40.editor.commands.splitListItem(_this40.name)},Tab:function Tab(){return _this40.editor.commands.sinkListItem(_this40.name)},"Shift-Tab":function ShiftTab(){return _this40.editor.commands.liftListItem(_this40.name)}}}}),inputRegex$2=/^(\d+)\.\s$/,OrderedList=Node.create({name:"orderedList",addOptions:function addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content:function content(){return this.options.itemTypeName+"+"},addAttributes:function addAttributes(){return{start:{default:1,parseHTML:function parseHTML(element){return element.hasAttribute("start")?parseInt(element.getAttribute("start")||"",10):1}}}},parseHTML:function parseHTML(){return[{tag:"ol"}]},renderHTML:function renderHTML(_ref126){var HTMLAttributes=_ref126.HTMLAttributes,start=HTMLAttributes.start,attributesWithoutStart=_objectWithoutProperties(HTMLAttributes,["start"]);return 1===start?["ol",mergeAttributes(this.options.HTMLAttributes,attributesWithoutStart),0]:["ol",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this41=this;return{toggleOrderedList:function toggleOrderedList(){return function(_ref127){return _ref127.commands.toggleList(_this41.name,_this41.options.itemTypeName)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this42=this;return{"Mod-Shift-7":function ModShift7(){return _this42.editor.commands.toggleOrderedList()}}},addInputRules:function addInputRules(){return[wrappingInputRule({find:inputRegex$2,type:this.type,getAttributes:function getAttributes(match){return{start:+match[1]}},joinPredicate:function joinPredicate(match,node){return node.childCount+node.attrs.start===+match[1]}})]}}),Paragraph=Node.create({name:"paragraph",priority:1e3,addOptions:function addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML:function parseHTML(){return[{tag:"p"}]},renderHTML:function renderHTML(_ref128){var HTMLAttributes=_ref128.HTMLAttributes;return["p",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this43=this;return{setParagraph:function setParagraph(){return function(_ref129){return _ref129.commands.setNode(_this43.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this44=this;return{"Mod-Alt-0":function ModAlt0(){return _this44.editor.commands.setParagraph()}}}}),inputRegex$1=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,pasteRegex=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Strike=Mark.create({name:"strike",addOptions:function addOptions(){return{HTMLAttributes:{}}},parseHTML:function parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:function getAttrs(style){return!!style.includes("line-through")&&{}}}]},renderHTML:function renderHTML(_ref130){var HTMLAttributes=_ref130.HTMLAttributes;return["s",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this45=this;return{setStrike:function setStrike(){return function(_ref131){return _ref131.commands.setMark(_this45.name)}},toggleStrike:function toggleStrike(){return function(_ref132){return _ref132.commands.toggleMark(_this45.name)}},unsetStrike:function unsetStrike(){return function(_ref133){return _ref133.commands.unsetMark(_this45.name)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this46=this;return{"Mod-Shift-x":function ModShiftX(){return _this46.editor.commands.toggleStrike()}}},addInputRules:function addInputRules(){return[markInputRule({find:inputRegex$1,type:this.type})]},addPasteRules:function addPasteRules(){return[markPasteRule({find:pasteRegex,type:this.type})]}}),Text$2=Node.create({name:"text",group:"inline"}),StarterKit=Extension.create({name:"starterKit",addExtensions:function addExtensions(){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,extensions=[];return!1!==this.options.blockquote&&extensions.push(Blockquote.configure(null===(_a=this.options)||void 0===_a?void 0:_a.blockquote)),!1!==this.options.bold&&extensions.push(Bold.configure(null===(_b=this.options)||void 0===_b?void 0:_b.bold)),!1!==this.options.bulletList&&extensions.push(BulletList$1.configure(null===(_c=this.options)||void 0===_c?void 0:_c.bulletList)),!1!==this.options.code&&extensions.push(Code.configure(null===(_d=this.options)||void 0===_d?void 0:_d.code)),!1!==this.options.codeBlock&&extensions.push(CodeBlock.configure(null===(_e=this.options)||void 0===_e?void 0:_e.codeBlock)),!1!==this.options.document&&extensions.push(Document.configure(null===(_f=this.options)||void 0===_f?void 0:_f.document)),!1!==this.options.dropcursor&&extensions.push(Dropcursor.configure(null===(_g=this.options)||void 0===_g?void 0:_g.dropcursor)),!1!==this.options.gapcursor&&extensions.push(Gapcursor.configure(null===(_h=this.options)||void 0===_h?void 0:_h.gapcursor)),!1!==this.options.hardBreak&&extensions.push(HardBreak.configure(null===(_j=this.options)||void 0===_j?void 0:_j.hardBreak)),!1!==this.options.heading&&extensions.push(Heading.configure(null===(_k=this.options)||void 0===_k?void 0:_k.heading)),!1!==this.options.history&&extensions.push(History.configure(null===(_l=this.options)||void 0===_l?void 0:_l.history)),!1!==this.options.horizontalRule&&extensions.push(HorizontalRule.configure(null===(_m=this.options)||void 0===_m?void 0:_m.horizontalRule)),!1!==this.options.italic&&extensions.push(Italic.configure(null===(_o=this.options)||void 0===_o?void 0:_o.italic)),!1!==this.options.listItem&&extensions.push(ListItem.configure(null===(_p=this.options)||void 0===_p?void 0:_p.listItem)),!1!==this.options.orderedList&&extensions.push(OrderedList.configure(null===(_q=this.options)||void 0===_q?void 0:_q.orderedList)),!1!==this.options.paragraph&&extensions.push(Paragraph.configure(null===(_r=this.options)||void 0===_r?void 0:_r.paragraph)),!1!==this.options.strike&&extensions.push(Strike.configure(null===(_s=this.options)||void 0===_s?void 0:_s.strike)),!1!==this.options.text&&extensions.push(Text$2.configure(null===(_t=this.options)||void 0===_t?void 0:_t.text)),extensions}}),inputRegex=/^\s*(\[([( |x])?\])\s$/,TaskItem$1=Node.create({name:"taskItem",addOptions:function addOptions(){return{nested:!1,HTMLAttributes:{}}},content:function content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes:function addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:function parseHTML(element){return"true"===element.getAttribute("data-checked")},renderHTML:function renderHTML(attributes){return{"data-checked":attributes.checked}}}}},parseHTML:function parseHTML(){return[{tag:'li[data-type="'+this.name+'"]',priority:51}]},renderHTML:function renderHTML(_ref134){var node=_ref134.node,HTMLAttributes=_ref134.HTMLAttributes;return["li",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:node.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this47=this,shortcuts={Enter:function Enter(){return _this47.editor.commands.splitListItem(_this47.name)},"Shift-Tab":function ShiftTab(){return _this47.editor.commands.liftListItem(_this47.name)}};return this.options.nested?Object.assign({},shortcuts,{Tab:function Tab(){return _this47.editor.commands.sinkListItem(_this47.name)}}):shortcuts},addNodeView:function addNodeView(){var _this48=this;return function(_ref135){var node=_ref135.node,HTMLAttributes=_ref135.HTMLAttributes,getPos=_ref135.getPos,editor=_ref135.editor,listItem=document.createElement("li"),checkboxWrapper=document.createElement("label"),checkboxStyler=document.createElement("span"),checkbox=document.createElement("input"),content=document.createElement("div");return checkboxWrapper.contentEditable="false",checkbox.type="checkbox",checkbox.addEventListener("change",(function(event){if(editor.isEditable||_this48.options.onReadOnlyChecked){var checked=event.target.checked;editor.isEditable&&"function"==typeof getPos&&editor.chain().focus(void 0,{scrollIntoView:!1}).command((function(_ref136){var tr=_ref136.tr,position=getPos(),currentNode=tr.doc.nodeAt(position);return tr.setNodeMarkup(position,void 0,Object.assign({},null==currentNode?void 0:currentNode.attrs,{checked})),!0})).run(),!editor.isEditable&&_this48.options.onReadOnlyChecked&&(_this48.options.onReadOnlyChecked(node,checked)||(checkbox.checked=!checkbox.checked))}else checkbox.checked=!checkbox.checked})),Object.entries(_this48.options.HTMLAttributes).forEach((function(_ref137){var _ref138=_slicedToArray(_ref137,2),key=_ref138[0],value=_ref138[1];listItem.setAttribute(key,value)})),listItem.dataset.checked=node.attrs.checked,node.attrs.checked&&checkbox.setAttribute("checked","checked"),checkboxWrapper.append(checkbox,checkboxStyler),listItem.append(checkboxWrapper,content),Object.entries(HTMLAttributes).forEach((function(_ref139){var _ref140=_slicedToArray(_ref139,2),key=_ref140[0],value=_ref140[1];listItem.setAttribute(key,value)})),{dom:listItem,contentDOM:content,update:function update(updatedNode){return updatedNode.type===_this48.type&&(listItem.dataset.checked=updatedNode.attrs.checked,updatedNode.attrs.checked?checkbox.setAttribute("checked","checked"):checkbox.removeAttribute("checked"),!0)}}}},addInputRules:function addInputRules(){return[wrappingInputRule({find:inputRegex,type:this.type,getAttributes:function getAttributes(match){return{checked:"x"===match[match.length-1]}}})]}}),customInputRegex$1=/^\s*([-+*]\s\[([( |x])?])\s$/,TaskItem=TaskItem$1.extend({addOptions:function addOptions(){var _a;return Object.assign(Object.assign({},null===(_a=this.parent)||void 0===_a?void 0:_a.call(this)),{nested:!0})},addAttributes:function addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:function parseHTML(element){var checkbox=element.querySelector("input[type=checkbox].task-list-item-checkbox");return null==checkbox?void 0:checkbox.checked},renderHTML:function renderHTML(attributes){return{"data-checked":attributes.checked}}}}},addNodeView:function addNodeView(){var _this49=this;return function(_ref141){var node=_ref141.node,HTMLAttributes=_ref141.HTMLAttributes,getPos=_ref141.getPos,editor=_ref141.editor,listItem=document.createElement("li"),checkboxWrapper=document.createElement("label"),checkboxStyler=document.createElement("span"),checkbox=document.createElement("input"),content=document.createElement("div");return checkboxWrapper.contentEditable="false",checkbox.type="checkbox",checkbox.addEventListener("change",(function(event){if(editor.isEditable||_this49.options.onReadOnlyChecked){var checked=event.target.checked;editor.isEditable&&"function"==typeof getPos&&editor.chain().focus(void 0,{scrollIntoView:!1}).command((function(_ref142){var tr=_ref142.tr,position=getPos(),currentNode=tr.doc.nodeAt(position);return tr.setNodeMarkup(position,void 0,Object.assign(Object.assign({},null==currentNode?void 0:currentNode.attrs),{checked})),!0})).run(),!editor.isEditable&&_this49.options.onReadOnlyChecked&&(_this49.options.onReadOnlyChecked(node,checked)||(checkbox.checked=!checkbox.checked))}else checkbox.checked=!checkbox.checked})),Object.entries(_this49.options.HTMLAttributes).forEach((function(_ref143){var _ref144=_slicedToArray(_ref143,2),key=_ref144[0],value=_ref144[1];listItem.setAttribute(key,value)})),listItem.dataset.checked=node.attrs.checked,node.attrs.checked&&checkbox.setAttribute("checked","checked"),checkboxWrapper.append(checkbox,checkboxStyler),listItem.append(checkboxWrapper,content),Object.entries(HTMLAttributes).forEach((function(_ref145){var _ref146=_slicedToArray(_ref145,2),key=_ref146[0],value=_ref146[1];listItem.setAttribute(key,value)})),{dom:listItem,contentDOM:content,update:function update(updatedNode){return updatedNode.type===_this49.type&&(listItem.dataset.checked=updatedNode.attrs.checked,updatedNode.attrs.checked?checkbox.setAttribute("checked","checked"):checkbox.removeAttribute("checked"),!0)},ignoreMutation:function ignoreMutation(mr){return"data-checked"!==mr.attributeName}}}},parseHTML:function parseHTML(){var _a;return[].concat(_toConsumableArray(null===(_a=this.parent)||void 0===_a?void 0:_a.call(this)),[{tag:"li.task-list-item",priority:100}])},addInputRules:function addInputRules(){var _a;return[].concat(_toConsumableArray(null===(_a=this.parent)||void 0===_a?void 0:_a.call(this)),[wrappingInputRule({find:customInputRegex$1,type:this.type,getAttributes:function getAttributes(match){return{checked:"x"===match[match.length-1]}}})])}}),TaskList$1=Node.create({name:"taskList",addOptions:function addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content:function content(){return this.options.itemTypeName+"+"},parseHTML:function parseHTML(){return[{tag:'ul[data-type="'+this.name+'"]',priority:51}]},renderHTML:function renderHTML(_ref147){var HTMLAttributes=_ref147.HTMLAttributes;return["ul",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes,{"data-type":this.name}),0]},addCommands:function addCommands(){var _this50=this;return{toggleTaskList:function toggleTaskList(){return function(_ref148){return _ref148.commands.toggleList(_this50.name,_this50.options.itemTypeName)}}}},addKeyboardShortcuts:function addKeyboardShortcuts(){var _this51=this;return{"Mod-Shift-9":function ModShift9(){return _this51.editor.commands.toggleTaskList()}}}}),__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},TaskList=TaskList$1.extend({addAttributes:function addAttributes(){return{numeric:{default:!1,parseHTML:function parseHTML(element){return"ol"===element.tagName.toLowerCase()}}}},parseHTML:function parseHTML(){return[{tag:".contains-task-list",priority:100}]},renderHTML:function renderHTML(_a){var _b=_a.HTMLAttributes;return[_b.numeric?"ol":"ul",mergeAttributes(__rest(_b,["numeric"]),{"data-type":"taskList"}),0]}}),customInputRegex=/^\s*([-+*]\s[^\[])$/,BulletList=BulletList$1.extend({addInputRules:function addInputRules(){return[wrappingInputRule({find:customInputRegex,type:this.type})]}});!function(ViewMode){ViewMode.MARKDOWN="markdown",ViewMode.PREVIEW="preview",ViewMode.READONLY="readonly"}(ViewMode||(ViewMode={}));var entities={Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",amp:"&",AMP:"&",andand:"",And:"",and:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angmsd:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",apacir:"",ap:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxHd:"",boxhD:"",boxHD:"",boxhu:"",boxHu:"",boxhU:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:"",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:"",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsolb:"",bsol:"\\",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",capand:"",capbrcup:"",capcap:"",cap:"",Cap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:"",Cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cir:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cupbrcap:"",cupcap:"",CupCap:"",cup:"",Cup:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:"",Dagger:"",daleth:"",darr:"",Darr:"",dArr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",ddagger:"",ddarr:"",DD:"",dd:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrowBar:"",downarrow:"",DownArrow:"",Downarrow:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVectorBar:"",DownLeftVector:"",DownRightTeeVector:"",DownRightVectorBar:"",DownRightVector:"",DownTeeArrow:"",DownTee:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",Ecirc:"",ecirc:"",ecir:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",edot:"",eDot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp13:"",emsp14:"",emsp:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",ge:"",gE:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",gescc:"",ges:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",gg:"",Gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gla:"",gl:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",gtcc:"",gtcir:"",gt:">",GT:">",Gt:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",harrcir:"",harr:"",hArr:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",ifr:"",Ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",Im:"",imof:"",imped:"",Implies:"",incare:"",in:"",infin:"",infintie:"",inodot:"",intcal:"",int:"",Int:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larrb:"",larrbfs:"",larr:"",Larr:"",lArr:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",latail:"",lAtail:"",lat:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",LeftArrowBar:"",leftarrow:"",LeftArrow:"",Leftarrow:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVectorBar:"",LeftDownVector:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTeeArrow:"",LeftTee:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangleBar:"",LeftTriangle:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVectorBar:"",LeftUpVector:"",LeftVectorBar:"",LeftVector:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",lescc:"",les:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",llarr:"",ll:"",Ll:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoustache:"",lmoust:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",LongLeftArrow:"",Longleftarrow:"",longleftrightarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longmapsto:"",longrightarrow:"",LongRightArrow:"",Longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",ltcc:"",ltcir:"",lt:"<",LT:"<",Lt:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",midast:"*",midcir:"",mid:"",middot:"",minusb:"",minus:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natural:"",naturals:"",natur:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",nearhk:"",nearr:"",neArr:"",nearrow:"",ne:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlarr:"",nlArr:"",nldr:"",nlE:"",nle:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",nopf:"",Nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangleBar:"",NotLeftTriangle:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangleBar:"",NotRightTriangle:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",nparallel:"",npar:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",nprec:"",npreceq:"",npre:"",nrarrc:"",nrarr:"",nrArr:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",Ocirc:"",ocirc:"",ocir:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",orarr:"",Or:"",or:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",otimesas:"",Otimes:"",otimes:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",para:"",parallel:"",par:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plusacir:"",plusb:"",pluscir:"",plus:"+",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",prap:"",Pr:"",pr:"",prcue:"",precapprox:"",prec:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",pre:"",prE:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportional:"",Proportion:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarr:"",Rarr:"",rArr:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",real:"",realine:"",realpart:"",reals:"",Re:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrowBar:"",rightarrow:"",RightArrow:"",Rightarrow:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVectorBar:"",RightDownVector:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTeeArrow:"",RightTee:"",RightTeeVector:"",rightthreetimes:"",RightTriangleBar:"",RightTriangle:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVectorBar:"",RightUpVector:"",RightVectorBar:"",RightVector:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoustache:"",rmoust:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",scap:"",Scaron:"",scaron:"",Sc:"",sc:"",sccue:"",sce:"",scE:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdotb:"",sdot:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",solbar:"",solb:"",sol:"/",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squ:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succapprox:"",succ:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup1:"",sup2:"",sup3:"",sup:"",Sup:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",therefore:"",Therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",ThinSpace:"",thinsp:"",thkap:"",thksim:"",THORN:"",thorn:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",timesbar:"",timesb:"",times:"",timesd:"",tint:"",toea:"",topbot:"",topcir:"",top:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",uarr:"",Uarr:"",uArr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrowBar:"",uparrow:"",UpArrow:"",Uparrow:"",UpArrowDownArrow:"",updownarrow:"",UpDownArrow:"",Updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTeeArrow:"",UpTee:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",Vcy:"",vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",veebar:"",vee:"",Vee:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xharr:"",xhArr:"",Xi:"",xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",yuml:"",Yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",zfr:"",Zfr:"",ZHcy:"",zhcy:"",zigrarr:"",zopf:"",Zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""},regex$4=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,encodeCache={};function encode$2(string,exclude,keepEscaped){var i,l,code,nextCode,cache,result="";for("string"!=typeof exclude&&(keepEscaped=exclude,exclude=encode$2.defaultChars),void 0===keepEscaped&&(keepEscaped=!0),cache=function getEncodeCache(exclude){var i,ch,cache=encodeCache[exclude];if(cache)return cache;for(cache=encodeCache[exclude]=[],i=0;i<128;i++)ch=String.fromCharCode(i),/^[0-9a-z]$/i.test(ch)?cache.push(ch):cache.push("%"+("0"+i.toString(16).toUpperCase()).slice(-2));for(i=0;i<exclude.length;i++)cache[exclude.charCodeAt(i)]=exclude[i];return cache}(exclude),i=0,l=string.length;i<l;i++)if(code=string.charCodeAt(i),keepEscaped&&37===code&&i+2<l&&/^[0-9a-f]{2}$/i.test(string.slice(i+1,i+3)))result+=string.slice(i,i+3),i+=2;else if(code<128)result+=cache[code];else if(code>=55296&&code<=57343){if(code>=55296&&code<=56319&&i+1<l&&(nextCode=string.charCodeAt(i+1))>=56320&&nextCode<=57343){result+=encodeURIComponent(string[i]+string[i+1]),i++;continue}result+="%EF%BF%BD"}else result+=encodeURIComponent(string[i]);return result}encode$2.defaultChars=";/?:@&=+$,-_.!~*'()#",encode$2.componentChars="-_.!~*'()";var encode_1=encode$2,decodeCache={};function decode$2(string,exclude){var cache;return"string"!=typeof exclude&&(exclude=decode$2.defaultChars),cache=function getDecodeCache(exclude){var i,ch,cache=decodeCache[exclude];if(cache)return cache;for(cache=decodeCache[exclude]=[],i=0;i<128;i++)ch=String.fromCharCode(i),cache.push(ch);for(i=0;i<exclude.length;i++)cache[ch=exclude.charCodeAt(i)]="%"+("0"+ch.toString(16).toUpperCase()).slice(-2);return cache}(exclude),string.replace(/(%[a-f0-9]{2})+/gi,(function(seq){var i,l,b1,b2,b3,b4,chr,result="";for(i=0,l=seq.length;i<l;i+=3)(b1=parseInt(seq.slice(i+1,i+3),16))<128?result+=cache[b1]:192==(224&b1)&&i+3<l&&128==(192&(b2=parseInt(seq.slice(i+4,i+6),16)))?(result+=(chr=b1<<6&1984|63&b2)<128?"":String.fromCharCode(chr),i+=3):224==(240&b1)&&i+6<l&&(b2=parseInt(seq.slice(i+4,i+6),16),b3=parseInt(seq.slice(i+7,i+9),16),128==(192&b2)&&128==(192&b3))?(result+=(chr=b1<<12&61440|b2<<6&4032|63&b3)<2048||chr>=55296&&chr<=57343?"":String.fromCharCode(chr),i+=6):240==(248&b1)&&i+9<l&&(b2=parseInt(seq.slice(i+4,i+6),16),b3=parseInt(seq.slice(i+7,i+9),16),b4=parseInt(seq.slice(i+10,i+12),16),128==(192&b2)&&128==(192&b3)&&128==(192&b4))?((chr=b1<<18&1835008|b2<<12&258048|b3<<6&4032|63&b4)<65536||chr>1114111?result+="":(chr-=65536,result+=String.fromCharCode(55296+(chr>>10),56320+(1023&chr))),i+=9):result+="";return result}))}decode$2.defaultChars=";/?:@&=+$,#",decode$2.componentChars="";var decode_1=decode$2;function Url$1(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};Url$1.prototype.parse=function(url,slashesDenoteHost){var i,l,lowerProto,hec,slashes,rest=url;if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.pathname=simplePath[1],simplePath[2]&&(this.search=simplePath[2]),this}var proto=protocolPattern.exec(rest);if(proto&&(lowerProto=(proto=proto[0]).toLowerCase(),this.protocol=proto,rest=rest.substr(proto.length)),(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(slashes="//"===rest.substr(0,2))||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)),!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var auth,atSign,hostEnd=-1;for(i=0;i<hostEndingChars.length;i++)-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec);for(-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=auth),hostEnd=-1,i=0;i<nonHostChars.length;i++)-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec);-1===hostEnd&&(hostEnd=rest.length),":"===rest[hostEnd-1]&&hostEnd--;var host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd),this.parseHost(host),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest=notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");return-1!==qm&&(this.search=rest.substr(qm),rest=rest.slice(0,qm)),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname=""),this},Url$1.prototype.parseHost=function(host){var port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)};var format=function format(url){var result="";return result+=url.protocol||"",result+=url.slashes?"//":"",result+=url.auth?url.auth+"@":"",url.hostname&&-1!==url.hostname.indexOf(":")?result+="["+url.hostname+"]":result+=url.hostname||"",result+=url.port?":"+url.port:"",result+=url.pathname||"",result+=url.search||"",result+=url.hash||""},mdurl={encode:encode_1,decode:decode_1,format,parse:function urlParse(url,slashesDenoteHost){if(url&&url instanceof Url$1)return url;var u=new Url$1;return u.parse(url,slashesDenoteHost),u}},regex$3=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,regex$2=/[\0-\x1F\x7F-\x9F]/,regex=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,uc_micro={Any:regex$3,Cc:regex$2,Cf:/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,P:regex$4,Z:regex},utils=(0,_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_72__.c)((function(module,exports){var _hasOwnProperty=Object.prototype.hasOwnProperty;function has(object,key){return _hasOwnProperty.call(object,key)}function isValidEntityCode(c){return!(c>=55296&&c<=57343)&&(!(c>=64976&&c<=65007)&&(65535!=(65535&c)&&65534!=(65535&c)&&(!(c>=0&&c<=8)&&(11!==c&&(!(c>=14&&c<=31)&&(!(c>=127&&c<=159)&&!(c>1114111)))))))}function fromCodePoint(c){if(c>65535){var surrogate1=55296+((c-=65536)>>10),surrogate2=56320+(1023&c);return String.fromCharCode(surrogate1,surrogate2)}return String.fromCharCode(c)}var UNESCAPE_MD_RE=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,UNESCAPE_ALL_RE=new RegExp(UNESCAPE_MD_RE.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),DIGITAL_ENTITY_TEST_RE=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;var HTML_ESCAPE_TEST_RE=/[&<>"]/,HTML_ESCAPE_REPLACE_RE=/[&<>"]/g,HTML_REPLACEMENTS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function replaceUnsafeChar(ch){return HTML_REPLACEMENTS[ch]}var REGEXP_ESCAPE_RE=/[.?*+^$[\]\\(){}|-]/g;exports.lib={},exports.lib.mdurl=mdurl,exports.lib.ucmicro=uc_micro,exports.assign=function assign(obj){var sources=Array.prototype.slice.call(arguments,1);return sources.forEach((function(source){if(source){if("object"!=typeof source)throw new TypeError(source+"must be object");Object.keys(source).forEach((function(key){obj[key]=source[key]}))}})),obj},exports.isString=function isString(obj){return"[object String]"===function _class(obj){return Object.prototype.toString.call(obj)}(obj)},exports.has=has,exports.unescapeMd=function unescapeMd(str){return str.indexOf("\\")<0?str:str.replace(UNESCAPE_MD_RE,"$1")},exports.unescapeAll=function unescapeAll(str){return str.indexOf("\\")<0&&str.indexOf("&")<0?str:str.replace(UNESCAPE_ALL_RE,(function(match,escaped,entity){return escaped||function replaceEntityPattern(match,name){var code=0;return has(entities,name)?entities[name]:35===name.charCodeAt(0)&&DIGITAL_ENTITY_TEST_RE.test(name)&&isValidEntityCode(code="x"===name[1].toLowerCase()?parseInt(name.slice(2),16):parseInt(name.slice(1),10))?fromCodePoint(code):match}(match,entity)}))},exports.isValidEntityCode=isValidEntityCode,exports.fromCodePoint=fromCodePoint,exports.escapeHtml=function escapeHtml(str){return HTML_ESCAPE_TEST_RE.test(str)?str.replace(HTML_ESCAPE_REPLACE_RE,replaceUnsafeChar):str},exports.arrayReplaceAt=function arrayReplaceAt(src,pos,newElements){return[].concat(src.slice(0,pos),newElements,src.slice(pos+1))},exports.isSpace=function isSpace(code){switch(code){case 9:case 32:return!0}return!1},exports.isWhiteSpace=function isWhiteSpace(code){if(code>=8192&&code<=8202)return!0;switch(code){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},exports.isMdAsciiPunct=function isMdAsciiPunct(ch){switch(ch){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},exports.isPunctChar=function isPunctChar(ch){return regex$4.test(ch)},exports.escapeRE=function escapeRE(str){return str.replace(REGEXP_ESCAPE_RE,"\\$&")},exports.normalizeReference=function normalizeReference(str){return str=str.trim().replace(/\s+/g," "),""==="".toLowerCase()&&(str=str.replace(//g,"")),str.toLowerCase().toUpperCase()}})),unescapeAll$2=utils.unescapeAll,unescapeAll$1=utils.unescapeAll,parseLinkLabel=function parseLinkLabel(state,start,disableNested){var level,found,marker,prevPos,labelEnd=-1,max=state.posMax,oldPos=state.pos;for(state.pos=start+1,level=1;state.pos<max;){if(93===(marker=state.src.charCodeAt(state.pos))&&0===--level){found=!0;break}if(prevPos=state.pos,state.md.inline.skipToken(state),91===marker)if(prevPos===state.pos-1)level++;else if(disableNested)return state.pos=oldPos,-1}return found&&(labelEnd=state.pos),state.pos=oldPos,labelEnd},parseLinkDestination=function parseLinkDestination(str,pos,max){var code,level,start=pos,result={ok:!1,pos:0,lines:0,str:""};if(60===str.charCodeAt(pos)){for(pos++;pos<max;){if(10===(code=str.charCodeAt(pos)))return result;if(60===code)return result;if(62===code)return result.pos=pos+1,result.str=unescapeAll$2(str.slice(start+1,pos)),result.ok=!0,result;92===code&&pos+1<max?pos+=2:pos++}return result}for(level=0;pos<max&&32!==(code=str.charCodeAt(pos))&&!(code<32||127===code);)if(92===code&&pos+1<max){if(32===str.charCodeAt(pos+1))break;pos+=2}else{if(40===code&&++level>32)return result;if(41===code){if(0===level)break;level--}pos++}return start===pos||0!==level||(result.str=unescapeAll$2(str.slice(start,pos)),result.lines=0,result.pos=pos,result.ok=!0),result},parseLinkTitle=function parseLinkTitle(str,pos,max){var code,marker,lines=0,start=pos,result={ok:!1,pos:0,lines:0,str:""};if(pos>=max)return result;if(34!==(marker=str.charCodeAt(pos))&&39!==marker&&40!==marker)return result;for(pos++,40===marker&&(marker=41);pos<max;){if((code=str.charCodeAt(pos))===marker)return result.pos=pos+1,result.lines=lines,result.str=unescapeAll$1(str.slice(start+1,pos)),result.ok=!0,result;if(40===code&&41===marker)return result;10===code?lines++:92===code&&pos+1<max&&(pos++,10===str.charCodeAt(pos)&&lines++),pos++}return result},helpers={parseLinkLabel,parseLinkDestination,parseLinkTitle},assign$1=utils.assign,unescapeAll=utils.unescapeAll,escapeHtml=utils.escapeHtml,default_rules={};function Renderer(){this.rules=assign$1({},default_rules)}default_rules.code_inline=function(tokens,idx,options,env,slf){var token=tokens[idx];return"<code"+slf.renderAttrs(token)+">"+escapeHtml(tokens[idx].content)+"</code>"},default_rules.code_block=function(tokens,idx,options,env,slf){var token=tokens[idx];return"<pre"+slf.renderAttrs(token)+"><code>"+escapeHtml(tokens[idx].content)+"</code></pre>\n"},default_rules.fence=function(tokens,idx,options,env,slf){var highlighted,i,arr,tmpAttrs,tmpToken,token=tokens[idx],info=token.info?unescapeAll(token.info).trim():"",langName="",langAttrs="";return info&&(langName=(arr=info.split(/(\s+)/g))[0],langAttrs=arr.slice(2).join("")),0===(highlighted=options.highlight&&options.highlight(token.content,langName,langAttrs)||escapeHtml(token.content)).indexOf("<pre")?highlighted+"\n":info?(i=token.attrIndex("class"),tmpAttrs=token.attrs?token.attrs.slice():[],i<0?tmpAttrs.push(["class",options.langPrefix+langName]):(tmpAttrs[i]=tmpAttrs[i].slice(),tmpAttrs[i][1]+=" "+options.langPrefix+langName),tmpToken={attrs:tmpAttrs},"<pre><code"+slf.renderAttrs(tmpToken)+">"+highlighted+"</code></pre>\n"):"<pre><code"+slf.renderAttrs(token)+">"+highlighted+"</code></pre>\n"},default_rules.image=function(tokens,idx,options,env,slf){var token=tokens[idx];return token.attrs[token.attrIndex("alt")][1]=slf.renderInlineAsText(token.children,options,env),slf.renderToken(tokens,idx,options)},default_rules.hardbreak=function(tokens,idx,options){return options.xhtmlOut?"<br />\n":"<br>\n"},default_rules.softbreak=function(tokens,idx,options){return options.breaks?options.xhtmlOut?"<br />\n":"<br>\n":"\n"},default_rules.text=function(tokens,idx){return escapeHtml(tokens[idx].content)},default_rules.html_block=function(tokens,idx){return tokens[idx].content},default_rules.html_inline=function(tokens,idx){return tokens[idx].content},Renderer.prototype.renderAttrs=function renderAttrs(token){var i,l,result;if(!token.attrs)return"";for(result="",i=0,l=token.attrs.length;i<l;i++)result+=" "+escapeHtml(token.attrs[i][0])+'="'+escapeHtml(token.attrs[i][1])+'"';return result},Renderer.prototype.renderToken=function renderToken(tokens,idx,options){var nextToken,result="",needLf=!1,token=tokens[idx];return token.hidden?"":(token.block&&-1!==token.nesting&&idx&&tokens[idx-1].hidden&&(result+="\n"),result+=(-1===token.nesting?"</":"<")+token.tag,result+=this.renderAttrs(token),0===token.nesting&&options.xhtmlOut&&(result+=" /"),token.block&&(needLf=!0,1===token.nesting&&idx+1<tokens.length&&("inline"===(nextToken=tokens[idx+1]).type||nextToken.hidden||-1===nextToken.nesting&&nextToken.tag===token.tag)&&(needLf=!1)),result+=needLf?">\n":">")},Renderer.prototype.renderInline=function(tokens,options,env){for(var type,result="",rules=this.rules,i=0,len=tokens.length;i<len;i++)void 0!==rules[type=tokens[i].type]?result+=rules[type](tokens,i,options,env,this):result+=this.renderToken(tokens,i,options);return result},Renderer.prototype.renderInlineAsText=function(tokens,options,env){for(var result="",i=0,len=tokens.length;i<len;i++)"text"===tokens[i].type?result+=tokens[i].content:"image"===tokens[i].type?result+=this.renderInlineAsText(tokens[i].children,options,env):"softbreak"===tokens[i].type&&(result+="\n");return result},Renderer.prototype.render=function(tokens,options,env){var i,len,type,result="",rules=this.rules;for(i=0,len=tokens.length;i<len;i++)"inline"===(type=tokens[i].type)?result+=this.renderInline(tokens[i].children,options,env):void 0!==rules[type]?result+=rules[tokens[i].type](tokens,i,options,env,this):result+=this.renderToken(tokens,i,options,env);return result};var renderer=Renderer;function Ruler(){this.__rules__=[],this.__cache__=null}Ruler.prototype.__find__=function(name){for(var i=0;i<this.__rules__.length;i++)if(this.__rules__[i].name===name)return i;return-1},Ruler.prototype.__compile__=function(){var self=this,chains=[""];self.__rules__.forEach((function(rule){rule.enabled&&rule.alt.forEach((function(altName){chains.indexOf(altName)<0&&chains.push(altName)}))})),self.__cache__={},chains.forEach((function(chain){self.__cache__[chain]=[],self.__rules__.forEach((function(rule){rule.enabled&&(chain&&rule.alt.indexOf(chain)<0||self.__cache__[chain].push(rule.fn))}))}))},Ruler.prototype.at=function(name,fn,options){var index=this.__find__(name),opt=options||{};if(-1===index)throw new Error("Parser rule not found: "+name);this.__rules__[index].fn=fn,this.__rules__[index].alt=opt.alt||[],this.__cache__=null},Ruler.prototype.before=function(beforeName,ruleName,fn,options){var index=this.__find__(beforeName),opt=options||{};if(-1===index)throw new Error("Parser rule not found: "+beforeName);this.__rules__.splice(index,0,{name:ruleName,enabled:!0,fn,alt:opt.alt||[]}),this.__cache__=null},Ruler.prototype.after=function(afterName,ruleName,fn,options){var index=this.__find__(afterName),opt=options||{};if(-1===index)throw new Error("Parser rule not found: "+afterName);this.__rules__.splice(index+1,0,{name:ruleName,enabled:!0,fn,alt:opt.alt||[]}),this.__cache__=null},Ruler.prototype.push=function(ruleName,fn,options){var opt=options||{};this.__rules__.push({name:ruleName,enabled:!0,fn,alt:opt.alt||[]}),this.__cache__=null},Ruler.prototype.enable=function(list,ignoreInvalid){Array.isArray(list)||(list=[list]);var result=[];return list.forEach((function(name){var idx=this.__find__(name);if(idx<0){if(ignoreInvalid)return;throw new Error("Rules manager: invalid rule name "+name)}this.__rules__[idx].enabled=!0,result.push(name)}),this),this.__cache__=null,result},Ruler.prototype.enableOnly=function(list,ignoreInvalid){Array.isArray(list)||(list=[list]),this.__rules__.forEach((function(rule){rule.enabled=!1})),this.enable(list,ignoreInvalid)},Ruler.prototype.disable=function(list,ignoreInvalid){Array.isArray(list)||(list=[list]);var result=[];return list.forEach((function(name){var idx=this.__find__(name);if(idx<0){if(ignoreInvalid)return;throw new Error("Rules manager: invalid rule name "+name)}this.__rules__[idx].enabled=!1,result.push(name)}),this),this.__cache__=null,result},Ruler.prototype.getRules=function(chainName){return null===this.__cache__&&this.__compile__(),this.__cache__[chainName]||[]};var ruler=Ruler,NEWLINES_RE=/\r\n?|\n/g,NULL_RE=/\0/g,arrayReplaceAt=utils.arrayReplaceAt;function isLinkClose(str){return/^<\/a\s*>/i.test(str)}var RARE_RE=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,SCOPED_ABBR_TEST_RE=/\((c|tm|r|p)\)/i,SCOPED_ABBR_RE=/\((c|tm|r|p)\)/gi,SCOPED_ABBR={c:"",r:"",p:"",tm:""};function replaceFn(match,name){return SCOPED_ABBR[name.toLowerCase()]}function replace_scoped(inlineTokens){var i,token,inside_autolink=0;for(i=inlineTokens.length-1;i>=0;i--)"text"!==(token=inlineTokens[i]).type||inside_autolink||(token.content=token.content.replace(SCOPED_ABBR_RE,replaceFn)),"link_open"===token.type&&"auto"===token.info&&inside_autolink--,"link_close"===token.type&&"auto"===token.info&&inside_autolink++}function replace_rare(inlineTokens){var i,token,inside_autolink=0;for(i=inlineTokens.length-1;i>=0;i--)"text"!==(token=inlineTokens[i]).type||inside_autolink||RARE_RE.test(token.content)&&(token.content=token.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1").replace(/(^|\s)--(?=\s|$)/gm,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1")),"link_open"===token.type&&"auto"===token.info&&inside_autolink--,"link_close"===token.type&&"auto"===token.info&&inside_autolink++}var isWhiteSpace$1=utils.isWhiteSpace,isPunctChar$1=utils.isPunctChar,isMdAsciiPunct$1=utils.isMdAsciiPunct,QUOTE_TEST_RE=/['"]/,QUOTE_RE=/['"]/g;function replaceAt(str,index,ch){return str.substr(0,index)+ch+str.substr(index+1)}function process_inlines(tokens,state){var i,token,text,t,pos,max,thisLevel,item,lastChar,nextChar,isLastPunctChar,isNextPunctChar,isLastWhiteSpace,isNextWhiteSpace,canOpen,canClose,j,isSingle,stack,openQuote,closeQuote;for(stack=[],i=0;i<tokens.length;i++){for(token=tokens[i],thisLevel=tokens[i].level,j=stack.length-1;j>=0&&!(stack[j].level<=thisLevel);j--);if(stack.length=j+1,"text"===token.type){pos=0,max=(text=token.content).length;OUTER:for(;pos<max&&(QUOTE_RE.lastIndex=pos,t=QUOTE_RE.exec(text));){if(canOpen=canClose=!0,pos=t.index+1,isSingle="'"===t[0],lastChar=32,t.index-1>=0)lastChar=text.charCodeAt(t.index-1);else for(j=i-1;j>=0&&("softbreak"!==tokens[j].type&&"hardbreak"!==tokens[j].type);j--)if(tokens[j].content){lastChar=tokens[j].content.charCodeAt(tokens[j].content.length-1);break}if(nextChar=32,pos<max)nextChar=text.charCodeAt(pos);else for(j=i+1;j<tokens.length&&("softbreak"!==tokens[j].type&&"hardbreak"!==tokens[j].type);j++)if(tokens[j].content){nextChar=tokens[j].content.charCodeAt(0);break}if(isLastPunctChar=isMdAsciiPunct$1(lastChar)||isPunctChar$1(String.fromCharCode(lastChar)),isNextPunctChar=isMdAsciiPunct$1(nextChar)||isPunctChar$1(String.fromCharCode(nextChar)),isLastWhiteSpace=isWhiteSpace$1(lastChar),(isNextWhiteSpace=isWhiteSpace$1(nextChar))?canOpen=!1:isNextPunctChar&&(isLastWhiteSpace||isLastPunctChar||(canOpen=!1)),isLastWhiteSpace?canClose=!1:isLastPunctChar&&(isNextWhiteSpace||isNextPunctChar||(canClose=!1)),34===nextChar&&'"'===t[0]&&lastChar>=48&&lastChar<=57&&(canClose=canOpen=!1),canOpen&&canClose&&(canOpen=isLastPunctChar,canClose=isNextPunctChar),canOpen||canClose){if(canClose)for(j=stack.length-1;j>=0&&(item=stack[j],!(stack[j].level<thisLevel));j--)if(item.single===isSingle&&stack[j].level===thisLevel){item=stack[j],isSingle?(openQuote=state.md.options.quotes[2],closeQuote=state.md.options.quotes[3]):(openQuote=state.md.options.quotes[0],closeQuote=state.md.options.quotes[1]),token.content=replaceAt(token.content,t.index,closeQuote),tokens[item.token].content=replaceAt(tokens[item.token].content,item.pos,openQuote),pos+=closeQuote.length-1,item.token===i&&(pos+=openQuote.length-1),max=(text=token.content).length,stack.length=j;continue OUTER}canOpen?stack.push({token:i,pos:t.index,single:isSingle,level:thisLevel}):canClose&&isSingle&&(token.content=replaceAt(token.content,t.index,""))}else isSingle&&(token.content=replaceAt(token.content,t.index,""))}}}}function Token(type,tag,nesting){this.type=type,this.tag=tag,this.attrs=null,this.map=null,this.nesting=nesting,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Token.prototype.attrIndex=function attrIndex(name){var attrs,i,len;if(!this.attrs)return-1;for(i=0,len=(attrs=this.attrs).length;i<len;i++)if(attrs[i][0]===name)return i;return-1},Token.prototype.attrPush=function attrPush(attrData){this.attrs?this.attrs.push(attrData):this.attrs=[attrData]},Token.prototype.attrSet=function attrSet(name,value){var idx=this.attrIndex(name),attrData=[name,value];idx<0?this.attrPush(attrData):this.attrs[idx]=attrData},Token.prototype.attrGet=function attrGet(name){var idx=this.attrIndex(name),value=null;return idx>=0&&(value=this.attrs[idx][1]),value},Token.prototype.attrJoin=function attrJoin(name,value){var idx=this.attrIndex(name);idx<0?this.attrPush([name,value]):this.attrs[idx][1]=this.attrs[idx][1]+" "+value};var token=Token;function StateCore(src,md,env){this.src=src,this.env=env,this.tokens=[],this.inlineMode=!1,this.md=md}StateCore.prototype.Token=token;var state_core=StateCore,_rules$2=[["normalize",function normalize(state){var str;str=(str=state.src.replace(NEWLINES_RE,"\n")).replace(NULL_RE,""),state.src=str}],["block",function block(state){var token;state.inlineMode?((token=new state.Token("inline","",0)).content=state.src,token.map=[0,1],token.children=[],state.tokens.push(token)):state.md.block.parse(state.src,state.md,state.env,state.tokens)}],["inline",function inline(state){var tok,i,l,tokens=state.tokens;for(i=0,l=tokens.length;i<l;i++)"inline"===(tok=tokens[i]).type&&state.md.inline.parse(tok.content,state.md,state.env,tok.children)}],["linkify",function linkify(state){var i,j,l,tokens,token,currentToken,nodes,ln,text,pos,lastPos,level,htmlLinkLevel,url,fullUrl,urlText,links,str,blockTokens=state.tokens;if(state.md.options.linkify)for(j=0,l=blockTokens.length;j<l;j++)if("inline"===blockTokens[j].type&&state.md.linkify.pretest(blockTokens[j].content))for(htmlLinkLevel=0,i=(tokens=blockTokens[j].children).length-1;i>=0;i--)if("link_close"!==(currentToken=tokens[i]).type){if("html_inline"===currentToken.type&&(str=currentToken.content,/^<a[>\s]/i.test(str)&&htmlLinkLevel>0&&htmlLinkLevel--,isLinkClose(currentToken.content)&&htmlLinkLevel++),!(htmlLinkLevel>0)&&"text"===currentToken.type&&state.md.linkify.test(currentToken.content)){for(text=currentToken.content,links=state.md.linkify.match(text),nodes=[],level=currentToken.level,lastPos=0,ln=0;ln<links.length;ln++)url=links[ln].url,fullUrl=state.md.normalizeLink(url),state.md.validateLink(fullUrl)&&(urlText=links[ln].text,urlText=links[ln].schema?"mailto:"!==links[ln].schema||/^mailto:/i.test(urlText)?state.md.normalizeLinkText(urlText):state.md.normalizeLinkText("mailto:"+urlText).replace(/^mailto:/,""):state.md.normalizeLinkText("http://"+urlText).replace(/^http:\/\//,""),(pos=links[ln].index)>lastPos&&((token=new state.Token("text","",0)).content=text.slice(lastPos,pos),token.level=level,nodes.push(token)),(token=new state.Token("link_open","a",1)).attrs=[["href",fullUrl]],token.level=level++,token.markup="linkify",token.info="auto",nodes.push(token),(token=new state.Token("text","",0)).content=urlText,token.level=level,nodes.push(token),(token=new state.Token("link_close","a",-1)).level=--level,token.markup="linkify",token.info="auto",nodes.push(token),lastPos=links[ln].lastIndex);lastPos<text.length&&((token=new state.Token("text","",0)).content=text.slice(lastPos),token.level=level,nodes.push(token)),blockTokens[j].children=tokens=arrayReplaceAt(tokens,i,nodes)}}else for(i--;tokens[i].level!==currentToken.level&&"link_open"!==tokens[i].type;)i--}],["replacements",function replace(state){var blkIdx;if(state.md.options.typographer)for(blkIdx=state.tokens.length-1;blkIdx>=0;blkIdx--)"inline"===state.tokens[blkIdx].type&&(SCOPED_ABBR_TEST_RE.test(state.tokens[blkIdx].content)&&replace_scoped(state.tokens[blkIdx].children),RARE_RE.test(state.tokens[blkIdx].content)&&replace_rare(state.tokens[blkIdx].children))}],["smartquotes",function smartquotes(state){var blkIdx;if(state.md.options.typographer)for(blkIdx=state.tokens.length-1;blkIdx>=0;blkIdx--)"inline"===state.tokens[blkIdx].type&&QUOTE_TEST_RE.test(state.tokens[blkIdx].content)&&process_inlines(state.tokens[blkIdx].children,state)}]];function Core(){this.ruler=new ruler;for(var i=0;i<_rules$2.length;i++)this.ruler.push(_rules$2[i][0],_rules$2[i][1])}Core.prototype.process=function(state){var i,l,rules;for(i=0,l=(rules=this.ruler.getRules("")).length;i<l;i++)rules[i](state)},Core.prototype.State=state_core;var parser_core=Core,isSpace$a=utils.isSpace;function getLine(state,line){var pos=state.bMarks[line]+state.tShift[line],max=state.eMarks[line];return state.src.substr(pos,max-pos)}function escapedSplit(str){var ch,result=[],pos=0,max=str.length,isEscaped=!1,lastPos=0,current="";for(ch=str.charCodeAt(pos);pos<max;)124===ch&&(isEscaped?(current+=str.substring(lastPos,pos-1),lastPos=pos):(result.push(current+str.substring(lastPos,pos)),current="",lastPos=pos+1)),isEscaped=92===ch,pos++,ch=str.charCodeAt(pos);return result.push(current+str.substring(lastPos)),result}var isSpace$9=utils.isSpace,isSpace$8=utils.isSpace,isSpace$7=utils.isSpace;function skipBulletListMarker(state,startLine){var marker,pos,max,ch;return pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine],42!==(marker=state.src.charCodeAt(pos++))&&45!==marker&&43!==marker||pos<max&&(ch=state.src.charCodeAt(pos),!isSpace$7(ch))?-1:pos}function skipOrderedListMarker(state,startLine){var ch,start=state.bMarks[startLine]+state.tShift[startLine],pos=start,max=state.eMarks[startLine];if(pos+1>=max)return-1;if((ch=state.src.charCodeAt(pos++))<48||ch>57)return-1;for(;;){if(pos>=max)return-1;if(!((ch=state.src.charCodeAt(pos++))>=48&&ch<=57)){if(41===ch||46===ch)break;return-1}if(pos-start>=10)return-1}return pos<max&&(ch=state.src.charCodeAt(pos),!isSpace$7(ch))?-1:pos}var normalizeReference$2=utils.normalizeReference,isSpace$6=utils.isSpace,open_tag="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",close_tag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",html_re={HTML_TAG_RE:new RegExp("^(?:"+open_tag+"|"+close_tag+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),HTML_OPEN_CLOSE_TAG_RE:new RegExp("^(?:"+open_tag+"|"+close_tag+")")},HTML_OPEN_CLOSE_TAG_RE=html_re.HTML_OPEN_CLOSE_TAG_RE,HTML_SEQUENCES=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"].join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(HTML_OPEN_CLOSE_TAG_RE.source+"\\s*$"),/^$/,!1]],isSpace$5=utils.isSpace,isSpace$4=utils.isSpace;function StateBlock(src,md,env,tokens){var ch,s,start,pos,len,indent,offset,indent_found;for(this.src=src,this.md=md,this.env=env,this.tokens=tokens,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",indent_found=!1,start=pos=indent=offset=0,len=(s=this.src).length;pos<len;pos++){if(ch=s.charCodeAt(pos),!indent_found){if(isSpace$4(ch)){indent++,9===ch?offset+=4-offset%4:offset++;continue}indent_found=!0}10!==ch&&pos!==len-1||(10!==ch&&pos++,this.bMarks.push(start),this.eMarks.push(pos),this.tShift.push(indent),this.sCount.push(offset),this.bsCount.push(0),indent_found=!1,indent=0,offset=0,start=pos+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}StateBlock.prototype.push=function(type,tag,nesting){var token$1=new token(type,tag,nesting);return token$1.block=!0,nesting<0&&this.level--,token$1.level=this.level,nesting>0&&this.level++,this.tokens.push(token$1),token$1},StateBlock.prototype.isEmpty=function isEmpty(line){return this.bMarks[line]+this.tShift[line]>=this.eMarks[line]},StateBlock.prototype.skipEmptyLines=function skipEmptyLines(from){for(var max=this.lineMax;from<max&&!(this.bMarks[from]+this.tShift[from]<this.eMarks[from]);from++);return from},StateBlock.prototype.skipSpaces=function skipSpaces(pos){for(var ch,max=this.src.length;pos<max&&(ch=this.src.charCodeAt(pos),isSpace$4(ch));pos++);return pos},StateBlock.prototype.skipSpacesBack=function skipSpacesBack(pos,min){if(pos<=min)return pos;for(;pos>min;)if(!isSpace$4(this.src.charCodeAt(--pos)))return pos+1;return pos},StateBlock.prototype.skipChars=function skipChars(pos,code){for(var max=this.src.length;pos<max&&this.src.charCodeAt(pos)===code;pos++);return pos},StateBlock.prototype.skipCharsBack=function skipCharsBack(pos,code,min){if(pos<=min)return pos;for(;pos>min;)if(code!==this.src.charCodeAt(--pos))return pos+1;return pos},StateBlock.prototype.getLines=function getLines(begin,end,indent,keepLastLF){var i,lineIndent,ch,first,last,queue,lineStart,line=begin;if(begin>=end)return"";for(queue=new Array(end-begin),i=0;line<end;line++,i++){for(lineIndent=0,lineStart=first=this.bMarks[line],last=line+1<end||keepLastLF?this.eMarks[line]+1:this.eMarks[line];first<last&&lineIndent<indent;){if(ch=this.src.charCodeAt(first),isSpace$4(ch))9===ch?lineIndent+=4-(lineIndent+this.bsCount[line])%4:lineIndent++;else{if(!(first-lineStart<this.tShift[line]))break;lineIndent++}first++}queue[i]=lineIndent>indent?new Array(lineIndent-indent+1).join(" ")+this.src.slice(first,last):this.src.slice(first,last)}return queue.join("")},StateBlock.prototype.Token=token;var state_block=StateBlock,_rules$1=[["table",function table(state,startLine,endLine,silent){var ch,lineText,pos,i,l,nextLine,columns,columnCount,token,aligns,t,tableLines,tbodyLines,oldParentType,terminate,terminatorRules,firstCh,secondCh;if(startLine+2>endLine)return!1;if(nextLine=startLine+1,state.sCount[nextLine]<state.blkIndent)return!1;if(state.sCount[nextLine]-state.blkIndent>=4)return!1;if((pos=state.bMarks[nextLine]+state.tShift[nextLine])>=state.eMarks[nextLine])return!1;if(124!==(firstCh=state.src.charCodeAt(pos++))&&45!==firstCh&&58!==firstCh)return!1;if(pos>=state.eMarks[nextLine])return!1;if(124!==(secondCh=state.src.charCodeAt(pos++))&&45!==secondCh&&58!==secondCh&&!isSpace$a(secondCh))return!1;if(45===firstCh&&isSpace$a(secondCh))return!1;for(;pos<state.eMarks[nextLine];){if(124!==(ch=state.src.charCodeAt(pos))&&45!==ch&&58!==ch&&!isSpace$a(ch))return!1;pos++}for(columns=(lineText=getLine(state,startLine+1)).split("|"),aligns=[],i=0;i<columns.length;i++){if(!(t=columns[i].trim())){if(0===i||i===columns.length-1)continue;return!1}if(!/^:?-+:?$/.test(t))return!1;58===t.charCodeAt(t.length-1)?aligns.push(58===t.charCodeAt(0)?"center":"right"):58===t.charCodeAt(0)?aligns.push("left"):aligns.push("")}if(-1===(lineText=getLine(state,startLine).trim()).indexOf("|"))return!1;if(state.sCount[startLine]-state.blkIndent>=4)return!1;if((columns=escapedSplit(lineText)).length&&""===columns[0]&&columns.shift(),columns.length&&""===columns[columns.length-1]&&columns.pop(),0===(columnCount=columns.length)||columnCount!==aligns.length)return!1;if(silent)return!0;for(oldParentType=state.parentType,state.parentType="table",terminatorRules=state.md.block.ruler.getRules("blockquote"),(token=state.push("table_open","table",1)).map=tableLines=[startLine,0],(token=state.push("thead_open","thead",1)).map=[startLine,startLine+1],(token=state.push("tr_open","tr",1)).map=[startLine,startLine+1],i=0;i<columns.length;i++)token=state.push("th_open","th",1),aligns[i]&&(token.attrs=[["style","text-align:"+aligns[i]]]),(token=state.push("inline","",0)).content=columns[i].trim(),token.children=[],token=state.push("th_close","th",-1);for(token=state.push("tr_close","tr",-1),token=state.push("thead_close","thead",-1),nextLine=startLine+2;nextLine<endLine&&!(state.sCount[nextLine]<state.blkIndent);nextLine++){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break;if(!(lineText=getLine(state,nextLine).trim()))break;if(state.sCount[nextLine]-state.blkIndent>=4)break;for((columns=escapedSplit(lineText)).length&&""===columns[0]&&columns.shift(),columns.length&&""===columns[columns.length-1]&&columns.pop(),nextLine===startLine+2&&((token=state.push("tbody_open","tbody",1)).map=tbodyLines=[startLine+2,0]),(token=state.push("tr_open","tr",1)).map=[nextLine,nextLine+1],i=0;i<columnCount;i++)token=state.push("td_open","td",1),aligns[i]&&(token.attrs=[["style","text-align:"+aligns[i]]]),(token=state.push("inline","",0)).content=columns[i]?columns[i].trim():"",token.children=[],token=state.push("td_close","td",-1);token=state.push("tr_close","tr",-1)}return tbodyLines&&(token=state.push("tbody_close","tbody",-1),tbodyLines[1]=nextLine),token=state.push("table_close","table",-1),tableLines[1]=nextLine,state.parentType=oldParentType,state.line=nextLine,!0},["paragraph","reference"]],["code",function code(state,startLine,endLine){var nextLine,last,token;if(state.sCount[startLine]-state.blkIndent<4)return!1;for(last=nextLine=startLine+1;nextLine<endLine;)if(state.isEmpty(nextLine))nextLine++;else{if(!(state.sCount[nextLine]-state.blkIndent>=4))break;last=++nextLine}return state.line=last,(token=state.push("code_block","code",0)).content=state.getLines(startLine,last,4+state.blkIndent,!1)+"\n",token.map=[startLine,state.line],!0}],["fence",function fence(state,startLine,endLine,silent){var marker,len,params,nextLine,mem,token,markup,haveEndMarker=!1,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(pos+3>max)return!1;if(126!==(marker=state.src.charCodeAt(pos))&&96!==marker)return!1;if(mem=pos,(len=(pos=state.skipChars(pos,marker))-mem)<3)return!1;if(markup=state.src.slice(mem,pos),params=state.src.slice(pos,max),96===marker&&params.indexOf(String.fromCharCode(marker))>=0)return!1;if(silent)return!0;for(nextLine=startLine;!(++nextLine>=endLine)&&!((pos=mem=state.bMarks[nextLine]+state.tShift[nextLine])<(max=state.eMarks[nextLine])&&state.sCount[nextLine]<state.blkIndent);)if(state.src.charCodeAt(pos)===marker&&!(state.sCount[nextLine]-state.blkIndent>=4||(pos=state.skipChars(pos,marker))-mem<len||(pos=state.skipSpaces(pos))<max)){haveEndMarker=!0;break}return len=state.sCount[startLine],state.line=nextLine+(haveEndMarker?1:0),(token=state.push("fence","code",0)).info=params,token.content=state.getLines(startLine+1,nextLine,len,!0),token.markup=markup,token.map=[startLine,state.line],!0},["paragraph","reference","blockquote","list"]],["blockquote",function blockquote(state,startLine,endLine,silent){var adjustTab,ch,i,initial,l,lastLineEmpty,lines,nextLine,offset,oldBMarks,oldBSCount,oldIndent,oldParentType,oldSCount,oldTShift,spaceAfterMarker,terminate,terminatorRules,token,isOutdented,oldLineMax=state.lineMax,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(62!==state.src.charCodeAt(pos++))return!1;if(silent)return!0;for(initial=offset=state.sCount[startLine]+1,32===state.src.charCodeAt(pos)?(pos++,initial++,offset++,adjustTab=!1,spaceAfterMarker=!0):9===state.src.charCodeAt(pos)?(spaceAfterMarker=!0,(state.bsCount[startLine]+offset)%4==3?(pos++,initial++,offset++,adjustTab=!1):adjustTab=!0):spaceAfterMarker=!1,oldBMarks=[state.bMarks[startLine]],state.bMarks[startLine]=pos;pos<max&&(ch=state.src.charCodeAt(pos),isSpace$9(ch));)9===ch?offset+=4-(offset+state.bsCount[startLine]+(adjustTab?1:0))%4:offset++,pos++;for(oldBSCount=[state.bsCount[startLine]],state.bsCount[startLine]=state.sCount[startLine]+1+(spaceAfterMarker?1:0),lastLineEmpty=pos>=max,oldSCount=[state.sCount[startLine]],state.sCount[startLine]=offset-initial,oldTShift=[state.tShift[startLine]],state.tShift[startLine]=pos-state.bMarks[startLine],terminatorRules=state.md.block.ruler.getRules("blockquote"),oldParentType=state.parentType,state.parentType="blockquote",nextLine=startLine+1;nextLine<endLine&&(isOutdented=state.sCount[nextLine]<state.blkIndent,!((pos=state.bMarks[nextLine]+state.tShift[nextLine])>=(max=state.eMarks[nextLine])));nextLine++)if(62!==state.src.charCodeAt(pos++)||isOutdented){if(lastLineEmpty)break;for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate){state.lineMax=nextLine,0!==state.blkIndent&&(oldBMarks.push(state.bMarks[nextLine]),oldBSCount.push(state.bsCount[nextLine]),oldTShift.push(state.tShift[nextLine]),oldSCount.push(state.sCount[nextLine]),state.sCount[nextLine]-=state.blkIndent);break}oldBMarks.push(state.bMarks[nextLine]),oldBSCount.push(state.bsCount[nextLine]),oldTShift.push(state.tShift[nextLine]),oldSCount.push(state.sCount[nextLine]),state.sCount[nextLine]=-1}else{for(initial=offset=state.sCount[nextLine]+1,32===state.src.charCodeAt(pos)?(pos++,initial++,offset++,adjustTab=!1,spaceAfterMarker=!0):9===state.src.charCodeAt(pos)?(spaceAfterMarker=!0,(state.bsCount[nextLine]+offset)%4==3?(pos++,initial++,offset++,adjustTab=!1):adjustTab=!0):spaceAfterMarker=!1,oldBMarks.push(state.bMarks[nextLine]),state.bMarks[nextLine]=pos;pos<max&&(ch=state.src.charCodeAt(pos),isSpace$9(ch));)9===ch?offset+=4-(offset+state.bsCount[nextLine]+(adjustTab?1:0))%4:offset++,pos++;lastLineEmpty=pos>=max,oldBSCount.push(state.bsCount[nextLine]),state.bsCount[nextLine]=state.sCount[nextLine]+1+(spaceAfterMarker?1:0),oldSCount.push(state.sCount[nextLine]),state.sCount[nextLine]=offset-initial,oldTShift.push(state.tShift[nextLine]),state.tShift[nextLine]=pos-state.bMarks[nextLine]}for(oldIndent=state.blkIndent,state.blkIndent=0,(token=state.push("blockquote_open","blockquote",1)).markup=">",token.map=lines=[startLine,0],state.md.block.tokenize(state,startLine,nextLine),(token=state.push("blockquote_close","blockquote",-1)).markup=">",state.lineMax=oldLineMax,state.parentType=oldParentType,lines[1]=state.line,i=0;i<oldTShift.length;i++)state.bMarks[i+startLine]=oldBMarks[i],state.tShift[i+startLine]=oldTShift[i],state.sCount[i+startLine]=oldSCount[i],state.bsCount[i+startLine]=oldBSCount[i];return state.blkIndent=oldIndent,!0},["paragraph","reference","blockquote","list"]],["hr",function hr(state,startLine,endLine,silent){var marker,cnt,ch,token,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(42!==(marker=state.src.charCodeAt(pos++))&&45!==marker&&95!==marker)return!1;for(cnt=1;pos<max;){if((ch=state.src.charCodeAt(pos++))!==marker&&!isSpace$8(ch))return!1;ch===marker&&cnt++}return!(cnt<3)&&(silent||(state.line=startLine+1,(token=state.push("hr","hr",0)).map=[startLine,state.line],token.markup=Array(cnt+1).join(String.fromCharCode(marker))),!0)},["paragraph","reference","blockquote","list"]],["list",function list(state,startLine,endLine,silent){var ch,contentStart,i,indent,indentAfterMarker,initial,isOrdered,itemLines,l,listLines,listTokIdx,markerCharCode,markerValue,max,nextLine,offset,oldListIndent,oldParentType,oldSCount,oldTShift,oldTight,pos,posAfterMarker,prevEmptyEnd,start,terminate,terminatorRules,token,isTerminatingParagraph=!1,tight=!0;if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(state.listIndent>=0&&state.sCount[startLine]-state.listIndent>=4&&state.sCount[startLine]<state.blkIndent)return!1;if(silent&&"paragraph"===state.parentType&&state.sCount[startLine]>=state.blkIndent&&(isTerminatingParagraph=!0),(posAfterMarker=skipOrderedListMarker(state,startLine))>=0){if(isOrdered=!0,start=state.bMarks[startLine]+state.tShift[startLine],markerValue=Number(state.src.slice(start,posAfterMarker-1)),isTerminatingParagraph&&1!==markerValue)return!1}else{if(!((posAfterMarker=skipBulletListMarker(state,startLine))>=0))return!1;isOrdered=!1}if(isTerminatingParagraph&&state.skipSpaces(posAfterMarker)>=state.eMarks[startLine])return!1;if(markerCharCode=state.src.charCodeAt(posAfterMarker-1),silent)return!0;for(listTokIdx=state.tokens.length,isOrdered?(token=state.push("ordered_list_open","ol",1),1!==markerValue&&(token.attrs=[["start",markerValue]])):token=state.push("bullet_list_open","ul",1),token.map=listLines=[startLine,0],token.markup=String.fromCharCode(markerCharCode),nextLine=startLine,prevEmptyEnd=!1,terminatorRules=state.md.block.ruler.getRules("list"),oldParentType=state.parentType,state.parentType="list";nextLine<endLine;){for(pos=posAfterMarker,max=state.eMarks[nextLine],initial=offset=state.sCount[nextLine]+posAfterMarker-(state.bMarks[startLine]+state.tShift[startLine]);pos<max;){if(9===(ch=state.src.charCodeAt(pos)))offset+=4-(offset+state.bsCount[nextLine])%4;else{if(32!==ch)break;offset++}pos++}if((indentAfterMarker=(contentStart=pos)>=max?1:offset-initial)>4&&(indentAfterMarker=1),indent=initial+indentAfterMarker,(token=state.push("list_item_open","li",1)).markup=String.fromCharCode(markerCharCode),token.map=itemLines=[startLine,0],isOrdered&&(token.info=state.src.slice(start,posAfterMarker-1)),oldTight=state.tight,oldTShift=state.tShift[startLine],oldSCount=state.sCount[startLine],oldListIndent=state.listIndent,state.listIndent=state.blkIndent,state.blkIndent=indent,state.tight=!0,state.tShift[startLine]=contentStart-state.bMarks[startLine],state.sCount[startLine]=offset,contentStart>=max&&state.isEmpty(startLine+1)?state.line=Math.min(state.line+2,endLine):state.md.block.tokenize(state,startLine,endLine,!0),state.tight&&!prevEmptyEnd||(tight=!1),prevEmptyEnd=state.line-startLine>1&&state.isEmpty(state.line-1),state.blkIndent=state.listIndent,state.listIndent=oldListIndent,state.tShift[startLine]=oldTShift,state.sCount[startLine]=oldSCount,state.tight=oldTight,(token=state.push("list_item_close","li",-1)).markup=String.fromCharCode(markerCharCode),nextLine=startLine=state.line,itemLines[1]=nextLine,contentStart=state.bMarks[startLine],nextLine>=endLine)break;if(state.sCount[nextLine]<state.blkIndent)break;if(state.sCount[startLine]-state.blkIndent>=4)break;for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break;if(isOrdered){if((posAfterMarker=skipOrderedListMarker(state,nextLine))<0)break;start=state.bMarks[nextLine]+state.tShift[nextLine]}else if((posAfterMarker=skipBulletListMarker(state,nextLine))<0)break;if(markerCharCode!==state.src.charCodeAt(posAfterMarker-1))break}return(token=isOrdered?state.push("ordered_list_close","ol",-1):state.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(markerCharCode),listLines[1]=nextLine,state.line=nextLine,state.parentType=oldParentType,tight&&function markTightParagraphs(state,idx){var i,l,level=state.level+2;for(i=idx+2,l=state.tokens.length-2;i<l;i++)state.tokens[i].level===level&&"paragraph_open"===state.tokens[i].type&&(state.tokens[i+2].hidden=!0,state.tokens[i].hidden=!0,i+=2)}(state,listTokIdx),!0},["paragraph","reference","blockquote"]],["reference",function reference(state,startLine,_endLine,silent){var ch,destEndPos,destEndLineNo,endLine,href,i,l,label,labelEnd,oldParentType,res,start,str,terminate,terminatorRules,title,lines=0,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine],nextLine=startLine+1;if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(91!==state.src.charCodeAt(pos))return!1;for(;++pos<max;)if(93===state.src.charCodeAt(pos)&&92!==state.src.charCodeAt(pos-1)){if(pos+1===max)return!1;if(58!==state.src.charCodeAt(pos+1))return!1;break}for(endLine=state.lineMax,terminatorRules=state.md.block.ruler.getRules("reference"),oldParentType=state.parentType,state.parentType="reference";nextLine<endLine&&!state.isEmpty(nextLine);nextLine++)if(!(state.sCount[nextLine]-state.blkIndent>3||state.sCount[nextLine]<0)){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break}for(max=(str=state.getLines(startLine,nextLine,state.blkIndent,!1).trim()).length,pos=1;pos<max;pos++){if(91===(ch=str.charCodeAt(pos)))return!1;if(93===ch){labelEnd=pos;break}(10===ch||92===ch&&++pos<max&&10===str.charCodeAt(pos))&&lines++}if(labelEnd<0||58!==str.charCodeAt(labelEnd+1))return!1;for(pos=labelEnd+2;pos<max;pos++)if(10===(ch=str.charCodeAt(pos)))lines++;else if(!isSpace$6(ch))break;if(!(res=state.md.helpers.parseLinkDestination(str,pos,max)).ok)return!1;if(href=state.md.normalizeLink(res.str),!state.md.validateLink(href))return!1;for(destEndPos=pos=res.pos,destEndLineNo=lines+=res.lines,start=pos;pos<max;pos++)if(10===(ch=str.charCodeAt(pos)))lines++;else if(!isSpace$6(ch))break;for(res=state.md.helpers.parseLinkTitle(str,pos,max),pos<max&&start!==pos&&res.ok?(title=res.str,pos=res.pos,lines+=res.lines):(title="",pos=destEndPos,lines=destEndLineNo);pos<max&&(ch=str.charCodeAt(pos),isSpace$6(ch));)pos++;if(pos<max&&10!==str.charCodeAt(pos)&&title)for(title="",pos=destEndPos,lines=destEndLineNo;pos<max&&(ch=str.charCodeAt(pos),isSpace$6(ch));)pos++;return!(pos<max&&10!==str.charCodeAt(pos))&&(!!(label=normalizeReference$2(str.slice(1,labelEnd)))&&(silent||(void 0===state.env.references&&(state.env.references={}),void 0===state.env.references[label]&&(state.env.references[label]={title,href}),state.parentType=oldParentType,state.line=startLine+lines+1),!0))}],["html_block",function html_block(state,startLine,endLine,silent){var i,nextLine,token,lineText,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(!state.md.options.html)return!1;if(60!==state.src.charCodeAt(pos))return!1;for(lineText=state.src.slice(pos,max),i=0;i<HTML_SEQUENCES.length&&!HTML_SEQUENCES[i][0].test(lineText);i++);if(i===HTML_SEQUENCES.length)return!1;if(silent)return HTML_SEQUENCES[i][2];if(nextLine=startLine+1,!HTML_SEQUENCES[i][1].test(lineText))for(;nextLine<endLine&&!(state.sCount[nextLine]<state.blkIndent);nextLine++)if(pos=state.bMarks[nextLine]+state.tShift[nextLine],max=state.eMarks[nextLine],lineText=state.src.slice(pos,max),HTML_SEQUENCES[i][1].test(lineText)){0!==lineText.length&&nextLine++;break}return state.line=nextLine,(token=state.push("html_block","",0)).map=[startLine,nextLine],token.content=state.getLines(startLine,nextLine,state.blkIndent,!0),!0},["paragraph","reference","blockquote"]],["heading",function heading(state,startLine,endLine,silent){var ch,level,tmp,token,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(state.sCount[startLine]-state.blkIndent>=4)return!1;if(35!==(ch=state.src.charCodeAt(pos))||pos>=max)return!1;for(level=1,ch=state.src.charCodeAt(++pos);35===ch&&pos<max&&level<=6;)level++,ch=state.src.charCodeAt(++pos);return!(level>6||pos<max&&!isSpace$5(ch))&&(silent||(max=state.skipSpacesBack(max,pos),(tmp=state.skipCharsBack(max,35,pos))>pos&&isSpace$5(state.src.charCodeAt(tmp-1))&&(max=tmp),state.line=startLine+1,(token=state.push("heading_open","h"+String(level),1)).markup="########".slice(0,level),token.map=[startLine,state.line],(token=state.push("inline","",0)).content=state.src.slice(pos,max).trim(),token.map=[startLine,state.line],token.children=[],(token=state.push("heading_close","h"+String(level),-1)).markup="########".slice(0,level)),!0)},["paragraph","reference","blockquote"]],["lheading",function lheading(state,startLine,endLine){var content,terminate,i,l,token,pos,max,level,marker,oldParentType,nextLine=startLine+1,terminatorRules=state.md.block.ruler.getRules("paragraph");if(state.sCount[startLine]-state.blkIndent>=4)return!1;for(oldParentType=state.parentType,state.parentType="paragraph";nextLine<endLine&&!state.isEmpty(nextLine);nextLine++)if(!(state.sCount[nextLine]-state.blkIndent>3)){if(state.sCount[nextLine]>=state.blkIndent&&(pos=state.bMarks[nextLine]+state.tShift[nextLine])<(max=state.eMarks[nextLine])&&(45===(marker=state.src.charCodeAt(pos))||61===marker)&&(pos=state.skipChars(pos,marker),(pos=state.skipSpaces(pos))>=max)){level=61===marker?1:2;break}if(!(state.sCount[nextLine]<0)){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break}}return!!level&&(content=state.getLines(startLine,nextLine,state.blkIndent,!1).trim(),state.line=nextLine+1,(token=state.push("heading_open","h"+String(level),1)).markup=String.fromCharCode(marker),token.map=[startLine,state.line],(token=state.push("inline","",0)).content=content,token.map=[startLine,state.line-1],token.children=[],(token=state.push("heading_close","h"+String(level),-1)).markup=String.fromCharCode(marker),state.parentType=oldParentType,!0)}],["paragraph",function paragraph(state,startLine){var content,terminate,i,l,token,oldParentType,nextLine=startLine+1,terminatorRules=state.md.block.ruler.getRules("paragraph"),endLine=state.lineMax;for(oldParentType=state.parentType,state.parentType="paragraph";nextLine<endLine&&!state.isEmpty(nextLine);nextLine++)if(!(state.sCount[nextLine]-state.blkIndent>3||state.sCount[nextLine]<0)){for(terminate=!1,i=0,l=terminatorRules.length;i<l;i++)if(terminatorRules[i](state,nextLine,endLine,!0)){terminate=!0;break}if(terminate)break}return content=state.getLines(startLine,nextLine,state.blkIndent,!1).trim(),state.line=nextLine,(token=state.push("paragraph_open","p",1)).map=[startLine,state.line],(token=state.push("inline","",0)).content=content,token.map=[startLine,state.line],token.children=[],token=state.push("paragraph_close","p",-1),state.parentType=oldParentType,!0}]];function ParserBlock(){this.ruler=new ruler;for(var i=0;i<_rules$1.length;i++)this.ruler.push(_rules$1[i][0],_rules$1[i][1],{alt:(_rules$1[i][2]||[]).slice()})}ParserBlock.prototype.tokenize=function(state,startLine,endLine){for(var i,rules=this.ruler.getRules(""),len=rules.length,line=startLine,hasEmptyLines=!1,maxNesting=state.md.options.maxNesting;line<endLine&&(state.line=line=state.skipEmptyLines(line),!(line>=endLine))&&!(state.sCount[line]<state.blkIndent);){if(state.level>=maxNesting){state.line=endLine;break}for(i=0;i<len&&!rules[i](state,line,endLine,!1);i++);state.tight=!hasEmptyLines,state.isEmpty(state.line-1)&&(hasEmptyLines=!0),(line=state.line)<endLine&&state.isEmpty(line)&&(hasEmptyLines=!0,line++,state.line=line)}},ParserBlock.prototype.parse=function(src,md,env,outTokens){var state;src&&(state=new this.State(src,md,env,outTokens),this.tokenize(state,state.line,state.lineMax))},ParserBlock.prototype.State=state_block;var parser_block=ParserBlock;function isTerminatorChar(ch){switch(ch){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}for(var isSpace$3=utils.isSpace,isSpace$2=utils.isSpace,ESCAPED=[],i=0;i<256;i++)ESCAPED.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(ch){ESCAPED[ch.charCodeAt(0)]=1}));function postProcess$1(state,delimiters){var i,j,startDelim,endDelim,token,loneMarkers=[],max=delimiters.length;for(i=0;i<max;i++)126===(startDelim=delimiters[i]).marker&&-1!==startDelim.end&&(endDelim=delimiters[startDelim.end],(token=state.tokens[startDelim.token]).type="s_open",token.tag="s",token.nesting=1,token.markup="~~",token.content="",(token=state.tokens[endDelim.token]).type="s_close",token.tag="s",token.nesting=-1,token.markup="~~",token.content="","text"===state.tokens[endDelim.token-1].type&&"~"===state.tokens[endDelim.token-1].content&&loneMarkers.push(endDelim.token-1));for(;loneMarkers.length;){for(j=(i=loneMarkers.pop())+1;j<state.tokens.length&&"s_close"===state.tokens[j].type;)j++;i!==--j&&(token=state.tokens[j],state.tokens[j]=state.tokens[i],state.tokens[i]=token)}}var strikethrough={tokenize:function strikethrough(state,silent){var i,scanned,len,ch,start=state.pos,marker=state.src.charCodeAt(start);if(silent)return!1;if(126!==marker)return!1;if(len=(scanned=state.scanDelims(state.pos,!0)).length,ch=String.fromCharCode(marker),len<2)return!1;for(len%2&&(state.push("text","",0).content=ch,len--),i=0;i<len;i+=2)state.push("text","",0).content=ch+ch,state.delimiters.push({marker,length:0,token:state.tokens.length-1,end:-1,open:scanned.can_open,close:scanned.can_close});return state.pos+=scanned.length,!0},postProcess:function strikethrough(state){var curr,tokens_meta=state.tokens_meta,max=state.tokens_meta.length;for(postProcess$1(state,state.delimiters),curr=0;curr<max;curr++)tokens_meta[curr]&&tokens_meta[curr].delimiters&&postProcess$1(state,tokens_meta[curr].delimiters)}};function postProcess(state,delimiters){var i,startDelim,endDelim,token,ch,isStrong;for(i=delimiters.length-1;i>=0;i--)95!==(startDelim=delimiters[i]).marker&&42!==startDelim.marker||-1!==startDelim.end&&(endDelim=delimiters[startDelim.end],isStrong=i>0&&delimiters[i-1].end===startDelim.end+1&&delimiters[i-1].marker===startDelim.marker&&delimiters[i-1].token===startDelim.token-1&&delimiters[startDelim.end+1].token===endDelim.token+1,ch=String.fromCharCode(startDelim.marker),(token=state.tokens[startDelim.token]).type=isStrong?"strong_open":"em_open",token.tag=isStrong?"strong":"em",token.nesting=1,token.markup=isStrong?ch+ch:ch,token.content="",(token=state.tokens[endDelim.token]).type=isStrong?"strong_close":"em_close",token.tag=isStrong?"strong":"em",token.nesting=-1,token.markup=isStrong?ch+ch:ch,token.content="",isStrong&&(state.tokens[delimiters[i-1].token].content="",state.tokens[delimiters[startDelim.end+1].token].content="",i--))}var emphasis={tokenize:function emphasis(state,silent){var i,scanned,start=state.pos,marker=state.src.charCodeAt(start);if(silent)return!1;if(95!==marker&&42!==marker)return!1;for(scanned=state.scanDelims(state.pos,42===marker),i=0;i<scanned.length;i++)state.push("text","",0).content=String.fromCharCode(marker),state.delimiters.push({marker,length:scanned.length,token:state.tokens.length-1,end:-1,open:scanned.can_open,close:scanned.can_close});return state.pos+=scanned.length,!0},postProcess:function emphasis(state){var curr,tokens_meta=state.tokens_meta,max=state.tokens_meta.length;for(postProcess(state,state.delimiters),curr=0;curr<max;curr++)tokens_meta[curr]&&tokens_meta[curr].delimiters&&postProcess(state,tokens_meta[curr].delimiters)}},normalizeReference$1=utils.normalizeReference,isSpace$1=utils.isSpace,normalizeReference=utils.normalizeReference,isSpace=utils.isSpace,EMAIL_RE=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,AUTOLINK_RE=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/,HTML_TAG_RE=html_re.HTML_TAG_RE;var has=utils.has,isValidEntityCode=utils.isValidEntityCode,fromCodePoint=utils.fromCodePoint,DIGITAL_RE=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,NAMED_RE=/^&([a-z][a-z0-9]{1,31});/i;function processDelimiters(state,delimiters){var closerIdx,openerIdx,closer,opener,minOpenerIdx,newMinOpenerIdx,isOddMatch,lastJump,openersBottom={},max=delimiters.length;if(max){var headerIdx=0,lastTokenIdx=-2,jumps=[];for(closerIdx=0;closerIdx<max;closerIdx++)if(closer=delimiters[closerIdx],jumps.push(0),delimiters[headerIdx].marker===closer.marker&&lastTokenIdx===closer.token-1||(headerIdx=closerIdx),lastTokenIdx=closer.token,closer.length=closer.length||0,closer.close){for(openersBottom.hasOwnProperty(closer.marker)||(openersBottom[closer.marker]=[-1,-1,-1,-1,-1,-1]),minOpenerIdx=openersBottom[closer.marker][(closer.open?3:0)+closer.length%3],newMinOpenerIdx=openerIdx=headerIdx-jumps[headerIdx]-1;openerIdx>minOpenerIdx;openerIdx-=jumps[openerIdx]+1)if((opener=delimiters[openerIdx]).marker===closer.marker&&opener.open&&opener.end<0&&(isOddMatch=!1,(opener.close||closer.open)&&(opener.length+closer.length)%3==0&&(opener.length%3==0&&closer.length%3==0||(isOddMatch=!0)),!isOddMatch)){lastJump=openerIdx>0&&!delimiters[openerIdx-1].open?jumps[openerIdx-1]+1:0,jumps[closerIdx]=closerIdx-openerIdx+lastJump,jumps[openerIdx]=lastJump,closer.open=!1,opener.end=closerIdx,opener.close=!1,newMinOpenerIdx=-1,lastTokenIdx=-2;break}-1!==newMinOpenerIdx&&(openersBottom[closer.marker][(closer.open?3:0)+(closer.length||0)%3]=newMinOpenerIdx)}}}var isWhiteSpace=utils.isWhiteSpace,isPunctChar=utils.isPunctChar,isMdAsciiPunct=utils.isMdAsciiPunct;function StateInline(src,md,env,outTokens){this.src=src,this.env=env,this.md=md,this.tokens=outTokens,this.tokens_meta=Array(outTokens.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1}StateInline.prototype.pushPending=function(){var token$1=new token("text","",0);return token$1.content=this.pending,token$1.level=this.pendingLevel,this.tokens.push(token$1),this.pending="",token$1},StateInline.prototype.push=function(type,tag,nesting){this.pending&&this.pushPending();var token$1=new token(type,tag,nesting),token_meta=null;return nesting<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),token$1.level=this.level,nesting>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],token_meta={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(token$1),this.tokens_meta.push(token_meta),token$1},StateInline.prototype.scanDelims=function(start,canSplitWord){var lastChar,nextChar,count,can_open,can_close,isLastWhiteSpace,isLastPunctChar,isNextWhiteSpace,isNextPunctChar,pos=start,left_flanking=!0,right_flanking=!0,max=this.posMax,marker=this.src.charCodeAt(start);for(lastChar=start>0?this.src.charCodeAt(start-1):32;pos<max&&this.src.charCodeAt(pos)===marker;)pos++;return count=pos-start,nextChar=pos<max?this.src.charCodeAt(pos):32,isLastPunctChar=isMdAsciiPunct(lastChar)||isPunctChar(String.fromCharCode(lastChar)),isNextPunctChar=isMdAsciiPunct(nextChar)||isPunctChar(String.fromCharCode(nextChar)),isLastWhiteSpace=isWhiteSpace(lastChar),(isNextWhiteSpace=isWhiteSpace(nextChar))?left_flanking=!1:isNextPunctChar&&(isLastWhiteSpace||isLastPunctChar||(left_flanking=!1)),isLastWhiteSpace?right_flanking=!1:isLastPunctChar&&(isNextWhiteSpace||isNextPunctChar||(right_flanking=!1)),canSplitWord?(can_open=left_flanking,can_close=right_flanking):(can_open=left_flanking&&(!right_flanking||isLastPunctChar),can_close=right_flanking&&(!left_flanking||isNextPunctChar)),{can_open,can_close,length:count}},StateInline.prototype.Token=token;var state_inline=StateInline,_rules=[["text",function text(state,silent){for(var pos=state.pos;pos<state.posMax&&!isTerminatorChar(state.src.charCodeAt(pos));)pos++;return pos!==state.pos&&(silent||(state.pending+=state.src.slice(state.pos,pos)),state.pos=pos,!0)}],["newline",function newline(state,silent){var pmax,max,ws,pos=state.pos;if(10!==state.src.charCodeAt(pos))return!1;if(pmax=state.pending.length-1,max=state.posMax,!silent)if(pmax>=0&&32===state.pending.charCodeAt(pmax))if(pmax>=1&&32===state.pending.charCodeAt(pmax-1)){for(ws=pmax-1;ws>=1&&32===state.pending.charCodeAt(ws-1);)ws--;state.pending=state.pending.slice(0,ws),state.push("hardbreak","br",0)}else state.pending=state.pending.slice(0,-1),state.push("softbreak","br",0);else state.push("softbreak","br",0);for(pos++;pos<max&&isSpace$3(state.src.charCodeAt(pos));)pos++;return state.pos=pos,!0}],["escape",function escape(state,silent){var ch,pos=state.pos,max=state.posMax;if(92!==state.src.charCodeAt(pos))return!1;if(++pos<max){if((ch=state.src.charCodeAt(pos))<256&&0!==ESCAPED[ch])return silent||(state.pending+=state.src[pos]),state.pos+=2,!0;if(10===ch){for(silent||state.push("hardbreak","br",0),pos++;pos<max&&(ch=state.src.charCodeAt(pos),isSpace$2(ch));)pos++;return state.pos=pos,!0}}return silent||(state.pending+="\\"),state.pos++,!0}],["backticks",function backtick(state,silent){var start,max,marker,token,matchStart,matchEnd,openerLength,closerLength,pos=state.pos;if(96!==state.src.charCodeAt(pos))return!1;for(start=pos,pos++,max=state.posMax;pos<max&&96===state.src.charCodeAt(pos);)pos++;if(openerLength=(marker=state.src.slice(start,pos)).length,state.backticksScanned&&(state.backticks[openerLength]||0)<=start)return silent||(state.pending+=marker),state.pos+=openerLength,!0;for(matchStart=matchEnd=pos;-1!==(matchStart=state.src.indexOf("`",matchEnd));){for(matchEnd=matchStart+1;matchEnd<max&&96===state.src.charCodeAt(matchEnd);)matchEnd++;if((closerLength=matchEnd-matchStart)===openerLength)return silent||((token=state.push("code_inline","code",0)).markup=marker,token.content=state.src.slice(pos,matchStart).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),state.pos=matchEnd,!0;state.backticks[closerLength]=matchStart}return state.backticksScanned=!0,silent||(state.pending+=marker),state.pos+=openerLength,!0}],["strikethrough",strikethrough.tokenize],["emphasis",emphasis.tokenize],["link",function link(state,silent){var attrs,code,label,labelEnd,labelStart,pos,res,ref,href="",title="",oldPos=state.pos,max=state.posMax,start=state.pos,parseReference=!0;if(91!==state.src.charCodeAt(state.pos))return!1;if(labelStart=state.pos+1,(labelEnd=state.md.helpers.parseLinkLabel(state,state.pos,!0))<0)return!1;if((pos=labelEnd+1)<max&&40===state.src.charCodeAt(pos)){for(parseReference=!1,pos++;pos<max&&(code=state.src.charCodeAt(pos),isSpace$1(code)||10===code);pos++);if(pos>=max)return!1;if(start=pos,(res=state.md.helpers.parseLinkDestination(state.src,pos,state.posMax)).ok){for(href=state.md.normalizeLink(res.str),state.md.validateLink(href)?pos=res.pos:href="",start=pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace$1(code)||10===code);pos++);if(res=state.md.helpers.parseLinkTitle(state.src,pos,state.posMax),pos<max&&start!==pos&&res.ok)for(title=res.str,pos=res.pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace$1(code)||10===code);pos++);}(pos>=max||41!==state.src.charCodeAt(pos))&&(parseReference=!0),pos++}if(parseReference){if(void 0===state.env.references)return!1;if(pos<max&&91===state.src.charCodeAt(pos)?(start=pos+1,(pos=state.md.helpers.parseLinkLabel(state,pos))>=0?label=state.src.slice(start,pos++):pos=labelEnd+1):pos=labelEnd+1,label||(label=state.src.slice(labelStart,labelEnd)),!(ref=state.env.references[normalizeReference$1(label)]))return state.pos=oldPos,!1;href=ref.href,title=ref.title}return silent||(state.pos=labelStart,state.posMax=labelEnd,state.push("link_open","a",1).attrs=attrs=[["href",href]],title&&attrs.push(["title",title]),state.md.inline.tokenize(state),state.push("link_close","a",-1)),state.pos=pos,state.posMax=max,!0}],["image",function image(state,silent){var attrs,code,content,label,labelEnd,labelStart,pos,ref,res,title,token,tokens,start,href="",oldPos=state.pos,max=state.posMax;if(33!==state.src.charCodeAt(state.pos))return!1;if(91!==state.src.charCodeAt(state.pos+1))return!1;if(labelStart=state.pos+2,(labelEnd=state.md.helpers.parseLinkLabel(state,state.pos+1,!1))<0)return!1;if((pos=labelEnd+1)<max&&40===state.src.charCodeAt(pos)){for(pos++;pos<max&&(code=state.src.charCodeAt(pos),isSpace(code)||10===code);pos++);if(pos>=max)return!1;for(start=pos,(res=state.md.helpers.parseLinkDestination(state.src,pos,state.posMax)).ok&&(href=state.md.normalizeLink(res.str),state.md.validateLink(href)?pos=res.pos:href=""),start=pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace(code)||10===code);pos++);if(res=state.md.helpers.parseLinkTitle(state.src,pos,state.posMax),pos<max&&start!==pos&&res.ok)for(title=res.str,pos=res.pos;pos<max&&(code=state.src.charCodeAt(pos),isSpace(code)||10===code);pos++);else title="";if(pos>=max||41!==state.src.charCodeAt(pos))return state.pos=oldPos,!1;pos++}else{if(void 0===state.env.references)return!1;if(pos<max&&91===state.src.charCodeAt(pos)?(start=pos+1,(pos=state.md.helpers.parseLinkLabel(state,pos))>=0?label=state.src.slice(start,pos++):pos=labelEnd+1):pos=labelEnd+1,label||(label=state.src.slice(labelStart,labelEnd)),!(ref=state.env.references[normalizeReference(label)]))return state.pos=oldPos,!1;href=ref.href,title=ref.title}return silent||(content=state.src.slice(labelStart,labelEnd),state.md.inline.parse(content,state.md,state.env,tokens=[]),(token=state.push("image","img",0)).attrs=attrs=[["src",href],["alt",""]],token.children=tokens,token.content=content,title&&attrs.push(["title",title])),state.pos=pos,state.posMax=max,!0}],["autolink",function autolink(state,silent){var url,fullUrl,token,ch,start,max,pos=state.pos;if(60!==state.src.charCodeAt(pos))return!1;for(start=state.pos,max=state.posMax;;){if(++pos>=max)return!1;if(60===(ch=state.src.charCodeAt(pos)))return!1;if(62===ch)break}return url=state.src.slice(start+1,pos),AUTOLINK_RE.test(url)?(fullUrl=state.md.normalizeLink(url),!!state.md.validateLink(fullUrl)&&(silent||((token=state.push("link_open","a",1)).attrs=[["href",fullUrl]],token.markup="autolink",token.info="auto",(token=state.push("text","",0)).content=state.md.normalizeLinkText(url),(token=state.push("link_close","a",-1)).markup="autolink",token.info="auto"),state.pos+=url.length+2,!0)):!!EMAIL_RE.test(url)&&(fullUrl=state.md.normalizeLink("mailto:"+url),!!state.md.validateLink(fullUrl)&&(silent||((token=state.push("link_open","a",1)).attrs=[["href",fullUrl]],token.markup="autolink",token.info="auto",(token=state.push("text","",0)).content=state.md.normalizeLinkText(url),(token=state.push("link_close","a",-1)).markup="autolink",token.info="auto"),state.pos+=url.length+2,!0))}],["html_inline",function html_inline(state,silent){var ch,match,max,pos=state.pos;return!!state.md.options.html&&(max=state.posMax,!(60!==state.src.charCodeAt(pos)||pos+2>=max)&&(!(33!==(ch=state.src.charCodeAt(pos+1))&&63!==ch&&47!==ch&&!function isLetter(ch){var lc=32|ch;return lc>=97&&lc<=122}(ch))&&(!!(match=state.src.slice(pos).match(HTML_TAG_RE))&&(silent||(state.push("html_inline","",0).content=state.src.slice(pos,pos+match[0].length)),state.pos+=match[0].length,!0))))}],["entity",function entity(state,silent){var code,match,pos=state.pos,max=state.posMax;if(38!==state.src.charCodeAt(pos))return!1;if(pos+1<max)if(35===state.src.charCodeAt(pos+1)){if(match=state.src.slice(pos).match(DIGITAL_RE))return silent||(code="x"===match[1][0].toLowerCase()?parseInt(match[1].slice(1),16):parseInt(match[1],10),state.pending+=isValidEntityCode(code)?fromCodePoint(code):fromCodePoint(65533)),state.pos+=match[0].length,!0}else if((match=state.src.slice(pos).match(NAMED_RE))&&has(entities,match[1]))return silent||(state.pending+=entities[match[1]]),state.pos+=match[0].length,!0;return silent||(state.pending+="&"),state.pos++,!0}]],_rules2=[["balance_pairs",function link_pairs(state){var curr,tokens_meta=state.tokens_meta,max=state.tokens_meta.length;for(processDelimiters(0,state.delimiters),curr=0;curr<max;curr++)tokens_meta[curr]&&tokens_meta[curr].delimiters&&processDelimiters(0,tokens_meta[curr].delimiters)}],["strikethrough",strikethrough.postProcess],["emphasis",emphasis.postProcess],["text_collapse",function text_collapse(state){var curr,last,level=0,tokens=state.tokens,max=state.tokens.length;for(curr=last=0;curr<max;curr++)tokens[curr].nesting<0&&level--,tokens[curr].level=level,tokens[curr].nesting>0&&level++,"text"===tokens[curr].type&&curr+1<max&&"text"===tokens[curr+1].type?tokens[curr+1].content=tokens[curr].content+tokens[curr+1].content:(curr!==last&&(tokens[last]=tokens[curr]),last++);curr!==last&&(tokens.length=last)}]];function ParserInline(){var i;for(this.ruler=new ruler,i=0;i<_rules.length;i++)this.ruler.push(_rules[i][0],_rules[i][1]);for(this.ruler2=new ruler,i=0;i<_rules2.length;i++)this.ruler2.push(_rules2[i][0],_rules2[i][1])}ParserInline.prototype.skipToken=function(state){var ok,i,pos=state.pos,rules=this.ruler.getRules(""),len=rules.length,maxNesting=state.md.options.maxNesting,cache=state.cache;if(void 0===cache[pos]){if(state.level<maxNesting)for(i=0;i<len&&(state.level++,ok=rules[i](state,!0),state.level--,!ok);i++);else state.pos=state.posMax;ok||state.pos++,cache[pos]=state.pos}else state.pos=cache[pos]},ParserInline.prototype.tokenize=function(state){for(var ok,i,rules=this.ruler.getRules(""),len=rules.length,end=state.posMax,maxNesting=state.md.options.maxNesting;state.pos<end;){if(state.level<maxNesting)for(i=0;i<len&&!(ok=rules[i](state,!1));i++);if(ok){if(state.pos>=end)break}else state.pending+=state.src[state.pos++]}state.pending&&state.pushPending()},ParserInline.prototype.parse=function(str,md,env,outTokens){var i,rules,len,state=new this.State(str,md,env,outTokens);for(this.tokenize(state),len=(rules=this.ruler2.getRules("")).length,i=0;i<len;i++)rules[i](state)},ParserInline.prototype.State=state_inline;var parser_inline=ParserInline;function assign(obj){var sources=Array.prototype.slice.call(arguments,1);return sources.forEach((function(source){source&&Object.keys(source).forEach((function(key){obj[key]=source[key]}))})),obj}function _class(obj){return Object.prototype.toString.call(obj)}function isFunction(obj){return"[object Function]"===_class(obj)}function escapeRE(str){return str.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var defaultOptions={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var defaultSchemas={"http:":{validate:function validate(text,pos,self){var tail=text.slice(pos);return self.re.http||(self.re.http=new RegExp("^\\/\\/"+self.re.src_auth+self.re.src_host_port_strict+self.re.src_path,"i")),self.re.http.test(tail)?tail.match(self.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function validate(text,pos,self){var tail=text.slice(pos);return self.re.no_http||(self.re.no_http=new RegExp("^"+self.re.src_auth+"(?:localhost|(?:(?:"+self.re.src_domain+")\\.)+"+self.re.src_domain_root+")"+self.re.src_port+self.re.src_host_terminator+self.re.src_path,"i")),self.re.no_http.test(tail)?pos>=3&&":"===text[pos-3]||pos>=3&&"/"===text[pos-3]?0:tail.match(self.re.no_http)[0].length:0}},"mailto:":{validate:function validate(text,pos,self){var tail=text.slice(pos);return self.re.mailto||(self.re.mailto=new RegExp("^"+self.re.src_email_name+"@"+self.re.src_host_strict,"i")),self.re.mailto.test(tail)?tail.match(self.re.mailto)[0].length:0}}},tlds_default="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function compile(self){var re$1=self.re=function re(opts){var re={};return re.src_Any=regex$3.source,re.src_Cc=regex$2.source,re.src_Z=regex.source,re.src_P=regex$4.source,re.src_ZPCc=[re.src_Z,re.src_P,re.src_Cc].join("|"),re.src_ZCc=[re.src_Z,re.src_Cc].join("|"),re.src_pseudo_letter="(?:(?![><]|"+re.src_ZPCc+")"+re.src_Any+")",re.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",re.src_auth="(?:(?:(?!"+re.src_ZCc+"|[@/\\[\\]()]).)+@)?",re.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",re.src_host_terminator="(?=$|[><]|"+re.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+re.src_ZPCc+"))",re.src_path="(?:[/?#](?:(?!"+re.src_ZCc+"|[><]|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+re.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+re.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+re.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+re.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+re.src_ZCc+"|[']).)+\\'|\\'(?="+re.src_pseudo_letter+"|[-]).|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+re.src_ZCc+"|[.]).|"+(opts&&opts["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+re.src_ZCc+").|;(?!"+re.src_ZCc+").|\\!+(?!"+re.src_ZCc+"|[!]).|\\?(?!"+re.src_ZCc+"|[?]).)+|\\/)?",re.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',re.src_xn="xn--[a-z0-9\\-]{1,59}",re.src_domain_root="(?:"+re.src_xn+"|"+re.src_pseudo_letter+"{1,63})",re.src_domain="(?:"+re.src_xn+"|(?:"+re.src_pseudo_letter+")|(?:"+re.src_pseudo_letter+"(?:-|"+re.src_pseudo_letter+"){0,61}"+re.src_pseudo_letter+"))",re.src_host="(?:(?:(?:(?:"+re.src_domain+")\\.)*"+re.src_domain+"))",re.tpl_host_fuzzy="(?:"+re.src_ip4+"|(?:(?:(?:"+re.src_domain+")\\.)+(?:%TLDS%)))",re.tpl_host_no_ip_fuzzy="(?:(?:(?:"+re.src_domain+")\\.)+(?:%TLDS%))",re.src_host_strict=re.src_host+re.src_host_terminator,re.tpl_host_fuzzy_strict=re.tpl_host_fuzzy+re.src_host_terminator,re.src_host_port_strict=re.src_host+re.src_port+re.src_host_terminator,re.tpl_host_port_fuzzy_strict=re.tpl_host_fuzzy+re.src_port+re.src_host_terminator,re.tpl_host_port_no_ip_fuzzy_strict=re.tpl_host_no_ip_fuzzy+re.src_port+re.src_host_terminator,re.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+re.src_ZPCc+"|>|$))",re.tpl_email_fuzzy='(^|[><]|"|\\(|'+re.src_ZCc+")("+re.src_email_name+"@"+re.tpl_host_fuzzy_strict+")",re.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+re.src_ZPCc+"))((?![$+<=>^`|])"+re.tpl_host_port_fuzzy_strict+re.src_path+")",re.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+re.src_ZPCc+"))((?![$+<=>^`|])"+re.tpl_host_port_no_ip_fuzzy_strict+re.src_path+")",re}(self.__opts__),tlds=self.__tlds__.slice();function untpl(tpl){return tpl.replace("%TLDS%",re$1.src_tlds)}self.onCompile(),self.__tlds_replaced__||tlds.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),tlds.push(re$1.src_xn),re$1.src_tlds=tlds.join("|"),re$1.email_fuzzy=RegExp(untpl(re$1.tpl_email_fuzzy),"i"),re$1.link_fuzzy=RegExp(untpl(re$1.tpl_link_fuzzy),"i"),re$1.link_no_ip_fuzzy=RegExp(untpl(re$1.tpl_link_no_ip_fuzzy),"i"),re$1.host_fuzzy_test=RegExp(untpl(re$1.tpl_host_fuzzy_test),"i");var aliases=[];function schemaError(name,val){throw new Error('(LinkifyIt) Invalid schema "'+name+'": '+val)}self.__compiled__={},Object.keys(self.__schemas__).forEach((function(name){var val=self.__schemas__[name];if(null!==val){var compiled={validate:null,link:null};if(self.__compiled__[name]=compiled,function isObject(obj){return"[object Object]"===_class(obj)}(val))return!function isRegExp(obj){return"[object RegExp]"===_class(obj)}(val.validate)?isFunction(val.validate)?compiled.validate=val.validate:schemaError(name,val):compiled.validate=function createValidator(re){return function(text,pos){var tail=text.slice(pos);return re.test(tail)?tail.match(re)[0].length:0}}(val.validate),void(isFunction(val.normalize)?compiled.normalize=val.normalize:val.normalize?schemaError(name,val):compiled.normalize=function(match,self){self.normalize(match)});!function isString(obj){return"[object String]"===_class(obj)}(val)?schemaError(name,val):aliases.push(name)}})),aliases.forEach((function(alias){self.__compiled__[self.__schemas__[alias]]&&(self.__compiled__[alias].validate=self.__compiled__[self.__schemas__[alias]].validate,self.__compiled__[alias].normalize=self.__compiled__[self.__schemas__[alias]].normalize)})),self.__compiled__[""]={validate:null,normalize:function(match,self){self.normalize(match)}};var slist=Object.keys(self.__compiled__).filter((function(name){return name.length>0&&self.__compiled__[name]})).map(escapeRE).join("|");self.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+re$1.src_ZPCc+"))("+slist+")","i"),self.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+re$1.src_ZPCc+"))("+slist+")","ig"),self.re.pretest=RegExp("("+self.re.schema_test.source+")|("+self.re.host_fuzzy_test.source+")|@","i"),function resetScanCache(self){self.__index__=-1,self.__text_cache__=""}(self)}function Match(self,shift){var start=self.__index__,end=self.__last_index__,text=self.__text_cache__.slice(start,end);this.schema=self.__schema__.toLowerCase(),this.index=start+shift,this.lastIndex=end+shift,this.raw=text,this.text=text,this.url=text}function createMatch(self,shift){var match=new Match(self,shift);return self.__compiled__[match.schema].normalize(match,self),match}function LinkifyIt(schemas,options){if(!(this instanceof LinkifyIt))return new LinkifyIt(schemas,options);options||function isOptionsObj(obj){return Object.keys(obj||{}).reduce((function(acc,k){return acc||defaultOptions.hasOwnProperty(k)}),!1)}(schemas)&&(options=schemas,schemas={}),this.__opts__=assign({},defaultOptions,options),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=assign({},defaultSchemas,schemas),this.__compiled__={},this.__tlds__=tlds_default,this.__tlds_replaced__=!1,this.re={},compile(this)}LinkifyIt.prototype.add=function add(schema,definition){return this.__schemas__[schema]=definition,compile(this),this},LinkifyIt.prototype.set=function set(options){return this.__opts__=assign(this.__opts__,options),this},LinkifyIt.prototype.test=function test(text){if(this.__text_cache__=text,this.__index__=-1,!text.length)return!1;var m,ml,me,len,shift,next,re,tld_pos;if(this.re.schema_test.test(text))for((re=this.re.schema_search).lastIndex=0;null!==(m=re.exec(text));)if(len=this.testSchemaAt(text,m[2],re.lastIndex)){this.__schema__=m[2],this.__index__=m.index+m[1].length,this.__last_index__=m.index+m[0].length+len;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(tld_pos=text.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||tld_pos<this.__index__)&&null!==(ml=text.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(shift=ml.index+ml[1].length,(this.__index__<0||shift<this.__index__)&&(this.__schema__="",this.__index__=shift,this.__last_index__=ml.index+ml[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&text.indexOf("@")>=0&&null!==(me=text.match(this.re.email_fuzzy))&&(shift=me.index+me[1].length,next=me.index+me[0].length,(this.__index__<0||shift<this.__index__||shift===this.__index__&&next>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=shift,this.__last_index__=next)),this.__index__>=0},LinkifyIt.prototype.pretest=function pretest(text){return this.re.pretest.test(text)},LinkifyIt.prototype.testSchemaAt=function testSchemaAt(text,schema,pos){return this.__compiled__[schema.toLowerCase()]?this.__compiled__[schema.toLowerCase()].validate(text,pos,this):0},LinkifyIt.prototype.match=function match(text){var shift=0,result=[];this.__index__>=0&&this.__text_cache__===text&&(result.push(createMatch(this,shift)),shift=this.__last_index__);for(var tail=shift?text.slice(shift):text;this.test(tail);)result.push(createMatch(this,shift)),tail=tail.slice(this.__last_index__),shift+=this.__last_index__;return result.length?result:null},LinkifyIt.prototype.tlds=function tlds(list,keepOld){return list=Array.isArray(list)?list:[list],keepOld?(this.__tlds__=this.__tlds__.concat(list).sort().filter((function(el,idx,arr){return el!==arr[idx-1]})).reverse(),compile(this),this):(this.__tlds__=list.slice(),this.__tlds_replaced__=!0,compile(this),this)},LinkifyIt.prototype.normalize=function normalize(match){match.schema||(match.url="http://"+match.url),"mailto:"!==match.schema||/^mailto:/i.test(match.url)||(match.url="mailto:"+match.url)},LinkifyIt.prototype.onCompile=function onCompile(){};var linkifyIt=LinkifyIt,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\0-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function mapDomain(string,fn){var parts=string.split("@"),result="";parts.length>1&&(result=parts[0]+"@",string=parts[1]);var encoded=function map(array,fn){for(var result=[],length=array.length;length--;)result[length]=fn(array[length]);return result}((string=string.replace(regexSeparators,".")).split("."),fn).join(".");return result+encoded}function ucs2decode(string){for(var output=[],counter=0,length=string.length;counter<length;){var value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){var extra=string.charCodeAt(counter++);56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)}else output.push(value)}return output}var basicToDigit=function basicToDigit(codePoint){return codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:36},digitToBasic=function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)},adapt=function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))},decode=function decode(input){var output=[],inputLength=input.length,i=0,n=128,bias=72,basic=input.lastIndexOf("-");basic<0&&(basic=0);for(var j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(var index=basic>0?basic+1:0;index<inputLength;){for(var oldi=i,w=1,k=36;;k+=36){index>=inputLength&&error("invalid-input");var digit=basicToDigit(input.charCodeAt(index++));(digit>=36||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w;var t=k<=bias?1:k>=bias+26?26:k-bias;if(digit<t)break;var baseMinusT=36-t;w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT}var out=output.length+1;bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return String.fromCodePoint.apply(String,output)},encode=function encode(input){var _step,output=[],inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,_iterator=_createForOfIteratorHelper(input);try{for(_iterator.s();!(_step=_iterator.n()).done;){var currentValue=_step.value;currentValue<128&&output.push(stringFromCharCode(currentValue))}}catch(err){_iterator.e(err)}finally{_iterator.f()}var basicLength=output.length,handledCPCount=basicLength;for(basicLength&&output.push("-");handledCPCount<inputLength;){var _step2,m=maxInt,_iterator2=_createForOfIteratorHelper(input);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _currentValue=_step2.value;_currentValue>=n&&_currentValue<m&&(m=_currentValue)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var handledCPCountPlusOne=handledCPCount+1;m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m;var _step3,_iterator3=_createForOfIteratorHelper(input);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _currentValue2=_step3.value;if(_currentValue2<n&&++delta>maxInt&&error("overflow"),_currentValue2==n){for(var q=delta,k=36;;k+=36){var t=k<=bias?1:k>=bias+26?26:k-bias;if(q<t)break;var qMinusT=q-t,baseMinusT=36-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}++delta,++n}return output.join("")},punycode_1={version:"2.1.0",ucs2:{decode:ucs2decode,encode:function ucs2encode(array){return String.fromCodePoint.apply(String,_toConsumableArray(array))}},decode,encode,toASCII:function toASCII(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function toUnicode(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},config={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},zero:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","text_collapse"]}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","text_collapse"]}}}},BAD_PROTO_RE=/^(vbscript|javascript|file|data):/,GOOD_DATA_RE=/^data:image\/(gif|png|jpeg|webp);/;function validateLink(url){var str=url.trim().toLowerCase();return!BAD_PROTO_RE.test(str)||!!GOOD_DATA_RE.test(str)}var RECODE_HOSTNAME_FOR=["http:","https:","mailto:"];function normalizeLink(url){var parsed=mdurl.parse(url,!0);if(parsed.hostname&&(!parsed.protocol||RECODE_HOSTNAME_FOR.indexOf(parsed.protocol)>=0))try{parsed.hostname=punycode_1.toASCII(parsed.hostname)}catch(er){}return mdurl.encode(mdurl.format(parsed))}function normalizeLinkText(url){var parsed=mdurl.parse(url,!0);if(parsed.hostname&&(!parsed.protocol||RECODE_HOSTNAME_FOR.indexOf(parsed.protocol)>=0))try{parsed.hostname=punycode_1.toUnicode(parsed.hostname)}catch(er){}return mdurl.decode(mdurl.format(parsed),mdurl.decode.defaultChars+"%")}function MarkdownIt(presetName,options){if(!(this instanceof MarkdownIt))return new MarkdownIt(presetName,options);options||utils.isString(presetName)||(options=presetName||{},presetName="default"),this.inline=new parser_inline,this.block=new parser_block,this.core=new parser_core,this.renderer=new renderer,this.linkify=new linkifyIt,this.validateLink=validateLink,this.normalizeLink=normalizeLink,this.normalizeLinkText=normalizeLinkText,this.utils=utils,this.helpers=utils.assign({},helpers),this.options={},this.configure(presetName),options&&this.set(options)}MarkdownIt.prototype.set=function(options){return utils.assign(this.options,options),this},MarkdownIt.prototype.configure=function(presets){var presetName,self=this;if(utils.isString(presets)&&!(presets=config[presetName=presets]))throw new Error('Wrong `markdown-it` preset "'+presetName+'", check name');if(!presets)throw new Error("Wrong `markdown-it` preset, can't be empty");return presets.options&&self.set(presets.options),presets.components&&Object.keys(presets.components).forEach((function(name){presets.components[name].rules&&self[name].ruler.enableOnly(presets.components[name].rules),presets.components[name].rules2&&self[name].ruler2.enableOnly(presets.components[name].rules2)})),this},MarkdownIt.prototype.enable=function(list,ignoreInvalid){var result=[];Array.isArray(list)||(list=[list]),["core","block","inline"].forEach((function(chain){result=result.concat(this[chain].ruler.enable(list,!0))}),this),result=result.concat(this.inline.ruler2.enable(list,!0));var missed=list.filter((function(name){return result.indexOf(name)<0}));if(missed.length&&!ignoreInvalid)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+missed);return this},MarkdownIt.prototype.disable=function(list,ignoreInvalid){var result=[];Array.isArray(list)||(list=[list]),["core","block","inline"].forEach((function(chain){result=result.concat(this[chain].ruler.disable(list,!0))}),this),result=result.concat(this.inline.ruler2.disable(list,!0));var missed=list.filter((function(name){return result.indexOf(name)<0}));if(missed.length&&!ignoreInvalid)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+missed);return this},MarkdownIt.prototype.use=function(plugin){var args=[this].concat(Array.prototype.slice.call(arguments,1));return plugin.apply(plugin,args),this},MarkdownIt.prototype.parse=function(src,env){if("string"!=typeof src)throw new Error("Input data should be a String");var state=new this.core.State(src,this,env);return this.core.process(state),state.tokens},MarkdownIt.prototype.render=function(src,env){return env=env||{},this.renderer.render(this.parse(src,env),this.options,env)},MarkdownIt.prototype.parseInline=function(src,env){var state=new this.core.State(src,this,env);return state.inlineMode=!0,this.core.process(state),state.tokens},MarkdownIt.prototype.renderInline=function(src,env){return env=env||{},this.renderer.render(this.parseInline(src,env),this.options,env)};var markdownIt=MarkdownIt,schema=new Schema({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:function toDOM(){return["p",0]}},blockquote:{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM:function toDOM(){return["blockquote",0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:function toDOM(){return["div",["hr"]]}},heading:{attrs:{level:{default:1}},content:"(text | image)*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:function toDOM(node){return["h"+node.attrs.level,0]}},code_block:{content:"text*",group:"block",code:!0,defining:!0,marks:"",attrs:{params:{default:""}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:function getAttrs(node){return{params:node.getAttribute("data-params")||""}}}],toDOM:function toDOM(node){return["pre",node.attrs.params?{"data-params":node.attrs.params}:{},["code",0]]}},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1},tight:{default:!1}},parseDOM:[{tag:"ol",getAttrs:function getAttrs(dom){return{order:dom.hasAttribute("start")?+dom.getAttribute("start"):1,tight:dom.hasAttribute("data-tight")}}}],toDOM:function toDOM(node){return["ol",{start:1==node.attrs.order?null:node.attrs.order,"data-tight":node.attrs.tight?"true":null},0]}},bullet_list:{content:"list_item+",group:"block",attrs:{tight:{default:!1}},parseDOM:[{tag:"ul",getAttrs:function getAttrs(dom){return{tight:dom.hasAttribute("data-tight")}}}],toDOM:function toDOM(node){return["ul",{"data-tight":node.attrs.tight?"true":null},0]}},list_item:{content:"paragraph block*",defining:!0,parseDOM:[{tag:"li"}],toDOM:function toDOM(){return["li",0]}},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:function getAttrs(dom){return{src:dom.getAttribute("src"),title:dom.getAttribute("title"),alt:dom.getAttribute("alt")}}}],toDOM:function toDOM(node){return["img",node.attrs]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function toDOM(){return["br"]}}},marks:{em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:function getAttrs(value){return"italic"==value&&null}}],toDOM:function toDOM(){return["em"]}},strong:{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-weight",getAttrs:function getAttrs(value){return/^(bold(er)?|[5-9]\d{2,})$/.test(value)&&null}}],toDOM:function toDOM(){return["strong"]}},link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function getAttrs(dom){return{href:dom.getAttribute("href"),title:dom.getAttribute("title")}}}],toDOM:function toDOM(node){return["a",node.attrs]}},code:{parseDOM:[{tag:"code"}],toDOM:function toDOM(){return["code"]}}}});var MarkdownParseState=function MarkdownParseState(schema,tokenHandlers){this.schema=schema,this.stack=[{type:schema.topNodeType,content:[]}],this.marks=Mark$1.none,this.tokenHandlers=tokenHandlers};function attrs(spec,token,tokens,i){return spec.getAttrs?spec.getAttrs(token,tokens,i):spec.attrs instanceof Function?spec.attrs(token):spec.attrs}function noCloseToken(spec,type){return spec.noCloseToken||"code_inline"==type||"code_block"==type||"fence"==type}function withoutTrailingNewline(str){return"\n"==str[str.length-1]?str.slice(0,str.length-1):str}function noOp(){}MarkdownParseState.prototype.top=function top(){return this.stack[this.stack.length-1]},MarkdownParseState.prototype.push=function push(elt){this.stack.length&&this.top().content.push(elt)},MarkdownParseState.prototype.addText=function addText(text){if(text){var merged,nodes=this.top().content,last=nodes[nodes.length-1],node=this.schema.text(text,this.marks);last&&(merged=function maybeMerge(a,b){if(a.isText&&b.isText&&Mark$1.sameSet(a.marks,b.marks))return a.withText(a.text+b.text)}(last,node))?nodes[nodes.length-1]=merged:nodes.push(node)}},MarkdownParseState.prototype.openMark=function openMark(mark){this.marks=mark.addToSet(this.marks)},MarkdownParseState.prototype.closeMark=function closeMark(mark){this.marks=mark.removeFromSet(this.marks)},MarkdownParseState.prototype.parseTokens=function parseTokens(toks){for(var i=0;i<toks.length;i++){var tok=toks[i],handler=this.tokenHandlers[tok.type];if(!handler)throw new Error("Token type `"+tok.type+"` not supported by Markdown parser");handler(this,tok,toks,i)}},MarkdownParseState.prototype.addNode=function addNode(type,attrs,content){var node=type.createAndFill(attrs,content,this.marks);return node?(this.push(node),node):null},MarkdownParseState.prototype.openNode=function openNode(type,attrs){this.stack.push({type,attrs,content:[]})},MarkdownParseState.prototype.closeNode=function closeNode(){this.marks.length&&(this.marks=Mark$1.none);var info=this.stack.pop();return this.addNode(info.type,info.attrs,info.content)};var MarkdownParser=function MarkdownParser(schema,tokenizer,tokens){this.tokens=tokens,this.schema=schema,this.tokenizer=tokenizer,this.tokenHandlers=function tokenHandlers(schema,tokens){var handlers=Object.create(null),loop=function loop(type){var spec=tokens[type];if(spec.block){var nodeType=schema.nodeType(spec.block);noCloseToken(spec,type)?handlers[type]=function(state,tok,tokens,i){state.openNode(nodeType,attrs(spec,tok,tokens,i)),state.addText(withoutTrailingNewline(tok.content)),state.closeNode()}:(handlers[type+"_open"]=function(state,tok,tokens,i){return state.openNode(nodeType,attrs(spec,tok,tokens,i))},handlers[type+"_close"]=function(state){return state.closeNode()})}else if(spec.node){var nodeType$1=schema.nodeType(spec.node);handlers[type]=function(state,tok,tokens,i){return state.addNode(nodeType$1,attrs(spec,tok,tokens,i))}}else if(spec.mark){var markType=schema.marks[spec.mark];noCloseToken(spec,type)?handlers[type]=function(state,tok,tokens,i){state.openMark(markType.create(attrs(spec,tok,tokens,i))),state.addText(withoutTrailingNewline(tok.content)),state.closeMark(markType)}:(handlers[type+"_open"]=function(state,tok,tokens,i){return state.openMark(markType.create(attrs(spec,tok,tokens,i)))},handlers[type+"_close"]=function(state){return state.closeMark(markType)})}else{if(!spec.ignore)throw new RangeError("Unrecognized parsing spec "+JSON.stringify(spec));noCloseToken(spec,type)?handlers[type]=noOp:(handlers[type+"_open"]=noOp,handlers[type+"_close"]=noOp)}};for(var type in tokens)loop(type);return handlers.text=function(state,tok){return state.addText(tok.content)},handlers.inline=function(state,tok){return state.parseTokens(tok.children)},handlers.softbreak=handlers.softbreak||function(state){return state.addText("\n")},handlers}(schema,tokens)};function listIsTight(tokens,i){for(;++i<tokens.length;)if("list_item_open"!=tokens[i].type)return tokens[i].hidden;return!1}MarkdownParser.prototype.parse=function parse(text){var doc,state=new MarkdownParseState(this.schema,this.tokenHandlers);state.parseTokens(this.tokenizer.parse(text,{}));do{doc=state.closeNode()}while(state.stack.length);return doc||this.schema.topNodeType.createAndFill()};var defaultMarkdownParser=new MarkdownParser(schema,markdownIt("commonmark",{html:!1}),{blockquote:{block:"blockquote"},paragraph:{block:"paragraph"},list_item:{block:"list_item"},bullet_list:{block:"bullet_list",getAttrs:function getAttrs(_,tokens,i){return{tight:listIsTight(tokens,i)}}},ordered_list:{block:"ordered_list",getAttrs:function getAttrs(tok,tokens,i){return{order:+tok.attrGet("start")||1,tight:listIsTight(tokens,i)}}},heading:{block:"heading",getAttrs:function getAttrs(tok){return{level:+tok.tag.slice(1)}}},code_block:{block:"code_block",noCloseToken:!0},fence:{block:"code_block",getAttrs:function getAttrs(tok){return{params:tok.info||""}},noCloseToken:!0},hr:{node:"horizontal_rule"},image:{node:"image",getAttrs:function getAttrs(tok){return{src:tok.attrGet("src"),title:tok.attrGet("title")||null,alt:tok.children[0]&&tok.children[0].content||null}}},hardbreak:{node:"hard_break"},em:{mark:"em"},strong:{mark:"strong"},link:{mark:"link",getAttrs:function getAttrs(tok){return{href:tok.attrGet("href"),title:tok.attrGet("title")||null}}},code_inline:{mark:"code",noCloseToken:!0}}),MarkdownSerializer=function MarkdownSerializer(nodes,marks){this.nodes=nodes,this.marks=marks};MarkdownSerializer.prototype.serialize=function serialize(content,options){var state=new MarkdownSerializerState(this.nodes,this.marks,options);return state.renderContent(content),state.out};var defaultMarkdownSerializer=new MarkdownSerializer({blockquote:function blockquote(state,node){state.wrapBlock("> ",null,node,(function(){return state.renderContent(node)}))},code_block:function code_block(state,node){state.write("```"+(node.attrs.params||"")+"\n"),state.text(node.textContent,!1),state.ensureNewLine(),state.write("```"),state.closeBlock(node)},heading:function heading(state,node){state.write(state.repeat("#",node.attrs.level)+" "),state.renderInline(node),state.closeBlock(node)},horizontal_rule:function horizontal_rule(state,node){state.write(node.attrs.markup||"---"),state.closeBlock(node)},bullet_list:function bullet_list(state,node){state.renderList(node,"  ",(function(){return(node.attrs.bullet||"*")+" "}))},ordered_list:function ordered_list(state,node){var start=node.attrs.order||1,maxW=String(start+node.childCount-1).length,space=state.repeat(" ",maxW+2);state.renderList(node,space,(function(i){var nStr=String(start+i);return state.repeat(" ",maxW-nStr.length)+nStr+". "}))},list_item:function list_item(state,node){state.renderContent(node)},paragraph:function paragraph(state,node){state.renderInline(node),state.closeBlock(node)},image:function image(state,node){state.write("!["+state.esc(node.attrs.alt||"")+"]("+node.attrs.src+(node.attrs.title?' "'+node.attrs.title.replace(/"/g,'\\"')+'"':"")+")")},hard_break:function hard_break(state,node,parent,index){for(var i=index+1;i<parent.childCount;i++)if(parent.child(i).type!=node.type)return void state.write("\\\n")},text:function text(state,node){state.text(node.text)}},{em:{open:"*",close:"*",mixable:!0,expelEnclosingWhitespace:!0},strong:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},link:{open:function open(_state,mark,parent,index){return isPlainURL(mark,parent,index,1)?"<":"["},close:function close(state,mark,parent,index){return isPlainURL(mark,parent,index,-1)?">":"]("+mark.attrs.href+(mark.attrs.title?' "'+mark.attrs.title.replace(/"/g,'\\"')+'"':"")+")"}},code:{open:function open(_state,_mark,parent,index){return backticksFor(parent.child(index),-1)},close:function close(_state,_mark,parent,index){return backticksFor(parent.child(index-1),1)},escape:!1}});function backticksFor(node,side){var m,ticks=/`+/g,len=0;if(node.isText)for(;m=ticks.exec(node.text);)len=Math.max(len,m[0].length);for(var result=len>0&&side>0?" `":"`",i=0;i<len;i++)result+="`";return len>0&&side<0&&(result+=" "),result}function isPlainURL(link,parent,index,side){if(link.attrs.title||!/^\w+:/.test(link.attrs.href))return!1;var content=parent.child(index+(side<0?-1:0));if(!content.isText||content.text!=link.attrs.href||content.marks[content.marks.length-1]!=link)return!1;if(index==(side<0?1:parent.childCount-1))return!0;var next=parent.child(index+(side<0?-2:1));return!link.isInSet(next.marks)}var MarkdownSerializerState=function MarkdownSerializerState(nodes,marks,options){this.nodes=nodes,this.marks=marks,this.delim=this.out="",this.closed=!1,this.inTightList=!1,this.options=options||{},void 0===this.options.tightLists&&(this.options.tightLists=!1)};MarkdownSerializerState.prototype.flushClose=function flushClose(size){if(this.closed){if(this.atBlank()||(this.out+="\n"),null==size&&(size=2),size>1){var delimMin=this.delim,trim=/\s+$/.exec(delimMin);trim&&(delimMin=delimMin.slice(0,delimMin.length-trim[0].length));for(var i=1;i<size;i++)this.out+=delimMin+"\n"}this.closed=!1}},MarkdownSerializerState.prototype.wrapBlock=function wrapBlock(delim,firstDelim,node,f){var old=this.delim;this.write(firstDelim||delim),this.delim+=delim,f(),this.delim=old,this.closeBlock(node)},MarkdownSerializerState.prototype.atBlank=function atBlank(){return/(^|\n)$/.test(this.out)},MarkdownSerializerState.prototype.ensureNewLine=function ensureNewLine(){this.atBlank()||(this.out+="\n")},MarkdownSerializerState.prototype.write=function write(content){this.flushClose(),this.delim&&this.atBlank()&&(this.out+=this.delim),content&&(this.out+=content)},MarkdownSerializerState.prototype.closeBlock=function closeBlock(node){this.closed=node},MarkdownSerializerState.prototype.text=function text(text$1,escape){for(var lines=text$1.split("\n"),i=0;i<lines.length;i++){var startOfLine=this.atBlank()||this.closed;this.write(),this.out+=!1!==escape?this.esc(lines[i],startOfLine):lines[i],i!=lines.length-1&&(this.out+="\n")}},MarkdownSerializerState.prototype.render=function render(node,parent,index){if("number"==typeof parent)throw new Error("!");if(!this.nodes[node.type.name])throw new Error("Token type `"+node.type.name+"` not supported by Markdown renderer");this.nodes[node.type.name](this,node,parent,index)},MarkdownSerializerState.prototype.renderContent=function renderContent(parent){var this$1=this;parent.forEach((function(node,_,i){return this$1.render(node,parent,i)}))},MarkdownSerializerState.prototype.renderInline=function renderInline(parent){var this$1=this,active=[],trailing="",progress=function progress(node,_,index){var marks=node?node.marks:[];node&&"hard_break"===node.type.name&&(marks=marks.filter((function(m){if(index+1==parent.childCount)return!1;var next=parent.child(index+1);return m.isInSet(next.marks)&&(!next.isText||/\S/.test(next.text))})));var leading=trailing;if(trailing="",node&&node.isText&&marks.some((function(mark){var info=this$1.marks[mark.type.name];return info&&info.expelEnclosingWhitespace}))){var ref=/^(\s*)(.*?)(\s*)$/m.exec(node.text),lead=ref[1],inner$1=ref[2],trail=ref[3];leading+=lead,trailing=trail,(lead||trail)&&((node=inner$1?node.withText(inner$1):null)||(marks=active))}var inner=marks.length&&marks[marks.length-1],noEsc=inner&&!1===this$1.marks[inner.type.name].escape,len=marks.length-(noEsc?1:0);outer:for(var i=0;i<len;i++){var mark=marks[i];if(!this$1.marks[mark.type.name].mixable)break;for(var j=0;j<active.length;j++){var other=active[j];if(!this$1.marks[other.type.name].mixable)break;if(mark.eq(other)){i>j?marks=marks.slice(0,j).concat(mark).concat(marks.slice(j,i)).concat(marks.slice(i+1,len)):j>i&&(marks=marks.slice(0,i).concat(marks.slice(i+1,j)).concat(mark).concat(marks.slice(j,len)));continue outer}}}for(var keep=0;keep<Math.min(active.length,len)&&marks[keep].eq(active[keep]);)++keep;for(;keep<active.length;)this$1.text(this$1.markString(active.pop(),!1,parent,index),!1);if(leading&&this$1.text(leading),node){for(;active.length<len;){var add=marks[active.length];active.push(add),this$1.text(this$1.markString(add,!0,parent,index),!1)}noEsc&&node.isText?this$1.text(this$1.markString(inner,!0,parent,index)+node.text+this$1.markString(inner,!1,parent,index+1),!1):this$1.render(node,parent,index)}};parent.forEach(progress),progress(null,0,parent.childCount)},MarkdownSerializerState.prototype.renderList=function renderList(node,delim,firstDelim){var this$1=this;this.closed&&this.closed.type==node.type?this.flushClose(3):this.inTightList&&this.flushClose(1);var isTight=void 0!==node.attrs.tight?node.attrs.tight:this.options.tightLists,prevTight=this.inTightList;this.inTightList=isTight,node.forEach((function(child,_,i){i&&isTight&&this$1.flushClose(1),this$1.wrapBlock(delim,firstDelim(i),node,(function(){return this$1.render(child,node,i)}))})),this.inTightList=prevTight},MarkdownSerializerState.prototype.esc=function esc(str,startOfLine){return str=str.replace(/[`*\\~\[\]_]/g,"\\$&"),startOfLine&&(str=str.replace(/^[:#\-*+>]/,"\\$&").replace(/^(\s*\d+)\./,"$1\\.")),str},MarkdownSerializerState.prototype.quote=function quote(str){var wrap=-1==str.indexOf('"')?'""':-1==str.indexOf("'")?"''":"()";return wrap[0]+str+wrap[1]},MarkdownSerializerState.prototype.repeat=function repeat(str,n){for(var out="",i=0;i<n;i++)out+=str;return out},MarkdownSerializerState.prototype.markString=function markString(mark,open,parent,index){var info=this.marks[mark.type.name],value=open?info.open:info.close;return"string"==typeof value?value:value(this,mark,parent,index)},MarkdownSerializerState.prototype.getEnclosingWhitespace=function getEnclosingWhitespace(text){return{leading:(text.match(/^(\s+)/)||[])[0],trailing:(text.match(/(\s+)$/)||[])[0]}};var dist=(0,_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_72__.c)((function(module,exports){var __importDefault=_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_72__.a&&_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_72__.a.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var token_1=__importDefault(token),checkboxRegex=/^ *\[([\sx])] /i;function findParentToken(tokens,index){for(var targetLevel=tokens[index].level-1,currentTokenIndex=index-1;currentTokenIndex>=0;currentTokenIndex--)if(tokens[currentTokenIndex].level===targetLevel)return tokens[currentTokenIndex]}function isTodoItem(tokens,index){return function isInline(token){return"inline"===token.type}(tokens[index])&&function isParagraph(token){return"paragraph_open"===token.type}(tokens[index-1])&&function isListItem(token){return"list_item_open"===token.type}(tokens[index-2])&&function startsWithTodoMarkdown(token){return checkboxRegex.test(token.content)}(tokens[index])}function todoify(token,options){if(null!=token.children){var id=function generateIdForToken(token){return token.map?"task-item-".concat(token.map[0]):"task-item-".concat(Math.ceil(1e7*Math.random()-1e3))}(token);token.children.splice(0,0,function createCheckboxToken(token,enabled,id){var checkbox=new token_1.default("taskListItemCheckbox","",0);enabled||checkbox.attrSet("disabled","true");token.map&&checkbox.attrSet("line",token.map[0].toString());checkbox.attrSet("id",id);var checkboxRegexResult=checkboxRegex.exec(token.content);"x"===(null==checkboxRegexResult?void 0:checkboxRegexResult[1].toLowerCase())&&checkbox.attrSet("checked","true");return checkbox}(token,options.enabled,id)),token.children[1].content=token.children[1].content.replace(checkboxRegex,""),options.label&&(token.children.splice(1,0,function createLabelBeginToken(id){var labelBeginToken=new token_1.default("taskListItemLabel_open","",1);return labelBeginToken.attrSet("id",id),labelBeginToken}(id)),token.children.push(function createLabelEndToken(){return new token_1.default("taskListItemLabel_close","",-1)}()))}}exports.default=function markdownItTaskLists(md,options){void 0===options&&(options={enabled:!1,label:!1,lineNumber:!1}),md.core.ruler.after("inline","task-lists",(function(state){return function processToken(state,options){for(var allTokens=state.tokens,i=2;i<allTokens.length;i++)if(isTodoItem(allTokens,i)){todoify(allTokens[i],options),allTokens[i-2].attrJoin("class","task-list-item ".concat(options.enabled?" enabled":""));var parentToken=findParentToken(allTokens,i-2);parentToken&&parentToken.attrJoin("class","contains-task-list")}return!1}(state,options)})),md.renderer.rules.taskListItemCheckbox=function(tokens){var token=tokens[0],checkedAttribute=token.attrGet("checked")?'checked="" ':"",disabledAttribute=token.attrGet("disabled")?'disabled="" ':"",line=token.attrGet("line"),idAttribute='id="'.concat(token.attrGet("id"),'" '),dataLineAttribute=line&&options.lineNumber?'data-line="'.concat(line,'" '):"";return'<input class="task-list-item-checkbox" type="checkbox" '.concat(checkedAttribute).concat(disabledAttribute).concat(dataLineAttribute).concat(idAttribute,"/>")},md.renderer.rules.taskListItemLabel_close=function(){return"</label>"},md.renderer.rules.taskListItemLabel_open=function(tokens){var id=tokens[0].attrGet("id");return'<label for="'.concat(id,'">')}}})),taskLists=(0,_commonjsHelpers_212d567a_js__WEBPACK_IMPORTED_MODULE_72__.g)(dist);function State(token){this.j={},this.jr=[],this.jd=null,this.t=token}State.prototype={accepts:function accepts(){return!!this.t},tt:function tt(input,tokenOrState){if(tokenOrState&&tokenOrState.j)return this.j[input]=tokenOrState,tokenOrState;var token=tokenOrState,nextState=this.j[input];if(nextState)return token&&(nextState.t=token),nextState;nextState=makeState();var templateState=takeT(this,input);return templateState?(Object.assign(nextState.j,templateState.j),nextState.jr.append(templateState.jr),nextState.jr=templateState.jd,nextState.t=token||templateState.t):nextState.t=token,this.j[input]=nextState,nextState}};var makeState=function makeState(){return new State},makeAcceptingState=function makeAcceptingState(token){return new State(token)},makeT=function makeT(startState,input,nextState){startState.j[input]||(startState.j[input]=nextState)},makeRegexT=function makeRegexT(startState,regex,nextState){startState.jr.push([regex,nextState])},takeT=function takeT(state,input){var nextState=state.j[input];if(nextState)return nextState;for(var i=0;i<state.jr.length;i++){var regex=state.jr[i][0],_nextState=state.jr[i][1];if(regex.test(input))return _nextState}return state.jd},makeMultiT=function makeMultiT(startState,chars,nextState){for(var i=0;i<chars.length;i++)makeT(startState,chars[i],nextState)},makeBatchT=function makeBatchT(startState,transitions){for(var i=0;i<transitions.length;i++){var input=transitions[i][0],nextState=transitions[i][1];makeT(startState,input,nextState)}},makeChainT=function makeChainT(state,str,endState,defaultStateFactory){for(var nextState,i=0,len=str.length;i<len&&(nextState=state.j[str[i]]);)state=nextState,i++;if(i>=len)return[];for(;i<len-1;)nextState=defaultStateFactory(),makeT(state,str[i],nextState),state=nextState,i++;makeT(state,str[len-1],endState)},DOMAIN="DOMAIN",TLD="TLD",NUM="NUM",AT="AT",DOT="DOT",SLASH="SLASH",text=Object.freeze({__proto__:null,DOMAIN,LOCALHOST:"LOCALHOST",TLD,NUM,PROTOCOL:"PROTOCOL",MAILTO:"MAILTO",WS:"WS",NL:"NL",OPENBRACE:"OPENBRACE",OPENBRACKET:"OPENBRACKET",OPENANGLEBRACKET:"OPENANGLEBRACKET",OPENPAREN:"OPENPAREN",CLOSEBRACE:"CLOSEBRACE",CLOSEBRACKET:"CLOSEBRACKET",CLOSEANGLEBRACKET:"CLOSEANGLEBRACKET",CLOSEPAREN:"CLOSEPAREN",AMPERSAND:"AMPERSAND",APOSTROPHE:"APOSTROPHE",ASTERISK:"ASTERISK",AT,BACKSLASH:"BACKSLASH",BACKTICK:"BACKTICK",CARET:"CARET",COLON:"COLON",COMMA:"COMMA",DOLLAR:"DOLLAR",DOT,EQUALS:"EQUALS",EXCLAMATION:"EXCLAMATION",HYPHEN:"HYPHEN",PERCENT:"PERCENT",PIPE:"PIPE",PLUS:"PLUS",POUND:"POUND",QUERY:"QUERY",QUOTE:"QUOTE",SEMI:"SEMI",SLASH,TILDE:"TILDE",UNDERSCORE:"UNDERSCORE",SYM:"SYM"}),tlds="aaa aarp abarth abb abbott abbvie abc able abogado abudhabi ac academy accenture accountant accountants aco actor ad adac ads adult ae aeg aero aetna af afamilycompany afl africa ag agakhan agency ai aig airbus airforce airtel akdn al alfaromeo alibaba alipay allfinanz allstate ally alsace alstom am amazon americanexpress americanfamily amex amfam amica amsterdam analytics android anquan anz ao aol apartments app apple aq aquarelle ar arab aramco archi army arpa art arte as asda asia associates at athleta attorney au auction audi audible audio auspost author auto autos avianca aw aws ax axa az azure ba baby baidu banamex bananarepublic band bank bar barcelona barclaycard barclays barefoot bargains baseball basketball bauhaus bayern bb bbc bbt bbva bcg bcn bd be beats beauty beer bentley berlin best bestbuy bet bf bg bh bharti bi bible bid bike bing bingo bio biz bj black blackfriday blockbuster blog bloomberg blue bm bms bmw bn bnpparibas bo boats boehringer bofa bom bond boo book booking bosch bostik boston bot boutique box br bradesco bridgestone broadway broker brother brussels bs bt budapest bugatti build builders business buy buzz bv bw by bz bzh ca cab cafe cal call calvinklein cam camera camp cancerresearch canon capetown capital capitalone car caravan cards care career careers cars casa case cash casino cat catering catholic cba cbn cbre cbs cc cd center ceo cern cf cfa cfd cg ch chanel channel charity chase chat cheap chintai christmas chrome church ci cipriani circle cisco citadel citi citic city cityeats ck cl claims cleaning click clinic clinique clothing cloud club clubmed cm cn co coach codes coffee college cologne com comcast commbank community company compare computer comsec condos construction consulting contact contractors cooking cookingchannel cool coop corsica country coupon coupons courses cpa cr credit creditcard creditunion cricket crown crs cruise cruises csc cu cuisinella cv cw cx cy cymru cyou cz dabur dad dance data date dating datsun day dclk dds de deal dealer deals degree delivery dell deloitte delta democrat dental dentist desi design dev dhl diamonds diet digital direct directory discount discover dish diy dj dk dm dnp do docs doctor dog domains dot download drive dtv dubai duck dunlop dupont durban dvag dvr dz earth eat ec eco edeka edu education ee eg email emerck energy engineer engineering enterprises epson equipment er ericsson erni es esq estate et etisalat eu eurovision eus events exchange expert exposed express extraspace fage fail fairwinds faith family fan fans farm farmers fashion fast fedex feedback ferrari ferrero fi fiat fidelity fido film final finance financial fire firestone firmdale fish fishing fit fitness fj fk flickr flights flir florist flowers fly fm fo foo food foodnetwork football ford forex forsale forum foundation fox fr free fresenius frl frogans frontdoor frontier ftr fujitsu fujixerox fun fund furniture futbol fyi ga gal gallery gallo gallup game games gap garden gay gb gbiz gd gdn ge gea gent genting george gf gg ggee gh gi gift gifts gives giving gl glade glass gle global globo gm gmail gmbh gmo gmx gn godaddy gold goldpoint golf goo goodyear goog google gop got gov gp gq gr grainger graphics gratis green gripe grocery group gs gt gu guardian gucci guge guide guitars guru gw gy hair hamburg hangout haus hbo hdfc hdfcbank health healthcare help helsinki here hermes hgtv hiphop hisamitsu hitachi hiv hk hkt hm hn hockey holdings holiday homedepot homegoods homes homesense honda horse hospital host hosting hot hoteles hotels hotmail house how hr hsbc ht hu hughes hyatt hyundai ibm icbc ice icu id ie ieee ifm ikano il im imamat imdb immo immobilien in inc industries infiniti info ing ink institute insurance insure int international intuit investments io ipiranga iq ir irish is ismaili ist istanbul it itau itv iveco jaguar java jcb je jeep jetzt jewelry jio jll jm jmp jnj jo jobs joburg jot joy jp jpmorgan jprs juegos juniper kaufen kddi ke kerryhotels kerrylogistics kerryproperties kfh kg kh ki kia kim kinder kindle kitchen kiwi km kn koeln komatsu kosher kp kpmg kpn kr krd kred kuokgroup kw ky kyoto kz la lacaixa lamborghini lamer lancaster lancia land landrover lanxess lasalle lat latino latrobe law lawyer lb lc lds lease leclerc lefrak legal lego lexus lgbt li lidl life lifeinsurance lifestyle lighting like lilly limited limo lincoln linde link lipsy live living lixil lk llc llp loan loans locker locus loft lol london lotte lotto love lpl lplfinancial lr ls lt ltd ltda lu lundbeck luxe luxury lv ly ma macys madrid maif maison makeup man management mango map market marketing markets marriott marshalls maserati mattel mba mc mckinsey md me med media meet melbourne meme memorial men menu merckmsd mg mh miami microsoft mil mini mint mit mitsubishi mk ml mlb mls mm mma mn mo mobi mobile moda moe moi mom monash money monster mormon mortgage moscow moto motorcycles mov movie mp mq mr ms msd mt mtn mtr mu museum mutual mv mw mx my mz na nab nagoya name nationwide natura navy nba nc ne nec net netbank netflix network neustar new news next nextdirect nexus nf nfl ng ngo nhk ni nico nike nikon ninja nissan nissay nl no nokia northwesternmutual norton now nowruz nowtv np nr nra nrw ntt nu nyc nz obi observer off office okinawa olayan olayangroup oldnavy ollo om omega one ong onl online onyourside ooo open oracle orange org organic origins osaka otsuka ott ovh pa page panasonic paris pars partners parts party passagens pay pccw pe pet pf pfizer pg ph pharmacy phd philips phone photo photography photos physio pics pictet pictures pid pin ping pink pioneer pizza pk pl place play playstation plumbing plus pm pn pnc pohl poker politie porn post pr pramerica praxi press prime pro prod productions prof progressive promo properties property protection pru prudential ps pt pub pw pwc py qa qpon quebec quest qvc racing radio raid re read realestate realtor realty recipes red redstone redumbrella rehab reise reisen reit reliance ren rent rentals repair report republican rest restaurant review reviews rexroth rich richardli ricoh ril rio rip rmit ro rocher rocks rodeo rogers room rs rsvp ru rugby ruhr run rw rwe ryukyu sa saarland safe safety sakura sale salon samsclub samsung sandvik sandvikcoromant sanofi sap sarl sas save saxo sb sbi sbs sc sca scb schaeffler schmidt scholarships school schule schwarz science scjohnson scot sd se search seat secure security seek select sener services ses seven sew sex sexy sfr sg sh shangrila sharp shaw shell shia shiksha shoes shop shopping shouji show showtime si silk sina singles site sj sk ski skin sky skype sl sling sm smart smile sn sncf so soccer social softbank software sohu solar solutions song sony soy spa space sport spot spreadbetting sr srl ss st stada staples star statebank statefarm stc stcgroup stockholm storage store stream studio study style su sucks supplies supply support surf surgery suzuki sv swatch swiftcover swiss sx sy sydney systems sz tab taipei talk taobao target tatamotors tatar tattoo tax taxi tc tci td tdk team tech technology tel temasek tennis teva tf tg th thd theater theatre tiaa tickets tienda tiffany tips tires tirol tj tjmaxx tjx tk tkmaxx tl tm tmall tn to today tokyo tools top toray toshiba total tours town toyota toys tr trade trading training travel travelchannel travelers travelersinsurance trust trv tt tube tui tunes tushu tv tvs tw tz ua ubank ubs ug uk unicom university uno uol ups us uy uz va vacations vana vanguard vc ve vegas ventures verisign versicherung vet vg vi viajes video vig viking villas vin vip virgin visa vision viva vivo vlaanderen vn vodka volkswagen volvo vote voting voto voyage vu vuelos wales walmart walter wang wanggou watch watches weather weatherchannel webcam weber website wed wedding weibo weir wf whoswho wien wiki williamhill win windows wine winners wme wolterskluwer woodside work works world wow ws wtc wtf xbox xerox xfinity xihuan xin xxx xyz yachts yahoo yamaxun yandex ye yodobashi yoga yokohama you youtube yt yun za zappos zara zero zip zm zone zuerich zw vermgensberater-ctb vermgensberatung-pwb                                                                                                                                                        ".split(" "),LETTER=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/,EMOJI=/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDD-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC5\uDED0-\uDED9\uDEE0-\uDEE7\uDEF0-\uDEF6])/,EMOJI_VARIATION=/\uFE0F/,DIGIT=/\d/,SPACE=/\s/;function init$2(){var customProtocols=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],S_START=makeState(),S_NUM=makeAcceptingState(NUM),S_DOMAIN=makeAcceptingState(DOMAIN),S_DOMAIN_HYPHEN=makeState(),S_WS=makeAcceptingState("WS"),DOMAIN_REGEX_TRANSITIONS=[[DIGIT,S_DOMAIN],[LETTER,S_DOMAIN],[EMOJI,S_DOMAIN],[EMOJI_VARIATION,S_DOMAIN]],makeDomainState=function makeDomainState(){var state=makeAcceptingState(DOMAIN);return state.j={"-":S_DOMAIN_HYPHEN},state.jr=[].concat(DOMAIN_REGEX_TRANSITIONS),state},makeNearDomainState=function makeNearDomainState(token){var state=makeDomainState();return state.t=token,state};makeBatchT(S_START,[["'",makeAcceptingState("APOSTROPHE")],["{",makeAcceptingState("OPENBRACE")],["[",makeAcceptingState("OPENBRACKET")],["<",makeAcceptingState("OPENANGLEBRACKET")],["(",makeAcceptingState("OPENPAREN")],["}",makeAcceptingState("CLOSEBRACE")],["]",makeAcceptingState("CLOSEBRACKET")],[">",makeAcceptingState("CLOSEANGLEBRACKET")],[")",makeAcceptingState("CLOSEPAREN")],["&",makeAcceptingState("AMPERSAND")],["*",makeAcceptingState("ASTERISK")],["@",makeAcceptingState(AT)],["`",makeAcceptingState("BACKTICK")],["^",makeAcceptingState("CARET")],[":",makeAcceptingState("COLON")],[",",makeAcceptingState("COMMA")],["$",makeAcceptingState("DOLLAR")],[".",makeAcceptingState(DOT)],["=",makeAcceptingState("EQUALS")],["!",makeAcceptingState("EXCLAMATION")],["-",makeAcceptingState("HYPHEN")],["%",makeAcceptingState("PERCENT")],["|",makeAcceptingState("PIPE")],["+",makeAcceptingState("PLUS")],["#",makeAcceptingState("POUND")],["?",makeAcceptingState("QUERY")],['"',makeAcceptingState("QUOTE")],["/",makeAcceptingState(SLASH)],[";",makeAcceptingState("SEMI")],["~",makeAcceptingState("TILDE")],["_",makeAcceptingState("UNDERSCORE")],["\\",makeAcceptingState("BACKSLASH")]]),makeT(S_START,"\n",makeAcceptingState("NL")),makeRegexT(S_START,SPACE,S_WS),makeT(S_WS,"\n",makeState()),makeRegexT(S_WS,SPACE,S_WS);for(var i=0;i<tlds.length;i++)makeChainT(S_START,tlds[i],makeNearDomainState(TLD),makeDomainState);var S_PROTOCOL_FILE=makeDomainState(),S_PROTOCOL_FTP=makeDomainState(),S_PROTOCOL_HTTP=makeDomainState(),S_MAILTO=makeDomainState();makeChainT(S_START,"file",S_PROTOCOL_FILE,makeDomainState),makeChainT(S_START,"ftp",S_PROTOCOL_FTP,makeDomainState),makeChainT(S_START,"http",S_PROTOCOL_HTTP,makeDomainState),makeChainT(S_START,"mailto",S_MAILTO,makeDomainState);var S_PROTOCOL_SECURE=makeDomainState(),S_FULL_PROTOCOL=makeAcceptingState("PROTOCOL"),S_FULL_MAILTO=makeAcceptingState("MAILTO");makeT(S_PROTOCOL_FTP,"s",S_PROTOCOL_SECURE),makeT(S_PROTOCOL_FTP,":",S_FULL_PROTOCOL),makeT(S_PROTOCOL_HTTP,"s",S_PROTOCOL_SECURE),makeT(S_PROTOCOL_HTTP,":",S_FULL_PROTOCOL),makeT(S_PROTOCOL_FILE,":",S_FULL_PROTOCOL),makeT(S_PROTOCOL_SECURE,":",S_FULL_PROTOCOL),makeT(S_MAILTO,":",S_FULL_MAILTO);for(var S_CUSTOM_PROTOCOL=makeDomainState(),_i=0;_i<customProtocols.length;_i++)makeChainT(S_START,customProtocols[_i],S_CUSTOM_PROTOCOL,makeDomainState);return makeT(S_CUSTOM_PROTOCOL,":",S_FULL_PROTOCOL),makeChainT(S_START,"localhost",makeNearDomainState("LOCALHOST"),makeDomainState),makeRegexT(S_START,DIGIT,S_NUM),makeRegexT(S_START,LETTER,S_DOMAIN),makeRegexT(S_START,EMOJI,S_DOMAIN),makeRegexT(S_START,EMOJI_VARIATION,S_DOMAIN),makeRegexT(S_NUM,DIGIT,S_NUM),makeRegexT(S_NUM,LETTER,S_DOMAIN),makeRegexT(S_NUM,EMOJI,S_DOMAIN),makeRegexT(S_NUM,EMOJI_VARIATION,S_DOMAIN),makeT(S_NUM,"-",S_DOMAIN_HYPHEN),makeT(S_DOMAIN,"-",S_DOMAIN_HYPHEN),makeT(S_DOMAIN_HYPHEN,"-",S_DOMAIN_HYPHEN),makeRegexT(S_DOMAIN,DIGIT,S_DOMAIN),makeRegexT(S_DOMAIN,LETTER,S_DOMAIN),makeRegexT(S_DOMAIN,EMOJI,S_DOMAIN),makeRegexT(S_DOMAIN,EMOJI_VARIATION,S_DOMAIN),makeRegexT(S_DOMAIN_HYPHEN,DIGIT,S_DOMAIN),makeRegexT(S_DOMAIN_HYPHEN,LETTER,S_DOMAIN),makeRegexT(S_DOMAIN_HYPHEN,EMOJI,S_DOMAIN),makeRegexT(S_DOMAIN_HYPHEN,EMOJI_VARIATION,S_DOMAIN),S_START.jd=makeAcceptingState("SYM"),S_START}var defaults_defaultProtocol="http";function MultiToken(){}function createTokenClass(type,props){function Token(value,tokens){this.t=type,this.v=value,this.tk=tokens}return function inherits(parent,child){var props=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},extended=Object.create(parent.prototype);for(var p in props)extended[p]=props[p];return extended.constructor=child,child.prototype=extended,child}(MultiToken,Token,props),Token}MultiToken.prototype={t:"token",isLink:!1,toString:function toString(){return this.v},toHref:function toHref(){return this.toString()},startIndex:function startIndex(){return this.tk[0].s},endIndex:function endIndex(){return this.tk[this.tk.length-1].e},toObject:function toObject(){var protocol=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaults_defaultProtocol;return{type:this.t,value:this.v,isLink:this.isLink,href:this.toHref(protocol),start:this.startIndex(),end:this.endIndex()}}};var MailtoEmail=createTokenClass("email",{isLink:!0}),Email=createTokenClass("email",{isLink:!0,toHref:function toHref(){return"mailto:"+this.toString()}}),Text$1=createTokenClass("text"),Nl=createTokenClass("nl"),Url=createTokenClass("url",{isLink:!0,toHref:function toHref(){for(var protocol=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaults_defaultProtocol,tokens=this.tk,hasProtocol=!1,hasSlashSlash=!1,result=[],i=0;"PROTOCOL"===tokens[i].t;)hasProtocol=!0,result.push(tokens[i].v),i++;for(;tokens[i].t===SLASH;)hasSlashSlash=!0,result.push(tokens[i].v),i++;for(;i<tokens.length;i++)result.push(tokens[i].v);return result=result.join(""),hasProtocol||hasSlashSlash||(result="".concat(protocol,"://").concat(result)),result},hasProtocol:function hasProtocol(){return"PROTOCOL"===this.tk[0].t}}),multi=Object.freeze({__proto__:null,MultiToken,Base:MultiToken,createTokenClass,MailtoEmail,Email,Text:Text$1,Nl,Url});function init$1(){var S_START=makeState(),S_PROTOCOL=makeState(),S_MAILTO=makeState(),S_PROTOCOL_SLASH=makeState(),S_PROTOCOL_SLASH_SLASH=makeState(),S_DOMAIN=makeState(),S_DOMAIN_DOT=makeState(),S_TLD=makeAcceptingState(Url),S_TLD_COLON=makeState(),S_TLD_PORT=makeAcceptingState(Url),S_URL=makeAcceptingState(Url),S_URL_NON_ACCEPTING=makeState(),S_URL_OPENBRACE=makeState(),S_URL_OPENBRACKET=makeState(),S_URL_OPENANGLEBRACKET=makeState(),S_URL_OPENPAREN=makeState(),S_URL_OPENBRACE_Q=makeAcceptingState(Url),S_URL_OPENBRACKET_Q=makeAcceptingState(Url),S_URL_OPENANGLEBRACKET_Q=makeAcceptingState(Url),S_URL_OPENPAREN_Q=makeAcceptingState(Url),S_URL_OPENBRACE_SYMS=makeState(),S_URL_OPENBRACKET_SYMS=makeState(),S_URL_OPENANGLEBRACKET_SYMS=makeState(),S_URL_OPENPAREN_SYMS=makeState(),S_EMAIL_DOMAIN=makeState(),S_EMAIL_DOMAIN_DOT=makeState(),S_EMAIL=makeAcceptingState(Email),S_EMAIL_COLON=makeState(),S_EMAIL_PORT=makeAcceptingState(Email),S_MAILTO_EMAIL=makeAcceptingState(MailtoEmail),S_MAILTO_EMAIL_NON_ACCEPTING=makeState(),S_LOCALPART=makeState(),S_LOCALPART_AT=makeState(),S_LOCALPART_DOT=makeState(),S_NL=makeAcceptingState(Nl);makeT(S_START,"NL",S_NL),makeT(S_START,"PROTOCOL",S_PROTOCOL),makeT(S_START,"MAILTO",S_MAILTO),makeT(S_PROTOCOL,SLASH,S_PROTOCOL_SLASH),makeT(S_PROTOCOL_SLASH,SLASH,S_PROTOCOL_SLASH_SLASH),makeT(S_START,TLD,S_DOMAIN),makeT(S_START,DOMAIN,S_DOMAIN),makeT(S_START,"LOCALHOST",S_TLD),makeT(S_START,NUM,S_DOMAIN),makeT(S_PROTOCOL_SLASH_SLASH,TLD,S_URL),makeT(S_PROTOCOL_SLASH_SLASH,DOMAIN,S_URL),makeT(S_PROTOCOL_SLASH_SLASH,NUM,S_URL),makeT(S_PROTOCOL_SLASH_SLASH,"LOCALHOST",S_URL),makeT(S_DOMAIN,DOT,S_DOMAIN_DOT),makeT(S_EMAIL_DOMAIN,DOT,S_EMAIL_DOMAIN_DOT),makeT(S_DOMAIN_DOT,TLD,S_TLD),makeT(S_DOMAIN_DOT,DOMAIN,S_DOMAIN),makeT(S_DOMAIN_DOT,NUM,S_DOMAIN),makeT(S_DOMAIN_DOT,"LOCALHOST",S_DOMAIN),makeT(S_EMAIL_DOMAIN_DOT,TLD,S_EMAIL),makeT(S_EMAIL_DOMAIN_DOT,DOMAIN,S_EMAIL_DOMAIN),makeT(S_EMAIL_DOMAIN_DOT,NUM,S_EMAIL_DOMAIN),makeT(S_EMAIL_DOMAIN_DOT,"LOCALHOST",S_EMAIL_DOMAIN),makeT(S_TLD,DOT,S_DOMAIN_DOT),makeT(S_EMAIL,DOT,S_EMAIL_DOMAIN_DOT),makeT(S_TLD,"COLON",S_TLD_COLON),makeT(S_TLD,SLASH,S_URL),makeT(S_TLD_COLON,NUM,S_TLD_PORT),makeT(S_TLD_PORT,SLASH,S_URL),makeT(S_EMAIL,"COLON",S_EMAIL_COLON),makeT(S_EMAIL_COLON,NUM,S_EMAIL_PORT);var qsAccepting=["AMPERSAND","ASTERISK",AT,"BACKSLASH","BACKTICK","CARET","DOLLAR",DOMAIN,"EQUALS","HYPHEN","LOCALHOST",NUM,"PERCENT","PIPE","PLUS","POUND","PROTOCOL",SLASH,"SYM","TILDE",TLD,"UNDERSCORE"],qsNonAccepting=["APOSTROPHE","CLOSEANGLEBRACKET","CLOSEBRACE","CLOSEBRACKET","CLOSEPAREN","COLON","COMMA",DOT,"EXCLAMATION","OPENANGLEBRACKET","OPENBRACE","OPENBRACKET","OPENPAREN","QUERY","QUOTE","SEMI"];makeT(S_URL,"OPENBRACE",S_URL_OPENBRACE),makeT(S_URL,"OPENBRACKET",S_URL_OPENBRACKET),makeT(S_URL,"OPENANGLEBRACKET",S_URL_OPENANGLEBRACKET),makeT(S_URL,"OPENPAREN",S_URL_OPENPAREN),makeT(S_URL_NON_ACCEPTING,"OPENBRACE",S_URL_OPENBRACE),makeT(S_URL_NON_ACCEPTING,"OPENBRACKET",S_URL_OPENBRACKET),makeT(S_URL_NON_ACCEPTING,"OPENANGLEBRACKET",S_URL_OPENANGLEBRACKET),makeT(S_URL_NON_ACCEPTING,"OPENPAREN",S_URL_OPENPAREN),makeT(S_URL_OPENBRACE,"CLOSEBRACE",S_URL),makeT(S_URL_OPENBRACKET,"CLOSEBRACKET",S_URL),makeT(S_URL_OPENANGLEBRACKET,"CLOSEANGLEBRACKET",S_URL),makeT(S_URL_OPENPAREN,"CLOSEPAREN",S_URL),makeT(S_URL_OPENBRACE_Q,"CLOSEBRACE",S_URL),makeT(S_URL_OPENBRACKET_Q,"CLOSEBRACKET",S_URL),makeT(S_URL_OPENANGLEBRACKET_Q,"CLOSEANGLEBRACKET",S_URL),makeT(S_URL_OPENPAREN_Q,"CLOSEPAREN",S_URL),makeT(S_URL_OPENBRACE_SYMS,"CLOSEBRACE",S_URL),makeT(S_URL_OPENBRACKET_SYMS,"CLOSEBRACKET",S_URL),makeT(S_URL_OPENANGLEBRACKET_SYMS,"CLOSEANGLEBRACKET",S_URL),makeT(S_URL_OPENPAREN_SYMS,"CLOSEPAREN",S_URL),makeMultiT(S_URL_OPENBRACE,qsAccepting,S_URL_OPENBRACE_Q),makeMultiT(S_URL_OPENBRACKET,qsAccepting,S_URL_OPENBRACKET_Q),makeMultiT(S_URL_OPENANGLEBRACKET,qsAccepting,S_URL_OPENANGLEBRACKET_Q),makeMultiT(S_URL_OPENPAREN,qsAccepting,S_URL_OPENPAREN_Q),makeMultiT(S_URL_OPENBRACE,qsNonAccepting,S_URL_OPENBRACE_SYMS),makeMultiT(S_URL_OPENBRACKET,qsNonAccepting,S_URL_OPENBRACKET_SYMS),makeMultiT(S_URL_OPENANGLEBRACKET,qsNonAccepting,S_URL_OPENANGLEBRACKET_SYMS),makeMultiT(S_URL_OPENPAREN,qsNonAccepting,S_URL_OPENPAREN_SYMS),makeMultiT(S_URL_OPENBRACE_Q,qsAccepting,S_URL_OPENBRACE_Q),makeMultiT(S_URL_OPENBRACKET_Q,qsAccepting,S_URL_OPENBRACKET_Q),makeMultiT(S_URL_OPENANGLEBRACKET_Q,qsAccepting,S_URL_OPENANGLEBRACKET_Q),makeMultiT(S_URL_OPENPAREN_Q,qsAccepting,S_URL_OPENPAREN_Q),makeMultiT(S_URL_OPENBRACE_Q,qsNonAccepting,S_URL_OPENBRACE_Q),makeMultiT(S_URL_OPENBRACKET_Q,qsNonAccepting,S_URL_OPENBRACKET_Q),makeMultiT(S_URL_OPENANGLEBRACKET_Q,qsNonAccepting,S_URL_OPENANGLEBRACKET_Q),makeMultiT(S_URL_OPENPAREN_Q,qsNonAccepting,S_URL_OPENPAREN_Q),makeMultiT(S_URL_OPENBRACE_SYMS,qsAccepting,S_URL_OPENBRACE_Q),makeMultiT(S_URL_OPENBRACKET_SYMS,qsAccepting,S_URL_OPENBRACKET_Q),makeMultiT(S_URL_OPENANGLEBRACKET_SYMS,qsAccepting,S_URL_OPENANGLEBRACKET_Q),makeMultiT(S_URL_OPENPAREN_SYMS,qsAccepting,S_URL_OPENPAREN_Q),makeMultiT(S_URL_OPENBRACE_SYMS,qsNonAccepting,S_URL_OPENBRACE_SYMS),makeMultiT(S_URL_OPENBRACKET_SYMS,qsNonAccepting,S_URL_OPENBRACKET_SYMS),makeMultiT(S_URL_OPENANGLEBRACKET_SYMS,qsNonAccepting,S_URL_OPENANGLEBRACKET_SYMS),makeMultiT(S_URL_OPENPAREN_SYMS,qsNonAccepting,S_URL_OPENPAREN_SYMS),makeMultiT(S_URL,qsAccepting,S_URL),makeMultiT(S_URL_NON_ACCEPTING,qsAccepting,S_URL),makeMultiT(S_URL,qsNonAccepting,S_URL_NON_ACCEPTING),makeMultiT(S_URL_NON_ACCEPTING,qsNonAccepting,S_URL_NON_ACCEPTING),makeT(S_MAILTO,TLD,S_MAILTO_EMAIL),makeT(S_MAILTO,DOMAIN,S_MAILTO_EMAIL),makeT(S_MAILTO,NUM,S_MAILTO_EMAIL),makeT(S_MAILTO,"LOCALHOST",S_MAILTO_EMAIL),makeMultiT(S_MAILTO_EMAIL,qsAccepting,S_MAILTO_EMAIL),makeMultiT(S_MAILTO_EMAIL,qsNonAccepting,S_MAILTO_EMAIL_NON_ACCEPTING),makeMultiT(S_MAILTO_EMAIL_NON_ACCEPTING,qsAccepting,S_MAILTO_EMAIL),makeMultiT(S_MAILTO_EMAIL_NON_ACCEPTING,qsNonAccepting,S_MAILTO_EMAIL_NON_ACCEPTING);var localpartAccepting=["AMPERSAND","APOSTROPHE","ASTERISK","BACKSLASH","BACKTICK","CARET","CLOSEBRACE","DOLLAR",DOMAIN,"EQUALS","HYPHEN",NUM,"OPENBRACE","PERCENT","PIPE","PLUS","POUND","QUERY",SLASH,"SYM","TILDE",TLD,"UNDERSCORE"];return makeMultiT(S_DOMAIN,localpartAccepting,S_LOCALPART),makeT(S_DOMAIN,AT,S_LOCALPART_AT),makeMultiT(S_TLD,localpartAccepting,S_LOCALPART),makeT(S_TLD,AT,S_LOCALPART_AT),makeMultiT(S_DOMAIN_DOT,localpartAccepting,S_LOCALPART),makeMultiT(S_LOCALPART,localpartAccepting,S_LOCALPART),makeT(S_LOCALPART,AT,S_LOCALPART_AT),makeT(S_LOCALPART,DOT,S_LOCALPART_DOT),makeMultiT(S_LOCALPART_DOT,localpartAccepting,S_LOCALPART),makeT(S_LOCALPART_AT,TLD,S_EMAIL_DOMAIN),makeT(S_LOCALPART_AT,DOMAIN,S_EMAIL_DOMAIN),makeT(S_LOCALPART_AT,NUM,S_EMAIL_DOMAIN),makeT(S_LOCALPART_AT,"LOCALHOST",S_EMAIL),S_START}function parserCreateMultiToken(Multi,input,tokens){var startIdx=tokens[0].s,endIdx=tokens[tokens.length-1].e;return new Multi(input.substr(startIdx,endIdx-startIdx),tokens)}var INIT={scanner:null,parser:null,pluginQueue:[],customProtocols:[],initialized:!1};function tokenize(str){return INIT.initialized||function init(){INIT.scanner={start:init$2(INIT.customProtocols),tokens:text},INIT.parser={start:init$1(),tokens:multi};for(var utils={createTokenClass},i=0;i<INIT.pluginQueue.length;i++)INIT.pluginQueue[i][1]({scanner:INIT.scanner,parser:INIT.parser,utils});INIT.initialized=!0}(),function run(start,input,tokens){for(var len=tokens.length,cursor=0,multis=[],textTokens=[];cursor<len;){for(var state=start,secondState=null,nextState=null,multiLength=0,latestAccepting=null,sinceAccepts=-1;cursor<len&&!(secondState=takeT(state,tokens[cursor].t));)textTokens.push(tokens[cursor++]);for(;cursor<len&&(nextState=secondState||takeT(state,tokens[cursor].t));)secondState=null,(state=nextState).accepts()?(sinceAccepts=0,latestAccepting=state):sinceAccepts>=0&&sinceAccepts++,cursor++,multiLength++;if(sinceAccepts<0)for(var i=cursor-multiLength;i<cursor;i++)textTokens.push(tokens[i]);else{textTokens.length>0&&(multis.push(parserCreateMultiToken(Text$1,input,textTokens)),textTokens=[]),cursor-=sinceAccepts,multiLength-=sinceAccepts;var Multi=latestAccepting.t,subtokens=tokens.slice(cursor-multiLength,cursor);multis.push(parserCreateMultiToken(Multi,input,subtokens))}}return textTokens.length>0&&multis.push(parserCreateMultiToken(Text$1,input,textTokens)),multis}(INIT.parser.start,str,function run$1(start,str){for(var iterable=function stringToArray(str){for(var result=[],len=str.length,index=0;index<len;){var first=str.charCodeAt(index),second=void 0,_char=first<55296||first>56319||index+1===len||(second=str.charCodeAt(index+1))<56320||second>57343?str[index]:str.slice(index,index+2);result.push(_char),index+=_char.length}return result}(str.replace(/[A-Z]/g,(function(c){return c.toLowerCase()}))),charCount=iterable.length,tokens=[],cursor=0,charCursor=0;charCursor<charCount;){for(var state=start,nextState=null,tokenLength=0,latestAccepting=null,sinceAccepts=-1,charsSinceAccepts=-1;charCursor<charCount&&(nextState=takeT(state,iterable[charCursor]));)(state=nextState).accepts()?(sinceAccepts=0,charsSinceAccepts=0,latestAccepting=state):sinceAccepts>=0&&(sinceAccepts+=iterable[charCursor].length,charsSinceAccepts++),tokenLength+=iterable[charCursor].length,cursor+=iterable[charCursor].length,charCursor++;cursor-=sinceAccepts,charCursor-=charsSinceAccepts,tokenLength-=sinceAccepts,tokens.push({t:latestAccepting.t,v:str.substr(cursor-tokenLength,tokenLength),s:cursor-tokenLength,e:cursor})}return tokens}(INIT.scanner.start,str))}function _find(str){for(var type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,tokens=tokenize(str),filtered=[],i=0;i<tokens.length;i++){var token=tokens[i];!token.isLink||type&&token.t!==type||filtered.push(token.toObject())}return filtered}function test(str){var type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,tokens=tokenize(str);return 1===tokens.length&&tokens[0].isLink&&(!type||tokens[0].t===type)}function autolink(options){return new Plugin({key:new PluginKey("autolink"),appendTransaction:function appendTransaction(transactions,oldState,newState){var docChanges=transactions.some((function(transaction){return transaction.docChanged}))&&!oldState.doc.eq(newState.doc),preventAutolink=transactions.some((function(transaction){return transaction.getMeta("preventAutolink")}));if(docChanges&&!preventAutolink){var tr=newState.tr,transform=function combineTransactionSteps(oldDoc,transactions){var transform=new Transform(oldDoc);return transactions.forEach((function(transaction){transaction.steps.forEach((function(step){transform.step(step)}))})),transform}(oldState.doc,transactions),mapping=transform.mapping,changes=function getChangedRanges(transform){var mapping=transform.mapping,steps=transform.steps,changes=[];return mapping.maps.forEach((function(stepMap,index){var ranges=[];if(stepMap.ranges.length)stepMap.forEach((function(from,to){ranges.push({from,to})}));else{var _steps$index=steps[index],from=_steps$index.from,to=_steps$index.to;if(void 0===from||void 0===to)return;ranges.push({from,to})}ranges.forEach((function(_ref89){var from=_ref89.from,to=_ref89.to,newStart=mapping.slice(index).map(from,-1),newEnd=mapping.slice(index).map(to),oldStart=mapping.invert().map(newStart,-1),oldEnd=mapping.invert().map(newEnd);changes.push({oldRange:{from:oldStart,to:oldEnd},newRange:{from:newStart,to:newEnd}})}))})),simplifyChangedRanges(changes)}(transform);if(changes.forEach((function(_ref149){var oldRange=_ref149.oldRange,newRange=_ref149.newRange;getMarksBetween(oldRange.from,oldRange.to,oldState.doc).filter((function(item){return item.mark.type===options.type})).forEach((function(oldMark){var newMarks=getMarksBetween(mapping.map(oldMark.from),mapping.map(oldMark.to),newState.doc).filter((function(item){return item.mark.type===options.type}));if(newMarks.length){var newMark=newMarks[0],oldLinkText=oldState.doc.textBetween(oldMark.from,oldMark.to,void 0," "),newLinkText=newState.doc.textBetween(newMark.from,newMark.to,void 0," "),wasLink=test(oldLinkText),isLink=test(newLinkText);wasLink&&!isLink&&tr.removeMark(newMark.from,newMark.to,options.type)}})),function findChildrenInRange(node,range,predicate){var nodesWithPos=[];return node.nodesBetween(range.from,range.to,(function(child,pos){predicate(child)&&nodesWithPos.push({node:child,pos})})),nodesWithPos}(newState.doc,newRange,(function(node){return node.isTextblock})).forEach((function(textBlock){_find(newState.doc.textBetween(textBlock.pos,textBlock.pos+textBlock.node.nodeSize,void 0," ")).filter((function(link){return link.isLink})).map((function(link){return Object.assign({},link,{from:textBlock.pos+link.start+1,to:textBlock.pos+link.end+1})})).filter((function(link){var fromIsInRange=newRange.from>=link.from&&newRange.from<=link.to,toIsInRange=newRange.to>=link.from&&newRange.to<=link.to;return fromIsInRange||toIsInRange})).forEach((function(link){tr.addMark(link.from,link.to,options.type.create({href:link.href}))}))}))})),tr.steps.length)return tr}}})}var Actions,Link=Mark.create({name:"link",priority:1e3,keepOnSplit:!1,inclusive:function inclusive(){return this.options.autolink},addOptions:function addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow"}}},addAttributes:function addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target}}},parseHTML:function parseHTML(){return[{tag:"a[href]"}]},renderHTML:function renderHTML(_ref150){var HTMLAttributes=_ref150.HTMLAttributes;return["a",mergeAttributes(this.options.HTMLAttributes,HTMLAttributes),0]},addCommands:function addCommands(){var _this52=this;return{setLink:function setLink(attributes){return function(_ref151){return(0,_ref151.chain)().setMark(_this52.name,attributes).setMeta("preventAutolink",!0).run()}},toggleLink:function toggleLink(attributes){return function(_ref152){return(0,_ref152.chain)().toggleMark(_this52.name,attributes,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},unsetLink:function unsetLink(){return function(_ref153){return(0,_ref153.chain)().unsetMark(_this52.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}}}},addPasteRules:function addPasteRules(){return[markPasteRule({find:function find(text){return _find(text).filter((function(link){return link.isLink})).map((function(link){return{text:link.value,index:link.start,data:link}}))},type:this.type,getAttributes:function getAttributes(match){var _a;return{href:null===(_a=match.data)||void 0===_a?void 0:_a.href}}})]},addProseMirrorPlugins:function addProseMirrorPlugins(){var plugins=[];return this.options.autolink&&plugins.push(autolink({type:this.type})),this.options.openOnClick&&plugins.push(function clickHandler(options){return new Plugin({key:new PluginKey("handleClickLink"),props:{handleClick:function handleClick(view,pos,event){var _a,attrs=_getAttributes(view.state,options.type.name);return!(!(null===(_a=event.target)||void 0===_a?void 0:_a.closest("a"))||!attrs.href||(window.open(attrs.href,attrs.target),0))}}})}({type:this.type})),this.options.linkOnPaste&&plugins.push(function pasteHandler(options){return new Plugin({key:new PluginKey("handlePasteLink"),props:{handlePaste:function handlePaste(view,event,slice){if(view.state.selection.empty)return!1;var textContent="";slice.content.forEach((function(node){textContent+=node.textContent}));var link=_find(textContent).find((function(item){return item.isLink&&item.value===textContent}));return!(!textContent||!link||(options.editor.commands.setMark(options.type,{href:link.href}),0))}}})}({editor:this.editor,type:this.type})),plugins}}),defaultSerializerConfig={marks:(_marks2={em:defaultMarkdownSerializer.marks.em},_marks2[Bold.name]=defaultMarkdownSerializer.marks.strong,_marks2[Code.name]=defaultMarkdownSerializer.marks.code,_marks2[Italic.name]={open:"_",close:"_",mixable:!0,expelEnclosingWhitespace:!0},_marks2[Link.name]=defaultMarkdownSerializer.marks.link,_marks2[Strike.name]={open:"~~",close:"~~",mixable:!0,expelEnclosingWhitespace:!0},_marks2),nodes:Object.assign(Object.assign({},defaultMarkdownSerializer.nodes),(_Object$assign5={},_Object$assign5[Blockquote.name]=function(state,node){node.attrs.multiline?(state.write(">>>"),state.ensureNewLine(),state.renderContent(node),state.ensureNewLine(),state.write(">>>"),state.closeBlock(node)):state.wrapBlock("> ",null,node,(function(){return state.renderContent(node)}))},_Object$assign5[CodeBlock.name]=defaultMarkdownSerializer.nodes.code_block,_Object$assign5[Heading.name]=defaultMarkdownSerializer.nodes.heading,_Object$assign5[HardBreak.name]=defaultMarkdownSerializer.nodes.hard_break,_Object$assign5[HorizontalRule.name]=defaultMarkdownSerializer.nodes.horizontal_rule,_Object$assign5[BulletList.name]=defaultMarkdownSerializer.nodes.bullet_list,_Object$assign5[OrderedList.name]=defaultMarkdownSerializer.nodes.ordered_list,_Object$assign5[ListItem.name]=defaultMarkdownSerializer.nodes.list_item,_Object$assign5[Paragraph.name]=defaultMarkdownSerializer.nodes.paragraph,_Object$assign5[Text.name]=defaultMarkdownSerializer.nodes.text,_Object$assign5[TaskItem.name]=function(state,node){state.write("["+(node.attrs.checked?"x":" ")+"] "),state.renderContent(node)},_Object$assign5[TaskList.name]=function(state,node){node.attrs.numeric?defaultMarkdownSerializer.nodes.ordered_list(state,node):defaultMarkdownSerializer.nodes.bullet_list(state,node)},_Object$assign5))},markdownSerializer=new MarkdownSerializer(defaultSerializerConfig.nodes,defaultSerializerConfig.marks),markdownRenderer=null,markdownSerializer$1_serialize=function serialize(content){return markdownSerializer.serialize(content,{tightLists:!0})},markdownSerializer$1_parse=function parse(markdownText){return markdownRenderer||(markdownRenderer=defaultMarkdownParser.tokenizer.enable("strikethrough").use(taskLists,{enabled:!0,label:!0,labelAfter:!0})),markdownRenderer.render(markdownText)};!function(Actions){Actions[Actions.ITALIC=0]="ITALIC",Actions[Actions.BOLD=1]="BOLD",Actions[Actions.H1=2]="H1",Actions[Actions.H2=3]="H2",Actions[Actions.STRIKE=4]="STRIKE",Actions[Actions.OL=5]="OL",Actions[Actions.UL=6]="UL",Actions[Actions.LINK=7]="LINK",Actions[Actions.CODE_BLOCK=8]="CODE_BLOCK",Actions[Actions.BLOCKQUOTE=9]="BLOCKQUOTE",Actions[Actions.TASK_LIST=10]="TASK_LIST"}(Actions||(Actions={}));var focusChain=function focusChain(editor){return editor.chain().focus()};var MarkdownEditor=function(){function MarkdownEditor(hostRef){var _this53=this;_classCallCheck(this,MarkdownEditor),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.r)(this,hostRef),this.viewModeChange=(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.c)(this,"viewModeChange",7),this.valueChange=(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.c)(this,"valueChange",7),this.inoBlur=(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.c)(this,"inoBlur",3),this.viewMode="preview",this.toolbarActionsState=new Set,this.errorMessage="",this.handlePreviewBlur=function(){var markdownText=_this53.htmlToMarkdown();_this53.errorMessage||_this53.valueChange.emit(markdownText),_this53.inoBlur.emit()},this.onEditorTransaction=function(){_this53.toolbarActionsState=new Set(Object.values(Actions).filter((function(action){return"number"==typeof action&&function isToolbarBtnActive(editor,action){if(!editor)return!1;switch(action){case Actions.H1:return editor.isActive("heading",{level:1});case Actions.H2:return editor.isActive("heading",{level:2});case Actions.BOLD:return editor.isActive("bold");case Actions.ITALIC:return editor.isActive("italic");case Actions.STRIKE:return editor.isActive("strike");case Actions.LINK:return editor.isActive("link");case Actions.OL:return editor.isActive("orderedList");case Actions.UL:return editor.isActive("bulletList");case Actions.BLOCKQUOTE:return editor.isActive("blockquote");case Actions.CODE_BLOCK:return editor.isActive("code");case Actions.TASK_LIST:return editor.isActive("taskList");default:console.warn("case missing:",action)}}(_this53.editor,action)})))},this.onTextareaChange=function(e){e.stopPropagation(),_this53.textareaRef.value=e.detail},this.handleMarkdownBlur=function(e){e.stopPropagation(),_this53.editor.commands.clearContent(),_this53.editor.commands.setContent(_this53.markdownToHtml(_this53.textareaRef.value)),_this53.errorMessage||_this53.valueChange.emit(_this53.textareaRef.value),_this53.inoBlur.emit()}}return _createClass(MarkdownEditor,[{key:"handleInitialValueChange",value:function handleInitialValueChange(newInitialValue){this.initializeEditor(newInitialValue)}},{key:"handleViewModeChange",value:function handleViewModeChange(newViewMode){var _a;newViewMode===ViewMode.MARKDOWN&&this.textareaRef?(this.textareaRef.value=this.htmlToMarkdown(),this.textareaRef.rows=this.textareaRef.value.split("\n").length):null===(_a=this.editor)||void 0===_a||_a.setEditable(newViewMode!==ViewMode.READONLY)}},{key:"componentDidLoad",value:function componentDidLoad(){this.createEditor(),this.initialValue&&this.initializeEditor(this.initialValue),this.textareaRef.addEventListener("valueChange",this.onTextareaChange),this.textareaRef.addEventListener("inoBlur",this.handleMarkdownBlur)}},{key:"disconnectedCallback",value:function disconnectedCallback(){var _a;null===(_a=this.editor)||void 0===_a||_a.destroy(),this.textareaRef.removeEventListener("valueChange",this.onTextareaChange),this.textareaRef.removeEventListener("inoBlur",this.handleMarkdownBlur)}},{key:"initializeEditor",value:function initializeEditor(initialValue){this.editor&&(this.editor.commands.setContent(this.markdownToHtml(initialValue),!0),this.textareaRef.value=this.htmlToMarkdown(),this.textareaRef.rows=this.textareaRef.value.split("\n").length)}},{key:"createEditor",value:function createEditor(){this.editor=new Editor({element:this.editorRef,extensions:[StarterKit.configure({bulletList:!1}),BulletList,Link,TaskItem,TaskList],onBlur:this.handlePreviewBlur,onTransaction:this.onEditorTransaction,editable:this.viewMode!==ViewMode.READONLY})}},{key:"htmlToMarkdown",value:function htmlToMarkdown(){var _this54=this;return this.tryParse((function(){var doc=_this54.editor.schema.nodeFromJSON(_this54.editor.getJSON());return markdownSerializer$1_serialize(doc)}),this.textareaRef.value)}},{key:"markdownToHtml",value:function markdownToHtml(){var md=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.initialValue;return this.tryParse((function(){return markdownSerializer$1_parse(md)}),this.editor.getHTML())}},{key:"tryParse",value:function tryParse(parseCallback,fallbackValue){try{return this.errorMessage="",parseCallback()}catch(err){return this.errorMessage=err.message,console.error(err),fallbackValue}}},{key:"handleViewModeBtnClick",value:function handleViewModeBtnClick(viewMode){this.errorMessage||this.viewModeChange.emit(viewMode)}},{key:"handleToolbarActionClick",value:function handleToolbarActionClick(action){!function handleToolbarBtnClick(editor,action){switch(action){case Actions.H1:focusChain(editor).toggleHeading({level:1}).run();break;case Actions.H2:focusChain(editor).toggleHeading({level:2}).run();break;case Actions.BOLD:focusChain(editor).toggleBold().run();break;case Actions.ITALIC:focusChain(editor).toggleItalic().run();break;case Actions.STRIKE:focusChain(editor).toggleStrike().run();break;case Actions.LINK:focusChain(editor).unsetLink().run();break;case Actions.OL:focusChain(editor).toggleOrderedList().run();break;case Actions.UL:focusChain(editor).toggleBulletList().run();break;case Actions.BLOCKQUOTE:focusChain(editor).toggleBlockquote().run();break;case Actions.CODE_BLOCK:focusChain(editor).toggleCodeBlock().run();break;case Actions.TASK_LIST:focusChain(editor).toggleTaskList().run();break;default:console.warn("case missing:",action)}}(this.editor,action)}},{key:"render",value:function render(){var _this55=this,isReadonlyMode=this.viewMode===ViewMode.READONLY,isPreviewMode=isReadonlyMode||this.viewMode===ViewMode.PREVIEW,isMarkdownMode=this.viewMode===ViewMode.MARKDOWN,editorClasses=(0,_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__.c)({"markdown-editor":!0,"markdown-editor--readonly":isReadonlyMode}),previewModeEditorClasses=(0,_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__.c)({"markdown-editor__content__container":!0,"show-editor":isPreviewMode,"hide-editor":isMarkdownMode}),markdownModeEditorClasses=(0,_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__.c)({"show-editor":isMarkdownMode,"hide-editor":isPreviewMode}),getViewModeBtnClasses=function getViewModeBtnClasses(viewMode){return(0,_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__.c)({"toolbar__action-button":!0,"toolbar__view-mode":!0,"toolbar__action-button--active":_this55.viewMode===viewMode})},textFormatToolbarClasses=(0,_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__.c)({"toolbar__text-format":!0,"toolbar__text-format--show":isPreviewMode,"toolbar__text-format--hide":isMarkdownMode}),getToolbarActionBtnClass=function getToolbarActionBtnClass(action){return(0,_index_b7e5b0c5_js__WEBPACK_IMPORTED_MODULE_71__.c)({"toolbar__action-button":!0,"toolbar__action-button--active":_this55.toolbarActionsState.has(action)})};return(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("div",{class:editorClasses},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("div",{class:"markdown-editor__toolbar"},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("div",null,(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getViewModeBtnClasses(ViewMode.PREVIEW),onClick:function onClick(){return _this55.handleViewModeBtnClick(ViewMode.PREVIEW)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"edit_text"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getViewModeBtnClasses(ViewMode.MARKDOWN),onClick:function onClick(){return _this55.handleViewModeBtnClick(ViewMode.MARKDOWN)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"code"}))),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("div",{class:textFormatToolbarClasses},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.H1),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.H1)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"headline_one"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.H2),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.H2)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"headline_two"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.BOLD),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.BOLD)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"bold"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.ITALIC),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.ITALIC)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"italic"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.STRIKE),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.STRIKE)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"strikethrough"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.LINK),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.LINK)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"link"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.UL),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.UL)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"bullet_list"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.OL),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.OL)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"numeric_list"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.TASK_LIST),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.TASK_LIST)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"checkmark"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.BLOCKQUOTE),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.BLOCKQUOTE)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"quote"})),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("button",{class:getToolbarActionBtnClass(Actions.CODE_BLOCK),onClick:function onClick(){return _this55.handleToolbarActionClick(Actions.CODE_BLOCK)}},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-icon",{icon:"code_block"}))),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-popover",{placement:"top-start","color-scheme":"transparent",controlled:!0,visible:Boolean(this.errorMessage)},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("span",{class:"markdown-editor__error-text"},this.errorMessage))),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("div",{class:"markdown-editor__content"},(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("div",{class:previewModeEditorClasses,ref:function ref(el){return _this55.editorRef=el}}),(0,_index_dbb9ab19_js__WEBPACK_IMPORTED_MODULE_70__.h)("ino-textarea",{ref:function ref(el){return _this55.textareaRef=el},class:markdownModeEditorClasses,cols:100,autogrow:!0,outline:!0})))}}],[{key:"watchers",get:function get(){return{initialValue:["handleInitialValueChange"],viewMode:["handleViewModeChange"]}}}]),MarkdownEditor}();MarkdownEditor.style="ino-markdown-editor .markdown-editor{border-radius:10px}ino-markdown-editor .markdown-editor--readonly .markdown-editor__toolbar{display:none}ino-markdown-editor .markdown-editor--readonly .ProseMirror{padding:0;border:0}ino-markdown-editor .markdown-editor--readonly .ProseMirror-focused{outline:none}ino-markdown-editor .markdown-editor__error-text{display:block;padding:10px;color:#9f0028}ino-markdown-editor .markdown-editor__toolbar{display:grid;grid-template-columns:auto auto;justify-content:space-between;border-radius:10px;background-color:#f9f9f9;padding:10px 20px;margin-bottom:10px}ino-markdown-editor .toolbar__action-button{--ino-icon-color-primary:#9d9d9d;border:0;margin:0;padding:1px 2px;border-radius:10px;background-color:transparent;font-size:22px}ino-markdown-editor .toolbar__action-button:hover{--ino-icon-color-primary:#0d10f3;background-color:rgba(13, 16, 243, 0.1);color:#0d10f3;cursor:pointer}ino-markdown-editor .toolbar__action-button--active{--ino-icon-color-primary:#0d10f3;background-color:rgba(13, 16, 243, 0.1);color:#0d10f3;box-shadow:inset 0 3px 6px rgba(0, 0, 0, 0.16)}ino-markdown-editor .toolbar__action-button ino-icon{vertical-align:middle;padding:5px}ino-markdown-editor .toolbar__view-mode{border-radius:0;margin:0}ino-markdown-editor .toolbar__view-mode:first-of-type{border-radius:10px 0 0 10px}ino-markdown-editor .toolbar__view-mode:last-of-type{border-radius:0 10px 10px 0}ino-markdown-editor .toolbar__text-format--show{display:block}ino-markdown-editor .toolbar__text-format--hide{display:none}ino-markdown-editor .markdown-editor__content__container{height:100%;width:100%}ino-markdown-editor .markdown-editor__content{overflow:auto;max-height:var(--ino-markdown-editor-max-height, none)}ino-markdown-editor .markdown-editor__content ino-textarea{width:100%;height:100%}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined{display:flex}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:#e7e7e7}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#9b9b9b}ino-markdown-editor .markdown-editor__content ino-textarea .mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{min-height:var(--ino-markdown-editor-min-height, 100px);line-height:normal;letter-spacing:0}ino-markdown-editor .show-editor{display:block}ino-markdown-editor .hide-editor{display:none}ino-markdown-editor .ProseMirror{min-height:var(--ino-markdown-editor-min-height, 100px);padding:15px;border-radius:4px;border:1px solid #e7e7e7;color:rgba(0, 0, 0, 0.87)}ino-markdown-editor .ProseMirror:hover:not(ino-markdown-editor .ProseMirror-focused){border-color:#9b9b9b}ino-markdown-editor .ProseMirror-focused{outline:#3d40f5 auto 1px}ino-markdown-editor .ProseMirror *:first-child{margin-top:0;padding-top:0}ino-markdown-editor .ProseMirror *:last-child{margin-bottom:0;padding-bottom:0}ino-markdown-editor .ProseMirror blockquote{padding-left:10px;border-left:3px solid #c1c1c1}ino-markdown-editor .ProseMirror p{margin-top:0;margin-bottom:1.2em}ino-markdown-editor .ProseMirror pre code{display:block;background-color:rgba(193, 193, 193, 0.15);white-space:pre;-webkit-overflow-scrolling:touch;overflow-x:auto;max-width:100%;min-width:100px;padding:6px 8px}ino-markdown-editor .ProseMirror ul[data-type=taskList]{list-style:none}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList]{padding-left:12px}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] p{margin:0}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li{display:flex}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li>label{flex:0 0 auto;margin-right:0.5rem;user-select:none}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li>div{flex:1 1 auto;display:inline-block}ino-markdown-editor .ProseMirror :is(ul,ol)[data-type=taskList] li input[type=checkbox]{accent-color:#3d40f5}"},"../../node_modules/core-js/internals/array-last-index-of.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var toIndexedObject=__webpack_require__("../../node_modules/core-js/internals/to-indexed-object.js"),toInteger=__webpack_require__("../../node_modules/core-js/internals/to-integer.js"),toLength=__webpack_require__("../../node_modules/core-js/internals/to-length.js"),arrayMethodIsStrict=__webpack_require__("../../node_modules/core-js/internals/array-method-is-strict.js"),min=Math.min,$lastIndexOf=[].lastIndexOf,NEGATIVE_ZERO=!!$lastIndexOf&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD=arrayMethodIsStrict("lastIndexOf"),FORCED=NEGATIVE_ZERO||!STRICT_METHOD;module.exports=FORCED?function lastIndexOf(searchElement){if(NEGATIVE_ZERO)return $lastIndexOf.apply(this,arguments)||0;var O=toIndexedObject(this),length=toLength(O.length),index=length-1;for(arguments.length>1&&(index=min(index,toInteger(arguments[1]))),index<0&&(index=length+index);index>=0;index--)if(index in O&&O[index]===searchElement)return index||0;return-1}:$lastIndexOf},"../../node_modules/core-js/internals/array-reduce.js":(module,__unused_webpack_exports,__webpack_require__)=>{var aFunction=__webpack_require__("../../node_modules/core-js/internals/a-function.js"),toObject=__webpack_require__("../../node_modules/core-js/internals/to-object.js"),IndexedObject=__webpack_require__("../../node_modules/core-js/internals/indexed-object.js"),toLength=__webpack_require__("../../node_modules/core-js/internals/to-length.js"),createMethod=function(IS_RIGHT){return function(that,callbackfn,argumentsLength,memo){aFunction(callbackfn);var O=toObject(that),self=IndexedObject(O),length=toLength(O.length),index=IS_RIGHT?length-1:0,i=IS_RIGHT?-1:1;if(argumentsLength<2)for(;;){if(index in self){memo=self[index],index+=i;break}if(index+=i,IS_RIGHT?index<0:length<=index)throw TypeError("Reduce of empty array with no initial value")}for(;IS_RIGHT?index>=0:length>index;index+=i)index in self&&(memo=callbackfn(memo,self[index],index,O));return memo}};module.exports={left:createMethod(!1),right:createMethod(!0)}},"../../node_modules/core-js/internals/flatten-into-array.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var isArray=__webpack_require__("../../node_modules/core-js/internals/is-array.js"),toLength=__webpack_require__("../../node_modules/core-js/internals/to-length.js"),bind=__webpack_require__("../../node_modules/core-js/internals/function-bind-context.js"),flattenIntoArray=function(target,original,source,sourceLen,start,depth,mapper,thisArg){for(var element,targetIndex=start,sourceIndex=0,mapFn=!!mapper&&bind(mapper,thisArg,3);sourceIndex<sourceLen;){if(sourceIndex in source){if(element=mapFn?mapFn(source[sourceIndex],sourceIndex,original):source[sourceIndex],depth>0&&isArray(element))targetIndex=flattenIntoArray(target,original,element,toLength(element.length),targetIndex,depth-1)-1;else{if(targetIndex>=9007199254740991)throw TypeError("Exceed the acceptable array length");target[targetIndex]=element}targetIndex++}sourceIndex++}return targetIndex};module.exports=flattenIntoArray},"../../node_modules/core-js/internals/number-parse-int.js":(module,__unused_webpack_exports,__webpack_require__)=>{var global=__webpack_require__("../../node_modules/core-js/internals/global.js"),trim=__webpack_require__("../../node_modules/core-js/internals/string-trim.js").trim,whitespaces=__webpack_require__("../../node_modules/core-js/internals/whitespaces.js"),$parseInt=global.parseInt,hex=/^[+-]?0[Xx]/,FORCED=8!==$parseInt(whitespaces+"08")||22!==$parseInt(whitespaces+"0x16");module.exports=FORCED?function parseInt(string,radix){var S=trim(String(string));return $parseInt(S,radix>>>0||(hex.test(S)?16:10))}:$parseInt},"../../node_modules/core-js/modules/es.array.flat.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),flattenIntoArray=__webpack_require__("../../node_modules/core-js/internals/flatten-into-array.js"),toObject=__webpack_require__("../../node_modules/core-js/internals/to-object.js"),toLength=__webpack_require__("../../node_modules/core-js/internals/to-length.js"),toInteger=__webpack_require__("../../node_modules/core-js/internals/to-integer.js"),arraySpeciesCreate=__webpack_require__("../../node_modules/core-js/internals/array-species-create.js");$({target:"Array",proto:!0},{flat:function flat(){var depthArg=arguments.length?arguments[0]:void 0,O=toObject(this),sourceLen=toLength(O.length),A=arraySpeciesCreate(O,0);return A.length=flattenIntoArray(A,O,O,sourceLen,0,void 0===depthArg?1:toInteger(depthArg)),A}})},"../../node_modules/core-js/modules/es.array.last-index-of.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),lastIndexOf=__webpack_require__("../../node_modules/core-js/internals/array-last-index-of.js");$({target:"Array",proto:!0,forced:lastIndexOf!==[].lastIndexOf},{lastIndexOf})},"../../node_modules/core-js/modules/es.array.reduce.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),$reduce=__webpack_require__("../../node_modules/core-js/internals/array-reduce.js").left,arrayMethodIsStrict=__webpack_require__("../../node_modules/core-js/internals/array-method-is-strict.js"),CHROME_VERSION=__webpack_require__("../../node_modules/core-js/internals/engine-v8-version.js"),IS_NODE=__webpack_require__("../../node_modules/core-js/internals/engine-is-node.js");$({target:"Array",proto:!0,forced:!arrayMethodIsStrict("reduce")||!IS_NODE&&CHROME_VERSION>79&&CHROME_VERSION<83},{reduce:function reduce(callbackfn){return $reduce(this,callbackfn,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"../../node_modules/core-js/modules/es.date.now.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{__webpack_require__("../../node_modules/core-js/internals/export.js")({target:"Date",stat:!0},{now:function now(){return(new Date).getTime()}})},"../../node_modules/core-js/modules/es.date.to-json.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),fails=__webpack_require__("../../node_modules/core-js/internals/fails.js"),toObject=__webpack_require__("../../node_modules/core-js/internals/to-object.js"),toPrimitive=__webpack_require__("../../node_modules/core-js/internals/to-primitive.js");$({target:"Date",proto:!0,forced:fails((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function toJSON(key){var O=toObject(this),pv=toPrimitive(O);return"number"!=typeof pv||isFinite(pv)?O.toISOString():null}})},"../../node_modules/core-js/modules/es.parse-int.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),parseIntImplementation=__webpack_require__("../../node_modules/core-js/internals/number-parse-int.js");$({global:!0,forced:parseInt!=parseIntImplementation},{parseInt:parseIntImplementation})},"../../node_modules/core-js/modules/es.string.from-code-point.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),toAbsoluteIndex=__webpack_require__("../../node_modules/core-js/internals/to-absolute-index.js"),fromCharCode=String.fromCharCode,$fromCodePoint=String.fromCodePoint;$({target:"String",stat:!0,forced:!!$fromCodePoint&&1!=$fromCodePoint.length},{fromCodePoint:function fromCodePoint(x){for(var code,elements=[],length=arguments.length,i=0;length>i;){if(code=+arguments[i++],toAbsoluteIndex(code,1114111)!==code)throw RangeError(code+" is not a valid code point");elements.push(code<65536?fromCharCode(code):fromCharCode(55296+((code-=65536)>>10),code%1024+56320))}return elements.join("")}})},"../../node_modules/core-js/modules/es.string.italics.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("../../node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("../../node_modules/core-js/internals/string-html-forced.js")("italics")},{italics:function italics(){return createHTML(this,"i","","")}})},"../../node_modules/core-js/modules/es.string.link.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("../../node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("../../node_modules/core-js/internals/string-html-forced.js")("link")},{link:function link(url){return createHTML(this,"a","href",url)}})},"../../node_modules/core-js/modules/es.string.match-all.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createIteratorConstructor=__webpack_require__("../../node_modules/core-js/internals/create-iterator-constructor.js"),requireObjectCoercible=__webpack_require__("../../node_modules/core-js/internals/require-object-coercible.js"),toLength=__webpack_require__("../../node_modules/core-js/internals/to-length.js"),aFunction=__webpack_require__("../../node_modules/core-js/internals/a-function.js"),anObject=__webpack_require__("../../node_modules/core-js/internals/an-object.js"),classof=__webpack_require__("../../node_modules/core-js/internals/classof-raw.js"),isRegExp=__webpack_require__("../../node_modules/core-js/internals/is-regexp.js"),getRegExpFlags=__webpack_require__("../../node_modules/core-js/internals/regexp-flags.js"),createNonEnumerableProperty=__webpack_require__("../../node_modules/core-js/internals/create-non-enumerable-property.js"),fails=__webpack_require__("../../node_modules/core-js/internals/fails.js"),wellKnownSymbol=__webpack_require__("../../node_modules/core-js/internals/well-known-symbol.js"),speciesConstructor=__webpack_require__("../../node_modules/core-js/internals/species-constructor.js"),advanceStringIndex=__webpack_require__("../../node_modules/core-js/internals/advance-string-index.js"),InternalStateModule=__webpack_require__("../../node_modules/core-js/internals/internal-state.js"),IS_PURE=__webpack_require__("../../node_modules/core-js/internals/is-pure.js"),MATCH_ALL=wellKnownSymbol("matchAll"),setInternalState=InternalStateModule.set,getInternalState=InternalStateModule.getterFor("RegExp String Iterator"),RegExpPrototype=RegExp.prototype,regExpBuiltinExec=RegExpPrototype.exec,nativeMatchAll="".matchAll,WORKS_WITH_NON_GLOBAL_REGEX=!!nativeMatchAll&&!fails((function(){"a".matchAll(/./)})),$RegExpStringIterator=createIteratorConstructor((function RegExpStringIterator(regexp,string,global,fullUnicode){setInternalState(this,{type:"RegExp String Iterator",regexp,string,global,unicode:fullUnicode,done:!1})}),"RegExp String",(function next(){var state=getInternalState(this);if(state.done)return{value:void 0,done:!0};var R=state.regexp,S=state.string,match=function(R,S){var result,exec=R.exec;if("function"==typeof exec){if("object"!=typeof(result=exec.call(R,S)))throw TypeError("Incorrect exec result");return result}return regExpBuiltinExec.call(R,S)}(R,S);return null===match?{value:void 0,done:state.done=!0}:state.global?(""==String(match[0])&&(R.lastIndex=advanceStringIndex(S,toLength(R.lastIndex),state.unicode)),{value:match,done:!1}):(state.done=!0,{value:match,done:!1})})),$matchAll=function(string){var C,flagsValue,flags,matcher,global,fullUnicode,R=anObject(this),S=String(string);return C=speciesConstructor(R,RegExp),void 0===(flagsValue=R.flags)&&R instanceof RegExp&&!("flags"in RegExpPrototype)&&(flagsValue=getRegExpFlags.call(R)),flags=void 0===flagsValue?"":String(flagsValue),matcher=new C(C===RegExp?R.source:R,flags),global=!!~flags.indexOf("g"),fullUnicode=!!~flags.indexOf("u"),matcher.lastIndex=toLength(R.lastIndex),new $RegExpStringIterator(matcher,S,global,fullUnicode)};$({target:"String",proto:!0,forced:WORKS_WITH_NON_GLOBAL_REGEX},{matchAll:function matchAll(regexp){var S,matcher,rx,O=requireObjectCoercible(this);if(null!=regexp){if(isRegExp(regexp)&&!~String(requireObjectCoercible("flags"in RegExpPrototype?regexp.flags:getRegExpFlags.call(regexp))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(WORKS_WITH_NON_GLOBAL_REGEX)return nativeMatchAll.apply(O,arguments);if(void 0===(matcher=regexp[MATCH_ALL])&&IS_PURE&&"RegExp"==classof(regexp)&&(matcher=$matchAll),null!=matcher)return aFunction(matcher).call(regexp,O)}else if(WORKS_WITH_NON_GLOBAL_REGEX)return nativeMatchAll.apply(O,arguments);return S=String(O),rx=new RegExp(regexp,"g"),IS_PURE?$matchAll.call(rx,S):rx[MATCH_ALL](S)}}),IS_PURE||MATCH_ALL in RegExpPrototype||createNonEnumerableProperty(RegExpPrototype,MATCH_ALL,$matchAll)},"../../node_modules/core-js/modules/es.string.strike.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var $=__webpack_require__("../../node_modules/core-js/internals/export.js"),createHTML=__webpack_require__("../../node_modules/core-js/internals/create-html.js");$({target:"String",proto:!0,forced:__webpack_require__("../../node_modules/core-js/internals/string-html-forced.js")("strike")},{strike:function strike(){return createHTML(this,"strike","","")}})},"../../node_modules/core-js/modules/web.url.to-json.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{"use strict";__webpack_require__("../../node_modules/core-js/internals/export.js")({target:"URL",proto:!0,enumerable:!0},{toJSON:function toJSON(){return URL.prototype.toString.call(this)}})}}]);
//# sourceMappingURL=622.90e5aec9.iframe.bundle.js.map